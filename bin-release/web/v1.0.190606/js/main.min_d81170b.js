var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,s){function r(e){try{l(o.next(e))}catch(t){s(t)}}function a(e){try{l(o["throw"](e))}catch(t){s(t)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(r,a)}l((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,s&&(r=s[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(s,n[1])).done)return r;switch(s=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,s=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(r=l.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){l.label=n[1];break}if(6===n[0]&&l.label<r[1]){l.label=r[1],r=n;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(n);break}r[2]&&l.ops.pop(),l.trys.pop();continue}n=t.call(e,l)}catch(o){n=[6,o],s=0}finally{i=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,s,r,a,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Email;!function(e){var t=function(){function e(){}return e.ITEMS_EMAIL_TIMEOUT=5e3,e.SYSTEM_ALL_UID="999999",e.EMAIL_REPLY_PREFIX="Re:",e.EVENT_EMAIL_RELOAD_DATA="Event.Email.Reload.Data",e}();e.Constants=t,__reflect(t.prototype,"Email.Constants")}(Email||(Email={}));var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function o(o){t.call(n,o,e)}if(RES.hasRes(e)){var i=RES.getRes(e);i?o(i):RES.getResAsync(e,o,this)}else RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(e){function t(){var n=e.call(this)||this;return t.instance=n,n}return __extends(t,e),t.getInstance=function(){return t.instance},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=t.sent(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,RES.loadGroup("loading")];case 2:return n.sent(),e=new LoadingUI,e.x=this.stage.width/2-e.width,e.width=this.stage.stageWidth,e.height=this.stage.stageHeight,this.stage.addChild(e),[4,this.loadTheme()];case 3:return n.sent(),[4,RES.loadGroup("preload",0,e)];case 4:return n.sent(),this.stage.removeChild(e),[3,6];case 5:return t=n.sent(),console.error(t),[3,6];case 6:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var o=new eui.Theme("resource/default.thm.json",e.stage);o.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){EventHandlersManager.getInstance().registerEventHandlers(),GlobalUtils.loadSystemConfiguration(),SceneManager.getInstance(),this.showLoginScene()},t.prototype.showLoginScene=function(){var e=LoginScene.getInstance(),t=this.stage.stageWidth,n=this.stage.stageHeight;e.width=t,e.height=n,e.x=0,e.y=0,e.horizontalCenter=0,e.verticalCenter=0,this.stage.addChild(e)},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t},t.prototype.onButtonClick=function(e){var t=new eui.Panel;t.title="Title",t.horizontalCenter=0,t.verticalCenter=0,this.addChild(t)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.login=function(e){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){return e="?Channel=REG&GameType=RM_DDZ&User=admin&AppName=WX_5E8A",t=new egret.HttpRequest,t.responseType=egret.HttpResponseType.TEXT,t.open("http://139.199.80.217/www/login/login_test.php"+e,egret.HttpMethod.GET),t.send(),t.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this),t.addEventListener(egret.ProgressEvent.PROGRESS,this.onPostProgress,this),[2]})})},e.prototype.onPostComplete=function(e){var t=e.currentTarget;console.log("post data : ",t.response)},e.prototype.onPostIOError=function(e){console.log("post error : "+e)},e.prototype.onPostProgress=function(e){console.log("post progress : "+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%")},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,o){function i(e){t.call(o,e)}function s(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),n.call(o))}"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(o,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Agent;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.agentData&&(this.agentData=new t),this.agentData},t.prototype.getAgentReq=function(){console.log("请求代理.");var t=EventType.AGENT_MGMT,n=new e.AgentReq;n.cmd=e.CommandType.GET_AGENT_REQ,n.agentQueryMode=e.AgentQueryMode.ALL;var o=new EventReq(t,n);Network.getInstance().send(o)},t.prototype.getAgentRes=function(e){console.log("取得代理的响应."),this.agent=e,this.agentTimeStamp=egret.getTimer()},t.prototype.getAgent=function(){return this.isAgentDataRefreshed()?this.agent:void(egret.getTimer()-this.agentReqTimeStamp<e.Constants.REQUEST_RETRY_LIMIT||(this.agentReqTimeStamp=egret.getTimer(),this.getAgentReq()))},t.prototype.isAgentDataRefreshed=function(){var t=egret.getTimer(),n=t-this.agentTimeStamp;return n<e.Constants.ITEMS_CACHE_TIMEOUT?!0:!1},t.prototype.getAgentRelsReq=function(){console.log("请求团队成员.");var t=EventType.AGENT_MGMT,n=new e.AgentReq;n.cmd=e.CommandType.GET_AGENTS_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},t.prototype.getAgentRelsRes=function(e){console.log("取得团队成员的响应."),this.agentRels=e.agentRels,this.agentRelsTimeStamp=egret.getTimer()},t.prototype.getAgentRels=function(){return this.isAgentRelsDataRefreshed()?this.agentRels:void(egret.getTimer()-this.agentRelsReqTimeStamp<e.Constants.REQUEST_RETRY_LIMIT||(this.agentRelsReqTimeStamp=egret.getTimer(),this.getAgentRelsReq()))},t.prototype.isAgentRelsDataRefreshed=function(){return egret.getTimer()-this.agentRelsTimeStamp<e.Constants.ITEMS_CACHE_TIMEOUT?!0:!1},t}();e.AgentData=t,__reflect(t.prototype,"Agent.AgentData")}(Agent||(Agent={}));var Agent;!function(e){var t=function(){function e(){}return e.PENDING="PENDING",e.APPROVED="APPROVED",e.PROCESSED="PROCESSED",e}();e.AgentWithdrawState=t,__reflect(t.prototype,"Agent.AgentWithdrawState");var n=function(){function e(){}return e.DAILY="DAILY",e.WEEKLY="WEEKLY",e.MONTHLY="MONTHLY",e}();e.AgentPerformancePeriodType=n,__reflect(n.prototype,"Agent.AgentPerformancePeriodType");var o=function(){function e(){}return e.BASE="BASE",e.PERFORMANCES="PERFORMANCES",e.WITHDRAWS="WITHDRAWS",e.ALL="ALL",e}();e.AgentQueryMode=o,__reflect(o.prototype,"Agent.AgentQueryMode");var i=function(){function e(){}return e.PENDING="PENDING",e.APPROVED="APPROVED",e.DISABLED="DISABLED",e}();e.AgentState=i,__reflect(i.prototype,"Agent.AgentState")}(Agent||(Agent={}));var Agent;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.agentLogic&&(this.agentLogic=new t),this.agentLogic},t.prototype.getCommand=function(e){return e.cmd},t.prototype.processCmd=function(t){var n=null,o="",i=this.getCommand(t);switch(i){case e.CommandType.GET_AGENT_RES:console.log("取得代理的响应."),n=this.getAgentRes(t);break;case e.CommandType.GET_AGENTS_RES:console.log("取得团队的响应."),n=this.getAgentRelsRes(t);break;default:o="命令:"+i+"不存在.",n=new FuncResult(!1,o)}return n},t.prototype.getAgentRes=function(t){var n=null,o=t;return e.AgentData.getInstance().getAgentRes(o),n},t.prototype.getAgentRelsRes=function(t){var n=null,o=t;return e.AgentData.getInstance().getAgentRelsRes(o),n},t}();e.AgentLogic=t,__reflect(t.prototype,"Agent.AgentLogic")}(Agent||(Agent={}));var Agent;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.agentRels=new Array,e.directMembers=new Array,e.agentPerfs=new Array,e.withdraws=new Array,e.skinName="AgentSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),e.syncGetAgent()},e),e}return __extends(n,t),n.getInstance=function(){return null==this.agentScene&&(this.agentScene=new n),this.agentScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.initOnce=function(){var e=this;this.cbDirectMembers.addEventListener(egret.Event.CHANGE,this.addAgentRelsItems,this),this.initTabMenu(),this.initTxtFields(),this.agentRadioBtn.group.addEventListener(eui.UIEvent.CHANGE,function(t){var n=t.target;e.vsAgent.selectedIndex=n.selectedValue,1==e.vsAgent.selectedIndex?e.syncGetAgentRels():e.syncGetAgent(),SoundManager.getInstance().playEffect("btn_click_mp3")},this),this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh0.setClick(function(){e.syncGetAgent()}),this.btnRefresh1.setClick(function(){e.syncGetAgentRels()}),this.btnRefresh2.setClick(function(){e.syncGetAgent()}),this.btnRefresh3.setClick(function(){e.syncGetAgent()}),this.btnBindBankCard.setClick(function(){e.showBindBankCardScene()}),this.btnBindAlipay.setClick(function(){e.showBindAlipayScene()}),this.btnWithdraw.setClick(function(){e.withdrawReq()}),this.btnApplyAgent.setClick(function(){e.applyAgentConfirmation()}),EventManager.getInstance().addEvent(GlobalConstants.EVENT_USER_DATA,this.refreshWithdrawUI.bind(this),null)},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initTabMenu=function(){this.grpAgentPerf.horizontalCenter=0,this.grpAgentPerf.verticalCenter=0,this.vsAgent.addChild(this.grpAgentPerf),this.grpAgentTeam.horizontalCenter=1,this.grpAgentTeam.verticalCenter=1,this.vsAgent.addChild(this.grpAgentTeam),this.grpAgentPerfs.horizontalCenter=2,this.grpAgentPerfs.verticalCenter=2,this.vsAgent.addChild(this.grpAgentPerfs),this.grpWithdraw.horizontalCenter=3,this.grpWithdraw.verticalCenter=3,this.vsAgent.addChild(this.grpWithdraw),this.grpWithdraws.horizontalCenter=4,this.grpWithdraws.verticalCenter=4,this.vsAgent.addChild(this.grpWithdraws),this.vsAgent.selectedIndex=0},n.prototype.initTheGroupContainer=function(){this.agentRes.beAgent?this.agent.state!=e.AgentState.APPROVED?(this.grpAgentState.visible=!0,this.grpApplyAgent.visible=!1,this.grpTabMenu.visible=!1,this.grpAgent.visible=!1,this.fillDataIntoAgentState()):(this.grpTabMenu.visible=!0,this.grpAgent.visible=!0,this.grpAgentState.visible=!1,this.grpApplyAgent.visible=!1,this.addAllListItems()):(this.grpApplyAgent.visible=!0,this.grpAgentState.visible=!1,this.grpTabMenu.visible=!1,this.grpAgent.visible=!1)},n.prototype.getState=function(t){var n="";return t==e.AgentState.PENDING?n=e.Locales.get()["Agent.State.Pending"]:t==e.AgentState.APPROVED?n=e.Locales.get()["Agent.State.Approved"]:t==e.AgentState.DISABLED&&(n=e.Locales.get()["Agent.State.Disabled"]),n},n.prototype.syncGetAgent=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getAgent()},!0,GlobalConstants.WAIT_FOR_INTRVAL_INMS,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.initTheGroupContainer()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getAgent=function(){console.log("取得代理的数据.");var t=e.AgentData.getInstance().getAgent();if(e.AgentData.getInstance().isAgentDataRefreshed()){if(null!=t){if(this.agentRes=t,this.agent=null!=t.agent?t.agent:null,null==this.agent)return!0;var n=this.agent.report;null!=n&&null!=n.perfs&&(this.agentPerfs=n.perfs),null!=n&&null!=n.withdraws&&(this.withdraws=n.withdraws)}return!0}return!1},n.prototype.syncGetAgentRels=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getAgentRels()},!0,GlobalConstants.WAIT_FOR_INTRVAL_INMS,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.addAgentRelsItems()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getAgentRels=function(){console.log("取得团队的数据.");var t=e.AgentData.getInstance().getAgentRels();return e.AgentData.getInstance().isAgentRelsDataRefreshed()?null!=t?(this.agentRels=t,this.directMembers=this.getDirectMembers(),!0):!0:!1},n.prototype.initTxtFields=function(){this.txtBankCardNo.text="",this.txtAlipayId.text=""},n.prototype.refreshWithdrawUI=function(){var e=UserService.getInstance().getUser().payment;null!=e&&(null==e.bankCard?this.txtBankCardNo.text="":this.txtBankCardNo.text=String(e.bankCard),null==e.alipayId?this.txtAlipayId.text="":this.txtAlipayId.text=String(e.alipayId))},n.prototype.addAllListItems=function(){this.fillDataIntoAgentPerf(),this.addAgentPerfsItems(),this.addWithdrawsItems(),this.refreshWithdrawUI()},n.prototype.fillDataIntoAgentPerf=function(){var e=this.agent.report;null!=e&&null!=e.curtPerf&&(this.labPerfSum.text=String(e.curtPerf.perfSum),this.labSelfPerf.text=String(e.curtPerf.selfPerf),this.labTeamMembersPerf.text=String(e.curtPerf.teamMembersPerf),this.labAvailBalance.text=String(e.availBalance),this.labRebateSum.text=String(e.curtPerf.rebateSum),this.labDirectMembersNum.text=String(e.curtPerf.directMembersNum),this.labTeamMembersNum.text=String(e.curtPerf.teamMembersNum),this.labBalanceNum.text=String(e.availBalance))},n.prototype.fillDataIntoAgentState=function(){this.labParentId.text=String(this.agent.pid),this.labUserId.text=String(this.agent.uid),this.labAgentState.text=this.getState(String(this.agent.state)),this.labCreateTime.text=String(GlobalUtils.dateFormat(this.agent.createTime))},n.prototype.getDirectMembers=function(){var e=this.agentRels;if(null!=e&&0!=e.length){var t=new Array;return e.forEach(function(e){1==e.agentLevel&&t.push(e)}),t}},n.prototype.addAgentRelsItems=function(){null!=this.agentRels&&0!=this.agentRels.length?this.lablistTeamMembersNoData.visible=!1:this.lablistTeamMembersNoData.visible=!0,this.listTeamMembers.dataProvider=this.agentRelsArray=new eui.ArrayCollection,this.listTeamMembers.itemRenderer=e.ItemTeamMember;var t=this.cbDirectMembers.selected?this.directMembers:this.agentRels;this.agentRelsArray.source=t,this.agentRelsArray.refresh()},n.prototype.addAgentPerfsItems=function(){null!=this.agentPerfs&&0!=this.agentPerfs.length?this.lablistAgentPerfsNoData.visible=!1:this.lablistAgentPerfsNoData.visible=!0,this.listAgentPerfs.dataProvider=this.agentperfsArray=new eui.ArrayCollection,this.listAgentPerfs.itemRenderer=e.ItemPerformance;var t=this.agentPerfs;this.agentperfsArray.source=t,this.agentperfsArray.refresh()},n.prototype.addWithdrawsItems=function(){null!=this.withdraws&&0!=this.withdraws.length?this.lablistWithdrawsNoData.visible=!1:this.lablistWithdrawsNoData.visible=!0,this.listWithdraws.dataProvider=this.agentperfsArray=new eui.ArrayCollection,this.listWithdraws.itemRenderer=e.ItemWithdraw;var t=this.withdraws;this.agentperfsArray.source=t,this.agentperfsArray.refresh()},n.prototype.refreshWithdrawsList=function(e){ArrayUtils.removeItemByKey(this.withdraws,"id",e),this.addWithdrawsItems()},n.prototype.withdrawReq=function(){if(console.log("兑换"),this.validateWithdrawTxtFields()){var t=EventType.AGENT_MGMT,n=new e.AgentReq;n.cmd=e.CommandType.AGENT_WITHDRAW_REQ,""!=this.txtBankCardNo.text.trim()?(n.paymentType=UserMgmt.PaymentType.BANKCARD,n.paymentId=this.txtBankCardNo.text.trim()):""!=this.txtAlipayId.text.trim()&&(n.paymentType=UserMgmt.PaymentType.ALIPAY,n.paymentId=this.txtAlipayId.text.trim()),n.amount=-Number(this.txtAmount.text.trim());var o=new EventReq(t,n);Network.getInstance().request(o,this.onWithdrawSuccess.bind(this),this.onWithdrawError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.validateWithdrawTxtFields=function(){if(""==this.txtBankCardNo.text.trim()&&""==this.txtAlipayId.text||""!=this.txtBankCardNo.text.trim()&&""!=this.txtAlipayId.text)return TipsScene.getInstance().showError("必须且只能选择一种支付方式！"),!1;var e=UserService.getInstance().getUser().coins;return""==this.txtAmount.text.trim()||!GlobalUtils.isNumbersOnly(this.txtAmount.text.trim())||Number(this.txtAmount.text.trim())>e?(TipsScene.getInstance().showError("请输入有效的兑换金额!"),!1):!0},n.prototype.onWithdrawSuccess=function(e){console.log("onWithdrawSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.onWithdrawError=function(e){console.log("onWithdrawError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.validateApplyAgentTxtFields=function(t,n){return 6!=t.length?(TipsScene.getInstance().showError(e.Locales.get()["User.Id.Error"]),!1):!0},n.prototype.applyAgentConfirmation=function(){var t=this;if(this.validateApplyAgentTxtFields(this.txtParentId.text.trim(),!0)){var n=GlobalUtils.stringFormat(e.Locales.get()["Apply.Agent.Confirmation"],this.txtParentId.text.trim());TipsScene.getInstance().confirm(n,function(){t.applyAgentReq()})}},n.prototype.applyAgentReq=function(){console.log("申请代理的请求");var t=EventType.AGENT_MGMT,n=new e.AgentReq;n.cmd=e.CommandType.APPLY_AGENT_REQ,n.parentId=String(this.txtParentId.text.trim());var o=new EventReq(t,n);Network.getInstance().request(o,this.onApplyAgentSuccess.bind(this),this.onApplyAgentError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onApplyAgentSuccess=function(e){var t=this;console.log("onApplyAgentSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().confirm(e.getContent(),function(){t.close()})},n.prototype.onApplyAgentError=function(e){console.log("onApplyAgentError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.showApplyAgentScene=function(){console.log("显示代理申请的窗口"),SceneManager.getInstance().pushScene(e.ApplyAgentScene.getInstance())},n.prototype.showBindBankCardScene=function(){console.log("显示绑定银行卡的窗口"),SceneManager.getInstance().pushScene(UserMgmt.BindBankCardScene.getInstance())},n.prototype.showBindAlipayScene=function(){console.log("显示绑定银行卡的窗口"),SceneManager.getInstance().pushScene(UserMgmt.BindAlipayScene.getInstance())},n}(eui.Component);e.AgentScene=t,__reflect(t.prototype,"Agent.AgentScene",["eui.UIComponent","egret.DisplayObject"])}(Agent||(Agent={}));var Agent;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ApplyAgentSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.applyAgentScene&&(this.applyAgentScene=new n),this.applyAgentScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnApplyAgent.setClick(function(){e.applyAgentConfirmation()})},n.prototype.validateTxtFields=function(t,n){return 6!=t.length?(TipsScene.getInstance().showError(e.Locales.get()["User.Id.Error"]),!1):!0},n.prototype.applyAgentConfirmation=function(){var t=this;if(this.validateTxtFields(this.txtParentId.text.trim(),!0)){var n=GlobalUtils.stringFormat(e.Locales.get()["Apply.Agent.Confirmation"],this.txtParentId.text.trim());TipsScene.getInstance().confirm(n,function(){t.applyAgentReq()})}},n.prototype.applyAgentReq=function(){console.log("申请代理的请求");var t=EventType.CLUB_MGMT,n=new e.AgentReq;n.cmd=e.CommandType.APPLY_AGENT_REQ,n.parentId=String(this.txtParentId.text.trim());var o=new EventReq(t,n);Network.getInstance().request(o,this.onApplyAgentSuccess.bind(this),this.onApplyAgentError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onApplyAgentSuccess=function(e){var t=this;console.log("onApplyAgentSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().confirm(e.getContent(),function(){t.close()})},n.prototype.onApplyAgentError=function(e){console.log("onApplyAgentError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.ApplyAgentScene=t,__reflect(t.prototype,"Agent.ApplyAgentScene",["eui.UIComponent","egret.DisplayObject"])}(Agent||(Agent={}));var Agent;!function(e){var t=function(){function e(){}return e.APPLY_AGENT_REQ="Apply.Agent.Req",e.APPLY_AGENT_RES="Apply.Agent.Res",e.GET_AGENT_REQ="Get.Agent.Req",e.GET_AGENT_RES="Get.Agent.Res",e.GET_AGENTS_REQ="Get.Agents.Req",e.GET_AGENTS_RES="Get.Agents.Res",e.DISABLE_AGENT_REQ="Disable.Agent.Req",e.DISABLE_AGENT_RES="Disable.Agent.Res",e.AGENT_WITHDRAW_REQ="Agent.Withdraw.Req",e.AGENT_WITHDRAW_RES="Agent.Withdraw.Res",e.DELETE_WITHDRAW_REQ="Delete.Withdraw.Req",e.DELETE_WITHDRAW_RES="Delete.Withdraw.Res",e}();e.CommandType=t,__reflect(t.prototype,"Agent.CommandType")}(Agent||(Agent={}));var Agent;!function(e){var t=function(){function e(){}return e.ITEM_NUM_PER_PAGE=30,e.ITEMS_CACHE_TIMEOUT=1e4,e.REQUEST_RETRY_LIMIT=1e4,e}();e.Constants=t,__reflect(t.prototype,"Agent.Constants")}(Agent||(Agent={}));var Agent;!function(e){var t=function(){function e(){}return e}();e.AgentReq=t,__reflect(t.prototype,"Agent.AgentReq");var n=function(){function e(){}return e}();e.AgentRes=n,__reflect(n.prototype,"Agent.AgentRes");var o=function(){function e(){}return e}();e.AgentRels=o,__reflect(o.prototype,"Agent.AgentRels");var i=function(){function e(){}return e}();e.Agent=i,__reflect(i.prototype,"Agent.Agent");var s=function(){function e(){}return e}();e.AgentPerformance=s,__reflect(s.prototype,"Agent.AgentPerformance");var r=function(){function e(){}return e}();e.AgentReport=r,__reflect(r.prototype,"Agent.AgentReport");var a=function(){function e(){}return e}();e.AgentWithdraw=a,__reflect(a.prototype,"Agent.AgentWithdraw")}(Agent||(Agent={}));var Agent;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="ItemPerformanceSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.labRebateSum.text=String(this.data.rebateSum),this.labPerfSum.text=String(this.data.perfSum),this.labDirectMembersNum.text=String(this.data.directMembersNum),this.labTeamMembersNum.text=String(this.data.teamMembersNum),this.labSartTime.text=String(GlobalUtils.dateFormat(this.data.startTime)),this.labEndTime.text=String(GlobalUtils.dateFormat(this.data.endTime))},t}(eui.ItemRenderer);e.ItemPerformance=t,__reflect(t.prototype,"Agent.ItemPerformance")}(Agent||(Agent={}));var Agent;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="ItemTeamMemberSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.labMemberName.text=String(this.data.name),this.labMemberId.text=String(this.data.uid),this.labAagentLevel.text=String(this.data.agentLevel)},t}(eui.ItemRenderer);e.ItemTeamMember=t,__reflect(t.prototype,"Agent.ItemTeamMember")}(Agent||(Agent={}));var Agent;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemWithdrawSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){var e=this;this.btnAction.setClick(function(){e.onBtnClicked()})},n.prototype.onBtnClicked=function(){this.deleteWithdrawReq()},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.state==e.AgentWithdrawState.PENDING?this.btnAction.visible=!0:this.btnAction.visible=!1,this.labAmount.text=String(this.data.amount),this.labState.text=this.getState(this.data.state),this.labPaymentType.text=this.getPaymentType(String(this.data.paymentType)),this.labPaymentId.text=String(this.data.paymentId),this.labCreateTime.text=String(GlobalUtils.dateFormat(this.data.createTime))},n.prototype.getState=function(t){var n="";return t==e.AgentWithdrawState.PENDING?n=e.Locales.get()["Withdraw.State.Pending"]:t==e.AgentWithdrawState.APPROVED?n=e.Locales.get()["Withdraw.State.Approved"]:t==e.AgentWithdrawState.PROCESSED&&(n=e.Locales.get()["Withdraw.State.Processed"]),n},n.prototype.getPaymentType=function(t){var n="";return t==UserMgmt.PaymentType.BANKCARD?n=e.Locales.get()["Payment.Type.BankCard"]:t==UserMgmt.PaymentType.ALIPAY?n=e.Locales.get()["Payment.Type.Alipay"]:t==UserMgmt.PaymentType.WEIXINPAY&&(n=e.Locales.get()["Payment.Type.Wxpay"]),n},n.prototype.deleteWithdrawReq=function(){console.log("撤销提现申请");var t=EventType.AGENT_MGMT,n=new e.AgentReq;n.cmd=e.CommandType.DELETE_WITHDRAW_REQ,n.withdrawId=this.data.id;var o=new EventReq(t,n);Network.getInstance().request(o,this.onDeleteWithdrawSuccess.bind(this),this.onDeleteWithdrawError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onDeleteWithdrawSuccess=function(t){console.log("onDeleteWithdrawSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),e.AgentScene.getInstance().refreshWithdrawsList(this.data.id),TipsScene.getInstance().showInfo(t.getContent())},n.prototype.onDeleteWithdrawError=function(e){console.log("onDeleteWithdrawError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.ItemRenderer);e.ItemWithdraw=t,__reflect(t.prototype,"Agent.ItemWithdraw")}(Agent||(Agent={}));var Agent;!function(e){var t=function(){function e(){}return e.get=function(){return e.CN},e.CN={"Network.Timeout.Error":"网络超时,请稍后重试","Network.Common.Error":"网络错误,请稍后重试","Withdraw.State.Pending":"待处理","Withdraw.State.Approved":"已批准","Withdraw.State.Processed":"已完成","Agent.State.Pending":"待处理","Agent.State.Approved":"已批准","Agent.State.Disabled":"已停用","Payment.Type.BankCard":"银行卡","Payment.Type.Alipay":"支付宝","Payment.Type.Wxpay":"微信支付","User.Id.Error":"请输入有效会员ID!","Apply.Agent.Confirmation":"您确认申请成为:{0}的代理吗?"},e}();e.Locales=t,__reflect(t.prototype,"Agent.Locales")}(Agent||(Agent={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ChangeDescriptionSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.changeDescriptionScene&&(this.changeDescriptionScene=new n),this.changeDescriptionScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.setClubId=function(t){this.clubId=t,this.club=null,e.ClubData.getInstance().resetClub(t),this.syncGetClub()},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnChangeDescription.setClick(function(){e.changeDescriptionReq()})},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.syncGetClub=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getClub()},!0,GlobalConstants.WAIT_FOR_INTRVAL_INMS,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.showClubDescription()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getClub=function(){console.log("取得俱乐部.");var t=e.ClubData.getInstance().getClub(this.clubId,e.ClubQueryMode.BASE);return null!=t?(this.club=t,!0):!1},n.prototype.showClubDescription=function(){null==this.club.description||0==this.club.description.length?this.txtClubDescription.text="":this.txtClubDescription.text=String(this.club.description)},n.prototype.validateTxtFields=function(){return""==this.txtClubDescription.text.trim()||this.txtClubDescription.text.length>150||this.txtClubDescription.text.length<2?(TipsScene.getInstance().showError("输入的字符数不符合要求,请重新输入!"),!1):!0},n.prototype.changeDescriptionReq=function(){if(console.log("修改俱乐部公告的请求"),this.validateTxtFields()){var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.CHANGE_DESCR_REQ,n.clubId=String(this.clubId),n.clubDescription=String(this.txtClubDescription.text.trim());var o=new EventReq(t,n);Network.getInstance().request(o,this.onChangeDescriptionSuccess.bind(this),this.onChangeDescriptionError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.onChangeDescriptionSuccess=function(t){var n=this;console.log("onChangeDescriptionSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().confirm(t.getContent(),function(){n.close()});var o=e.ClubHallScene.getInstance();o.setClubId(this.clubId)},n.prototype.onChangeDescriptionError=function(e){console.log("onChangeDescriptionError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.ChangeDescriptionScene=t,__reflect(t.prototype,"Club.ChangeDescriptionScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Club;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.clubData&&(this.clubData=new t),this.clubData},t.prototype.resetClub=function(e){null!=this.club&&e!=this.club.id&&(this.club=null)},t.prototype.getClubReq=function(t,n){console.log("请求俱乐部.");var o=EventType.CLUB_MGMT,i=new e.ClubReq;i.cmd=e.CommandType.GET_CLUB_REQ,i.clubId=t,i.clubQueryMode=n;var s=new EventReq(o,i);Network.getInstance().send(s)},t.prototype.getClubRes=function(e){console.log("取得俱乐部的响应."),this.club=e.clubs[0],this.clubTimeStamp=egret.getTimer()
},t.prototype.getClub=function(t,n){return null!=this.club&&this.club.id==t&&this.isClubDataRefreshed()?this.club:void(egret.getTimer()-this.clubReqTimeStamp<e.Constants.REQUEST_RETRY_LIMIT||(this.clubReqTimeStamp=egret.getTimer(),this.getClubReq(t,n)))},t.prototype.isClubDataRefreshed=function(){return null!=this.club&&egret.getTimer()-this.clubTimeStamp<e.Constants.ITEMS_CACHE_TIMEOUT?!0:!1},t.prototype.getOrdersReq=function(t,n){console.log("请求上下分记录.");var o=EventType.CLUB_MGMT,i=new e.ClubReq;i.cmd=e.CommandType.GET_ORDERS_REQ,i.clubId=t,i.memberId=n;var s=new EventReq(o,i);Network.getInstance().send(s)},t.prototype.getOrdersRes=function(e){console.log("取得上下分记录的响应."),this.clubOrders=e.orders,this.ordersTimeStamp=egret.getTimer()},t.prototype.getOrders=function(t,n){return null!=this.club&&this.club.id==t&&this.isOrdersDataRefreshed()?this.clubOrders:void(egret.getTimer()-this.ordersReqTimeStamp<e.Constants.REQUEST_RETRY_LIMIT||(this.ordersReqTimeStamp=egret.getTimer(),this.getOrdersReq(t,n)))},t.prototype.isOrdersDataRefreshed=function(){return egret.getTimer()-this.ordersTimeStamp<e.Constants.ITEMS_CACHE_TIMEOUT?!0:!1},t}();e.ClubData=t,__reflect(t.prototype,"Club.ClubData")}(Club||(Club={}));var Club;!function(e){var t=function(){function e(){}return e.PENDING="PENDING",e.APPROVED="APPROVED",e.DENIED="DENIED",e.DISABLED="DISABLED",e}();e.ClubMemberState=t,__reflect(t.prototype,"Club.ClubMemberState");var n=function(){function e(){}return e.NONE="NONE",e.ASSISTANT="ASSISTANT",e.ADMINISTRATOR="ADMINISTRATOR",e.SUPERADMIN="SUPERADMIN",e}();e.ClubAdminRole=n,__reflect(n.prototype,"Club.ClubAdminRole");var o=function(){function e(){}return e.BASE="BASE",e.MEMBERS="MEMBERS",e.ONLINEROOMS="ONLINEROOMS",e.OFFLINEROOMS="OFFLINEROOMS",e}();e.ClubQueryMode=o,__reflect(o.prototype,"Club.ClubQueryMode")}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return n.isAdmin=!1,n.isOwner=!1,n.clubQueryMode=e.ClubQueryMode.MEMBERS,n.onlineRooms=new Array,n.skinName="ClubHallSkin",n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(n.stage,n)},n),n}return __extends(n,t),n.getInstance=function(){return null==this.clubHallScene&&(this.clubHallScene=new n),this.clubHallScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.setClubId=function(t){this.clubId=t,this.club=null,e.ClubData.getInstance().resetClub(t),this.syncGetClub()},n.prototype.close=function(){this.clubLeaveReq(),SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.cbAllOnlineRooms.addEventListener(egret.Event.CHANGE,this.switchClubQueryMode,this),this.btnGoBack.setClick(function(){e.close()}),this.btnRefresh.setClick(function(){e.syncGetClub()}),this.btnCreateClubRoom.setClick(function(){e.showCreateRoomWin()}),this.btnAdminMembers.setClick(function(){e.showClubMembersWin()}),this.btnAdminAdv.setClick(function(){e.showClubAdvWin()}),this.btnAdminGameConf.setClick(function(){e.showGameConfsWin()}),this.btnAdminOfflineRooms.setClick(function(){e.showOfflineRoomsWin()}),this.btnAdminClubSetting.setClick(function(){e.showClubSettingWin()}),this.btnMembers.setClick(function(){e.showClubMembersWin()}),this.btnOfflineRooms.setClick(function(){e.showOfflineRoomsWin()}),this.btnClubme.setClick(function(){e.showClubMeWin()})},n.prototype.showClubMembersWin=function(){console.log("显示会员管理的窗口");var t=e.ClubMembersScene.getInstance();SceneManager.getInstance().pushScene(t),t.setClubId(this.clubId)},n.prototype.showClubAdvWin=function(){console.log("显示俱乐部公告的窗口");var t=e.ChangeDescriptionScene.getInstance();SceneManager.getInstance().pushScene(t),t.setClubId(this.clubId)},n.prototype.showGameConfsWin=function(){console.log("显示玩法设置的窗口");var t=e.GameConfsScene.getInstance();SceneManager.getInstance().pushScene(t),t.setClubId(this.clubId)},n.prototype.showOfflineRoomsWin=function(){console.log("显示战绩的窗口"),SceneManager.getInstance().pushScene(e.OfflineRoomsScene.getInstance(this.clubId))},n.prototype.showClubSettingWin=function(){console.log("显示设置的窗口"),SceneManager.getInstance().pushScene(e.ClubSettingScene.getInstance(this.clubId))},n.prototype.showClubMeWin=function(){console.log("显示我的窗口");var t=e.ClubMeScene.getInstance();t.setClubAndMember(this.clubId,this.me),SceneManager.getInstance().pushScene(t)},n.prototype.showCreateRoomWin=function(){console.log("显示我的窗口");var t=e.CreateClubRoomScene.getInstance();SceneManager.getInstance().pushScene(t),t.setClubId(this.clubId)},n.prototype.syncGetClub=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getClub()},!0,500,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.refreshDataAndUI()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.refreshDataAndUI=function(){var t=UserService.getInstance().getUser();if(null!=t){var n=t.id;if(null!=n&&this.club.ownerId==n)this.isOwner=!0;else{if(null==n||null==this.club.members||0==this.club.members.length)return;this.me=ArrayUtils.findItemByKey(this.club.members,"id",n),(this.club.ownerId==n||null!=this.me.adminRole&&this.me.adminRole!=e.ClubAdminRole.NONE)&&(this.isAdmin=!0)}this.showUserBtns(),this.initClubNameAndId(),this.ShowAnnouncement(),this.addOnlineRoomsItems()}},n.prototype.getClub=function(){console.log("取得在线房间.");var t=e.ClubData.getInstance().getClub(this.clubId,this.clubQueryMode);return null!=t?(this.club=t,this.onlineRooms=t.onlineRooms,!0):!1},n.prototype.switchClubQueryMode=function(){1==this.cbAllOnlineRooms.selected?this.clubQueryMode=e.ClubQueryMode.ONLINEROOMS:this.clubQueryMode=e.ClubQueryMode.BASE,this.syncGetClub()},n.prototype.addOnlineRoomsItems=function(){null!=this.onlineRooms&&0!=this.onlineRooms.length?this.lablistOnlineRoomsNoData.visible=!1:this.lablistOnlineRoomsNoData.visible=!0,this.listOnlineRooms.dataProvider=this.orsArray=new eui.ArrayCollection,this.listOnlineRooms.itemRenderer=e.ItemOnlineRoom;var t=this.onlineRooms;this.orsArray.source=t,this.orsArray.refresh()},n.prototype.clubLeaveReq=function(){console.log("进入俱乐部");var e=EventType.CLUB_LEAVE,t=new ClubLeaveReq;t.clubId=String(this.clubId);var n=new EventReq(e,t);Network.getInstance().send(n)},n.prototype.initClubNameAndId=function(){null!=this.club.name&&(this.labClubName.text=String(this.club.name)),null!=this.club.id&&(this.labClubId.text=String(this.club.id))},n.prototype.ShowAnnouncement=function(){var t=e.Locales.get()["No.Announcement"];null!=this.club.description&&(t=String(this.club.description)),this.labAnnouncement.text=t},n.prototype.showUserBtns=function(){this.isAdmin||this.isOwner?(this.grpAdminMenu.visible=!0,this.grpMemberMenu.visible=!1,this.isAdmin&&(this.btnAdminClubSetting.visible=!1,this.btnClubme.visible=!0),this.isOwner&&(this.btnAdminClubSetting.visible=!0,this.btnClubme.visible=!1)):(this.grpMemberMenu.visible=!0,this.grpAdminMenu.visible=!1)},n}(eui.Component);e.ClubHallScene=t,__reflect(t.prototype,"Club.ClubHallScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Club;!function(e){var t=function(){function e(){}return e.LV1="LV1",e.LV2="LV2",e.LV3="LV3",e.LV4="LV4",e.LV5="LV5",e}();e.ClubLevel=t,__reflect(t.prototype,"Club.ClubLevel")}(Club||(Club={}));var Club;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.clubLogic&&(this.clubLogic=new t),this.clubLogic},t.prototype.getCommand=function(e){return e.cmd},t.prototype.processCmd=function(t){var n=null,o="",i=this.getCommand(t);switch(i){case e.CommandType.GET_ALL_CLUBS_RES:console.log("取得所有的俱乐部."),n=this.getAllClubsRes(t);break;case e.CommandType.GET_MY_CLUBS_RES:console.log("取得我创建的俱乐部."),n=this.getMyClubsRes(t);break;case e.CommandType.GET_JOINED_CLUBS_RES:console.log("取得我加入的俱乐部."),n=this.getJoinedClubsRes(t);break;case e.CommandType.GET_CLUB_RES:console.log("取得俱乐部."),n=this.getClubRes(t);break;case e.CommandType.GET_ORDERS_RES:console.log("取得上下分记录."),n=this.getOrdersRes(t);break;default:o="命令:"+i+"不存在.",n=new FuncResult(!1,o)}return n},t.prototype.getAllClubsRes=function(t){var n=null,o=t;return e.ClubsScene.getInstance().getAllClubsRes(o),n},t.prototype.getMyClubsRes=function(t){var n=null,o=t;return e.ClubsScene.getInstance().getMyClubsRes(o),n},t.prototype.getJoinedClubsRes=function(t){var n=null,o=t;return e.ClubsScene.getInstance().getJoinedClubsRes(o),n},t.prototype.getClubRes=function(t){var n=null,o=t;return e.ClubData.getInstance().getClubRes(o),n},t.prototype.getOrdersRes=function(t){var n=null,o=t;return e.ClubData.getInstance().getOrdersRes(o),n},t}();e.ClubLogic=t,__reflect(t.prototype,"Club.ClubLogic")}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.allMembers=new Array,e.admins=new Array,e.appliedMembers=new Array,e.invitedMembers=new Array,e.skinName="ClubMembersSkin",e.pagedItems=new Dictionary,e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.clubMembersScene&&(this.clubMembersScene=new n),this.clubMembersScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.setClubId=function(t){this.clubId=t,this.club=null,e.ClubData.getInstance().resetClub(t),this.syncGetClubMembers()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.initTabMenu(),this.radioBtn.group.addEventListener(eui.UIEvent.CHANGE,function(t){var n=t.target;e.vsMembers.selectedIndex=n.selectedValue,e.syncGetClubMembers(),SoundManager.getInstance().playEffect("btn_click_mp3")},this),this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh1.setClick(function(){e.syncGetClubMembers()}),this.btnRefresh2.setClick(function(){e.syncGetClubMembers()}),this.btnRefresh3.setClick(function(){e.syncGetClubMembers()}),this.btnMemberMgmt.setClick(function(){e.showMemberMgmtScene()}),this.btnAddClubAdmin.setClick(function(){e.addAdminReq()}),this.cbAutoApprove.addEventListener(egret.Event.CHANGE,this.changeAutoApproveReq.bind(this),this),this.btnPageUp.setClick(function(){e.pageIdx<=1?e.pageIdx=1:e.pageIdx--,e.addAllMembersItems(e.pageIdx)}),this.btnPageDown.setClick(function(){e.pageIdx>=e.pagesNum?e.pageIdx=e.pagesNum:e.pageIdx++,e.addAllMembersItems(e.pageIdx)})},n.prototype.initTabMenu=function(){this.grpAllMembers.horizontalCenter=0,this.grpAllMembers.verticalCenter=0,this.vsMembers.addChild(this.grpAllMembers),this.grpAdmins.horizontalCenter=0,this.grpAdmins.verticalCenter=0,this.vsMembers.addChild(this.grpAdmins),this.grpAppliedMembers.horizontalCenter=0,this.grpAppliedMembers.verticalCenter=0,this.vsMembers.addChild(this.grpAppliedMembers),this.grpInvitedMembers.horizontalCenter=0,this.grpInvitedMembers.verticalCenter=0,this.vsMembers.addChild(this.grpInvitedMembers),this.vsMembers.selectedIndex=0},n.prototype.syncGetClubMembers=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getClubMembers()},!0,GlobalConstants.WAIT_FOR_INTRVAL_INMS,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.addAllListItems()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getClubMembers=function(){console.log("取得会员的数据.");var t=e.ClubData.getInstance().getClub(String(this.clubId),e.ClubQueryMode.MEMBERS);return null!=t&&null!=t.members?(this.club=t,this.setMembersArrayValue(),!0):!1},n.prototype.setMembersArrayValue=function(){var t=this,n=this.club.members;this.allMembers=[],this.admins=[],this.appliedMembers=[],this.invitedMembers=[],n.forEach(function(n){n.state==e.ClubMemberState.APPROVED&&t.allMembers.push(n)}),this.allMembers.forEach(function(n){n.adminRole!=e.ClubAdminRole.NONE&&t.admins.push(n)}),n.forEach(function(n){n.state==e.ClubMemberState.PENDING&&t.appliedMembers.push(n)})},n.prototype.showCBAutoApprove=function(){(null==this.club||null==this.club.autoApprove)&&(this.cbAutoApprove.selected=!1),this.cbAutoApprove.selected=this.club.autoApprove},n.prototype.addAllListItems=function(){this.showCBAutoApprove(),this.splitAllMembersIntoPages(),this.addAllMembersItems(this.pageIdx),this.addAdminsItems(),this.addAppliedMembersItems()},n.prototype.splitAllMembersIntoPages=function(){for(var t=1;this.allMembers.length>0;){var n=this.allMembers.splice(0,e.Constants.ITEM_MEMBERS_NUM_PER_PAGE);this.pagedItems.Add(String(t),n),t++}this.pageIdx=1,this.pagesNum=t-1},n.prototype.addAllMembersItems=function(t){null!=this.pagedItems&&0!=this.pagedItems.Count()?this.lablistAllMembersNoData.visible=!1:this.lablistAllMembersNoData.visible=!0,this.listAllMembers.dataProvider=this.allMembersArray=new eui.ArrayCollection,this.listAllMembers.itemRenderer=e.ItemClubMember;var n=this.pagedItems.Item(String(t));this.allMembersArray.source=n,this.allMembersArray.refresh(),this.labPagesNum.text=String(t)+"/"+String(this.pagesNum)},n.prototype.addAdminsItems=function(){null!=this.admins&&0!=this.admins.length?this.lablistAdminsNoData.visible=!1:this.lablistAdminsNoData.visible=!0,this.listAdmins.dataProvider=this.adminsArray=new eui.ArrayCollection,this.listAdmins.itemRenderer=e.ItemAdmins;var t=this.admins;this.adminsArray.source=t,this.adminsArray.refresh()},n.prototype.refreshAdminsList=function(e){ArrayUtils.removeItemByKey(this.admins,"id",e),this.addAdminsItems()},n.prototype.addAppliedMembersItems=function(){null!=this.appliedMembers&&0!=this.appliedMembers.length?this.lablistAppliedMembersNoData.visible=!1:this.lablistAppliedMembersNoData.visible=!0,this.listAppliedMembers.dataProvider=this.appliedMembersArray=new eui.ArrayCollection,this.listAppliedMembers.itemRenderer=e.ItemAppliedMember;var t=this.appliedMembers;this.appliedMembersArray.source=t,this.appliedMembersArray.refresh()},n.prototype.refreshAppliedMembersList=function(e){ArrayUtils.removeItemByKey(this.appliedMembers,"id",e),this.addAppliedMembersItems()},n.prototype.showMemberMgmtScene=function(){if(console.log("显示管理会员的窗口"),this.validateTxtFields(this.txtMemberId.text.trim())){var t=ArrayUtils.findItemByKey(this.club.members,"id",this.txtMemberId.text.trim());if(null==t)return void TipsScene.getInstance().showError("请输入有效的会员ID!");var n=e.MemberMgmtScene.getInstance();n.setClubAndMember(String(this.club.id),t),SceneManager.getInstance().pushScene(n)}},n.prototype.showInviteMemberScene=function(){console.log("显示邀请会员的窗口"),SceneManager.getInstance().pushScene(e.CreateClubScene.getInstance())},n.prototype.validateTxtFields=function(e){return 6!=e.length?(TipsScene.getInstance().showError("请输入有效的会员ID!"),!1):!0},n.prototype.addAdminReq=function(){if(console.log("添加管理员"),this.validateTxtFields(this.txtAdminId.text.trim())){var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.ADD_ADMIN_REQ,n.clubId=this.club.id,n.memberId=String(this.txtAdminId.text.trim()),n.adminRole=e.ClubAdminRole.ADMINISTRATOR;var o=new EventReq(t,n);Network.getInstance().request(o,this.onAddAdminSuccess.bind(this),this.onAddAdminError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.onAddAdminSuccess=function(t){console.log("onAddAdminSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance());var n=e.GameConfsScene.getInstance();n.setClubId(this.clubId),n.syncGetGameConfs(),TipsScene.getInstance().showInfo(t.getContent())},n.prototype.onAddAdminError=function(e){console.log("onAddAdminError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.changeAutoApproveReq=function(){console.log("管理自动审批功能.");var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.CHANGE_AUTO_APPROVE_REQ,n.clubId=this.club.id,n.autoApprove=this.cbAutoApprove.selected;var o=new EventReq(t,n);Network.getInstance().request(o,this.onChangeAutoApproveSuccess.bind(this),this.onChangeAutoApproveError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onChangeAutoApproveSuccess=function(e){console.log("onChangeAutoApproveSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.onChangeAutoApproveError=function(e){console.log("onChangeAutoApproveError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.showAddClubAdminScene=function(){console.log("显示增加管理员的窗口"),SceneManager.getInstance().pushScene(e.CreateClubScene.getInstance())},n}(eui.Component);e.ClubMembersScene=t,__reflect(t.prototype,"Club.ClubMembersScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ClubMeSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.clubMeScene&&(this.clubMeScene=new n),this.clubMeScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh.setClick(function(){e.syncGetClubMembers()}),this.btnQuitClub.setClick(function(){e.quitClubConfirmation()}),this.btnClubOrders.setClick(function(){e.showClubOrdersWin()})},n.prototype.showClubOrdersWin=function(){console.log("显示上下分记录的窗口");var t=e.ClubOrdersScene.getInstance();t.setClubAndMember(this.clubId,this.memberId),SceneManager.getInstance().pushScene(t)},n.prototype.syncGetClubMembers=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getClubMembers()},!0,GlobalConstants.WAIT_FOR_INTRVAL_INMS,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.refreshMemberInfo()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getClubMembers=function(){console.log("取得会员的数据.");var t=e.ClubData.getInstance().getClub(String(this.clubId),e.ClubQueryMode.MEMBERS);return null!=t&&null!=t.members?(this.club=t,!0):!1},n.prototype.refreshMemberInfo=function(){this.member=ArrayUtils.findItemByKey(this.club.members,"id",this.memberId),this.setClubAndMember(this.clubId,this.member)},n.prototype.setClubAndMember=function(e,t){this.clubId=e,this.memberId=t.id,this.member=t,this.showMemberInfo()},n.prototype.showMemberInfo=function(){var t=GlobalConstants.USER_DEFAULT_IMAGE;null!=this.member.avatar&&(t=String(this.member.avatar)),this.imgMemberAvatar.source=t,this.labMemberName.text=String(this.member.name),this.labMemberId.text=String(this.member.id),this.labMemberLv.text=String(this.member.level),this.labMemberScore.text=String(this.member.score),this.labCreateTime.text=String(this.member.createTime),null==this.member.adminRole||this.member.adminRole==e.ClubAdminRole.NONE?this.labIsAdmin.text=e.Locales.get().No:this.labIsAdmin.text=e.Locales.get().Yes},n.prototype.quitClubConfirmation=function(){var t=this,n=GlobalUtils.stringFormat(e.Locales.get()["Quit.Club.Confirmation"],this.clubId);TipsScene.getInstance().confirm(n,function(){t.quitClubReq()})},n.prototype.quitClubReq=function(){console.log("退出俱乐部");var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.QUIT_CLUB_REQ,n.clubId=this.club.id;var o=new EventReq(t,n);Network.getInstance().request(o,this.onQuitClubSuccess.bind(this),this.onQuitClubError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onQuitClubSuccess=function(e){var t=this;console.log("onQuitClubSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().confirm(e.getContent(),function(){t.close()})},n.prototype.onQuitClubError=function(e){console.log("onQuitClubError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.ClubMeScene=t,__reflect(t.prototype,"Club.ClubMeScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ClubOrdersSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),e.syncGetOrders()},e),e}return __extends(n,t),n.getInstance=function(){return null==this.clubOrdersScene&&(this.clubOrdersScene=new n),this.clubOrdersScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh.setClick(function(){e.syncGetOrders()})},n.prototype.setClubAndMember=function(e,t){this.clubId=e,this.memberId=t,this.initSumValues()},n.prototype.syncGetOrders=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getOrders()},!0,500,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.refreshAllItems()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getOrders=function(){console.log("取得玩法.");var t=e.ClubData.getInstance().getOrders(this.clubId,this.memberId);return e.ClubData.getInstance().isOrdersDataRefreshed()?(null!=t&&(this.clubOrders=t),!0):!1},n.prototype.refreshAllItems=function(){this.showSumValues(),this.addOrdersItems()},n.prototype.initSumValues=function(){this.labBalance.text="",this.labRechargeSum.text="",this.labWithdrawSum.text=""},n.prototype.showSumValues=function(){null!=this.clubOrders&&(this.labBalance.text=String(this.clubOrders.balance),this.labRechargeSum.text=String(this.clubOrders.rechargeSum),this.labWithdrawSum.text=String(this.clubOrders.withdrawSum))},n.prototype.addOrdersItems=function(){if(null==this.clubOrders||null==this.clubOrders.orders||0==this.clubOrders.orders.length)return void(this.lablistClubOrdersNoData.visible=!0);this.lablistClubOrdersNoData.visible=!1,this.listClubOrders.dataProvider=this.clubOrdersArray=new eui.ArrayCollection,this.listClubOrders.itemRenderer=e.ItemClubOrder;var t=this.clubOrders.orders;this.clubOrdersArray.source=t,this.clubOrdersArray.refresh()},n}(eui.Component);e.ClubOrdersScene=t,__reflect(t.prototype,"Club.ClubOrdersScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.skinName="ClubSettingSkin",n.clubId=e,n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(n.stage,n)},n),n}return __extends(n,t),n.getInstance=function(e){return null==this.clubSettingScene&&(this.clubSettingScene=new n(e)),this.clubSettingScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.setClubId=function(t){this.clubId=t,e.ClubData.getInstance().resetClub(t)},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnDeleteClub.setClick(function(){e.deleteClubConfirmation()}),this.btnTransferClub.setClick(function(){e.tranferClubConfirmation()})},n.prototype.validateTxtFields=function(t,n){return n&&t!=this.clubId?(TipsScene.getInstance().showError(e.Locales.get()["Club.Id.Error"]),!1):6!=t.length?(TipsScene.getInstance().showError(e.Locales.get()["User.Id.Error"]),!1):!0},n.prototype.deleteClubConfirmation=function(){var t=this;if(this.validateTxtFields(this.txtClubId.text.trim(),!0)){var n=GlobalUtils.stringFormat(e.Locales.get()["Delete.Club.Confirmation"],this.txtClubId.text.trim());TipsScene.getInstance().confirm(n,function(){t.deleteClubReq()})}},n.prototype.tranferClubConfirmation=function(){var t=this;if(this.validateTxtFields(this.txtUserId.text.trim(),!1)){var n=GlobalUtils.stringFormat(e.Locales.get()["Transfer.Club.Confirmation"],this.clubId,this.txtUserId.text.trim());TipsScene.getInstance().confirm(n,function(){t.transferClubReq()})}},n.prototype.deleteClubReq=function(){console.log("删除俱乐部的请求");var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.DELETE_CLUB_REQ,n.clubId=String(this.txtClubId.text.trim());var o=new EventReq(t,n);Network.getInstance().request(o,this.onDeleteClubSuccess.bind(this),this.onDeleteClubError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onDeleteClubSuccess=function(e){var t=this;console.log("onDeleteClubSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().confirm(e.getContent(),function(){t.close()})},n.prototype.onDeleteClubError=function(e){console.log("onDeleteClubError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.transferClubReq=function(){console.log("删除俱乐部的请求");var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.CHANGE_OWNER_REQ,n.clubId=String(this.clubId),n.memberId=this.txtUserId.text.trim();var o=new EventReq(t,n);Network.getInstance().request(o,this.onTransferClubSuccess.bind(this),this.onTransferClubError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onTransferClubSuccess=function(e){var t=this;console.log("onTransferClubSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().confirm(e.getContent(),function(){t.close()})},n.prototype.onTransferClubError=function(e){console.log("onTransferClubError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.ClubSettingScene=t,__reflect(t.prototype,"Club.ClubSettingScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.allClubs=new Array,e.myClubs=new Array,e.joinedClubs=new Array,e.appliedClubs=new Array,e.skinName="ClubsSkin",e.pagedItems=new Dictionary,e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),e.getAllClubsReq()},e),e}return __extends(n,t),n.getInstance=function(){return null==this.clubsScene&&(this.clubsScene=new n),this.clubsScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.initTabMenu(),this.clubRadioBtn.group.addEventListener(eui.UIEvent.CHANGE,function(t){var n=t.target;e.vsClubs.selectedIndex=n.selectedValue,e.sendGetDataReqs(),SoundManager.getInstance().playEffect("btn_click_mp3")},this),this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh.setClick(function(){e.getAllClubsReq()}),this.btnShowCCWin.setClick(function(){e.showCreateClubScene()}),this.btnJoinClub.setClick(function(){e.joinClubReq()}),this.btnPageUp.setClick(function(){e.pageIdx<=1?e.pageIdx=1:e.pageIdx--,e.addAllClubsItems(e.pageIdx)}),this.btnPageDown.setClick(function(){e.pageIdx>=e.pagesNum?e.pageIdx=e.pagesNum:e.pageIdx++,e.addAllClubsItems(e.pageIdx)})},n.prototype.initTabMenu=function(){this.grpAllClubs.horizontalCenter=0,this.grpAllClubs.verticalCenter=0,this.vsClubs.addChild(this.grpAllClubs),this.grpMyClubs.horizontalCenter=0,this.grpMyClubs.verticalCenter=0,this.vsClubs.addChild(this.grpMyClubs),this.grpJoinedClubs.horizontalCenter=0,this.grpJoinedClubs.verticalCenter=0,this.vsClubs.addChild(this.grpJoinedClubs),this.grpAppliedClubs.horizontalCenter=0,this.grpAppliedClubs.verticalCenter=0,this.vsClubs.addChild(this.grpAppliedClubs),this.vsClubs.selectedIndex=0},n.prototype.sendGetDataReqs=function(){0==this.vsClubs.selectedIndex?this.getAllClubsReq():1==this.vsClubs.selectedIndex?this.getMyClubsReq():this.getJoinedClubsReq()},n.prototype.getAllClubsReq=function(){if(console.log("请求所有俱乐部."),!(null!=this.allClubs&&egret.getTimer()-this.acaTimeStamp<e.Constants.ITEMS_CACHE_TIMEOUT)){var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.GET_ALL_CLUBS_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)}},n.prototype.getAllClubsRes=function(t){console.log("取得所有俱乐部的响应."),this.allClubs=new Array,this.allClubs=t.clubs,this.acaTimeStamp=egret.getTimer();for(var n=1;this.allClubs.length>0;){var o=this.allClubs.splice(0,e.Constants.ITEM_CLUBS_NUM_PER_PAGE);this.pagedItems.Add(String(n),o),n++}this.pageIdx=1,this.pagesNum=n-1,this.addAllClubsItems(1)},n.prototype.addAllClubsItems=function(t){null!=this.pagedItems&&0!=this.pagedItems.Count()?this.lablistAllClubsNoData.visible=!1:this.lablistAllClubsNoData.visible=!0,this.listAllClubs.dataProvider=this.allClubsArray=new eui.ArrayCollection,this.listAllClubs.itemRenderer=e.ItemAllClub;var n=this.pagedItems.Item(String(t));this.allClubsArray.source=n,this.allClubsArray.refresh(),this.labPagesNum.text=String(t)+"/"+String(this.pagesNum)},n.prototype.refreshAllClubsList=function(e){var t=this.pagedItems.Item(String(this.pageIdx));ArrayUtils.removeItemByKey(t,"id",e),this.addAllClubsItems(this.pageIdx)},n.prototype.getMyClubsReq=function(){if(console.log("请求我创建的俱乐部."),!(null!=this.myClubs&&egret.getTimer()-this.mcaTimeStamp<e.Constants.ITEMS_CACHE_TIMEOUT)){var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.GET_MY_CLUBS_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)}},n.prototype.getMyClubsRes=function(e){console.log("取得我创建的俱乐部的响应."),this.myClubs=new Array,this.myClubs=e.clubs,this.mcaTimeStamp=egret.getTimer(),this.addMyClubsItems()},n.prototype.addMyClubsItems=function(){null!=this.myClubs&&0!=this.myClubs.length?this.lablistMyClubsNoData.visible=!1:this.lablistMyClubsNoData.visible=!0,this.listMyClubs.dataProvider=this.myClubsArray=new eui.ArrayCollection,this.listMyClubs.itemRenderer=e.ItemMyClub;var t=this.myClubs;this.myClubsArray.source=t,this.myClubsArray.refresh()},n.prototype.getJoinedClubsReq=function(){if(console.log("请求我加入的俱乐部."),!(null!=this.joinedClubs&&egret.getTimer()-this.jcaTimeStamp<e.Constants.ITEMS_CACHE_TIMEOUT)){var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.GET_JOINED_CLUBS_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)}},n.prototype.getJoinedClubsRes=function(e){console.log("取得我加入的俱乐部的响应."),this.setJoinedAndAppliedClubs(e),this.jcaTimeStamp=egret.getTimer(),this.addJoinedClubsItems(),this.addJAppliedClubsItems()},n.prototype.addJoinedClubsItems=function(){null!=this.joinedClubs&&0!=this.joinedClubs.length?this.lablistJoinedClubsNoData.visible=!1:this.lablistJoinedClubsNoData.visible=!0,this.listJoinedClubs.dataProvider=this.joinedClubsArray=new eui.ArrayCollection,this.listJoinedClubs.itemRenderer=e.ItemJoinedClub;
var t=this.joinedClubs;this.joinedClubsArray.source=t,this.joinedClubsArray.refresh()},n.prototype.addJAppliedClubsItems=function(){null!=this.appliedClubs&&0!=this.appliedClubs.length?this.lablistMyAppliedClubsNoData.visible=!1:this.lablistMyAppliedClubsNoData.visible=!0,this.listMyAppliedClubs.dataProvider=this.appliedClubsArray=new eui.ArrayCollection,this.listMyAppliedClubs.itemRenderer=e.ItemAppliedClub;var t=this.appliedClubs;this.appliedClubsArray.source=t,this.appliedClubsArray.refresh()},n.prototype.setJoinedAndAppliedClubs=function(t){this.joinedClubs=new Array,this.appliedClubs=new Array;var n=t.clubs;if(null!=n&&0!=n.length)for(var o=UserService.getInstance().getUser().id,i=0;i<n.length;i++){var s=ArrayUtils.findItemByKey(n[i].members,"id",o);null!=s&&(s.state==e.ClubMemberState.PENDING?this.appliedClubs.push(n[i]):this.joinedClubs.push(n[i]))}},n.prototype.refreshAppliedClubsList=function(e){ArrayUtils.removeItemByKey(this.appliedClubs,"id",e),this.addJAppliedClubsItems()},n.prototype.joinClubReq=function(){if(console.log("加入俱乐部"),this.validateTxtFields()){var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.JOIN_CLUB_REQ,n.clubId=this.txtClubId.text.trim();var o=new EventReq(t,n);Network.getInstance().request(o,this.onJoinClubSuccess.bind(this),this.onJoinClubError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.validateTxtFields=function(){return""!=this.txtClubId.text.trim()&&GlobalUtils.isNumbersOnly(this.txtClubId.text.trim())&&6==this.txtClubId.text.length?!0:(TipsScene.getInstance().showError("请输入有效的俱乐部Id!"),!1)},n.prototype.onJoinClubSuccess=function(e){console.log("onJoinClubSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.onJoinClubError=function(e){console.log("onJoinClubError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.showCreateClubScene=function(){console.log("显示创建俱乐部的窗口"),SceneManager.getInstance().pushScene(e.CreateClubScene.getInstance())},n.prototype.showJoinClubScene=function(){console.log("显示加入俱乐部的窗口"),SceneManager.getInstance().pushScene(e.CreateClubScene.getInstance())},n}(eui.Component);e.ClubsScene=t,__reflect(t.prototype,"Club.ClubsScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Club;!function(e){var t=function(){function e(){}return e.CREATE_CLUB_REQ="Create.Club.Req",e.CREATE_CLUB_RES="Create.Club.Res",e.GET_ALL_CLUBS_REQ="Get.All.Clubs.Req",e.GET_ALL_CLUBS_RES="Get.All.Clubs.Res",e.GET_MY_CLUBS_REQ="Get.My.Clubs.Req",e.GET_MY_CLUBS_RES="Get.My.Clubs.Res",e.GET_JOINED_CLUBS_REQ="Get.Joined.Clubs.Req",e.GET_JOINED_CLUBS_RES="Get.Joined.Clubs.Res",e.GET_CLUB_REQ="Get.Club.Req",e.GET_CLUB_RES="Get.Club.Res",e.JOIN_CLUB_REQ="Join.Club.Req",e.JOIN_CLUB_RES="Join.Club.Res",e.QUIT_CLUB_REQ="Quit.Club.Req",e.QUIT_CLUB_RES="Quit.Club.Res",e.ADD_MEMBER_SCORE_REQ="Add.Member.Score.Req",e.ADD_MEMBER_SCORE_RES="Add.Member.Score.Res",e.CHANGE_MEMBER_LEVEL_REQ="Change.Member.Level.Req",e.CHANGE_MEMBER_LEVEL_RES="Change.Member.Level.Res",e.CHANGE_MEMBER_STATE_REQ="Change.Member.State.Req",e.CHANGE_MEMBER_STATE_RES="Change.Member.State.Res",e.REMOVE_MEMBER_REQ="Remove.Member.Req",e.REMOVE_MEMBER_STATE_RES="Remove.Member.Res",e.CHANGE_ADMIN_ROLE_REQ="Change.Admin.Role.Req",e.CHANGE_ADMIN_ROLE_RES="Change.Admin.Role.Res",e.ADD_ADMIN_REQ="Add.Admin.Req",e.ADD_ADMIN_RES="Add.Admin.Res",e.ADD_GAME_CONF_REQ="Add.Game.Conf.Req",e.ADD_GAME_CONF_RES="Add.Game.Conf.Res",e.CHANGE_GAME_CONF_REQ="Change.Game.Conf.Req",e.CHANGE_GAME_CONF_RES="Change.Game.Conf.Res",e.DELETE_GAME_CONF_REQ="Delete.Game.Conf.Req",e.DELETE_GAME_CONF_RES="Delete.Game.Conf.Res",e.REMOVE_ADMIN_REQ="Remove.Admin.Req",e.REMOVE_ADMIN_RES="Remove.Admin.Res",e.CHANGE_OWNER_REQ="Change.Owner.Req",e.CHANGE_OWNER_RES="Change.Owner.Res",e.DISABLE_CLUB_REQ="Disable.Club.Req",e.DISABLE_CLUB_RES="Disable.Club.Res",e.ACTIVATE_CLUB_REQ="Activate.Club.Req",e.ACTIVATE_CLUB_RES="Activate.Club.Res",e.UPGRADE_CLUB_REQ="Upgrade.Club.Req",e.UPGRADE_CLUB_RES="Upgrade.Club.Res",e.CHANGE_DESCR_REQ="Change.Descr.Req",e.CHANGE_DESCR_RES="Change.Descr.Res",e.DELETE_CLUB_REQ="Delete.Club.Req",e.DELETE_CLUB_RES="Delete.Club.Res",e.CREATE_ROOM_REQ="Create.Room.Req",e.CREATE_ROOM_RES="Delete.Room.Res",e.CHANGE_AUTO_APPROVE_REQ="Change.Auto.Approve.Req",e.CHANGE_AUTO_APPROVE_RES="Change.Auto.Approve.Res",e.CLOSE_ROOM_REQ="Close.Room.Req",e.CLOSE_ROOM_RES="Close.Room.Res",e.GET_ORDERS_REQ="Get.Orders.Req",e.GET_ORDERS_RES="Get.Orders.Res",e}();e.CommandType=t,__reflect(t.prototype,"Club.CommandType")}(Club||(Club={}));var Club;!function(e){var t=function(){function e(){}return e.ITEM_CLUBS_NUM_PER_PAGE=30,e.ITEM_MEMBERS_NUM_PER_PAGE=30,e.ITEM_ROOMS_NUM_PER_PAGE=30,e.ITEMS_CACHE_TIMEOUT=5e3,e.REQUEST_RETRY_LIMIT=5e3,e.GAME_DDZ_ROOM_CAPACITY=3,e.EVENT_CLUB_RELOAD_DATA="Event.Club.Reload.Data",e}();e.Constants=t,__reflect(t.prototype,"Club.Constants")}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.gameConfs=new Array,e.skinName="CreateClubRoomSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.createClubRoomScene&&(this.createClubRoomScene=new n),this.createClubRoomScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.setClubId=function(t){this.clubId=t,this.club=null,e.ClubData.getInstance().resetClub(t),this.syncGetGameConfs()},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh.setClick(function(){e.syncGetGameConfs()})},n.prototype.syncGetGameConfs=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getGameConfs()},!0,500,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.addGameConfsItems()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getGameConfs=function(){console.log("取得玩法.");var t=e.ClubData.getInstance().getClub(String(this.clubId),e.ClubQueryMode.BASE);return null!=t?(this.club=t,this.gameConfs=t.gameConfs,!0):!1},n.prototype.addGameConfsItems=function(){null!=this.gameConfs&&0!=this.gameConfs.length?this.labListNoData.visible=!1:this.labListNoData.visible=!0,this.listGameConfs.dataProvider=this.gcsArray=new eui.ArrayCollection,this.listGameConfs.itemRenderer=e.ItemCRGameConf;var t=this.gameConfs;this.gcsArray.source=t,this.gcsArray.refresh()},n}(eui.Component);e.CreateClubRoomScene=t,__reflect(t.prototype,"Club.CreateClubRoomScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.gameTypes=["DDZ","TEXAS","QZNN","ZJH"],e.dllSelectedIdx=-1,e.skinName="CreateClubsSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.createClubScene&&(this.createClubScene=new n),this.createClubScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.initDropDownList(),this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnCreateClub.setClick(function(){e.createClub()})},n.prototype.initDropDownList=function(){this.ddlGameType.setListSkin("DropDownItemSkin"),this.ddlGameType.addItem("斗地主"),this.ddlGameType.addItem("德州扑克"),this.ddlGameType.addItem("抢庄牛牛"),this.ddlGameType.addItem("炸金花"),this.ddlGameType.addEventListener(egret.TouchEvent.CHANGE,this.onDdlChange,this)},n.prototype.onDdlChange=function(e){this.dllSelectedIdx=e.data.selectedIndex;e.data.itemValue;this.ddlGameType.setBtnLable(String(e.data.itemValue))},n.prototype.createClub=function(){if(console.log("创建俱乐部"),this.validateTxtFields()){var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.CREATE_CLUB_REQ,n.clubName=this.txtClubName.text.trim(),n.feeRate=Number(this.txtfeeRate.text.trim()),n.gameType=this.gameTypes[this.dllSelectedIdx],n.clubLevel=e.ClubLevel.LV1;var o=new EventReq(t,n);Network.getInstance().request(o,this.onCreateClubSuccess.bind(this),this.onCreateClubError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.validateTxtFields=function(){return""==this.txtClubName.text.trim()||this.txtClubName.text.length>6||this.txtClubName.text.length<2?(TipsScene.getInstance().showError("请输入有效的名称!"),!1):""==this.txtfeeRate.text.trim()||!GlobalUtils.isNumbersOnly(this.txtfeeRate.text.trim())||Number(this.txtfeeRate.text.trim())>100||Number(this.txtfeeRate.text.trim())<0?(TipsScene.getInstance().showError("请输入有效的服务费的比率!"),!1):-1==this.dllSelectedIdx?(TipsScene.getInstance().showError("请选择俱乐部的游戏!"),!1):!0},n.prototype.onCreateClubSuccess=function(e){console.log("onCreateClubSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),SceneManager.getInstance().popScene(n.getInstance());e.getArgs();TipsScene.getInstance().showInfo(e.getContent())},n.prototype.onCreateClubError=function(e){console.log("onCreateClubError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.CreateClubScene=t,__reflect(t.prototype,"Club.CreateClubScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="CreateGameConfSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.createGameConfScene&&(this.createGameConfScene=new n),this.createGameConfScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.setClub=function(t){this.club=t,e.ClubData.getInstance().resetClub(String(t.id)),this.roomConfsReq(),this.showConfsByGameType()},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnCreateDdzRoom.setClick(function(){e.createDdzRoomReq()}),this.btnCreateTexasRoom.setClick(function(){e.createTexasRoomReq()}),this.btnCreateQznnRoom.setClick(function(){e.createQznnRoomReq()}),this.btnCreateZjhRoom.setClick(function(){e.createZjhRoomReq()}),this.hsTexasCapacity.addEventListener(egret.Event.CHANGE,this.onHsTexasCapacityChange,this),this.hsQznnCapacity.addEventListener(egret.Event.CHANGE,this.onHsQznnCapacityChange,this),this.hsZjhCapacity.addEventListener(egret.Event.CHANGE,this.onHsZjhCapacityChange,this)},n.prototype.roomConfsReq=function(){if(console.log("请求房间的配置."),null==this.roomConfs||0==this.roomConfs.length){var e=EventType.ROOM_CONFS,t=new RoomConfsReq,n=new EventReq(e,t);Network.getInstance().send(n)}},n.prototype.romConfsRes=function(e){console.log("处理房间的配置.");var t=e;null!=t&&(this.roomConfs=t.roomConfs,LocalStorage.setItemObj(GlobalConstants.ROOM_CONFS,t.roomConfs),this.initRoomConfs())},n.prototype.initRoomConfs=function(){this.initDdzRoomConf(),this.initTexasRoomConf(),this.initQznnRoomConf(),this.initZjhRoomConf()},n.prototype.showConfsByGameType=function(){this.grpCreateDdzRoom.visible=!1,this.grpCreateTexasRoom.visible=!1,this.grpCreateQznnRoom.visible=!1,this.grpCreateZjhRoom.visible=!1,null!=this.club&&(this.club.gameType==RoomType.DDZ&&(this.grpCreateDdzRoom.visible=!0),this.club.gameType==RoomType.TEXAS&&(this.grpCreateTexasRoom.visible=!0),this.club.gameType==RoomType.QZNN&&(this.grpCreateQznnRoom.visible=!0),this.club.gameType==RoomType.ZJH&&(this.grpCreateZjhRoom.visible=!0))},n.prototype.initDdzRoomConf=function(){var e=ArrayUtils.findItemByKey(this.roomConfs,"roomType",RoomType.DDZ);if(null!=e){var t=e.bottomScore.split("|");this.ddzBottomOpt1.label=t[0],this.ddzBottomOpt2.label=t[1],this.ddzBottomOpt3.label=t[2],this.ddzBottomOpt1.value=t[0],this.ddzBottomOpt2.value=t[1],this.ddzBottomOpt3.value=t[2];var n=e.rounds.split("|");this.ddzRoundsOpt1.label=n[0],this.ddzRoundsOpt2.label=n[1],this.ddzRoundsOpt3.label=n[2],this.ddzRoundsOpt1.value=n[0],this.ddzRoundsOpt2.value=n[1],this.ddzRoundsOpt3.value=n[2];var o=e.minChips.split("|");this.ddzMinChipsOpt1.label=o[0],this.ddzMinChipsOpt2.label=o[1],this.ddzMinChipsOpt3.label=o[2],this.ddzMinChipsOpt1.value=o[0],this.ddzMinChipsOpt2.value=o[1],this.ddzMinChipsOpt3.value=o[2]}},n.prototype.onHsTexasCapacityChange=function(){this.labTexasCapacity.text=String(this.hsTexasCapacity.value)},n.prototype.onHsQznnCapacityChange=function(){this.labQznnCapacity.text=String(this.hsQznnCapacity.value)},n.prototype.onHsZjhCapacityChange=function(){this.labZjhCapacity.text=String(this.hsZjhCapacity.value)},n.prototype.initTexasRoomConf=function(){var e=ArrayUtils.findItemByKey(this.roomConfs,"roomType",RoomType.TEXAS);if(null!=e){var t=e.bottomScore.split("|");this.texasBottomOpt1.label=t[0]+"/"+String(2*Number(t[0])),this.texasBottomOpt2.label=t[1]+"/"+String(2*Number(t[1])),this.texasBottomOpt3.label=t[2]+"/"+String(2*Number(t[2])),this.texasBottomOpt1.value=t[0],this.texasBottomOpt2.value=t[1],this.texasBottomOpt3.value=t[2];var n=e.rounds.split("|");this.texasRoundsOpt1.label=n[0],this.texasRoundsOpt2.label=n[1],this.texasRoundsOpt3.label=n[2],this.texasRoundsOpt1.value=n[0],this.texasRoundsOpt2.value=n[1],this.texasRoundsOpt3.value=n[2];var o=e.minChips.split("|");this.texasMinChipsOpt1.label=o[0],this.texasMinChipsOpt2.label=o[1],this.texasMinChipsOpt3.label=o[2],this.texasMinChipsOpt1.value=o[0],this.texasMinChipsOpt2.value=o[1],this.texasMinChipsOpt3.value=o[2];var i=e.maxChips.split("|");this.texasMaxChipsOpt1.label=i[0],this.texasMaxChipsOpt2.label=i[1],this.texasMaxChipsOpt3.label=i[2],this.texasMaxChipsOpt1.value=i[0],this.texasMaxChipsOpt2.value=i[1],this.texasMaxChipsOpt3.value=i[2],this.hsTexasCapacity.minimum=2,this.hsTexasCapacity.maximum=9,this.hsTexasCapacity.value=6,this.hsTexasCapacity.snapInterval=1,this.labTexasCapacity.text=String(this.hsTexasCapacity.value)}},n.prototype.initQznnRoomConf=function(){var e=ArrayUtils.findItemByKey(this.roomConfs,"roomType",RoomType.QZNN);if(null!=e){var t=e.bottomScore.split("|");this.qznnBottomOpt1.label=t[0],this.qznnBottomOpt2.label=t[1],this.qznnBottomOpt3.label=t[2],this.qznnBottomOpt1.value=t[0],this.qznnBottomOpt2.value=t[1],this.qznnBottomOpt3.value=t[2];var n=e.rounds.split("|");this.qznnRoundsOpt1.label=n[0],this.qznnRoundsOpt2.label=n[1],this.qznnRoundsOpt3.label=n[2],this.qznnRoundsOpt1.value=n[0],this.qznnRoundsOpt2.value=n[1],this.qznnRoundsOpt3.value=n[2];var o=e.minChips.split("|");this.qznnMinChipsOpt1.label=o[0],this.qznnMinChipsOpt2.label=o[1],this.qznnMinChipsOpt3.label=o[2],this.qznnMinChipsOpt1.value=o[0],this.qznnMinChipsOpt2.value=o[1],this.qznnMinChipsOpt3.value=o[2],this.hsQznnCapacity.minimum=2,this.hsQznnCapacity.maximum=9,this.hsQznnCapacity.value=6,this.hsQznnCapacity.snapInterval=1,this.labQznnCapacity.text=String(this.hsQznnCapacity.value)}},n.prototype.initZjhRoomConf=function(){var e=ArrayUtils.findItemByKey(this.roomConfs,"roomType",RoomType.QZNN);if(null!=e){var t=e.bottomScore.split("|");this.zjhBottomOpt1.label=t[0],this.zjhBottomOpt2.label=t[1],this.zjhBottomOpt3.label=t[2],this.zjhBottomOpt1.value=t[0],this.zjhBottomOpt2.value=t[1],this.zjhBottomOpt3.value=t[2];var n=e.rounds.split("|");this.zjhRoundsOpt1.label=n[0],this.zjhRoundsOpt2.label=n[1],this.zjhRoundsOpt3.label=n[2],this.zjhRoundsOpt1.value=n[0],this.zjhRoundsOpt2.value=n[1],this.zjhRoundsOpt3.value=n[2];var o=e.minChips.split("|");this.zjhMinChipsOpt1.label=o[0],this.zjhMinChipsOpt2.label=o[1],this.zjhMinChipsOpt3.label=o[2],this.zjhMinChipsOpt1.value=o[0],this.zjhMinChipsOpt2.value=o[1],this.zjhMinChipsOpt3.value=o[2];var i=e.maxChips.split("|");this.zjhMaxChipsOpt1.label=i[0],this.zjhMaxChipsOpt2.label=i[1],this.zjhMaxChipsOpt3.label=i[2],this.zjhMaxChipsOpt1.value=i[0],this.zjhMaxChipsOpt2.value=i[1],this.zjhMaxChipsOpt3.value=i[2],this.hsZjhCapacity.minimum=2,this.hsZjhCapacity.maximum=9,this.hsZjhCapacity.value=6,this.hsZjhCapacity.snapInterval=1,this.labZjhCapacity.text=String(this.hsZjhCapacity.value)}},n.prototype.createDdzRoomReq=function(){console.log("创建Ddz房间的玩法");var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.ADD_GAME_CONF_REQ,n.clubId=this.club.id,n.bottomScore=this.ddzBottomOpt1.group.selectedValue,n.rounds=this.ddzRoundsOpt1.group.selectedValue,n.minChips=this.ddzMinChipsOpt1.group.selectedValue,n.capacity=e.Constants.GAME_DDZ_ROOM_CAPACITY;var o=new EventReq(t,n);Network.getInstance().request(o,this.onCreateDdzRoomSuccess.bind(this),this.onCreateDdzRoomError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onCreateDdzRoomSuccess=function(t){var n=this;console.log("onCreateDdzRoomSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance());var o=e.GameConfsScene.getInstance();o.setClubId(String(this.club.id)),o.syncGetGameConfs(),TipsScene.getInstance().confirm(t.getContent(),function(){n.close()})},n.prototype.onCreateDdzRoomError=function(e){console.log("onCreateDdzRoomError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.createTexasRoomReq=function(){console.log("创建Texas房间的玩法");var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.ADD_GAME_CONF_REQ,n.clubId=this.club.id;var o=this.texasBottomOpt1.group.selectedValue.split("/",2);n.bottomScore=Number(o[0]),n.rounds=this.texasRoundsOpt1.group.selectedValue,n.minChips=this.texasMinChipsOpt1.group.selectedValue,n.maxChips=this.texasMaxChipsOpt1.group.selectedValue,n.capacity=this.hsTexasCapacity.value;var i=new EventReq(t,n);Network.getInstance().request(i,this.onCreateTexasRoomSuccess.bind(this),this.onCreateTexasRoomError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onCreateTexasRoomSuccess=function(t){var n=this;console.log("onCreateTexasRoomSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance());var o=e.GameConfsScene.getInstance();o.setClubId(String(this.club.id)),o.syncGetGameConfs(),TipsScene.getInstance().confirm(t.getContent(),function(){n.close()})},n.prototype.onCreateTexasRoomError=function(e){console.log("onCreatTexasRoomError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.createQznnRoomReq=function(){console.log("创建Qznn房间的玩法");var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.ADD_GAME_CONF_REQ,n.clubId=this.club.id,n.bottomScore=this.qznnBottomOpt1.group.selectedValue,n.rounds=this.qznnRoundsOpt1.group.selectedValue,n.minChips=this.qznnMinChipsOpt1.group.selectedValue,n.capacity=this.hsQznnCapacity.value;var o=new EventReq(t,n);Network.getInstance().request(o,this.onCreateQznnRoomSuccess.bind(this),this.onCreateQznnRoomError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onCreateQznnRoomSuccess=function(t){var n=this;console.log("onCreateQznnRoomSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance());var o=e.GameConfsScene.getInstance();o.setClubId(String(this.club.id)),o.syncGetGameConfs(),TipsScene.getInstance().confirm(t.getContent(),function(){n.close()})},n.prototype.onCreateQznnRoomError=function(e){console.log("onCreateQznnRoomError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.createZjhRoomReq=function(){console.log("创建Zjh房间的玩法");var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.ADD_GAME_CONF_REQ,n.clubId=this.club.id,n.bottomScore=this.zjhBottomOpt1.group.selectedValue,n.rounds=this.zjhRoundsOpt1.group.selectedValue,n.minChips=this.zjhMinChipsOpt1.group.selectedValue,n.maxChips=this.zjhMaxChipsOpt1.group.selectedValue,n.capacity=this.hsZjhCapacity.value;var o=new EventReq(t,n);Network.getInstance().request(o,this.onCreateZjhRoomSuccess.bind(this),this.onCreateZjhRoomError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onCreateZjhRoomSuccess=function(t){var n=this;console.log("onCreateZjhRoomSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance());var o=e.GameConfsScene.getInstance();o.setClubId(String(this.club.id)),o.syncGetGameConfs(),TipsScene.getInstance().confirm(t.getContent(),function(){n.close()})},n.prototype.onCreateZjhRoomError=function(e){console.log("onCreateZjhRoomError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.CreateGameConfScene=t,__reflect(t.prototype,"Club.CreateGameConfScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Club;!function(e){var t=function(){function e(){}return e}();e.ClubReq=t,__reflect(t.prototype,"Club.ClubReq");var n=function(){function e(){}return e}();e.ClubRes=n,__reflect(n.prototype,"Club.ClubRes");var o=function(){function e(){}return e}();e.Club=o,__reflect(o.prototype,"Club.Club");var i=function(){function e(){}return e}();e.ClubMember=i,__reflect(i.prototype,"Club.ClubMember");var s=function(){function e(){}return e}();e.GameConf=s,__reflect(s.prototype,"Club.GameConf");var r=function(){function e(){}return e}();e.ClubOrders=r,__reflect(r.prototype,"Club.ClubOrders");var a=function(){function e(){}return e}();e.Order=a,__reflect(a.prototype,"Club.Order")}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.gameConfs=new Array,e.skinName="GameConfsSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.gameConfsScene&&(this.gameConfsScene=new n),this.gameConfsScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.setClubId=function(t){this.clubId=t,this.club=null,e.ClubData.getInstance().resetClub(t),this.syncGetGameConfs()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh.setClick(function(){e.syncGetGameConfs()}),this.btnShowCGCWin.setClick(function(){e.showCreateGameConfScene()})},n.prototype.showCreateGameConfScene=function(){console.log("显示创建俱乐部的窗口");var t=e.CreateGameConfScene.getInstance();SceneManager.getInstance().pushScene(t),t.setClub(this.club)},n.prototype.syncGetGameConfs=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getGameConfs()},!0,500,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.addGameConfsItems()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getGameConfs=function(){console.log("取得玩法.");var t=e.ClubData.getInstance().getClub(this.clubId,e.ClubQueryMode.BASE);return null!=t?(this.club=t,this.gameConfs=t.gameConfs,!0):!1},n.prototype.addGameConfsItems=function(){null!=this.gameConfs&&0!=this.gameConfs.length?this.labListNoData.visible=!1:this.labListNoData.visible=!0,this.listGameConfs.dataProvider=this.gcsArray=new eui.ArrayCollection,this.listGameConfs.itemRenderer=e.ItemGameConf;var t=this.gameConfs;this.gcsArray.source=t,this.gcsArray.refresh()},n.prototype.refreshGameConfsList=function(e){ArrayUtils.removeItemByKey(this.gameConfs,"gcId",e),this.addGameConfsItems()},n}(eui.Component);e.GameConfsScene=t,__reflect(t.prototype,"Club.GameConfsScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemAppliedMemberSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){var e=this;this.btnApprove.setClick(function(){e.approveMemberReq()}),this.btnDeny.setClick(function(){e.denyMemberReq()})},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=GlobalConstants.USER_DEFAULT_IMAGE;null!=this.data.avatar&&(e=this.data.avatar),this.imgMemberAvatar=GlobalUtils.getImagebyUrl(this.data.avatar),this.labMemberName.text=String(this.data.name),this.labMemberId.text=String(this.data.id),this.labCreateTime.text=String(this.data.createTime)},n.prototype.approveMemberReq=function(){this.changeMemberStateReq(e.ClubMemberState.APPROVED)},n.prototype.denyMemberReq=function(){this.deleteMemberReq()},n.prototype.changeMemberStateReq=function(t){console.log("批准会员的请求");var n=EventType.CLUB_MGMT,o=new e.ClubReq;if(o.cmd=e.CommandType.CHANGE_MEMBER_STATE_REQ,null!=e.ClubData.getInstance().club){var i=e.ClubData.getInstance().club.id;o.clubId=String(i),o.memberId=String(this.data.id),o.memberState=t;var s=new EventReq(n,o);Network.getInstance().request(s,this.onChangeMemberStateSuccess.bind(this),this.onChangeMemberStateError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.onChangeMemberStateSuccess=function(t){if(console.log("onChangeMemberStateSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),null!=e.ClubData.getInstance().club){var n=e.ClubData.getInstance().club.id,o=e.ClubMembersScene.getInstance();TipsScene.getInstance().showInfo(t.getContent()),o.setClubId(String(n)),o.refreshAppliedMembersList(this.data.id)}},n.prototype.onChangeMemberStateError=function(e){console.log("onChangeMemberStateError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.deleteMemberReq=function(){console.log("删除申请的请求");var t=EventType.CLUB_MGMT,n=new e.ClubReq;if(n.cmd=e.CommandType.REMOVE_MEMBER_REQ,null!=e.ClubData.getInstance().club){var o=e.ClubData.getInstance().club.id;n.clubId=String(o),n.memberId=String(this.data.id);var i=new EventReq(t,n);Network.getInstance().request(i,this.onDeleteMemberSuccess.bind(this),this.onDeleteMemberError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.onDeleteMemberSuccess=function(t){if(console.log("onDeleteMemberSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),null!=e.ClubData.getInstance().club){var n=e.ClubData.getInstance().club.id,o=e.ClubMembersScene.getInstance();o.setClubId(String(n)),o.refreshAppliedMembersList(this.data.id),TipsScene.getInstance().showInfo(t.getContent())}},n.prototype.onDeleteMemberError=function(e){console.log("onDeleteMemberError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.ItemRenderer);e.ItemAppliedMember=t,__reflect(t.prototype,"Club.ItemAppliedMember")}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemClubSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){var e=this;this.btnAction.setClick(function(){e.onBtnClicked()}),this.setBtnLable()},n.prototype.onBtnClicked=function(){this.joinClubReq()},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.labClubName.text=String(this.data.name),this.labClubId.text=String(this.data.id),this.labGameType.text=this.getGameType(String(this.data.gameType)),this.labClubMembers.text=String(this.data.membersNum+"/"+this.data.membersCapacity),this.labState=this.data.state,this.labCreateTime.text=String(this.data.createTime)},n.prototype.setBtnLable=function(){this.btnAction.setLabTitle(e.Locales.get()["Btn.Join"])},n.prototype.getGameType=function(e){return e==RoomType.DDZ?"斗地主":e==RoomType.TEXAS?"德州扑克":e==RoomType.QZNN?"抢庄牛牛":e==RoomType.ZJH?"炸金花":""},n.prototype.clubEnterReq=function(){console.log("进入俱乐部");var e=EventType.CLUB_ENTER,t=new ClubEnterReq;t.clubId=String(this.data.id);var n=new EventReq(e,t);Network.getInstance().send(n)},n.prototype.joinClubReq=function(){console.log("加入俱乐部");var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.JOIN_CLUB_REQ,n.clubId=String(this.data.id);var o=new EventReq(t,n);Network.getInstance().request(o,this.onJoinClubSuccess.bind(this),this.onJoinClubError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onJoinClubSuccess=function(t){console.log("onJoinClubSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),e.ClubsScene.getInstance().refreshAllClubsList(this.data.id),TipsScene.getInstance().showInfo(t.getContent())},n.prototype.onJoinClubError=function(e){console.log("onJoinClubError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.ItemRenderer);e.ItemAllClub=t,__reflect(t.prototype,"Club.ItemAllClub");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.onBtnClicked=function(){t.prototype.clubEnterReq.call(this);var n=e.ClubHallScene.getInstance();SceneManager.getInstance().pushScene(n),n.setClubId(String(this.data.id))},n.prototype.setBtnLable=function(){this.btnAction.setLabTitle(e.Locales.get()["Btn.Enter"])},n}(t);e.ItemMyClub=n,__reflect(n.prototype,"Club.ItemMyClub");var o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.onBtnClicked=function(){t.prototype.clubEnterReq.call(this);var n=e.ClubHallScene.getInstance();SceneManager.getInstance().pushScene(n),n.setClubId(String(this.data.id))},n.prototype.setBtnLable=function(){this.btnAction.setLabTitle(e.Locales.get()["Btn.Enter"])},n}(t);e.ItemJoinedClub=o,__reflect(o.prototype,"Club.ItemJoinedClub");var i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.onBtnClicked=function(){this.quitClubReq()},n.prototype.setBtnLable=function(){this.btnAction.setLabTitle(e.Locales.get()["Btn.Withdraw.App"])},n.prototype.quitClubReq=function(){console.log("退出俱乐部");var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.QUIT_CLUB_REQ,n.clubId=String(this.data.id);var o=new EventReq(t,n);Network.getInstance().request(o,this.onQuitClubSuccess.bind(this),this.onQuitClubError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onQuitClubSuccess=function(t){console.log("onQuitClubSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),e.ClubsScene.getInstance().refreshAppliedClubsList(this.data.id),TipsScene.getInstance().showInfo(t.getContent())},n.prototype.onQuitClubError=function(e){console.log("onQuitClubError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(t);e.ItemAppliedClub=i,__reflect(i.prototype,"Club.ItemAppliedClub")
}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemClubMemberSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){var e=this;this.btnAction.setClick(function(){e.onBtnClicked()}),this.setBtnLable()},n.prototype.onBtnClicked=function(){this.showMemberMgmtScene()},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=GlobalConstants.USER_DEFAULT_IMAGE;null!=this.data.avatar&&(e=this.data.avatar),this.imgMemberAvatar.source=String(e),this.labMemberName.text=String(this.data.name),this.labMemberId.text=String(this.data.id),this.labMemberLv.text=String(this.data.level),this.labMemberScore.text=String(this.data.score),this.labCreateTime.text=String(this.data.createTime)},n.prototype.setBtnLable=function(){this.btnAction.setLabTitle(e.Locales.get()["Btn.Manage"])},n.prototype.showMemberMgmtScene=function(){if(console.log("显示管理会员的窗口"),null!=e.ClubData.getInstance().club){var t=String(e.ClubData.getInstance().club.id),n=this.data,o=e.MemberMgmtScene.getInstance();o.setClubAndMember(t,n),SceneManager.getInstance().pushScene(o)}},n}(eui.ItemRenderer);e.ItemClubMember=t,__reflect(t.prototype,"Club.ItemClubMember");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.onBtnClicked=function(){console.log("删除管理员"),this.removeAdminReq()},n.prototype.setBtnLable=function(){this.btnAction.setLabTitle(e.Locales.get()["Btn.Delete"])},n.prototype.removeAdminReq=function(){console.log("删除管理员");var t=EventType.CLUB_MGMT,n=new e.ClubReq;if(n.cmd=e.CommandType.REMOVE_ADMIN_REQ,null!=e.ClubData.getInstance().club){n.clubId=e.ClubData.getInstance().club.id,n.memberId=this.data.id,n.adminRole=e.ClubAdminRole.ADMINISTRATOR;var o=new EventReq(t,n);Network.getInstance().request(o,this.onRemoveAdminSuccess.bind(this),this.onRemoveAdminError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.onRemoveAdminSuccess=function(t){if(console.log("onRemoveAdminSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),null!=e.ClubData.getInstance().club){var n=e.ClubData.getInstance().club.id,o=e.ClubMembersScene.getInstance();TipsScene.getInstance().showInfo(t.getContent()),o.setClubId(String(n)),o.refreshAppliedMembersList(this.data.id)}},n.prototype.onRemoveAdminError=function(e){console.log("onRemoveAdminError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(t);e.ItemAdmins=n,__reflect(n.prototype,"Club.ItemAdmins")}(Club||(Club={}));var Club;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="ItemClubOrderSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.labAmount.text=String(this.data.amount),this.labUpdatedAmt.text=String(this.data.updatedAmt),this.labCreateTime.text=String(GlobalUtils.dateFormat(this.data.createTime))},t}(eui.ItemRenderer);e.ItemClubOrder=t,__reflect(t.prototype,"Club.ItemClubOrder")}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemGameConfSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){var e=this;this.btnAction.setClick(function(){e.onBtnClicked()}),this.setBtnLable()},n.prototype.onBtnClicked=function(){this.deleteGameConfReq()},n.prototype.setBtnLable=function(){this.btnAction.setLabTitle(e.Locales.get()["Btn.Delete"])},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.labBottomScore.text=String(this.data.bottomScore),this.labMinChips.text=String(this.data.minChips),this.labMaxChips.text=String(this.data.maxChips),this.labCapacity.text=String(this.data.capacity),this.labRounds.text=String(this.data.rounds)},n.prototype.deleteGameConfReq=function(){console.log("删除玩法");var t=EventType.CLUB_MGMT,n=new e.ClubReq;if(n.cmd=e.CommandType.DELETE_GAME_CONF_REQ,null!=e.ClubData.getInstance().club){n.clubId=e.ClubData.getInstance().club.id,n.gcId=String(this.data.gcId);var o=new EventReq(t,n);Network.getInstance().request(o,this.onDeleteGameConfSuccess.bind(this),this.onDeleteGameConfError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.onDeleteGameConfSuccess=function(t){console.log("onDeleteGameConfSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance());var n=String(e.ClubData.getInstance().club.id),o=e.GameConfsScene.getInstance();o.setClubId(String(n)),o.refreshGameConfsList(this.data.gcId),TipsScene.getInstance().showInfo(t.getContent())},n.prototype.onDeleteGameConfError=function(e){console.log("onDeleteGameConfError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.ItemRenderer);e.ItemGameConf=t,__reflect(t.prototype,"Club.ItemGameConf");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.onBtnClicked=function(){this.createClubRoomReq()},n.prototype.setBtnLable=function(){this.btnAction.setLabTitle(e.Locales.get()["Btn.Create"])},n.prototype.createClubRoomReq=function(){console.log("创建俱乐部房间");var t=EventType.CLUB_MGMT,n=new e.ClubReq;if(n.cmd=e.CommandType.CREATE_ROOM_REQ,null!=e.ClubData.getInstance().club){n.clubId=e.ClubData.getInstance().club.id,n.gcId=this.data.gcId;var o=new EventReq(t,n);Network.getInstance().request(o,this.onCreateClubRoomSuccess.bind(this),this.onCreateClubRoomError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.onCreateClubRoomSuccess=function(e){console.log("onCreateClubRoomSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.onCreateClubRoomError=function(e){console.log("onCreateClubRoomError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(t);e.ItemCRGameConf=n,__reflect(n.prototype,"Club.ItemCRGameConf")}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemOnlineRoomSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){var e=this;this.btnJoinRoom.setClick(function(){e.joinRoomReq()}),this.btnCloseRoom.setClick(function(){e.closeRoomReq()})},n.prototype.showBtnCloseRoom=function(){this.data.status!=RoomState.CLOSED?this.btnCloseRoom.visible=!0:this.btnCloseRoom.visible=!1},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.labRoomId.text=String(this.data.id),this.data.type==RoomType.TEXAS?(this.labBottomTips.text=e.Locales.get()["Lab.Texas.BottomTips"],this.labBottomScore.text=String(this.data.bottomScore)+"/"+String(2*this.data.bottomScore)):(this.labBottomTips.text=e.Locales.get()["Lab.Others.BottomTips"],this.labBottomScore.text=String(this.data.bottomScore)),this.labMinChips.text=String(this.data.minChips),this.labRounds.text=String(this.data.rounds);var n=0;null!=this.data.users&&0!=this.data.users.length&&(n=this.data.users.length),this.labRoomMembers.text=String(n+"/"+this.data.capacity),this.labState.text=this.data.status,this.labCreateTime.text=String(this.data.createDate),this.showBtnCloseRoom()},n.prototype.joinRoomReq=function(){console.log("加入房间");var e=EventType.ROOM_JOIN,t=new RoomJoinReq;t.roomId=this.data.id;var n=new EventReq(e,t);Network.getInstance().request(n,this.onJoinRoomSuccess.bind(this),this.onJoinRoomError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onJoinRoomSuccess=function(e){console.log("onJoinRoomSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.onJoinRoomError=function(e){console.log("onJoinRoomError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.closeRoomReq=function(){console.log("关闭房间");var t=EventType.CLUB_MGMT,n=new e.ClubReq;if(n.cmd=e.CommandType.CLOSE_ROOM_REQ,null!=e.ClubData.getInstance().club){var o=e.ClubData.getInstance().club.id;n.clubId=o,n.roomId=this.data.id;var i=new EventReq(t,n);Network.getInstance().request(i,this.onCloseRoomSuccess.bind(this),this.onCloseRoomError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.onCloseRoomSuccess=function(e){console.log("onJoinRoomSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.onCloseRoomError=function(e){console.log("onCloseRoomError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.ItemRenderer);e.ItemOnlineRoom=t,__reflect(t.prototype,"Club.ItemOnlineRoom")}(Club||(Club={}));var Club;!function(e){var t=function(){function e(){}return e.get=function(){return e.CN},e.CN={"Btn.Join":"加入","Btn.Enter":"进入","Lab.Texas.BottomTips":"盲注:","Lab.Others.BottomTips":"底分:","Btn.Withdraw.App":"撤销","Network.Timeout.Error":"网络超时,请稍后重试","Network.Common.Error":"网络错误,请稍后重试","Btn.Delete":"删除","Btn.Create":"创建","Btn.Manage":"管理","Btn.Approve":"批准","No.Announcement":"暂无公告.",Yes:"是",No:"否","Club.Id.Error":"请输入正确的俱乐部ID!","User.Id.Error":"请输入有效会员ID!","Delete.Club.Confirmation":"您确认删除俱乐部:{0}吗?","Transfer.Club.Confirmation":"您确认将俱乐部:{0}转让给用户:{1}吗?","Quit.Club.Confirmation":"您确认将退出俱乐部:{0}吗?退出后您在本俱乐部的数据都会清空."},e}();e.Locales=t,__reflect(t.prototype,"Club.Locales")}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="MemberMgmtSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),e.syncGetClubMembers()},e),e}return __extends(n,t),n.getInstance=function(){return null==this.memberMgmtScene&&(this.memberMgmtScene=new n),this.memberMgmtScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh.setClick(function(){e.syncGetClubMembers()}),this.btnResetScore.setClick(function(){e.resetMemberScoreReq()}),this.btnPlusScore.setClick(function(){e.plusMemberScoreReq()}),this.btnMinusScore.setClick(function(){e.minusMemberScoreReq()}),this.btnDeleteMember.setClick(function(){e.deleteMemberReq()}),this.btnAddAdmin.setClick(function(){e.addAdminReq()}),this.btnClubOrders.setClick(function(){e.showClubOrdersWin()})},n.prototype.showClubOrdersWin=function(){console.log("显示上下分记录的窗口");var t=e.ClubOrdersScene.getInstance();t.setClubAndMember(this.clubId,this.memberId),SceneManager.getInstance().pushScene(t)},n.prototype.syncGetClubMembers=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getClubMembers()},!0,300,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.refreshMemberInfo()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getClubMembers=function(){console.log("取得会员的数据.");var t=e.ClubData.getInstance().getClub(String(this.clubId),e.ClubQueryMode.MEMBERS);return null!=t&&null!=t.members?(this.club=t,!0):!1},n.prototype.refreshMemberInfo=function(){this.member=ArrayUtils.findItemByKey(this.club.members,"id",this.memberId),this.setClubAndMember(this.clubId,this.member)},n.prototype.resetTxtInputFields=function(){this.txtPlusScore.text="",this.txtMinusScore.text=""},n.prototype.setClubAndMember=function(e,t){this.clubId=e,this.memberId=t.id,this.member=t,this.showMemberInfo(),this.resetTxtInputFields()},n.prototype.showMemberInfo=function(){var t=GlobalConstants.USER_DEFAULT_IMAGE;null!=this.member.avatar&&(t=String(this.member.avatar)),this.imgMemberAvatar.source=t,this.labMemberName.text=String(this.member.name),this.labMemberId.text=String(this.member.id),this.labMemberLv.text=String(this.member.level),this.labMemberScore.text=String(this.member.score),this.labCreateTime.text=String(this.member.createTime),null==this.member.adminRole||this.member.adminRole==e.ClubAdminRole.NONE?this.labIsAdmin.text=e.Locales.get().No:this.labIsAdmin.text=e.Locales.get().Yes},n.prototype.validateTxtFields=function(e){return""!=e&&GlobalUtils.isInteger(e)?!0:!1},n.prototype.resetMemberScoreReq=function(){var e=-Number(this.member.score);this.addMemberScore(e)},n.prototype.plusMemberScoreReq=function(){this.validateTxtFields(this.txtPlusScore.text.trim())&&this.addMemberScore(Number(this.txtPlusScore.text.trim()))},n.prototype.minusMemberScoreReq=function(){this.validateTxtFields(this.txtMinusScore.text.trim())&&this.addMemberScore(-Number(this.txtMinusScore.text.trim()))},n.prototype.addMemberScore=function(t){console.log("会员上分");var n=EventType.CLUB_MGMT,o=new e.ClubReq;if(o.cmd=e.CommandType.ADD_MEMBER_SCORE_REQ,null!=e.ClubData.getInstance().club){o.clubId=e.ClubData.getInstance().club.id,o.memberId=this.member.id,o.memberScore=t;var i=new EventReq(n,o);Network.getInstance().request(i,this.onAddMemberScoreSuccess.bind(this),this.onAddMemberScoreError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.onAddMemberScoreSuccess=function(e){console.log("onAddMemberScoreSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.onAddMemberScoreError=function(e){console.log("onAddMemberScoreError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.deleteMemberReq=function(){console.log("删除会员的请求");var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.REMOVE_MEMBER_REQ,n.clubId=String(this.clubId),n.memberId=String(this.member.id);var o=new EventReq(t,n);Network.getInstance().request(o,this.onDeleteMemberSuccess.bind(this),this.onDeleteMemberError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onDeleteMemberSuccess=function(t){var n=this;console.log("onDeleteMemberSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance());var o=e.ClubMembersScene.getInstance();TipsScene.getInstance().confirm(t.getContent(),function(){n.close()}),o.setClubId(String(this.clubId)),o.refreshAppliedMembersList(String(this.member.id))},n.prototype.onDeleteMemberError=function(e){console.log("onDeleteMemberError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.addAdminReq=function(){console.log("添加管理员");var t=EventType.CLUB_MGMT,n=new e.ClubReq;n.cmd=e.CommandType.ADD_ADMIN_REQ,n.clubId=this.club.id,n.memberId=String(this.member.id),n.adminRole=e.ClubAdminRole.ADMINISTRATOR;var o=new EventReq(t,n);Network.getInstance().request(o,this.onAddAdminSuccess.bind(this),this.onAddAdminError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onAddAdminSuccess=function(e){console.log("onAddAdminSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),this.syncGetClubMembers(),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.onAddAdminError=function(e){console.log("onAddAdminError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.MemberMgmtScene=t,__reflect(t.prototype,"Club.MemberMgmtScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Club;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.offlineRooms=new Array,n.skinName="OfflineRoomsSkin",n.pagedItems=new Dictionary,n.entityId=e,n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(n.stage,n),n.syncGetOfflineRooms()},n),n}return __extends(n,t),n.getInstance=function(e){return null==this.offlineRoomsScene&&(this.offlineRoomsScene=new n(e)),this.offlineRoomsScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh.setClick(function(){e.syncGetOfflineRooms()}),this.btnPageUp.setClick(function(){e.pageIdx<=1?e.pageIdx=1:e.pageIdx--,e.addOfflineRoomsItems(e.pageIdx)}),this.btnPageDown.setClick(function(){e.pageIdx>=e.pagesNum?e.pageIdx=e.pagesNum:e.pageIdx++,e.addOfflineRoomsItems(e.pageIdx)})},n.prototype.syncGetOfflineRooms=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getOfflineRooms()},!0,GlobalConstants.WAIT_FOR_INTRVAL_INMS,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.addAllListItems()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getOfflineRooms=function(){console.log("取得离线房间的数据.");var t=e.ClubData.getInstance().getClub(String(this.entityId),e.ClubQueryMode.OFFLINEROOMS);return null!=t&&null!=t.offlineRooms?(this.club=t,this.offlineRooms=t.offlineRooms,!0):!1},n.prototype.addAllListItems=function(){this.splitAllRoomsIntoPages(),this.addOfflineRoomsItems(this.pageIdx)},n.prototype.splitAllRoomsIntoPages=function(){for(var t=1;this.offlineRooms.length>0;){var n=this.offlineRooms.splice(0,e.Constants.ITEM_ROOMS_NUM_PER_PAGE);this.pagedItems.Add(String(t),n),t++}this.pageIdx=1,this.pagesNum=t-1},n.prototype.addOfflineRoomsItems=function(e){null!=this.pagedItems&&0!=this.pagedItems.Count()?this.lablistOfflineRoomsNoData.visible=!1:this.lablistOfflineRoomsNoData.visible=!0,this.listOfflineRooms.dataProvider=this.offlineRoomsArray=new eui.ArrayCollection,this.listOfflineRooms.itemRenderer=GameResult.ItemOfflineRoom;var t=this.pagedItems.Item(String(e));this.offlineRoomsArray.source=t,this.offlineRoomsArray.refresh(),this.labPagesNum.text=String(e)+"/"+String(this.pagesNum)},n}(eui.Component);e.OfflineRoomsScene=t,__reflect(t.prototype,"Club.OfflineRoomsScene",["eui.UIComponent","egret.DisplayObject"])}(Club||(Club={}));var Adaptive=function(){function e(){}return e.initData=function(){this.viewRotation=Math.abs(Number(window.orientation)),this.viewPortWidth=document.body.offsetWidth,this.viewPortHeight=document.body.offsetHeight,this.orientation==egret.OrientationMode.LANDSCAPE&&(this.viewPortWidth>this.viewPortHeight?(this.viewRotation=90,egret.log("宽度大于高度强制改变角度90")):this.viewRotation=0)},e.updateAdaptive=function(e){if(this.initData(),egret.Capabilities.isMobile){StageProxy.stage.orientation=this.orientation;var t,n;90==this.viewRotation?(n=this.viewPortWidth/this.initHeight,t=this.viewPortHeight/this.initWidth):(t=this.viewPortWidth/this.initWidth,n=this.viewPortHeight/this.initHeight),t>n?StageProxy.stage.scaleMode=egret.StageScaleMode.FIXED_NARROW:StageProxy.stage.scaleMode=egret.StageScaleMode.FIXED_NARROW}("Windows PC"==egret.Capabilities.os||"Mac OS"==egret.Capabilities.os)&&(StageProxy.stage.$stageWidth=960,StageProxy.stage.$stageHeight=640,StageProxy.stage.scaleMode=egret.StageScaleMode.FIXED_NARROW),console.log("-----------设备信息----------"),egret.log("网页正文的宽",this.viewPortWidth),egret.log("网页正文的高",this.viewPortHeight),egret.log("屏幕舞台宽度",StageProxy.stage.stageWidth),egret.log("屏幕舞台高度",StageProxy.stage.stageHeight),egret.log("屏幕宽度比例",t),egret.log("屏幕高度比例",n),egret.log("设备类型",egret.Capabilities.os,egret.Capabilities.runtimeType),egret.log("语言类型",egret.Capabilities.language),egret.log("适配类型",StageProxy.stage.scaleMode),console.log("----------------------------")},e.landscapeAdaptive=function(){this.orientation=egret.OrientationMode.LANDSCAPE,StageProxy.stage.addEventListener(egret.Event.RESIZE,this.updateAdaptive,this),this.updateAdaptive()},e.initWidth=960,e.initHeight=640,e}();__reflect(Adaptive.prototype,"Adaptive");var AppNative=function(){function e(){}return e.init=function(){1==e.isApp()&&("iOS"==egret.Capabilities.os?window.funRegister(this.iosCallBack.bind(this)):"Android"==egret.Capabilities.os&&(window.getData=this.getDataAndroid.bind(this),window.getMachineCode=this.getMachineCodeAndroid.bind(this),window.backTips=this.backTipsAndroid.bind(this)))},e.getDataAndroid=function(t){e.is_Run_App=!0,""==t||null==t?e.AppData={}:e.AppData=JSON.parse(t)},e.getMachineCodeAndroid=function(t){e.is_Run_App=!0,e.MachineCode=t},e.backTipsAndroid=function(){},e.iosCallBack=function(t,n){"getData"==t?(e.is_Run_App=!0,""==n||null==n?e.AppData={}:e.AppData=JSON.parse(n)):"getMachineCode"==t&&(e.is_Run_App=!0,e.MachineCode=n)},e.isAlready=function(){try{1==e.isApp()&&("iOS"==egret.Capabilities.os?window.isAlreadyIOS():"Android"==egret.Capabilities.os&&window.isAlreadyAndroid())}catch(t){console.log("调用APP已准备失败")}e.is_Run_App=!1},e.saveData=function(t){try{1==e.isApp()&&("iOS"==egret.Capabilities.os?window.saveDataIOS(t):"Android"==egret.Capabilities.os&&window.saveDataAndroid(t))}catch(n){console.log("调用APP保存数据失败")}},e.openBrowser=function(t){try{1==e.isApp()&&("iOS"==egret.Capabilities.os?window.openBrowserIOS(t):"Android"==egret.Capabilities.os&&window.openBrowserAndroid(t))}catch(n){console.log("调用APP浏览器失败")}},e.closeGame=function(){try{1==e.isApp()&&"Android"==egret.Capabilities.os&&window.closeGameAndroid()}catch(t){console.log("调用APP退出失败")}},e.isWeiXin=function(){var e=navigator.userAgent.toString(),t=e.match(/MicroMessenger/i);return"MicroMessenger"==t?!0:!1},e.isApp=function(){return 0==this.isWeiXin()?egret.Capabilities.os.indexOf("Windows")>=0||egret.Capabilities.os.indexOf("Mac")>=0?!1:null==e.is_Run_App?!0:1==e.is_Run_App?!0:!1:!1},e.AppData={},e.is_Run_App=null,e.SHOW_DATA="app_show_data",e.SHOW_EXITTIPS="show_exittips",e.SHOW_MACHINECODE="app_show_machinecode",e}();__reflect(AppNative.prototype,"AppNative");var AppStorage=function(){function e(){}return e.getItem=function(e){return AppNative.AppData[e]?AppNative.AppData[e]:null},e.setItem=function(e,t){return null==AppNative.AppData[e]?(AppNative.AppData[e]=t,AppNative.saveData(JSON.stringify(AppNative.AppData)),!1):(AppNative.AppData[e]=t,AppNative.saveData(JSON.stringify(AppNative.AppData)),!0)},e.getItemObj=function(e,t){void 0===t&&(t=null);var n;try{n=JSON.parse(this.getItem(e))}catch(o){}return n||(n=t),n},e.setItemObj=function(e,t){return this.setItem(e,JSON.stringify(t))},e}();__reflect(AppStorage.prototype,"AppStorage");var Dictionary=function(){function e(){this.items={},this.count=0}return e.prototype.ContainsKey=function(e){return this.items.hasOwnProperty(e)},e.prototype.Count=function(){return this.count},e.prototype.Add=function(e,t){this.items.hasOwnProperty(e)||this.count++,this.items[e]=t},e.prototype.Remove=function(e){var t=this.items[e];return delete this.items[e],this.count--,t},e.prototype.Item=function(e){return this.items[e]},e.prototype.Keys=function(){var e=[];for(var t in this.items)this.items.hasOwnProperty(t)&&e.push(t);return e},e.prototype.Values=function(){var e=[];for(var t in this.items)this.items.hasOwnProperty(t)&&e.push(this.items[t]);return e},e}();__reflect(Dictionary.prototype,"Dictionary",["IKeyedCollection"]);var DisUtil=function(){function e(){}return e.size=function(e,t,n){e.width=t,e.height=n},e.ancho=function(e,t,n){e.anchorOffsetX=t,e.anchorOffsetY=n},e.location=function(e,t,n){e.x=t,e.y=n},e.getCloneBase=function(t){var n=new egret.DisplayObject;return e.location(n,0,0),e.size(n,t.width,t.height),n},e.getRelaRect=function(t,n){var o=e.getCloneBase(t);return o=e.getInRectRelaRect(o,t,n)},e.getInRectRelaRect=function(e,t,n){for(var o,i,s,r;t!=n;)egret.is(t,"egret.Stage")?(o=0,i=0,s=1,r=1):(o=t.x,i=t.y,s=t.scaleX,r=t.scaleY),e.x=o+(e.x-t.anchorOffsetX)*s,e.y=i+(e.y-t.anchorOffsetY)*r,e.width*=s,e.height*=r,t=t.parent;return e},e.get=function(t,n){var o=e.getRelaRect(t,n);return new situate(o,t,n)},e.setScal=function(e,t){e.scaleX=e.scaleY=t},e.scale=function(e,t){e.scaleX*=t,e.scaleY*=t},e.scalLen=function(e,t){e.width*=t,e.height*=t},e.disShow=function(e,t){t=t?t:1,console.log("x:"+e.x.toFixed(t)+",y:"+e.y.toFixed(t)+",anchorOffsetX:"+e.anchorOffsetX.toFixed(t)+",anchorOffsetY:"+e.anchorOffsetY.toFixed(t)+",scaleX:"+e.scaleX.toFixed(t)+",scaleY:"+e.scaleY.toFixed(t)+",width:"+e.width.toFixed(t)+",height:"+e.height.toFixed(t)+",alpha:"+e.alpha)},e}();__reflect(DisUtil.prototype,"DisUtil");var situate=function(){function e(e,t,n){this.relRect=e,this.disObj=t,this.ancient=n,n?(this.conWidth=n.width,this.conHeight=n.height):(this.conWidth=window.innerWidth,this.conHeight=window.innerHeight),this.anRateX=t.anchorOffsetX/t.width,this.anRateY=t.anchorOffsetY/t.height}return e.prototype.scale=function(e){var t=this,n=this.anRateX*(e-1)*t.relRect.width,o=this.anRateY*(e-1)*t.relRect.height;DisUtil.scale(t.disObj,e),DisUtil.scalLen(t.relRect,e),t.relRect.x-=n,t.relRect.y-=o},e.prototype.moveX=function(e,t){var n=this;n.relRect.x+=e,n.disObj.x+=e*=t},e.prototype.moveY=function(e,t){var n=this;n.relRect.y+=e,n.disObj.y+=e*=t},e.prototype.fitW=function(){var e=this;if(0==e.relRect.width)return egret.error("宽度为0的显示对象无法应用“适应宽度”的缩放模式"),this;var t=e.conWidth/e.relRect.width;return e.scale(t),e.cenHor(),e},e.prototype.fitH=function(){var e=this;if(0==e.relRect.height)return egret.error("高度为0的显示对象无法应用“适应高度”的缩放模式"),this;var t=e.conHeight/e.relRect.height;return e.scale(t),e.cenVer(),e},e.prototype.beCon=function(){var e=this,t=e.conWidth/e.conHeight,n=e.relRect.width/e.relRect.height,o=n>=t?e.conWidth/e.relRect.width:e.conHeight/e.relRect.height;return e.scale(o),e.center(),this},e.prototype.cover=function(){var e=this,t=e.conWidth/e.conHeight,n=e.relRect.width/e.relRect.height,o=n>=t?e.conHeight/e.relRect.height:e.conWidth/e.relRect.width;return e.scale(o),e.center(),this},e.prototype.center=function(){return this.cenVer(),this.cenHor(),this},e.prototype.cenVer=function(){var e=this,t=e.conHeight/2-e.relRect.y-e.relRect.height/2,n=e.disObj.height*e.disObj.scaleY/e.relRect.height;return e.moveY(t,n),e},e.prototype.cenHor=function(){var e=this,t=e.conWidth/2-e.relRect.x-e.relRect.width/2,n=e.disObj.width*e.disObj.scaleX/e.relRect.width;return e.moveX(t,n),e},e.prototype.left=function(e){e=null==e?0:e;var t=this,n=t.disObj.width*t.disObj.scaleX/t.relRect.width,o=e-t.relRect.x;return t.moveX(o,n),this},e.prototype.right=function(e){var t=this;e=null==e?0:e;var n=t.disObj.width*t.disObj.scaleX/t.relRect.width,o=t.conWidth-t.relRect.x-t.relRect.width-e;return t.moveX(o,n),this},e.prototype.top=function(e){e=null==e?0:e;var t=this,n=t.disObj.height*t.disObj.scaleY/t.relRect.height,o=e-t.relRect.y;return t.moveY(o,n),this},e.prototype.bottom=function(e){e=null==e?0:e;var t=this;e=null==e?0:e;var n=t.disObj.height*t.disObj.scaleY/t.relRect.height,o=t.conHeight-t.relRect.y-t.relRect.height-e;return t.moveY(o,n),this},e.prototype.show=function(e){e=e?e:1;var t=this.relRect;return console.log("x:"+t.x.toFixed(e)+",y:"+t.y.toFixed(e)+",width:"+t.width.toFixed(e)+",height:"+t.height.toFixed(e)),this},e}();__reflect(situate.prototype,"situate");var UserDataReq=function(){function e(){}return e}();__reflect(UserDataReq.prototype,"UserDataReq");var UserDataRes=function(){function e(){}return e}();__reflect(UserDataRes.prototype,"UserDataRes");var RoomListReq=function(){function e(){}return e}();__reflect(RoomListReq.prototype,"RoomListReq");var RoomListRes=function(){function e(){}return e}();__reflect(RoomListRes.prototype,"RoomListRes");var RoomConfsReq=function(){function e(){}return e}();__reflect(RoomConfsReq.prototype,"RoomConfsReq");var RoomConfsRes=function(){function e(){}return e}();__reflect(RoomConfsRes.prototype,"RoomConfsRes");var RoomCreateReq=function(){function e(){}return e}();__reflect(RoomCreateReq.prototype,"RoomCreateReq");var RoomCreateRes=function(){function e(){}return e}();__reflect(RoomCreateRes.prototype,"RoomCreateRes");var RoomJoinReq=function(){function e(){}return e}();__reflect(RoomJoinReq.prototype,"RoomJoinReq");var RoomJoinRes=function(){function e(){}return e}();__reflect(RoomJoinRes.prototype,"RoomJoinRes");var RoomReJoinReq=function(){function e(){}return e}();__reflect(RoomReJoinReq.prototype,"RoomReJoinReq");var RoomJoinOthersRes=function(){function e(){}return e}();__reflect(RoomJoinOthersRes.prototype,"RoomJoinOthersRes");var BeReadyReq=function(){function e(){}return e}();__reflect(BeReadyReq.prototype,"BeReadyReq");var BeReadyRes=function(){function e(){}return e}();__reflect(BeReadyRes.prototype,"BeReadyRes");var RoomLeaveReq=function(){function e(){}return e}();__reflect(RoomLeaveReq.prototype,"RoomLeaveReq");var RoomLeaveRes=function(){function e(){}return e}();__reflect(RoomLeaveRes.prototype,"RoomLeaveRes");var ClubEnterReq=function(){function e(){}return e}();__reflect(ClubEnterReq.prototype,"ClubEnterReq");var ClubEnterRes=function(){function e(){}return e}();__reflect(ClubEnterRes.prototype,"ClubEnterRes");var ClubLeaveReq=function(){function e(){}return e}();__reflect(ClubLeaveReq.prototype,"ClubLeaveReq");var ClubLeaveRes=function(){function e(){}return e}();__reflect(ClubLeaveRes.prototype,"ClubLeaveRes");var RoomCloseReq=function(){function e(){}return e}();__reflect(RoomCloseReq.prototype,"RoomCloseReq");var EnableHostReq=function(){function e(){}return e}();__reflect(EnableHostReq.prototype,"EnableHostReq");var EnableHostRes=function(){function e(){}return e}();__reflect(EnableHostRes.prototype,"EnableHostRes");var DisableHostReq=function(){function e(){}return e}();__reflect(DisableHostReq.prototype,"DisableHostReq");var DisableHostRes=function(){function e(){}return e}();__reflect(DisableHostRes.prototype,"DisableHostRes");var CommonRes=function(){function e(){}return e}();__reflect(CommonRes.prototype,"CommonRes");var CoinModeRoomJoinReq=function(){function e(){}return e}();__reflect(CoinModeRoomJoinReq.prototype,"CoinModeRoomJoinReq");var CoinModeRoomJoinRes=function(){function e(){}return e}();__reflect(CoinModeRoomJoinRes.prototype,"CoinModeRoomJoinRes");var LogOutReq=function(){function e(){}return e}();__reflect(LogOutReq.prototype,"LogOutReq");var HeartBeatReq=function(){function e(){}return e}();__reflect(HeartBeatReq.prototype,"HeartBeatReq");var HeartBeatRes=function(){function e(){}return e}();__reflect(HeartBeatRes.prototype,"HeartBeatRes");var EventHandlersManager=function(){function e(){}return e.getInstance=function(){return null==this.evtHandlerMgr&&(this.evtHandlerMgr=new e),this.evtHandlerMgr},e.prototype.registerEventHandlers=function(){Network.getInstance().bind(String(EventType.USER_DATA),this.userDataEventHandler,this),Network.getInstance().bind(String(EventType.ROOM_JOIN_OTHERS),this.roomJoinOthersEventHandler,this),Network.getInstance().bind(String(EventType.TABLE_IS_FULL),this.tableIsFullEventHandler,this),Network.getInstance().bind(String(EventType.BE_READY),this.beReadyEventHandler,this),Network.getInstance().bind(String(EventType.ENABLE_HOST),this.enableHostEventHandler,this),Network.getInstance().bind(String(EventType.DISABLE_HOST),this.disableHostEventHandler,this),Network.getInstance().bind(String(EventType.ROOM_LEAVE_OTHERS),this.roomLeaveOthersEventHandler,this),Network.getInstance().bind(String(EventType.ROOM_JOIN),this.roomJoinEventHandler,this),Network.getInstance().bind(String(EventType.ROOM_REJOIN),this.roomRejoinEventHandler,this),Network.getInstance().bind(String(EventType.ROOM_CONFS),this.roomConfsEventHandler,this),Network.getInstance().bind(String(EventType.CLUB_MGMT),this.clubMgmtEventHandler,this),Network.getInstance().bind(String(EventType.SHOP_MGMT),this.shopMgmtEventHandler,this),Network.getInstance().bind(String(EventType.AGENT_MGMT),this.agentMgmtEventHandler,this),Network.getInstance().bind(String(EventType.EMAIL_MGMT),this.emailMgmtEventHandler,this),Network.getInstance().bind(String(EventType.FEEDBACK_MGMT),this.feedbackMgmtEventHandler,this),Network.getInstance().bind(String(EventType.SYSTEM_MGMT),this.systemMgmtEventHandler,this),Network.getInstance().bind(String(EventType.USER_MGMT),this.userMgmtEventHandler,this),Network.getInstance().bind(String(EventType.ROOM_LIST),this.RoomListEventHandler,this),Network.getInstance().bind(String(EventType.GAME_DDZ),this.ddzEventHandler,this),Network.getInstance().bind(String(EventType.GAME_DDZ_TIMED_TASK),this.ddzTimedTaskEventHandler,this),Network.getInstance().bind(String(EventType.GAME_TEXAS),this.texasEventHandler,this),Network.getInstance().bind(String(EventType.GAME_TEXAS_TIMED_TASK),this.texasTimedTaskEventHandler,this),Network.getInstance().bind(String(EventType.GAME_ZJH),this.zjhEventHandler,this),Network.getInstance().bind(String(EventType.GAME_ZJH_TIMED_TASK),this.zjhTimedTaskEventHandler,this),Network.getInstance().bind(String(EventType.GAME_QZNN),this.qznnEventHandler,this),Network.getInstance().bind(String(EventType.GAME_QZNN_TIMED_TASK),this.qznnTimedTaskEventHandler,this),Network.getInstance().bind(String(EventType.SYSTEM_MESSAGE),this.systemMessageEventHandler,this),Network.getInstance().bind(String(EventType.HEARTBEAT),this.HeartBeatEventHandler,this)
},e.prototype.userDataEventHandler=function(e){console.log("userData Event here！"+e);try{var t=e;(null!=t||null!=t.user)&&(UserService.getInstance().setUser(t.user),EventManager.getInstance().dispatchEvent(GlobalConstants.EVENT_USER_DATA))}catch(n){console.log(n)}},e.prototype.ddzEventHandler=function(e){console.log("ddz Event here！"+e);try{Ddz.GameLogic.getInstance().processCmd(e)}catch(t){console.log(t)}},e.prototype.texasEventHandler=function(e){console.log("texas Event here！"+e);try{Texas.GameLogic.getInstance().processCmd(e)}catch(t){console.log(t)}},e.prototype.zjhEventHandler=function(e){console.log("zjh Event here！"+e);try{Zjh.GameLogic.getInstance().processCmd(e)}catch(t){console.log(t)}},e.prototype.qznnEventHandler=function(e){console.log("qznn Event here！"+e);try{Qznn.GameLogic.getInstance().processCmd(e)}catch(t){console.log(t)}},e.prototype.beReadyEventHandler=function(t){console.log("beReady Event here！"+t);try{var n=RoomService.getInstance().getRoom(),o=e.getHandlerInstanceByRoomType(n.type);o.beReady(t)}catch(i){console.log(i)}},e.getHandlerInstanceByRoomType=function(e){var t=null;switch(e){case RoomType.DDZ:console.log("斗地主."),t=Ddz.GameLogic.getInstance();break;case RoomType.TEXAS:console.log("德州扑克."),t=Texas.GameLogic.getInstance();break;case RoomType.ZJH:console.log("炸金花."),t=Zjh.GameLogic.getInstance();break;case RoomType.QZNN:console.log("抢庄牛牛."),t=Qznn.GameLogic.getInstance();break;default:console.log("房间类型:"+e+"不存在.")}return t},e.getExtraAttrByRoomType=function(e){var t=null;switch(e){case RoomType.DDZ:console.log("斗地主."),t=new Ddz.ExtraAttribute;break;case RoomType.TEXAS:console.log("德州扑克."),t=new Texas.ExtraAttribute;break;case RoomType.ZJH:console.log("炸金花."),t=new Zjh.ExtraAttribute;break;case RoomType.QZNN:console.log("抢庄牛牛."),t=new Qznn.ExtraAttribute;break;default:console.log("房间类型:"+e+"不存在.")}return t},e.prototype.roomJoinOthersEventHandler=function(t){console.log("RoomJoinOthers Event here！"+t);try{var n=RoomService.getInstance().getRoom(),o=e.getHandlerInstanceByRoomType(n.type);o.roomJoinOthers(t)}catch(i){console.log(i)}},e.prototype.roomJoinEventHandler=function(t){try{Room.init(t.room);var n=RoomService.getInstance().getRoom();Table.init(n);var o=e.getExtraAttrByRoomType(n.type);n.table.setExtraAttribute(o),User.init(t.users);var i=UserService.getInstance().getUser();i.beReady=!1;var s=e.getHandlerInstanceByRoomType(n.type);s.roomJoin(t)}catch(r){console.log(r)}},e.prototype.roomRejoinEventHandler=function(t){console.log("RoomReJoin Event here！"+t);try{Room.init(t.room);var n=RoomService.getInstance().getRoom();Table.init(n);var o=e.getExtraAttrByRoomType(n.type);n.table.setExtraAttribute(o),User.init(t.users);var i=e.getHandlerInstanceByRoomType(n.type);i.roomRejoin(t)}catch(s){console.log(s)}},e.prototype.enableHostEventHandler=function(e){console.log("EnableHost Event here！"+e);try{var t=RoomService.getInstance().getRoom(),n=t.table.getAllUsers(),o=ArrayUtils.findItemByKey(n,"id",e.userId);o.beHosted=!0;var i=UserService.getInstance().getUser();i.id==e.userId&&(i.beHosted=!0),EventManager.getInstance().dispatchEvent(GlobalConstants.EVENT_ENABLE_HOST,e)}catch(s){console.log(s)}},e.prototype.disableHostEventHandler=function(e){console.log("DisableHost Event here！"+e);try{var t=RoomService.getInstance().getRoom(),n=t.table.getAllUsers(),o=ArrayUtils.findItemByKey(n,"id",e.userId);o.beHosted=!1;var i=UserService.getInstance().getUser();i.id==e.userId&&(i.beHosted=!1),EventManager.getInstance().dispatchEvent(GlobalConstants.EVENT_DISABLE_HOST,e)}catch(s){console.log(s)}},e.prototype.tableIsFullEventHandler=function(e){var t=this;console.log("TableIsFull Event here！"+e),GlobalUtils.waitfor(function(){return null!=RoomService.getInstance().getRoom()},!0,GlobalConstants.WAIT_FOR_INTRVAL_INMS,egret.getTimer(),5e3,function(){t.tableIsFullEventProc(e)},null)},e.prototype.tableIsFullEventProc=function(t){try{var n=RoomService.getInstance().getRoom(),o=e.getHandlerInstanceByRoomType(n.type);o.tableIsFull(t)}catch(i){console.log(i)}},e.prototype.roomLeaveOthersEventHandler=function(t){console.log("RoomLeaveOthers Event here！"+t);try{var n=RoomService.getInstance().getRoom(),o=t;n.id==o.roomId&&n.table.removeUserById(o.userId);var i=e.getHandlerInstanceByRoomType(n.type);i.roomLeaveOthers(t)}catch(s){console.log(s)}},e.prototype.ddzTimedTaskEventHandler=function(e){},e.prototype.texasTimedTaskEventHandler=function(e){},e.prototype.qznnTimedTaskEventHandler=function(e){},e.prototype.zjhTimedTaskEventHandler=function(e){},e.prototype.roomConfsEventHandler=function(e){try{var t=e;CreateRoomScene.getInstance().romConfsRes(t)}catch(n){console.log(n)}},e.prototype.clubMgmtEventHandler=function(e){console.log("club Event here！"+e);try{Club.ClubLogic.getInstance().processCmd(e)}catch(t){console.log(t)}},e.prototype.shopMgmtEventHandler=function(e){console.log("shop Event here！"+e);try{Shop.ShopLogic.getInstance().processCmd(e)}catch(t){console.log(t)}},e.prototype.agentMgmtEventHandler=function(e){console.log("agent Event here！"+e);try{Agent.AgentLogic.getInstance().processCmd(e)}catch(t){console.log(t)}},e.prototype.emailMgmtEventHandler=function(e){console.log("email Event here！"+e);try{Email.EmailLogic.getInstance().processCmd(e)}catch(t){console.log(t)}},e.prototype.feedbackMgmtEventHandler=function(e){console.log("feedback Event here！"+e);try{Feedback.FeedbackLogic.getInstance().processCmd(e)}catch(t){console.log(t)}},e.prototype.systemMgmtEventHandler=function(e){console.log("system Event here！"+e);try{Hall.HallLogic.getInstance().processCmd(e)}catch(t){console.log(t)}},e.prototype.userMgmtEventHandler=function(e){console.log("user Event here！"+e);try{UserMgmt.UserMgmtLogic.getInstance().processCmd(e)}catch(t){console.log(t)}},e.prototype.RoomListEventHandler=function(e){console.log("room List Event here！"+e);try{RoomList.RoomListLogic.getInstance().processCmd(e)}catch(t){console.log(t)}},e.prototype.systemMessageEventHandler=function(e){console.log("system message Event here！"+e);try{EventManager.getInstance().dispatchEvent(GlobalConstants.EVENT_SYSTEM_MESSAGE,e)}catch(t){console.log(t)}},e.prototype.clubEnterEventHandler=function(e){console.log("club enter Event here！"+e);try{EventManager.getInstance().dispatchEvent(GlobalConstants.EVENT_CLUB_ENTER,e);var t=e,n=UserService.getInstance().getUser();null!=n&&(n.score=t.score)}catch(o){console.log(o)}},e.prototype.clubLeaveEventHandler=function(e){console.log("club leave Event here！"+e);try{EventManager.getInstance().dispatchEvent(GlobalConstants.EVENT_CLUB_LEAVE,e);var t=e,n=UserService.getInstance().getUser();null!=n&&(n.score=t.score)}catch(o){console.log(o)}},e.prototype.HeartBeatEventHandler=function(e){console.log("Heartbeat Event here！"+e);try{var t=EventType.HEARTBEAT,n=new HeartBeatReq,o=new EventReq(t,n);Network.getInstance().send(o)}catch(i){console.log(i)}},e}();__reflect(EventHandlersManager.prototype,"EventHandlersManager");var EvetnId=function(){function e(){}return e.UUID=function(){return e.counter++},e.counter=1,e}();__reflect(EvetnId.prototype,"EvetnId");var EventManager=function(){function e(){this.eventList={}}return e.getInstance=function(){return void 0==this._instance&&(this._instance=new e),this._instance},e.prototype.dispatchEvent=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=this.eventList[e];if(null!=o)for(var i,s,r=o.length,a=0;r>a;a++){var l=o[a];i=l[0],s=l[1],i.apply(s,t)}},e.prototype.addEvent=function(e,t,n){var o=this.eventList[e];if(null==o)o=[],this.eventList[e]=o;else for(var i=o.length,s=0;i>s;s++)if(o[s][0]==t&&o[s][1]==n)return;o.push([t,n])},e.prototype.removeEvent=function(e,t,n){var o=this.eventList[e];if(null!=o)for(var i=o.length,s=i-1;s>=0;s--)o[s][0]==t&&o[s][1]==n&&o.splice(s,1);o&&0==o.length&&(this.eventList[e]=null,delete this.eventList[e])},e}();__reflect(EventManager.prototype,"EventManager");var FuncResult=function(){function e(e,t){this.success=e,this.data=t}return e.prototype.getSuccess=function(){return this.success},e.prototype.getData=function(){return this.getData},e}();__reflect(FuncResult.prototype,"FuncResult");var GameRsl=function(){function e(){}return e}();__reflect(GameRsl.prototype,"GameRsl");var GlobalConstants=function(){function e(){}return e.HTTP_HOST="",e.HTTP_PORT=0,e.HTTP_URL="",e.ENABLE_COMM_ENCRYPTION=!0,e.USER_DEFAULT_IMAGE="man_01_png",e.POKER_WvsH_RATIO=1.35,e.POKER_XL_W=95,e.POKER_L_W=75,e.POKER_M_W=60,e.POKER_S_W=50,e.POKER_XL_VISIBLEW=38,e.POKER_L_VISIBLEW=35,e.POKER_M_VISIBLEW=30,e.POKER_S_VISIBLEW=20,e.WAIT_FOR_INTRVAL_INMS=900,e.ROOM_CONFS="Room.Confs",e.RECONNECT_USERNAME="Reconnect.UserName",e.RECONNECT_PASSWORD="Reconnect.Password",e.EVENT_USER_DATA="Event.User.Reload.Data",e.EVENT_ENABLE_HOST="Event.Enable.Host",e.EVENT_DISABLE_HOST="Event.Disable.Host",e.EVENT_SYSTEM_MESSAGE="Event.System.Message",e.EVENT_CLUB_ENTER="Event.Club.Enter",e.EVENT_CLUB_LEAVE="Event.Club.Leave",e.EVENT_MUSIC_BG_CHANGED="Event.Music.Bg.Changed",e.EVENT_MUSIC_EFFECT_CHANGED="Event.Music.Effect.Changed",e}();__reflect(GlobalConstants.prototype,"GlobalConstants");var GlobalLocales=function(){function e(){}return e.get=function(){return e.CN},e.CN={"common.error":"错误:","nw.connection.error":"连接错误,请检查网络连接.","nw.data.error":"数据错误,请重新连接.","start.Matching.Player":"开始匹配玩家..."},e}();__reflect(GlobalLocales.prototype,"GlobalLocales");var GlobalVars=function(){function e(){}return e.getInstance=function(){return void 0==this._instance&&(this._instance=new e),this._instance},e}();__reflect(GlobalVars.prototype,"GlobalVars");var LocalStorage=function(){function e(){}return e.init=function(e){this.ID=e},e.getItem=function(e){return egret.localStorage.getItem(this.ID&&""!=this.ID?this.ID+"_"+e:e)},e.setItem=function(e,t){return egret.localStorage.setItem(this.ID&&""!=this.ID?this.ID+"_"+e:e,t)},e.getItemObj=function(e,t){void 0===t&&(t=null);var n;try{n=JSON.parse(this.getItem(e))}catch(o){}return n||(n=t),n},e.setItemObj=function(e,t){return this.setItem(e,JSON.stringify(t))},e}();__reflect(LocalStorage.prototype,"LocalStorage");var Payment=function(){function e(){}return e}();__reflect(Payment.prototype,"Payment");var Room=function(){function e(){}return e.init=function(e){null!=e&&RoomService.getInstance().setRoom(e)},e}();__reflect(Room.prototype,"Room");var RoomCategory=function(){function e(){}return e.CARDMODE="CARDMODE",e.COINMODE="COINMODE",e.CLUBMODE="CLUBMODE",e.CONTEST="CONTEST",e}();__reflect(RoomCategory.prototype,"RoomCategory");var RoomChargingMode=function(){function e(){}return e.OWNER="OWNER",e.AA="AA",e}();__reflect(RoomChargingMode.prototype,"RoomChargingMode");var RoomConf=function(){function e(){}return e}();__reflect(RoomConf.prototype,"RoomConf");var RoomService=function(){function e(){}return e.getInstance=function(){return null==this.roomSvc&&(this.roomSvc=new e),this.roomSvc},e.prototype.setRoom=function(e){this.room=e},e.prototype.getRoom=function(){return this.room},e.prototype.getRoomExtraAttribute=function(){return this.room.extraAttribute},e.prototype.setUserExtraAttribute=function(e){this.room.extraAttribute=e},e}();__reflect(RoomService.prototype,"RoomService");var RoomState=function(){function e(){}return e.CREATED="CREATED",e.READY="READY",e.RUNNING="RUNNING",e.CLOSED="CLOSED",e}();__reflect(RoomState.prototype,"RoomState");var RoomTier=function(){function e(){}return e.STD="STD",e.VIP="VIP",e}();__reflect(RoomTier.prototype,"RoomTier");var RoomType=function(){function e(){}return e.DDZ="DDZ",e.QZNN="QZNN",e.ZJH="ZJH",e.TEXAS="TEXAS",e}();__reflect(RoomType.prototype,"RoomType");var SceneManager=function(){function e(){this.main=Main.getInstance(),this.scenes=[]}return e.getInstance=function(){return null==this.manager&&(this.manager=new e),this.manager},e.prototype.pushScene=function(e){this.popScene(e),e.x=.5*this.main.width-.5*e.width,e.y=.5*this.main.height-.5*e.height,e.anchorOffsetX=0,e.anchorOffsetY=0,this.main.stage.addChild(e),this.scenes.push(e)},e.prototype.popScene=function(e){null!=e&&this.main.stage.contains(e)&&this.main.stage.removeChild(e);for(var t=this.scenes.length-1;t>=0;--t){var n=this.scenes[t];n==e&&this.scenes.splice(t,1)}},e.prototype.popLastScene=function(){if(null!=this.scenes){var e=this.scenes.length;if(e>0){var t=this.scenes[e-1];t.parent==this.main.stage&&(null!=t&&this.main.stage.contains(t)&&this.main.stage.removeChild(t),this.scenes.pop())}}},e}();__reflect(SceneManager.prototype,"SceneManager");var Seat=function(){function e(e){this.user=e}return e}();__reflect(Seat.prototype,"Seat");var Session=function(){function e(){}return e}();__reflect(Session.prototype,"Session");var SoundManager=function(){function e(){}return e.getInstance=function(){return void 0==this._instance&&(this._instance=new e),this._instance},e.prototype.playMusic=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=0),e&&(this.musicRes=e),!this.musicMute){this.stopMusic();var n=RES.getRes(this.musicRes);null!=n&&(0==t?this.musicChannel=n.play(0):this.musicChannel=n.play(0,t),this.musicChannel.volume=this.musicVolume,this.musicChannel.addEventListener(egret.Event.SOUND_COMPLETE,this.onMusicComplete,this))}},e.prototype.setVolume=function(){this.musicChannel&&(this.musicChannel.volume=this.musicVolume)},e.prototype.setVolumeNum=function(e){this.musicChannel&&(this.musicChannel.volume=e)},e.prototype.onMusicComplete=function(e){this.stopMusic()},e.prototype.stopMusic=function(){this.musicChannel&&(this.musicChannel.stop(),this.musicChannel.removeEventListener(egret.Event.SOUND_COMPLETE,this.onMusicComplete,this),this.musicChannel=null)},e.prototype.switchMusic=function(){this.musicMute=!this.musicMute,this.musicRes&&(this.musicMute?this.stopMusic():this.playMusic())},Object.defineProperty(e.prototype,"musicVolume",{get:function(){var e;return e=LocalStorage.getItem("musicVolume")?Number(LocalStorage.getItem("musicVolume")):1},set:function(e){LocalStorage.setItem("musicVolume",e.toString())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"musicMute",{get:function(){var e=LocalStorage.getItem("musicMute");return e?"1"==e:!1},set:function(e){LocalStorage.setItem("musicMute",e?"1":"0")},enumerable:!0,configurable:!0}),e.prototype.playEffect=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=1),e&&(this.effectRes=e,!this.effectMute)){var n=RES.getRes(this.effectRes);null!=n&&(this.effectChannel=n.play(0,t),this.effectChannel.volume=this.effectVolume)}},e.prototype.stopEffect=function(){this.effectChannel&&(this.effectChannel.stop(),this.effectChannel=null)},e.prototype.switchEffect=function(){this.effectMute=!this.effectMute},Object.defineProperty(e.prototype,"effectMute",{get:function(){var e=LocalStorage.getItem("effectMute");return e?"1"==e:!1},set:function(e){LocalStorage.setItem("effectMute",e?"1":"0")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectVolume",{get:function(){var e;return e=LocalStorage.getItem("effectVolume")?Number(LocalStorage.getItem("effectVolume")):1},set:function(e){LocalStorage.setItem("effectVolume",e.toString())},enumerable:!0,configurable:!0}),e.prototype.switchAll=function(){this.switchEffect(),this.switchMusic()},e}();__reflect(SoundManager.prototype,"SoundManager");var StageProxy=function(){function e(){}return e.init=function(e,t){this.stage=e,this.root=t},Object.defineProperty(e,"width",{get:function(){return this.stage.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e,"height",{get:function(){return this.stage.stageHeight},enumerable:!0,configurable:!0}),e.CHANGE_RESIZE="change_resize",e}();__reflect(StageProxy.prototype,"StageProxy");var Table=function(){function e(e){this.mySeatNo=-1,this.seats=[],this.seatsNum=e,this.buildSeats(this.seatsNum)}return e.prototype.buildSeats=function(e){for(var t=0;e+1>t;t++)this.seats.push(null)},e.init=function(t){t.table=new e(t.capacity)},e.prototype.getSeatsNum=function(){return this.seatsNum},e.prototype.addUser=function(e,t,n){var o=new Seat(t);n&&(this.mySeatNo=e),this.seats.splice(e,1,o)},e.prototype.removeUser=function(e){this.seats.splice(e,1,null)},e.prototype.removeUserById=function(e){var t=this.getSeatNoByUserId(e);t>0&&this.removeUser(t)},e.prototype.getUserBySeatNo=function(e){var t=this.seats[e];return null==t?null:t.user},e.prototype.getAllUsers=function(){for(var e=[],t=1;t<this.seats.length;t++){var n=this.seats[t];null!=n&&null!=n.user&&e.push(n.user)}return e},e.prototype.getSeatNoByUserId=function(e){for(var t=1;t<this.seats.length;t++){var n=this.seats[t];if(null!=n&&e==n.user.id)return t}return-1},e.prototype.getUserByUserId=function(e){for(var t=1;t<this.seats.length;t++){var n=this.seats[t];if(null!=n&&n.user.id==e)return n.user}return null},e.prototype.getMe=function(){return this.mySeatNo&&null!=this.seats[this.mySeatNo]?this.seats[this.mySeatNo].user:null},e.prototype.peekPreviousSeatNo=function(e){if(1==this.seatsNum)return-1;var t=e-1>=1?e-1:this.seats.length-1;return t},e.prototype.peekSeatNoRecursively=function(e,t){var n=-1;return n=t>0?this.peekNextSeatNoRecursively(e,t):0==t?e:this.peekPreviousSeatNoRecursively(e,Math.abs(t))},e.prototype.peekPreviousSeatNoRecursively=function(e,t){for(var n=e,o=0;t>o;o++)n=this.peekPreviousSeatNo(n);return n},e.prototype.getPreviousUser=function(){var e=this.peekPreviousSeatNo(this.mySeatNo);return-1==e?null:this.seats[e].user},e.prototype.getMySeatNo=function(){return this.mySeatNo},e.prototype.peekNextSeatNo=function(e){if(1==this.seatsNum)return-1;var t=e+1>=this.seats.length?1:e+1;return t},e.prototype.peekNextSeatNoRecursively=function(e,t){for(var n=e,o=0;t>o;o++)n=this.peekNextSeatNo(n);return n},e.prototype.getNextUser=function(){var e=this.peekNextSeatNo(this.mySeatNo);return-1==e?null:this.seats[e].user},e.prototype.getExtraAttribute=function(){return this.extraAttribute},e.prototype.setExtraAttribute=function(e){this.extraAttribute=e},e}();__reflect(Table.prototype,"Table");var Timer=function(){function e(){this._delta=0,this.scale=1,this.currTimer=this._now(),this.currFrame=0,this._lastTimer=this._now(),this._mid=1,this._methodMap=new Dictionary,this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._init()}return Object.defineProperty(e.prototype,"delta",{get:function(){return this._delta},enumerable:!0,configurable:!0}),e.prototype._init=function(){this._timer&&this._timer.frameLoop(1,this,this.update)},e.prototype._now=function(){return Date.now()},e.prototype.update=function(){if(this.scale<=0)return void(this._lastTimer=this._now());var e=this.currFrame=this.currFrame+this.scale,t=this._now();this._delta=(t-this._lastTimer)*this.scale;var n=this.currTimer=this.currTimer+this._delta;this._lastTimer=t;var o=this._handlers;for(this._count=0,r=0,a=o.length;a>r;r++)if(l=o[r],null!==l.method){var i=l.userFrame?e:n;if(i>=l.exeTime)if(l.repeat)if(l.jumpFrame)for(;i>=l.exeTime;)l.exeTime+=l.delay,l.run(!1);else l.exeTime+=l.delay,l.run(!1),i>l.exeTime&&(l.exeTime+=Math.ceil((i-l.exeTime)/l.delay)*l.delay);else l.run(!0)}else this._count++;(this._count>30||e%200===0)&&this._clearHandlers();for(var s=this._laters,r=0,a=s.length-1;a>=r;r++){var l=s[r];null!==l.method&&(this._methodMap.Remove(String(l.method)),l.run(!1)),this._recoverHandler(l),r===a&&(a=s.length-1)}s.length=0},e.prototype._clearHandlers=function(){for(var e=this._handlers,t=0,n=e.length;n>t;t++){var o=e[t];null!==o.method?this._temp.push(o):this._recoverHandler(o)}this._handlers=this._temp,this._temp=e,this._temp.length=0},e.prototype._recoverHandler=function(t){this._methodMap.Item(String(t.method))==t&&this._methodMap.Remove(String(t.method)),t.clear(),e._pool.push(t)},e.prototype._create=function(t,n,o,i,s,r,a){if(!o)return s.apply(i,[r]),null;if(a){var l=this._getHandler(i,s);if(l)return l.repeat=n,l.userFrame=t,l.delay=o,l.caller=i,l.method=s,l.args=r,l.exeTime=o+(t?this.currFrame:this.currTimer+this._now()-this._lastTimer),l}return l=e._pool.length>0?e._pool.pop():new TimerHandler,l.repeat=n,l.userFrame=t,l.delay=o,l.caller=i,l.method=s,l.args=r,l.exeTime=o+(t?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(l),this._handlers.push(l),l},e.prototype._indexHandler=function(e){this._methodMap.Add(String(e.method),e)},e.prototype.once=function(e,t,n,o,i){void 0===o&&(o=null),void 0===i&&(i=!0),this._create(!1,!1,e,t,n,o,i)},e.prototype.loop=function(e,t,n,o,i,s){void 0===o&&(o=null),void 0===i&&(i=!0),void 0===s&&(s=!1);var r=this._create(!1,!0,e,t,n,o,i);r&&(r.jumpFrame=s)},e.prototype.frameOnce=function(e,t,n,o,i){void 0===o&&(o=null),void 0===i&&(i=!0),this._create(!0,!1,e,t,n,o,i)},e.prototype.frameLoop=function(e,t,n,o,i){void 0===o&&(o=null),void 0===i&&(i=!0),this._create(!0,!0,e,t,n,o,i)},e.prototype.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+e._pool.length},e.prototype.clear=function(e,t){var n=this._getHandler(e,t);n&&(this._methodMap.Remove(String(n.method)),n.clear())},e.prototype.clearAll=function(e){if(e)for(var t=0,n=this._handlers.length;n>t;t++){var o=this._handlers[t];o.caller===e&&(this._methodMap.Remove(String(o.method)),o.clear())}},e.prototype._getHandler=function(e,t){for(var n=0,o=this._handlers.length;o>n;n++){var i=this._handlers[n];if(i.caller===e&&i.method==t)return i}return null},e.prototype.callLater=function(t,n,o){if(void 0===o&&(o=null),null==this._getHandler(t,n)){if(e._pool.length)var i=e._pool.pop();else i=new TimerHandler;i.caller=t,i.method=n,i.args=o,this._indexHandler(i),this._laters.push(i)}},e.prototype.runCallLater=function(e,t){var n=this._getHandler(e,t);n&&null!=n.method&&(this._methodMap.Remove(String(n.method)),n.run(!0))},e.prototype.runTimer=function(e,t){this.runCallLater(e,t)},e._pool=[],e}();__reflect(Timer.prototype,"Timer");var TimerHandler=function(){function e(){}return e.prototype.clear=function(){this.caller=null,this.method=null,this.args=null},e.prototype.run=function(e){var t=this.caller;if(t&&t.destroyed)return this.clear();var n=this.method,o=this.args;e&&this.clear(),null!=n&&(o?n.apply(t,o):n.call(t))},e}();__reflect(TimerHandler.prototype,"TimerHandler");var User=function(){function e(){this.id="",this.name="",this.nickName="",this.password="",this.sex="",this.avatar="",this.level=UserLevel.BASIC.toString(),this.cardNum=0,this.coins=0,this.score=0,this.room="",this.beReady=!1,this.beHosted=!1,this.seatNo=-1,this.sessionId=""}return e.prototype.getId=function(){return this.id},e.init=function(e){null!=e&&e.forEach(function(e){e.id==UserService.getInstance().getUser().id?(UserService.getInstance().getUser().beReady=!1,UserService.getInstance().getUser().seatNo=e.seatNo,RoomService.getInstance().getRoom().table.addUser(e.seatNo,UserService.getInstance().getUser(),!0)):RoomService.getInstance().getRoom().table.addUser(e.seatNo,e,!1)})},e}();__reflect(User.prototype,"User");var UserLevel;!function(e){e[e.BASIC=0]="BASIC",e[e.VIP1=1]="VIP1",e[e.VIP2=2]="VIP2",e[e.VIP3=3]="VIP3",e[e.VIP4=4]="VIP4",e[e.VIP5=5]="VIP5"}(UserLevel||(UserLevel={}));var UserRsl=function(){function e(){}return e}();__reflect(UserRsl.prototype,"UserRsl");var UserService=function(){function e(){}return e.getInstance=function(){return null==this.userSvc&&(this.userSvc=new e),this.userSvc},e.prototype.setUser=function(e){this.user=e},e.prototype.getUser=function(){return this.user},e.prototype.getUserExtraAttribute=function(){return this.user.attributes},e.prototype.setUserExtraAttribute=function(e){this.user.attributes=e},e}();__reflect(UserService.prototype,"UserService");var EventReq=function(){function e(e,t){this.id=EvetnId.UUID(),this.type=e,this.args=t}return e.prototype.getId=function(){return this.id},e.encode=function(e){return GlobalConstants.ENABLE_COMM_ENCRYPTION?Base64.b64EncodeUnicode(JSON.stringify(e)):JSON.stringify(e)},e}();__reflect(EventReq.prototype,"EventReq");var EventRes=function(){function e(e,t,n,o){this.id=e,this.type=t,this.status=n,this.args=o}return e.prototype.getId=function(){return this.id},e.prototype.getType=function(){return this.type},e.prototype.getStatus=function(){return this.status},e.prototype.getArgs=function(){return this.args},e.prototype.getContent=function(){return this.args.content},e.decode=function(t){if(t)try{var n=null;n=GlobalConstants.ENABLE_COMM_ENCRYPTION?Base64.b64DecodeUnicode(t):t;var o=JSON.parse(n);return new e(o.id,o.type,o.status,o.args)}catch(i){console.log(i),TipsScene.getInstance().showError(i)}},e}();__reflect(EventRes.prototype,"EventRes");var EventType=function(){function e(){}return e.ANY=1e3,e.CONNECT=1010,e.CONNECT_FAILED=1011,e.CONNECT_SUCCESS=1012,e.DISCONNECT=1013,e.RECONNECT=1014,e.RECONNEC_FAILEDT=1015,e.RECONNECT_SUCCESS=1016,e.LOG_IN=1020,e.LOG_IN_SUCCESS=1021,e.LOG_IN_FAILURE=1022,e.LOG_OUT=1023,e.LOG_OUT_SUCCESS=1024,e.SESSION_IDLE=1025,e.SESSION_TIMEOUT=1026,e.USER_DATA=1027,e.USER_MGMT=1028,e.GAME_LIST=1030,e.ROOM_LIST=1040,e.ROOM_CONFS=1041,e.ROOM_CREATE=1050,e.ROOM_CREATE_SUCCESS=1051,e.ROOM_CREATE_FAILED=1052,e.ROOM_JOIN=1060,e.ROOM_JOIN_OTHERS=1061,e.ROOM_JOIN_SUCCESS=1062,e.ROOM_JOIN_FAILED=1063,e.ROOM_REJOIN=1064,e.TABLE_IS_FULL=1065,e.BE_READY=1070,e.BE_READY_TIME_TASK=1072,e.USERS_ARE_READY=1073,e.ROOM_LEAVE=1090,e.ROOM_LEAVE_OTHERS=1091,e.ROOM_CLOSE=1100,e.ENABLE_HOST=1101,e.DISABLE_HOST=1102,e.COINMODE_ROOM_JOIN=1105,e.COINMODE_ROOM_JOIN_FAILED=1106,e.CONTEST_ROOM_JOIN=1108,e.CONTEST_ROOM_JOIN_FAILED=1109,e.AGENT_MGMT=1201,e.CLUB_MGMT=1301,e.CLUB_ENTER=1311,e.CLUB_LEAVE=1312,e.SHOP_MGMT=1401,e.EMAIL_MGMT=1501,e.FEEDBACK_MGMT=1601,e.SYSTEM_MGMT=1701,e.GAME_DDZ=2e3,e.GAME_DDZ_TIMED_TASK=2001,e.GAME_TEXAS=2010,e.GAME_TEXAS_TIMED_TASK=2011,e.GAME_ZJH=2020,e.GAME_ZJH_TIMED_TASK=2021,e.GAME_QZNN=2030,e.GAME_QZNN_TIMED_TASK=2031,e.USER_MESSAGE=9970,e.ROOM_MESSAGE=9980,e.SYSTEM_MESSAGE=9990,e.EXCEPTION=9999,e.HEARTBEAT=1e4,e}();__reflect(EventType.prototype,"EventType");var Network=function(){function e(){this.handler={},this.cbConnect=[],this.cbClose=[],this.cbError=[],this.socket=new egret.WebSocket,e.resMap=new Dictionary,this.timeoutInSec=10,this.socket.type=egret.WebSocket.TYPE_STRING,this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketData,this),this.socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)}return e.getInstance=function(){return null==this.net&&(this.net=new e),this.net},e.prototype.setConnectHandler=function(e,t){this.cbConnect=[t,e]},e.prototype.setCloseHandler=function(e,t){this.cbClose=[t,e]},e.prototype.setErrorHandler=function(e,t){this.cbError=[t,e]},e.prototype.connect=function(e){this.socket.connected||(this.socket.connectByUrl(e),this.serverUrl=e)},e.prototype.reconnect=function(){this.connect(this.serverUrl)},e.prototype.bind=function(e,t,n){this.handler[e]=[n,t]},e.prototype.send=function(e){console.log("send -->",EventReq.encode(e)),this.socket.writeUTF(EventReq.encode(e))},e.prototype.isResReceived=function(t){var n=e.resMap.ContainsKey(String(t));return n},e.prototype.request=function(t,n,o){var i=this;console.log("send -->",EventReq.encode(t)),this.socket.writeUTF(EventReq.encode(t)),GlobalUtils.waitfor(function(){return i.isResReceived(t.getId())},!0,GlobalConstants.WAIT_FOR_INTRVAL_INMS,egret.getTimer(),1e3*this.timeoutInSec,function(){var i=e.resMap.Item(String(t.getId()));i.getStatus()?n(i):o(i),e.resMap.Remove(String(t.getId()))},function(){var e="请求："+t.getId()+"超时.",n={content:e},i=new EventRes(t.getId(),null,!1,n);o(i)})},e.prototype.isConnected=function(){return this.socket.connected},e.prototype.onSocketOpen=function(){if(console.log("websocket connected"),this.cbConnect.length>0){var e=this.cbConnect[0],t=this.cbConnect[1];t.call(e)}},e.prototype.onSocketClose=function(){if(console.log("websocket closed"),this.cbClose.length>0){var e=this.cbClose[0],t=this.cbClose[1];t.call(e)}},e.prototype.onSocketError=function(){if(console.log("websocket error"),this.cbError.length>0){var e=this.cbError[0],t=this.cbError[1];t.call(e)}},e.prototype.onSocketData=function(t){var n=this.socket.readUTF();console.log("recv -->",n);var o=EventRes.decode(n);return 0!=o.getId()?void e.resMap.Add(String(o.getId()),o):void this.dispatch(o)},e.prototype.dispatch=function(e){if(0!=e.getType()){var t=String(e.getType()),n=this.handler[t];if(n){var o=n[0],i=n[1];i.call(o,e.getArgs())}else console.log("not found handler --> "+t)}},e}();__reflect(Network.prototype,"Network");var SocketMsg=function(){function e(e){void 0===e&&(e=""),this.buff_msg=new egret.ByteArray,this.buff_msg.endian=egret.Endian.LITTLE_ENDIAN,this.reset(e)}return e.prototype.reset=function(e){this.name=e,this.buff_msg.clear(),this.buff_msg.writeInt(0),this.buff_msg.writeByte(0),this.wstring(this.name)},e.prototype.fill=function(e,t,n){this.buff_msg.clear(),this.buff_msg.writeBytes(e,t,n),this.buff_msg.position=5,this.name=this.rstring()},e.prototype.wstring=function(e){this.wint32(e.length),this.buff_msg.writeUTFBytes(e)},e.prototype.wint32=function(e){this.buff_msg.writeInt(e)},e.prototype.wuint32=function(e){this.buff_msg.writeUnsignedInt(e)},e.prototype.wdouble=function(e){this.buff_msg.writeDouble(e)},e.prototype.wprotobuf=function(e,t){var n=e.encode(t).finish(),o=new egret.ByteArray(n);this.wint32(o.length),this.buff_msg.writeBytes(o,0,o.length)},e.prototype.wjson=function(e){this.wstring(JSON.stringify(e))},e.prototype.rint32=function(){return this.buff_msg.readInt()},e.prototype.ruint32=function(){return this.buff_msg.readUnsignedInt()},e.prototype.rdouble=function(){return this.buff_msg.readDouble()},e.prototype.rstring=function(){var e=this.rint32();return this.buff_msg.readUTFBytes(e)},e.prototype.rjson=function(){var e=this.rint32(),t=this.buff_msg.readUTFBytes(e);return JSON.parse(t)},e.prototype.rprotobuf=function(e){var t=this.rint32(),n=new egret.ByteArray;return this.buff_msg.readBytes(n,0,t),e.decode(n.bytes)},e}();__reflect(SocketMsg.prototype,"SocketMsg");var BetCoin=function(e){function t(t){var n=e.call(this)||this;return n.betNum=t,n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(t,e),t.prototype.onAddToStage=function(){this.drawCoin(),this.drawBetNum()},t.prototype.drawCoin=function(){this.betNum>=1e4?this.betBitmap=GlobalUtils.createBitmapByName("coin_s_4_png"):this.betNum>=1e3?this.betBitmap=GlobalUtils.createBitmapByName("coin_s_3_png"):this.betNum>=100?this.betBitmap=GlobalUtils.createBitmapByName("coin_s_2_png"):this.betBitmap=GlobalUtils.createBitmapByName("coin_s_1_png"),this.betBitmap.width=70,this.betBitmap.height=70,this.addChild(this.betBitmap)},t.prototype.drawBetNum=function(){this.text=new egret.TextField,this.text.size=20,this.text.textColor=16777215,this.text.text=this.formatBetNum(),this.text.textAlign=egret.HorizontalAlign.CENTER,this.text.verticalAlign=egret.VerticalAlign.MIDDLE,this.text.x=(this.betBitmap.width-this.text.width)/2,this.text.y=(this.betBitmap.height-this.text.height)/2,this.betNum>=1e4?this.text.strokeColor=9717541:this.betNum>=1e3?this.text.strokeColor=9384236:this.betNum>=100?this.text.strokeColor=1467512:this.text.strokeColor=2059080,this.text.stroke=2,this.addChild(this.text)},t.prototype.formatBetNum=function(){var e;return e=GlobalUtils.shortNumber(this.betNum)},t.prototype.fly=function(e,t,n){this.startContainer=e,this.endContainer=t,this.cbFunc=n,this.x=(e.width-this.width)/2,this.y=0,e.addChild(this);var o=Math.floor(t.width/4),i=Math.floor(t.height/2),s=t.x+t.width/2+GlobalUtils.getRandomInt(-o,o),r=t.y+GlobalUtils.getRandomInt(0,i),a=e.globalToLocal(s,r);SoundManager.getInstance().playEffect("put_coins_wav"),this.tw=egret.Tween.get(this),this.tw.to({x:a.x,y:a.y},500,egret.Ease.sineInOut).call(function(){this.startContainer&&this.startContainer.contains(this)&&this.startContainer.removeChild(this),egret.Tween.removeTweens(this.tw),this.tween=null;var e=t.globalToLocal(s,r);this.x=e.x,this.y=e.y,t.addChild(this),null!=this.cbFunc&&this.cbFunc()
},this)},t}(egret.DisplayObjectContainer);__reflect(BetCoin.prototype,"BetCoin");var CbButton=function(e){function t(t,n){var o=e.call(this)||this;return o.sp=new egret.Sprite,o.addChild(o.sp),o.unChkedBG=GlobalUtils.createBitmapByName(t+"_0_png"),o.chkedBG=GlobalUtils.createBitmapByName(t+"_1_png"),o.checked=!1,o.unChkedBG.visible=!0,o.chkedBG.visible=!1,null==o.title&&(o.title=new egret.TextField),o.title.text=n,o.addEventListener(egret.Event.ADDED_TO_STAGE,function(){},o),o}return __extends(t,e),t.prototype.childrenCreated=function(){var e=this;this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){e.isClicked||(e.scaleX=.95,e.scaleY=.95,e.isClicked=!0,SoundManager.getInstance().playEffect("btn_click_mp3"))},this),this.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.isClicked=!1,e.scaleX=1,e.scaleY=1,e.checked?(e.checked=!1,e.unChkedBG.visible=!0,e.chkedBG.visible=!1,e.unChkedCall&&e.unChkedCall()):(e.checked=!0,e.unChkedBG.visible=!1,e.chkedBG.visible=!0,e.chkedCall&&e.chkedCall())},this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){e.isClicked=!1,e.scaleX=1,e.scaleY=1},this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,function(){e.isClicked=!1,e.scaleX=1,e.scaleY=1},this)},t.prototype.setSize=function(e,t,n){this.unChkedBG.width=this.chkedBG.width=e-10,this.unChkedBG.height=this.chkedBG.height=t,this.sp.addChild(this.unChkedBG),this.sp.addChild(this.chkedBG),this.title.size=n,this.title.bold=!0,this.title.textColor=16777215,this.title.stroke=2,this.title.strokeColor=0,this.title.fontFamily="微软雅黑",this.title.x=this.unChkedBG.width-this.title.width>>1,this.title.y=this.unChkedBG.height-this.title.height>>1,this.sp.addChild(this.title)},t.prototype.setTitle=function(e){this.title.text=e,this.title.x=this.unChkedBG.width-this.title.width>>1,this.title.y=this.unChkedBG.height-this.title.height>>1},t.prototype.setChkedCall=function(e){this.touchEnabled=!0,this.chkedCall=null,this.chkedCall=e},t.prototype.setUnChkedCall=function(e){this.touchEnabled=!0,this.unChkedCall=null,this.unChkedCall=e},t}(egret.Sprite);__reflect(CbButton.prototype,"CbButton");var ChipsFly=function(e){function t(t,n,o){var i=e.call(this)||this;return i.num=8,i.num=t,i.chips=new Array,i.startContainer=n,i.endContainer=o,i.generateChips(),i.timer=new egret.Timer(100),i.timer.repeatCount=t,i.timer.addEventListener(egret.TimerEvent.TIMER,i.timerFunc,i),i.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,i.timerComplete,i),i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.onComplete=function(e){this.call=e},t.prototype.fly=function(){this.timer.stop(),this.timer.start()},t.prototype.generateChips=function(){for(var e=0;e<this.num;e++){var t=GlobalUtils.createBitmapByName("coin_gold_s_png");t.x=GlobalUtils.getRandomInt(this.startContainer.width/2-10,this.startContainer.width/2+10),t.y=GlobalUtils.getRandomInt(this.startContainer.height/2-10,this.startContainer.height/2+10),this.startContainer.addChild(t),this.chips.push(t)}},t.prototype.timerFunc=function(){this.num-=1;var e=this.chips[this.num];SoundManager.getInstance().playEffect("coins_fly_in_wav");var t=this.startContainer.globalToLocal(this.endContainer.x,this.endContainer.y);t.x=t.x+.5*this.endContainer.width,this.tw=egret.Tween.get(e).to({x:t.x,y:t.y},200).call(function(){egret.Tween.removeTweens(this.tw),null!=e&&this.startContainer.contains(e)&&this.startContainer.removeChild(e)},this)},t.prototype.timerComplete=function(){console.log("筹码飞行结束"),this.parent&&this.parent.removeChild(this),null!=this.call&&this.call()},t}(eui.Component);__reflect(ChipsFly.prototype,"ChipsFly");var ChipsNum=function(e){function t(t){var n=e.call(this)||this;return n.skinName="ChipsNumSkin",n.labChipNums.text=String(t),n}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.setLabChipNums=function(e){this.labChipNums.text=String(e)},t.prototype.onComplete=function(e){this.cbFunc=e},t.prototype.getLabChipNums=function(){return this.labChipNums.text},t.prototype.fly=function(e,t){this.x=(e.width-this.width)/2,this.y=0,e.addChild(this);var n=e.globalToLocal(t.x,t.y);SoundManager.getInstance().playEffect("put_coins_wav"),egret.Tween.get(this).to({x:n.x,y:n.y},1e3,egret.Ease.backInOut).call(function(){e&&e.contains(this)&&e.removeChild(this),egret.Tween.removeTweens(this),this.x=this.y=0,t.addChild(this),this.cbFunc&&this.cbFunc()},this)},t}(eui.Component);__reflect(ChipsNum.prototype,"ChipsNum",["eui.UIComponent","egret.DisplayObject"]);var CountDownTimer=function(e){function t(t){var n=e.call(this)||this;return n.timer=new egret.Timer(1e3),n.contentPrefix=t,n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(t,e),t.prototype.onAddToStage=function(){this.drawBg(),this.drawContent(),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComplete,this),this.timeStart(this.seconds)},t.prototype.onComplete=function(e){this.call=e},t.prototype.timeStart=function(e){this.seconds=e,this.timer.stop(),this.timer.repeatCount=e+1,this.timer.start()},t.prototype.drawBg=function(){this.bg=GlobalUtils.createBitmapByName("toast_bg_png"),this.bg.x=0,this.bg.y=0,this.bg.width=this.parent.width,this.bg.height=this.parent.height,this.bg.visible=!1,this.addChild(this.bg)},t.prototype.timerFunc=function(){this.seconds=this.seconds<0?0:this.seconds,0==this.bg.visible&&(this.bg.visible=!0),this.content.text=this.contentPrefix+": "+String(this.seconds)+"s",this.seconds-=1,this.seconds>0&&SoundManager.getInstance().playEffect("time_countdown_mp3")},t.prototype.drawContent=function(){this.content=new egret.TextField,this.addChild(this.content),this.content.textColor=16777215,this.content.stroke=2,this.content.strokeColor=5001051,this.content.bold=!0,this.content.size=28,this.content.width=this.parent.width,this.content.height=this.parent.height,this.content.textAlign=egret.HorizontalAlign.CENTER,this.content.verticalAlign=egret.VerticalAlign.MIDDLE,this.content.text="",this.content.fontFamily="微软雅黑"},t.prototype.stop=function(){this.content=null,null!=this.timer&&this.timer.stop(),this.timer=null,null!=this.parent&&this.parent.removeChild(this)},t.prototype.timerComplete=function(){null!=this.parent&&this.parent.removeChild(this),null!=this.call&&this.call()},t}(egret.DisplayObjectContainer);__reflect(CountDownTimer.prototype,"CountDownTimer");var CTimer=function(){function e(e,t,n){this.tgtBitmap=e,this.anticlockwise=t,this.dic=n,this.initContainer(e)}return e.prototype.initContainer=function(e){this.container=new egret.DisplayObjectContainer;var t=e.width,n=e.height;this.radius=Math.max(t,n)/2*1.5,this.container.addChild(e),this.shape=new egret.Shape,this.shape.x=e.width/2,this.shape.y=e.height/2,e.mask=this.shape,this.container.addChild(this.shape),this.angle=0},e.prototype.getContainer=function(){return this.container},e.prototype.addCall=function(e){this.call=e},e.prototype.setTime=function(e){this.timeInSecs=e,this.repeatInOneSec=12,this.num=e*this.repeatInOneSec,this.timer=new egret.Timer(Math.round(1e3/this.repeatInOneSec)),this.timer.repeatCount=e*this.repeatInOneSec,this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComplete,this)},e.prototype.timerStart=function(e){this.setTime(e),this.tgtBitmap.visible=!0,this.timer.stop(),this.timer.start()},e.prototype.timerStop=function(){this.tgtBitmap.visible=!1,this.shape.graphics.clear(),null!=this.timer&&this.timer.stop(),this.timer=null,this.num=0,this.angle=0},e.prototype.timerFunc=function(){return this.num-=1,this.angle+=Math.round(360/(this.timeInSecs*this.repeatInOneSec)*10)/10*this.dic,this.changeGraphics(this.angle),this.angle=this.angle%360,this.num<=5*this.repeatInOneSec&&this.num%this.repeatInOneSec==0&&SoundManager.getInstance().playEffect("time_countdown_mp3"),this.shape},e.prototype.changeGraphics=function(e){this.shape.graphics.clear(),this.shape.graphics.beginFill(5633542,1),this.shape.graphics.lineTo(this.radius,0),this.shape.graphics.drawArc(0,0,this.radius,0,e*Math.PI/180,this.anticlockwise),this.shape.graphics.lineTo(0,0),this.shape.graphics.endFill()},e.prototype.timerComplete=function(){this.tgtBitmap.visible=!1,this.shape.graphics.clear(),this.timer=null,null!=this.call&&this.call()},e}();__reflect(CTimer.prototype,"CTimer");var CToggleSwitch=function(e){function t(){var t=e.call(this)||this;return t.skinName="CToggleSwitchSkin",t.addEventListener(eui.UIEvent.CHANGE,t.changeHandler,t),t}return __extends(t,e),t.prototype.setSelected=function(e){this.selected=e},t.prototype.changeHandler=function(e){null!=this.onChanged&&this.onChanged()},t.prototype.setClick=function(e){this.onChanged=null,this.onChanged=e},t}(eui.ToggleSwitch);__reflect(CToggleSwitch.prototype,"CToggleSwitch");var Dialog=function(e){function t(){var t=e.call(this)||this;return t.skinName="DialogSkin",t.addEventListener(egret.Event.ADDED_TO_STAGE,function(){t.width=t.stage.stageWidth,t.height=t.stage.stageHeight},t),t}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.imgBG.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.close()},this),this.btnCancel.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.close()},this),this.btnOk.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.close()},this)},t.prototype.show=function(e){void 0!=e&&(this.lbMsg.text=e,SceneManager.getInstance().pushScene(this))},t.prototype.close=function(){SceneManager.getInstance().popScene(this)},t}(eui.Component);__reflect(Dialog.prototype,"Dialog",["eui.UIComponent","egret.DisplayObject"]);var DropDownList=function(e){function t(){var t=e.call(this)||this;return t.listItems=[],t.bOpen=!1,t.openSpeed=100,t}return __extends(t,e),t.prototype.childrenCreated=function(){this.listMask.y=this.menuBtn.y+this.menuBtn.height,this.list.mask=this.listMask,this.list.y=this.menuBtn.y+this.menuBtn.height,this.menuBgMask.y=this.menuBtn.y+this.menuBtn.height,this.menuBg.y=this.menuBg.y+this.menuBtn.height,this.menuBg.mask=this.menuBgMask,this.menuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuBtnTouch,this),this.list.addEventListener(egret.TouchEvent.CHANGE,this.onChange,this)},t.prototype.setListSkin=function(e){this.list.itemRendererSkinName=e,this.list.y=this.menuBtn.y+this.menuBtn.height},t.prototype.setBtnLable=function(e){this.menuBtn.label=e},t.prototype.addItem=function(e){this.listItems.push({itemValue:e}),this.list.dataProvider=new eui.ArrayCollection(this.listItems),this.listMask.height=this.list.height,this.menuBgMask.height=this.list.height,this.menuBg.height=this.list.height,0==this.bOpen&&(this.list.y=this.menuBtn.y+this.menuBtn.height-this.list.height,this.menuBg.y=this.menuBtn.y+this.menuBtn.height-this.list.height)},t.prototype.removeItem=function(e){for(var t=this.listItems.length,n=t-1;n>=0;n--){var o=this.listItems[n];if(o.itemValue==e){this.listItems.splice(n,1);break}}this.list.dataProvider=new eui.ArrayCollection(this.listItems),this.listMask.height=this.list.height,this.menuBgMask.height=this.list.height,this.menuBg.height=this.list.height},t.prototype.open=function(){egret.Tween.removeTweens(this.list),this.bOpen=!0,egret.Tween.get(this.list).to({y:this.menuBtn.y+this.menuBtn.height},this.openSpeed),egret.Tween.get(this.menuBg).to({y:this.menuBtn.y+this.menuBtn.height},this.openSpeed),this.list.selectedIndex=-1},t.prototype.close=function(e){void 0===e&&(e=!0),egret.Tween.removeTweens(this.list),this.bOpen=!1,e?(egret.Tween.get(this.list).to({y:this.menuBtn.y+this.menuBtn.height-this.list.height},this.openSpeed),egret.Tween.get(this.menuBg).to({y:this.menuBtn.y+this.menuBtn.height-this.list.height},this.openSpeed)):(this.list.y=this.menuBtn.y+this.menuBtn.height-this.list.height,this.menuBg.y=this.menuBtn.y+this.menuBtn.height-this.list.height)},t.prototype.onMenuBtnTouch=function(e){this.bOpen?this.close():this.open()},t.prototype.onChange=function(e){this.close(!1),this.dispatchEventWith(egret.TouchEvent.CHANGE,!1,{selectedIndex:this.list.selectedIndex,itemValue:this.list.selectedItem.itemValue})},t}(eui.Component);__reflect(DropDownList.prototype,"DropDownList");var EButton=function(e){function t(){var t=e.call(this)||this;return t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.addEventListener(egret.Event.ADDED_TO_STAGE,function(){},t),t}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.getImgBtn(),this.getLabTitle(),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.isClicked||(t.scaleX=.95,t.scaleY=.95,t.isClicked=!0,SoundManager.getInstance().playEffect("btn_click_mp3"))},this),this.addEventListener(egret.TouchEvent.TOUCH_END,function(){t.isClicked=!1,t.scaleX=1,t.scaleY=1,null!=t.call&&t.call()},this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.isClicked=!1,t.scaleX=1,t.scaleY=1},this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,function(){t.isClicked=!1,t.scaleX=1,t.scaleY=1},this)},t.prototype.getImgBtn=function(){this.numChildren>=1&&(this.imgBtn=this.getChildAt(0),null!=this.imgBtn&&(this.imgBtn.x=.5*this.width,this.imgBtn.y=.5*this.height,this.imgBtn.anchorOffsetX=.5*this.width,this.imgBtn.anchorOffsetY=.5*this.height))},t.prototype.getLabTitle=function(){this.numChildren>=2&&(this.labTitle=this.getChildAt(1))},t.prototype.setLabTitle=function(e){this.labTitle.text=e,this.labTitle.x=this.width/2-this.labTitle.width/2,this.labTitle.y=this.height/2-this.labTitle.height/2},t.prototype.setClick=function(e){this.touchEnabled=!0,this.call=e},t}(eui.Button);__reflect(EButton.prototype,"EButton",["eui.UIComponent","egret.DisplayObject"]);var Effects=function(){function e(){}return e.wordsImgAnimation=function(t,n,o,i,s){var r=GlobalUtils.createBitmapByName(n);r.anchorOffsetX=.5*r.width,r.anchorOffsetY=.5*r.height,r.alpha=1,r.x=.5*t.width,o==e.V_ALIGNMENT_TOP?r.y=.5*r.height:o==e.V_ALIGNMENT_BOTTOM?r.y=t.height-r.height/2:r.y=.5*t.height,0==t.visible&&(t.visible=!0),t.addChild(r);var a=egret.Tween.get(r);a.to({scaleX:2,scaleY:2},100,egret.Ease.quintOut).to({scaleX:.9,scaleY:.9},100,egret.Ease.sineIn).to({scaleX:1.2,scaleY:1.2},100,egret.Ease.sineIn).to({scaleX:1,scaleY:1},100,egret.Ease.sineIn).wait(1500).call(function(){s&&t&&t.contains(r)&&t.removeChild(r),egret.Tween.removeTweens(a),null!=i&&i()})},e.playMovieClip=function(e,t,n,o,i){if(null!=e){var s=RES.getRes(t+"_json"),r=RES.getRes(t+"_png");if(null!=s&&null!=r){var a=new egret.MovieClipDataFactory(s,r),l=new egret.MovieClip(a.generateMovieClipData(t));null!=l&&(l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,l.x=e.width/2,l.y=e.height/2-35,e.addChild(l),l.visible=!1,l.addEventListener(egret.Event.COMPLETE,function(t){i&&e&&e.contains(l)&&e.removeChild(l)},this),e.visible=!0,l.visible=!0,null!=n&&SoundManager.getInstance().playEffect(n),l.gotoAndPlay(t,o))}}},e.H_ALIGNMENT_LEFT="LEFT",e.H_ALIGNMENT_RIGHT="RIGHT",e.H_ALIGNMENT_CENTER="CENTER",e.V_ALIGNMENT_TOP="TOP",e.V_ALIGNMENT_MIDDLE="MIDDLE",e.V_ALIGNMENT_BOTTOM="BOTTOM",e}();__reflect(Effects.prototype,"Effects");var EIcon=function(e){function t(t,n,o){var i=e.call(this)||this;return i.skinName="EIconSkin",i.width=n,i.height=o,i.addEventListener(egret.Event.ADDED_TO_STAGE,function(){i.ImgBtn.source=t},i),i}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.isClicked||(t.scaleX=.95,t.scaleY=.95,t.isClicked=!0,SoundManager.getInstance().playEffect("btn_click_mp3"))},this),this.addEventListener(egret.TouchEvent.TOUCH_END,function(){t.isClicked=!1,t.scaleX=1,t.scaleY=1,null!=t.call&&t.call()},this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.isClicked=!1,t.scaleX=1,t.scaleY=1},this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,function(){t.isClicked=!1,t.scaleX=1,t.scaleY=1},this)},t.prototype.setLbBottomScoreVal=function(e){this.lbBottomScoreVal.text=String(e)},t.prototype.setLbMinChipsVal=function(e){this.lbMinChipsVal.text=String(e)},t.prototype.setClick=function(e){this.touchEnabled=!0,this.call=e},t}(eui.Button);__reflect(EIcon.prototype,"EIcon",["eui.UIComponent","egret.DisplayObject"]);var ETimer=function(e){function t(t){var n=e.call(this)||this;return n.num=t,n.skinName="ETimerSkin",n.anchorOffsetX=.5*n.width,n.anchorOffsetY=.5*n.height,n}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.onComplete=function(e){this.call=e},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.startTimer=function(){this.visible=!0,null!=this.timer&&void 0!=this.timer&&this.timer.stop(),this.timer=new egret.Timer(1e3),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComplete,this),this.timer.repeatCount=this.num,this.timer.start()},t.prototype.stopTimer=function(){null!=this.timer&&void 0!=this.timer&&(this.num=0,this.timer.stop(),this.timer=null),this.visible=!1},t.prototype.timerFunc=function(){this.num-=1,this.lbTime.text=this.num.toString(),this.num<=5&&(SoundManager.getInstance().playEffect("time_countdown_mp3"),this.tween=egret.Tween.get(this,{loop:!0}).to({scaleX:1.05,scaleY:1.05},500).wait(200)),this.num<=0&&egret.Tween.pauseTweens(this)},t.prototype.timerComplete=function(){null!=this.timer&&void 0!=this.timer&&(this.timer.stop(),this.timer=null),null!=this.call&&this.call()},t}(eui.Component);__reflect(ETimer.prototype,"ETimer",["eui.UIComponent","egret.DisplayObject"]);var EToast=function(e){function t(t){var n=e.call(this)||this;return n.skinName="EToastSkin",n.delayInSecons=t,n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(n.stage,n)},n),n}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.imgBG.width=StageProxy.width,this.imgBG.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.close()},this),this.timer=new egret.Timer(1e3*this.delayInSecons,2),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.close,this),this.timer.start()},t.prototype.setColor=function(e){this.labMsg.textColor=e},t.prototype.show=function(e,t){void 0!=e&&(this.labMsg.text=e,SceneManager.getInstance().pushScene(this),t&&SoundManager.getInstance().playEffect("ops_error_mp3"))},t.prototype.close=function(){SceneManager.getInstance().popScene(this)},t}(eui.Component);__reflect(EToast.prototype,"EToast",["eui.UIComponent","egret.DisplayObject"]);var LoadingScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="LoadingSkin",t}return __extends(t,e),t.getInstance=function(){return null==this.loadingScene&&(this.loadingScene=new t),this.loadingScene},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this);var t=egret.Tween.get(this.img_load,{loop:!0});t.to({rotation:360},2e3)},t}(eui.Component);__reflect(LoadingScene.prototype,"LoadingScene",["eui.UIComponent","egret.DisplayObject"]);var Particles=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.show_num=0,t.show_detail=[],t.start_show_num=50,t.timer_action=null,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.start=function(){this.stop();for(var e=0;e<this.start_show_num;e++)this.show(0,this.show_num),this.show_num+=1;this.timer_action=new egret.Timer(300),this.timer_action.addEventListener(egret.TimerEvent.TIMER,this.onAction,this),this.timer_action.start()},t.prototype.stop=function(){this.timer_action&&(this.timer_action.stop(),this.timer_action.removeEventListener(egret.TimerEvent.TIMER,this.onAction,this),this.timer_action=null);for(var e=0;e<this.show_num;e++)this.show_detail[e]&&this.show_detail[e].stop();this.show_num=0,this.show_detail=[]},t.prototype.onAction=function(e){this.show(1,this.show_num),this.show_num+=1},t.prototype.show=function(e,t){var n=this,o=new ParticleAnimation;o.x=640*Math.random(),0==e?o.y=Math.random()*(this.height-50):o.y=0,this.show_detail[t]=o,this.addChild(this.show_detail[t]),this.show_detail[t].start(this.height,function(){n.removeChild(n.show_detail[t]),n.show_detail[t]=null})},t}(eui.Component);__reflect(Particles.prototype,"Particles");var ParticleAnimation=function(e){function t(){var t=e.call(this)||this;return t._tween_x=null,t._tween_y=null,t._tween_rotation=null,t.skinName="ParticleAnimationSkin",t}return __extends(t,e),t.prototype.start=function(e,t){var n,o,i,s,r,a,l,c=this;this.callback=t,this.speed_y=Math.random()+1,this.speed_x=1.5-3*Math.random(),this.speed_rotation=2*Math.random(),this.speed_x<0?(n=0,s=this.x):(n=StageProxy.width,s=StageProxy.width-this.x),r=e-this.y,a=Math.random()<.5?360:-360,this.currentState=Math.floor(3*Math.random()).toString(),o=(Math.abs(this.speed_x)+5)*s*30,i=Math.abs(this.speed_y)*r*30,l=360*(this.speed_rotation+2)*30,this._tween_rotation=egret.Tween.get(this,{loop:!0}).to({rotation:a},l),this._tween_x=egret.Tween.get(this).to({x:n},o).call(function(){c.stop()}),this._tween_y=egret.Tween.get(this).to({y:e},i).call(function(){c.stop()})},t.prototype.stop=function(){this._tween_x&&(this._tween_x.setPaused(!0),this._tween_x=null),this._tween_y&&(this._tween_y.setPaused(!0),this._tween_y=null),this._tween_rotation&&(this._tween_rotation.setPaused(!0),this._tween_rotation=null),this.callback()},t}(eui.Component);__reflect(ParticleAnimation.prototype,"ParticleAnimation");var PopTips=function(e){function t(){var t=e.call(this)||this;return t.popTipsBg="pop_tips_png",t.bg=GlobalUtils.createBitmapByName(t.popTipsBg),t.addChild(t.bg),t}return __extends(t,e),t.prototype.launch=function(e,t){var n=this;this.cont=e;var o=120,i=50,s=new egret.TextField;s.multiline=!0,s.size=24,s.bold=!0,s.textColor=16777215,s.stroke=2,s.strokeColor=0,s.text=t,s.fontFamily="微软雅黑",s.textAlign=egret.HorizontalAlign.CENTER,s.width=.84*o,s.x=(this.bg.width-s.width)/2,s.y=15,this.addChild(s),this.anchorOffsetX=.5*this.width,this.anchorOffsetY=.5*this.height,this.x=.5*o,this.y=.618*i,this.alpha=1,this.cont.addChild(this),this.tw=egret.Tween.get(this),this.tw.wait(2500).to({y:10,alpha:0},3e3,egret.Ease.backInOut).call(function(){n.parent&&n.parent.contains(n)&&n.parent.removeChild(n),egret.Tween.removeTweens(n.tw)})},t}(egret.DisplayObjectContainer);__reflect(PopTips.prototype,"PopTips");var ScrollingMessages=function(){function e(e){this.paoMaDengMsg=[],this.paoMaDengMsg1=[],this.paomadengMask=new eui.Rect,this.paoMaDengTimer=new egret.Timer(500,0),this.paoMaDengRun=new egret.Timer(20,0),this.paoMaDengIsRunning=!1,this.paoMaDengLable=new eui.Label,this.paoMaDengBg=new eui.Image,this.paoMaDengTimer1=new egret.Timer(500,0),this.paoMaDengRun1=new egret.Timer(20,0),this.paoMaDengIsRunning1=!1,this.paoMaDengLable1=new eui.Label,this.paoMaDengBg1=new eui.Image,this.group=e,this.paoMaDengLable1.x=0,this.paoMaDengLable1.y=0,this.paoMaDengLable1.size=25,this.paomadengMask.width=e.width,this.paomadengMask.height=25,this.paomadengMask.x=.5*(e.width-this.paomadengMask.width),this.paomadengMask.y=0,this.paoMaDengLable.x=this.paomadengMask.width+this.paomadengMask.x,this.paoMaDengLable.y=this.paomadengMask.y,this.paoMaDengLable.size=25,this.group.addChild(this.paoMaDengBg1),this.group.addChild(this.paoMaDengBg),this.group.addChild(this.paoMaDengLable1),this.group.addChild(this.paomadengMask),this.group.addChild(this.paoMaDengLable),this.paoMaDengLable.mask=this.paomadengMask,this.paoMaDengBg.visible=!1,this.paoMaDengBg.source=RES.getRes("scroll_lamp_bg_png"),this.paoMaDengBg.width=this.paomadengMask.width,this.paoMaDengBg.height=this.paomadengMask.height+10,this.paoMaDengBg.x=this.paomadengMask.x,this.paoMaDengBg.y=this.paomadengMask.y-5,this.paoMaDengBg1.visible=!1,this.paoMaDengBg1.source=RES.getRes("scroll_lamp_bg_png"),this.paoMaDengBg1.width=this.group.width,this.paoMaDengBg1.height=this.paomadengMask.height+10,this.paoMaDengBg1.x=0,this.paoMaDengBg1.y=this.paoMaDengLable1.y-5,this.paoMaDengTimerListen(),this.paoMaDengTimerListen1()}return e.prototype.onComplete=function(e){this.call=e},e.prototype.timerComplete=function(){null!=this.call&&this.call()},e.prototype.pushpaoMaDengMsg=function(e){if(0==e.type)for(var t=0;t<e.loopNum;t++)this.paoMaDengMsg.push(e.msg);else for(var t=0;t<e.loopNum;t++)this.paoMaDengMsg1.push(e.msg)},e.prototype.start=function(){this.paoMaDengTimer.start()},e.prototype.paoMaDengTimerListen=function(){this.paoMaDengTimer.addEventListener(egret.TimerEvent.TIMER,this.updatePaoMaDeng,this),this.paoMaDengTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComplete,this),this.paoMaDengRun.addEventListener(egret.TimerEvent.TIMER,this.paoMaDengMove,this)},e.prototype.updatePaoMaDeng=function(){0==this.paoMaDengMsg.length&&(this.paoMaDengTimer.stop(),this.timerComplete()),!this.paoMaDengIsRunning&&this.paoMaDengMsg.length>0&&(this.paoMaDengIsRunning=!0,this.paoMaDengLable.text=this.paoMaDengMsg.shift(),this.paoMaDengBg.visible=!0,this.paoMaDengStart())},e.prototype.paoMaDengStart=function(){this.paoMaDengRun.start()},e.prototype.paoMaDengMove=function(){this.paoMaDengLable.x-=2,this.paoMaDengLable.textWidth+this.paoMaDengLable.x<this.paomadengMask.x&&(this.paoMaDengIsRunning=!1,this.paoMaDengLable.x=this.paomadengMask.width+this.paomadengMask.x,this.paoMaDengLable.text="",this.paoMaDengRun.stop(),this.paoMaDengBg.visible=!1)},e.prototype.start1=function(){this.paoMaDengTimer1.start()},e.prototype.paoMaDengTimerListen1=function(){this.paoMaDengTimer1.addEventListener(egret.TimerEvent.TIMER,this.updatePaoMaDeng1,this),this.paoMaDengTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComplete,this),this.paoMaDengRun1.addEventListener(egret.TimerEvent.TIMER,this.paoMaDengMove1,this)},e.prototype.updatePaoMaDeng1=function(){0==this.paoMaDengMsg1.length&&(this.paoMaDengTimer1.stop(),this.timerComplete()),!this.paoMaDengIsRunning1&&this.paoMaDengMsg1.length>0&&(this.paoMaDengIsRunning1=!0,this.paoMaDengLable1.text=this.paoMaDengMsg1.shift(),this.paoMaDengLable1.x=this.group.width,this.paoMaDengBg1.visible=!0,this.paoMaDengStart1())},e.prototype.paoMaDengStart1=function(){this.paoMaDengRun1.start()},e.prototype.paoMaDengMove1=function(){this.paoMaDengLable1.x-=2,this.paoMaDengLable1.textWidth+this.paoMaDengLable1.x<0&&(this.paoMaDengIsRunning1=!1,this.paoMaDengLable1.x=this.group.width,this.paoMaDengLable1.text="",this.paoMaDengBg1.visible=!1,this.paoMaDengRun1.stop())},e}();__reflect(ScrollingMessages.prototype,"ScrollingMessages");var ScrollingMessage=function(){function e(e,t){this.msg=e.msg,this.loopNum=e.loopNum,this.removeAllPreviousMsg=e.removeAllPreviousMsg,this.msgType=e.msgType,this.hasUrl=e.hasUrl,this.Url=e.Url,this.type=t}return e}();__reflect(ScrollingMessage.prototype,"ScrollingMessage");var Shuffle=function(e){function t(t,n){var o=e.call(this)||this;return o._clipWidth=306,o._clipHeight=183,o.cont=t,o.cbFunc=n,o.initMovieClip(),o}return __extends(t,e),t.prototype.initMovieClip=function(){var e=this,t=RES.getRes("shuffle_json"),n=RES.getRes("shuffle_png"),o=new egret.MovieClipDataFactory(t,n);this.mc=new egret.MovieClip(o.generateMovieClipData("shuffle")),this.mc.anchorOffsetX=this._clipWidth/2,this.mc.anchorOffsetY=this._clipHeight/2,this.mc.x=this.cont.width/2,this.mc.y=this.cont.height/2-35,this.cont.addChild(this.mc),this.mc.visible=!1,this.mc.addEventListener(egret.Event.COMPLETE,function(t){null!=e.cbFunc&&e.cbFunc(),e.mc.visible=!1},this)},t.prototype.launch=function(){this.cont.visible=!0,this.mc.visible=!0,SoundManager.getInstance().playEffect("shuffle_cards_mp3"),this.mc.gotoAndPlay("shuffle",1)},t}(eui.Component);__reflect(Shuffle.prototype,"Shuffle");var TButton=function(e){function t(t,n){var o=e.call(this)||this;return o.sp=new egret.Sprite,o.addChild(o.sp),o.bg=GlobalUtils.createBitmapByName(t),null==o.title&&(o.title=new egret.TextField),o.title.text=n,o.addEventListener(egret.Event.ADDED_TO_STAGE,function(){},o),o.initialize(),o}return __extends(t,e),t.prototype.initialize=function(){var e=this;this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){e.isClicked||(e.scaleX=.95,e.scaleY=.95,e.isClicked=!0,SoundManager.getInstance().playEffect("btn_click_mp3"))},this),this.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.isClicked=!1,e.scaleX=1,e.scaleY=1,null!=e.call&&e.call()},this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){e.isClicked=!1,e.scaleX=1,e.scaleY=1},this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,function(){e.isClicked=!1,e.scaleX=1,e.scaleY=1},this)},t.prototype.setSize=function(e,t,n){this.bg.width=e,this.bg.height=t,this.sp.addChild(this.bg),this.title.size=n,this.title.bold=!0,this.title.textColor=16777215,this.title.stroke=2,this.title.strokeColor=0,this.title.fontFamily="微软雅黑",this.title.x=this.bg.width-this.title.width>>1,this.title.y=this.bg.height-this.title.height>>1,this.sp.addChild(this.title)},t.prototype.setTitle=function(e){this.title.text=e,this.title.x=this.bg.width-this.title.width>>1,this.title.y=this.bg.height-this.title.height>>1},t.prototype.setClick=function(e){this.touchEnabled=!0,this.call=null,this.call=e},t}(egret.Sprite);__reflect(TButton.prototype,"TButton");var TipsScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="TipsSkin",t.addEventListener(egret.Event.ADDED_TO_STAGE,function(){t.btnOk.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouch,t),t.imgBG.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchCancel,t),t.btnCancel.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchCancel,t),t.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchCancel,t)},t),t}return __extends(t,e),t.getInstance=function(){return null==this.tipsScence&&(this.tipsScence=new t),this.tipsScence},t.prototype.onTouch=function(e){SceneManager.getInstance().popScene(this),this.func&&this.func.call(this.obj)},t.prototype.onTouchCancel=function(e){SceneManager.getInstance().popScene(this),this.cfunc&&this.cfunc.call(this.obj)},t.prototype.show=function(e,n,o,i,s,r){void 0===n&&(n=!0),void 0===o&&(o=null),void 0===i&&(i=null),void 0===s&&(s=!1),void 0===r&&(r=null),n&&(e=t.texts[e]),this.labContent.text=e,this.func=o,this.cfunc=r,this.obj=i,s||(this.btnOk.horizontalCenter=0,this.btnCancel.visible=!1),SceneManager.getInstance().pushScene(this)},t.prototype.showError=function(e){this.imgWinTitle.source="txt_title_error_png";var t=GlobalLocales.get()["common.error"]+e;this.show(t,!1,null,null,!1,null),SoundManager.getInstance().playEffect("ops_error_mp3")},t.prototype.showInfo=function(e){this.imgWinTitle.source="txt_title_tips_png",this.show(e,!1,null,null,!1,null)},t.prototype.confirm=function(e,t){this.imgWinTitle.source="txt_title_tips_png",this.show(e,!1,t,null,!1,null)},t.texts={InvalidToken:"登录验证失败",GoldLess:"钻石少于5个不能进入房间",InRoom:"你已经有房间了，点击进入即可",CreateFailed:"创建房间出现了异常",InvalidRoomId:"房间不存在",RoomNotFound:"房间不存在",Already:"已经准备了",PlayerStateError:"还有玩家没有准备",PlayerLess:"一个人怎么玩?还不赶快邀请你的基友互相伤害!",RaiseFailed:"跟注错误",FollowFailed:"加注错误",LookFailed:"看牌错误",GiveupFailed:"放弃错误",PkFailed:"比牌错误",UserNotExists:"用户不存在"},t}(eui.Component);__reflect(TipsScene.prototype,"TipsScene",["eui.UIComponent","egret.DisplayObject"]);var Toast=function(e){function t(n,o,i){var s=e.call(this)||this;
console.log("Toast:",n);var r=new egret.Bitmap(t._txtrToastBg);s.addChild(r);var a=new egret.TextField;return a.multiline=!0,a.size=20,a.bold=!0,a.textColor=16777215,a.stroke=2,a.strokeColor=0,a.text=n,a.fontFamily="微软雅黑",a.textAlign=egret.HorizontalAlign.CENTER,a.width=.84*o,a.x=(t._txtrToastBg.textureWidth-a.width)/2,a.y=6,s.addChild(a),r.height=12+a.height,s.anchorOffsetX=.5*s.width,s.anchorOffsetY=.5*s.height,s.x=.5*o,s.y=.618*i,s.alpha=0,egret.Tween.get(s).to({alpha:1},800,egret.Ease.quintOut).wait(1600).to({alpha:0},1200,egret.Ease.quintIn).call(function(){s.parent&&s.parent.removeChild(s)}),s}return __extends(t,e),t.init=function(e,t){console.log("Toast.init",t),this._cont=e,this._txtrToastBg=t},t.launch=function(e){if(this._cont){var n=new t(e,this._cont.stage.stageWidth,this._cont.stage.stageHeight);this._cont.addChild(n)}},t}(egret.DisplayObjectContainer);__reflect(Toast.prototype,"Toast");var Ddz;!function(e){var t=function(){function e(){}return e.START_GAME_RES="Start.Game.Res",e.DEAL_POKERS_RES="Deal.Pokers.Res",e.DEAL_POKERS_END_REQ="Deal.Pokers.End.Req",e.CALL_LANDLORD_RES="Call.Landlord.Res",e.CALL_LANDLORD_REQ="Call.Landlord.Req",e.HAS_LANDLORD_RES="Has.Landlord.Res",e.NO_LANDLORD_RES="No.Landlord.Res",e.ADD_SCORE_RES="Add.Score.Res",e.ADD_SCORE_REQ="Add.Score.Req",e.PLAY_POKERS_REQ="Play.Pokers.Req",e.PLAY_POKERS_RES="Play.Pokers.Res",e.SHOW_DOWN_RES="Show.Down.Res",e.RELOAD_DATA_REQ="Reload.Data.Req",e.RELOAD_DATA_RES="Reload.Data.Res",e.SUB_GAME_END_RES="Sub.Game.End.Res",e.GAME_END_RES="Game.End.Res",e}();e.CommandType=t,__reflect(t.prototype,"Ddz.CommandType")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function e(){}return e.BOTTOM_POKERS_NUM=3,e.TOTAL_POKERS_PER_PLAYER=17,e.TOTAL_POKERS_PER_DECK=54,e.USER_NUM_PER_TABLE=3,e.POKERS_IN_HAND_GAP=-45,e.POKERS_GAP=-30,e.BOTTOM_POKERS_GAP=20,e.EVENT_DDZ_RELOAD_DATA="Event.Ddz.Reload.Data",e}();e.Constants=t,__reflect(t.prototype,"Ddz.Constants")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function e(){}return e.playRocketAnimation=function(e){var t=RES.getRes("ddzRocketAnim_json"),n=RES.getRes("ddzRocketAnim_png"),o=new egret.MovieClipDataFactory(t,n),i=new egret.MovieClip(o.generateMovieClipData("ddzRocketAnim"));i.addEventListener(egret.Event.COMPLETE,function(t){e.removeChild(i)},this),e.visible=!0,i.x=0,i.y=0,i.anchorOffsetX=.5*i.width,i.anchorOffsetY=.5*i.height,e.addChild(i),i.gotoAndPlay("rocket",1),SoundManager.getInstance().playEffect("anim_rocket_mp3")},e.playBombAnimation=function(e){var t=RES.getRes("ddzBombAnim_json"),n=RES.getRes("ddzBombAnim_png"),o=new egret.MovieClipDataFactory(t,n),i=new egret.MovieClip(o.generateMovieClipData("ddzBombAnim"));i.addEventListener(egret.Event.COMPLETE,function(t){e.removeChild(i)},this),e.visible=!0,i.x=.5*e.width,i.y=0,i.anchorOffsetX=.5*i.width,i.anchorOffsetY=.5*i.height,e.addChild(i),i.gotoAndPlay("bomb",1),SoundManager.getInstance().playEffect("anim_boom_mp3")},e.playPlaneAnimation=function(e){function t(e,t){e.removeChild(t)}var n=RES.getRes("ddzPlaneAnim_json"),o=RES.getRes("ddzPlaneAnim_png"),i=new egret.MovieClipDataFactory(n,o),s=new egret.MovieClip(i.generateMovieClipData("ddzPlaneAnim"));e.visible=!0,s.x=.5*e.width,s.y=0,s.anchorOffsetX=.5*s.width,s.anchorOffsetY=.5*s.height,e.addChild(s),s.gotoAndPlay("start",-1);var r=egret.Tween.get(s);r.to({x:-356},2e3),r.call(t,this,[e,s]),SoundManager.getInstance().playEffect("anim_plane_mp3")},e.playStraightAnimation=function(e){function t(e,t){e.removeChild(t)}var n=RES.getRes("ddzShunZiAnim_json"),o=RES.getRes("ddzShunZiAnim_png"),i=new egret.MovieClipDataFactory(n,o),s=new egret.MovieClip(i.generateMovieClipData("ddzShunZiAnim"));e.visible=!0,s.x=.5*e.width,s.y=0,s.anchorOffsetX=.5*s.width,s.anchorOffsetY=.5*s.height,e.addChild(s),s.gotoAndPlay("start",-1);var r=egret.Tween.get(s);r.to({x:-260},2e3),r.call(t,this,[e,s]),SoundManager.getInstance().playEffect("anim_straight_mp3")},e}();e.DdzEffects=t,__reflect(t.prototype,"Ddz.DdzEffects")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function e(){this.dic=new Array}return e.getInstance=function(){return null==this.ddz&&(this.ddz=new e),this.ddz},e.prototype.getStr=function(e){return this.dic[e]},e.prototype.getStartXPosOfCenterAlignment=function(e,t,n,o){var i=Math.max(0,Math.round(.5*(e-t*o-(n-o))));return i},e.prototype.getStartXPosOfRightAlignment=function(e,t,n,o){var i=Math.max(0,Math.round(e-t*o-(n-o)-10));return i},e}();e.DdzUtils=t,__reflect(t.prototype,"Ddz.DdzUtils")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function e(){}return e}();e.StartGameRes=t,__reflect(t.prototype,"Ddz.StartGameRes");var n=function(){function e(){}return e}();e.DealPokersRes=n,__reflect(n.prototype,"Ddz.DealPokersRes");var o=function(){function e(){}return e}();e.DealPokersEndReq=o,__reflect(o.prototype,"Ddz.DealPokersEndReq");var i=function(){function e(){}return e}();e.CallLandlordRes=i,__reflect(i.prototype,"Ddz.CallLandlordRes");var s=function(){function e(){}return e}();e.CallLandlordReq=s,__reflect(s.prototype,"Ddz.CallLandlordReq");var r=function(){function e(){}return e}();e.HasLandlordRes=r,__reflect(r.prototype,"Ddz.HasLandlordRes");var a=function(){function e(){}return e}();e.NoLandlordRes=a,__reflect(a.prototype,"Ddz.NoLandlordRes");var l=function(){function e(){}return e}();e.AddScoreRes=l,__reflect(l.prototype,"Ddz.AddScoreRes");var c=function(){function e(){}return e}();e.AddScoreReq=c,__reflect(c.prototype,"Ddz.AddScoreReq");var h=function(){function e(){}return e}();e.PlayPokersReq=h,__reflect(h.prototype,"Ddz.PlayPokersReq");var u=function(){function e(){}return e}();e.PlayPokersRes=u,__reflect(u.prototype,"Ddz.PlayPokersRes");var p=function(){function e(){}return e}();e.ShowDownRes=p,__reflect(p.prototype,"Ddz.ShowDownRes");var g=function(){function e(){}return e}();e.SubGameEndRes=g,__reflect(g.prototype,"Ddz.SubGameEndRes");var d=function(){function e(){}return e}();e.UserData=d,__reflect(d.prototype,"Ddz.UserData");var m=function(){function e(){}return e}();e.GameEndReq=m,__reflect(m.prototype,"Ddz.GameEndReq");var f=function(){function e(){}return e}();e.GameEndRes=f,__reflect(f.prototype,"Ddz.GameEndRes");var S=function(){function e(){}return e}();e.ReloadDataReq=S,__reflect(S.prototype,"Ddz.ReloadDataReq");var y=function(){function e(){}return e}();e.ReloadDataRes=y,__reflect(y.prototype,"Ddz.ReloadDataRes")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function e(){this.subGameIndex=0,this.subGameNums=0,this.bottomScore=0,this.landLordSeatNo=-1,this.landLordScore=0,this.winnerSeatNo=-1,this.userDatas=new Array,this.LastPokersPlayed=new Array,this.pokersToBeVerified=new Array,this.lastSeatPlayed=-1,this.currentSeatNo=-1,this.pokerSpritesInHands=new Array,this.bottomPokers=new Array}return e.get=function(){return RoomService.getInstance().getRoom().table.getExtraAttribute()},e.reset=function(){var t=new e;RoomService.getInstance().getRoom().table.setExtraAttribute(t)},e}();e.ExtraAttribute=t,__reflect(t.prototype,"Ddz.ExtraAttribute")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.ddzLogic&&(this.ddzLogic=new t),this.ddzLogic},t.prototype.getCommand=function(e){return e.cmd},t.prototype.processCmd=function(t){var n=null,o="",i=this.getCommand(t);switch(i){case e.CommandType.START_GAME_RES:console.log("游戏开始."),n=this.startGameRes(t);break;case e.CommandType.DEAL_POKERS_RES:console.log("服务器发牌."),n=this.dealPokersRes(t);break;case e.CommandType.CALL_LANDLORD_RES:console.log("服务器通知叫地主."),n=this.callLandlordRes(t);break;case e.CommandType.HAS_LANDLORD_RES:console.log("服务器通知地主产生."),n=this.hasLandlordRes(t);break;case e.CommandType.NO_LANDLORD_RES:console.log("服务器通知无地主."),n=this.noLandlordRes(t);break;case e.CommandType.ADD_SCORE_RES:console.log("服务器通知加分."),n=this.addScoreRes(t);break;case e.CommandType.PLAY_POKERS_RES:console.log("服务器通知出牌."),n=this.playPokersRes(t);break;case e.CommandType.RELOAD_DATA_RES:console.log("服务器通知数据重载."),n=this.reloadDataRes(t);break;case e.CommandType.SHOW_DOWN_RES:console.log("服务器通知本局结束."),n=this.showDownRes(t);break;case e.CommandType.SUB_GAME_END_RES:console.log("服务器通知本局结束."),n=this.subGameEndRes(t);break;case e.CommandType.GAME_END_RES:console.log("服务通知本房间游戏结束."),n=this.gameEndRes(t);break;default:o="命令:"+i+"不存在.",n=new FuncResult(!1,o)}return n},t.prototype.beReadyRes=function(t){var n=t;e.TableScene.getInstance().beReadyRes(n)},t.prototype.startGameRes=function(t){var n=null,o=t;return e.ExtraAttribute.reset(),e.ExtraAttribute.get().subGameIndex=o.subGameIndex,e.ExtraAttribute.get().subGameNums=o.subGameNums,e.TableScene.getInstance().startGameRes(o),n},t.prototype.dealPokersRes=function(t){var n=null,o=(new Array,t);return e.ExtraAttribute.get().bottomScore=o.bottomScore,null!=o.pokers&&o.pokers.length>0&&this.setPokersInHand(o.pokers),e.TableScene.getInstance().dealPokersRes(),n},t.prototype.setPokersInHand=function(t){var n=e.PokerUtils.parsePokersFromPokerIds(t);n=e.PokerUtils.sortDescPokers(n),n.forEach(function(t){var n=new e.PokerSprite(t,GlobalConstants.POKER_XL_W,!0);null==e.ExtraAttribute.get().pokerSpritesInHands&&(e.ExtraAttribute.get().pokerSpritesInHands=new Array),e.ExtraAttribute.get().pokerSpritesInHands.push(n)})},t.prototype.callLandlordRes=function(t){var n=null,o=t;return console.log("callLandlordRes:"+JSON.stringify(o)),e.ExtraAttribute.get().currentSeatNo=o.currentSeatNo,e.ExtraAttribute.get().landLordScore=o.landLordScore,e.ExtraAttribute.get().callLandlordTimeout=o.callLandlordTimeout,e.TableScene.getInstance().callLandlordRes(o),n},t.prototype.roomJoinOthers=function(t){var n=t;null!=n.user&&RoomService.getInstance().getRoom().table.addUser(n.user.seatNo,n.user,!1),e.TableScene.getInstance().roomJoinOthers(n)},t.prototype.roomLeaveOthers=function(t){var n=t,o=RoomService.getInstance().getRoom();null!=n.userId&&""!=n.userId&&o.id==n.roomId&&e.TableScene.getInstance().roomLeaveOthers(n)},t.prototype.tableIsFull=function(t){e.TableScene.getInstance().tableIsFull()},t.prototype.addScoreRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().currentSeatNo=o.currentSeatNo,e.ExtraAttribute.get().landLordScore=o.landLordScore,e.TableScene.getInstance().addScoreRes(o),n},t.prototype.hasLandlordRes=function(t){var n=null,o=t;e.ExtraAttribute.get().landLordSeatNo=o.landLordSeatNo,e.ExtraAttribute.get().landLordScore=o.landLordScore;var i=new Array;return i=e.PokerUtils.parsePokersFromPokerIds(o.bottomPokers),e.ExtraAttribute.get().bottomPokers=e.PokerUtils.sortDescPokers(i),e.TableScene.getInstance().hasLandlordRes(o),n},t.prototype.noLandlordRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().currentSeatNo=-1,e.ExtraAttribute.get().pokerSpritesInHands.splice(0,e.ExtraAttribute.get().pokerSpritesInHands.length),e.TableScene.getInstance().noLandlordRes(o),n},t.prototype.playPokersRes=function(t){var n=null,o=t;e.ExtraAttribute.get().currentSeatNo=o.currentSeatNo,e.ExtraAttribute.get().lastSeatPlayed=o.lastSeatPlayed,e.ExtraAttribute.get().landLordScore=o.landLordScore;var i=e.PokerUtils.parsePokersFromPokerIds(o.lastPokersPlayed);return e.ExtraAttribute.get().LastPokersPlayed=[],e.ExtraAttribute.get().pokersToBeVerified=[],i.forEach(function(t){var n=new e.PokerSprite(t,GlobalConstants.POKER_S_W,!1);e.ExtraAttribute.get().LastPokersPlayed.push(n)}),e.TableScene.getInstance().playPokersRes(o),n},t.prototype.showDownRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().userDatas=o.userDatas,e.TableScene.getInstance().showDownRes(),n},t.prototype.reloadDataRes=function(t){var n=null,o=t;e.ExtraAttribute.get().subGameIndex=o.subGameIndex,e.ExtraAttribute.get().subGameNums=o.subGameNums,e.ExtraAttribute.get().startGameTimeout=o.startGameTimeout,e.ExtraAttribute.get().bottomScore=o.bottomScore,e.ExtraAttribute.get().currentSeatNo=o.currentSeatNo,e.ExtraAttribute.get().callLandlordTimeout=o.callLandlordTimeout,e.ExtraAttribute.get().noLandlordTimeout=o.noLandlordTimeout,e.ExtraAttribute.get().landLordSeatNo=o.landLordSeatNo,e.ExtraAttribute.get().landLordScore=o.landLordScore,e.ExtraAttribute.get().addScoreTimeout=o.addScoreTimeout,e.ExtraAttribute.get().playPokersTimeout=o.playPokersTimeout;var i=this.getMyData(o.userDatas);return null!=i&&null!=i.pokers&&i.pokers.length>0&&this.setPokersInHand(i.pokers),e.ExtraAttribute.get().userDatas=o.userDatas,e.TableScene.getInstance().reloadDataRes(o),n},t.prototype.getMyData=function(e){var t=RoomService.getInstance().getRoom().table.getMySeatNo(),n=ArrayUtils.findItemByKey(e,"seatNo",t);return n},t.prototype.roomJoin=function(t){var n=null,o=RoomService.getInstance().getRoom(),i=e.TableScene.getInstance();i.initTheTable(),i.setRoom(o.id),i.setUsersReady();var s=!0;return null!=o.category&&o.category==RoomCategory.COINMODE&&(s=!1),i.initGrpReadyAndInvite(s),SceneManager.getInstance().pushScene(i),n},t.prototype.roomRejoin=function(t){var n=null;EventManager.getInstance().addEvent(e.Constants.EVENT_DDZ_RELOAD_DATA,e.TableScene.getInstance().reloadDataReq.bind(this),null);var o=e.TableScene.getInstance();return o.initTheTable(),o.setRoom(RoomService.getInstance().getRoom().id),o.setUsersReady(),SceneManager.getInstance().pushScene(o),n},t.prototype.beReady=function(t){var n=t;e.TableScene.getInstance().beReadyRes(n)},t.prototype.subGameEndRes=function(e){var t=null;return t},t.prototype.gameEndRes=function(t){var n=null,o=t;return e.TableScene.getInstance().gameEndRes(o),n},t.prototype.getRoomType=function(){return RoomType.DDZ},t}();e.GameLogic=t,__reflect(t.prototype,"Ddz.GameLogic")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function e(){}return e.get=function(){return e.CN},e.CN={"start.game.countdown":"游戏即将开始","no.landlord.countdown":"荒局,即将重新发牌","subgame.continue.countdown":"本局游戏结束,继续",roundnums:"局数:","call.landlord.error":"抢地主时出现错误,请重试.","add.score.error":"底分加倍时出现错误，请重试","prompt.pokers.error":"系统没能发现可用的牌.","play.Pokers.error":"牌型或出牌错误,请重试.","Go.Back.Confirmation":"这将退出当前游戏,您确认吗?"},e}();e.Locales=t,__reflect(t.prototype,"Ddz.Locales")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.MockTest&&(this.MockTest=new t),this.MockTest},t.prototype.joinRoomResp=function(){var e='{"id":1,"type":1060,"status":true,"args":{"room":{"id":"827314","game":null,"name":null,"tier":"STD","bottomScore":0,"type":"TEXAS","status":"CREATED","owner":"1","capacity":3,"rounds":0},"users":[{"id":"1","name":"wesley","nickName":null,"sex":null,"avatar":null,"level":0,"cardNum":9,"score":2500,"room":"827314","seatNo":1},{"id":"2","name":"tom1001","nickName":null,"sex":null,"avatar":null,"level":0,"cardNum":10,"score":2500,"room":"827314","seatNo":2},{"id":"305921","name":"boby1001","nickName":null,"sex":null,"avatar":null,"level":0,"cardNum":10,"score":5000,"room":"827314","seatNo":3}]}}',t=EventRes.decode(e);Hall.HallScene.getInstance().onJoinRoomSuccess(t)},t.prototype.startGameRes=function(){var t='{"id":0,"type":2000,"status":true,"args":{"cmd":"Start.Game.Res","subGameIndex":1,"subGameNums":15,"startGameTimeout":5}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.dealPokersRes=function(){var t='{"id":0,"type":2000,"status":true,"args":{"cmd":"Deal.Pokers.Res","pokers":[10,7,14,40,35,9,20,50,42,36,54,1,44,8,45,25,38]}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.callLandlordRes=function(){var t='{"id":0,"type":2000,"status":true,"args":{"cmd":"Call.Landlord.Res","currentSeatNo":1, "landLordScore":3, "lastCallLandlordScore":3,"lastCallLandlordSeatNo":3,"callLandlordTimeout":20}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.noLandlordRes=function(){var t='{"id":0,"type":2000,"status":true,"args":{"cmd":"No.Landlord.Res"}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.addScoreRes=function(){var t='{"id":0,"type":2000,"status":true,"args":{"cmd":"Add.Score.Res","currentSeatNo":3,"lastAddScoreSeatNo":-1,"lastAddScore":1,"addScoreTimeout":20}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.hasLandlordRes=function(){var t='{"id":0,"type":2000,"status":true,"args":{"cmd":"Has.Landlord.Res","landLordSeatNo":3,"landLordScore":3,"bottomPokers":[22,28,41]}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.bottomScoreRes=function(){var t='{"id":0,"type":2000,"status":true,"args":{"cmd":"Bottom.Score.Res","landLordScore":3,"lastAddScoreSeatNo":2,"lastAddScore":1}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.playPokersRes=function(){var t='{"id":0,"type":2000,"status":true,"args":{"cmd":"Play.Pokers.Res","currentSeatNo":3,"lastPokersPlayed":[],"lastSeatPlayed":3,"lastSeatPokersNum":20,"landLordScore":3,"playPokersTimeout":20}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.showDownRes=function(){var t='{"id":0,"type":2000,"status":true,"args":{"cmd":"Show.Down.Res","userDatas":[{"userId":"2","seatNo":1,"landlord":false,"win":false,"score":4988,"awarded":-12,"pokers":[8,5,43,28,27,10,32,54,11,46,9,47,44,12,42,45,24],"pokersNum":17},{"userId":"1","seatNo":2,"landlord":false,"win":false,"score":4988,"awarded":-12,"pokers":[2,18,31,29,6,33,7,48,36,3,38,22,25,16,39,37,14],"pokersNum":17},{"userId":"305921","seatNo":3,"landlord":true,"win":true,"score":5024,"awarded":24,"pokers":[],"pokersNum":0}]}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t}();e.MockTest=t,__reflect(t.prototype,"Ddz.MockTest")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function e(e,t){this.id=e,this.orderValue=t}return e.prototype.getId=function(){return this.id},e.prototype.getOrderValue=function(){return this.orderValue},e.prototype.toString=function(){return"["+this.id+","+this.orderValue+"]"},e}();e.Poker=t,__reflect(t.prototype,"Ddz.Poker")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function t(){}return t.comparePokers=function(t,n){var o=e.PokerUtils.sortDescPokers(t),i=e.PokerUtils.sortDescPokers(n);if(o.length<1||i.length<1)return!1;if(-1!=e.PokerTypeUtils.isKingBoom(i))return!1;if(-1!=e.PokerTypeUtils.isKingBoom(o))return!0;if(-1!=e.PokerTypeUtils.isBoom(i))return-1!=e.PokerTypeUtils.isBoom(o)?this.compareOne(o[0],i[0]):!1;if(-1!=e.PokerTypeUtils.isBoom(o))return!0;if(t.length!=n.length)return!1;var s=e.PokerTypeUtils.getType(o),r=e.PokerTypeUtils.getType(i);return null==s||null==r||s.getType()!=r.getType()?!1:s.getSort()>r.getSort()},t.compareOne=function(e,t){return e.getOrderValue()>t.getOrderValue()?!0:!1},t}();e.PokerCompareUtils=t,__reflect(t.prototype,"Ddz.PokerCompareUtils")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function t(){}return t.seekBiggerHand=function(t,n){var o=e.PokerUtils.sortDescPokers(t),i=e.PokerUtils.sortDescPokers(n),s=null,r=e.PokerTypeUtils.getType(n);return null==r?s=this.seekBiggerSingle(o,0):r.getType()===e.PokerTypeUtils.KingBoom?s=null:r.getType()===e.PokerTypeUtils.Single?s=this.seekBiggerSingle(o,r.getSort()):r.getType()===e.PokerTypeUtils.Pair?s=this.seekBiggerPair(o,r.getSort()):r.getType()===e.PokerTypeUtils.Three?s=this.seekBiggerThree(o,r.getSort()):r.getType()===e.PokerTypeUtils.ThreeSingle?s=this.seekBiggerThreeSingle(o,r.getSort()):r.getType()===e.PokerTypeUtils.ThreePair?s=this.seekBiggerThreePair(o,r.getSort()):r.getType()===e.PokerTypeUtils.Straight?s=this.seekBiggerStraight(o,r.getSort(),i.length):r.getType()===e.PokerTypeUtils.StraightPairs?s=this.seekBiggerStraightPairs(o,r.getSort(),i.length):r.getType()===e.PokerTypeUtils.Plane?s=this.seekBiggerPlane(o,r.getSort(),i.length):r.getType()===e.PokerTypeUtils.Plane2Single?s=this.seekBiggerPlane2Single(o,r.getSort(),i.length):r.getType()===e.PokerTypeUtils.Plane2Pairs?s=this.seekBiggerPlane2Pairs(o,r.getSort(),i.length):r.getType()===e.PokerTypeUtils.Four2Single?s=this.seekBiggerFour2Single(o,r.getSort()):r.getType()===e.PokerTypeUtils.Four2Pairs&&(s=this.seekBiggerFour2Pairs(o,r.getSort())),(null==s||0==s.length)&&(s=r.getType()===e.PokerTypeUtils.Boom?this.seekBiggerBoom(o,r.getSort()):this.seekBoom(o)),(null==s||0==s.length)&&(s=this.seekKingBoom(o)),null!=s&&s.length>0?s:[]},t.asValueStaticPoker=function(e){var t=new Dictionary;return e.forEach(function(e){var n=new Array;t.ContainsKey(String(e.getOrderValue()))&&(n=t.Item(String(e.getOrderValue()))),n.push(e),t.Add(String(e.getOrderValue()),n)}),t},t.seekBoom=function(e){for(var t=e.length-1;t>=3;t--)if(e[t].getOrderValue()===e[t-1].getOrderValue()&&e[t].getOrderValue()===e[t-2].getOrderValue()&&e[t].getOrderValue()===e[t-3].getOrderValue())return[e[t],e[t-1],e[t-2],e[t-3]];return[]},t.seekBiggerBoom=function(e,t){for(var n=e.length-1;n>=3;n--)if(e[n].getOrderValue()===e[n-1].getOrderValue()&&e[n].getOrderValue()===e[n-2].getOrderValue()&&e[n].getOrderValue()===e[n-3].getOrderValue()&&e[n].getOrderValue()>t)return[e[n],e[n-1],e[n-2],e[n-3]];return[]},t.seekKingBoom=function(t){for(var n=[],o=t.length-1;o>=1;o--)(t[o].getOrderValue()===e.PokerUtils.BigKingValue||t[o].getOrderValue()===e.PokerUtils.SmallKingValue)&&n.push(t[o]);return 2===n.length?n:[]},t.seekBiggerSingle=function(e,t){for(var n=e.length-1;n>=0;n--)if(e[n].getOrderValue()>t)return[e[n]];return[]},t.seekBiggerPair=function(e,t){for(var n=e.length-1;n>=1;n--)if(e[n].getOrderValue()===e[n-1].getOrderValue()&&e[n].getOrderValue()>t)return[e[n],e[n-1]];return[]},t.seekBiggerThree=function(e,t){for(var n=e.length-1;n>=2;n--)if(e[n].getOrderValue()===e[n-1].getOrderValue()&&e[n].getOrderValue()===e[n-2].getOrderValue()&&e[n].getOrderValue()>t)return[e[n],e[n-1],e[n-2]];return[]},t.seekBiggerThreeSingle=function(e,t){for(var n=0,o=new Array,i=e.length-1;i>=2;i--)if(e[i].getOrderValue()===e[i-1].getOrderValue()&&e[i].getOrderValue()===e[i-2].getOrderValue()&&e[i].getOrderValue()>t){n=i,o.push(e[i],e[i-1],e[i-2]);break}return 0===n?[]:(n===e.length-1?o.push(e[n-3]):o.push(e[e.length-1]),o)},t.seekBiggerThreePair=function(e,t){for(var n=0,o=new Array,i=e.length-1;i>=2;i--)if(e[i].getOrderValue()===e[i-1].getOrderValue()&&e[i].getOrderValue()===e[i-2].getOrderValue()&&e[i].getOrderValue()>t){n=i,o.push(e[i],e[i-1],e[i-2]);break}if(0!=n)for(var s=0,i=e.length-1;i>=2;i--)if(e[i].getOrderValue()===e[i-1].getOrderValue()){if(i==n||i==n-1||i==n-2)continue;s=i,o.push(e[i],e[i-1]);break}return null!=o&&5===o.length?o:[]},t.seekBiggerStraight=function(t,n,o){if(n==e.PokerUtils.AValue)return[];var i=this.asValueStaticPoker(t),s=[],r=[];if(i.Keys().forEach(function(t){4!=i.Item(t).length&&Number(t)<=e.PokerUtils.AValue&&s.push(Number(t))}),s.length<o)return[];var a=GlobalUtils.findNumbersSequence(s,o);if(0==a.length)return[];for(var l=[],c=0;c<a.length;c++){var h=a[c];if(h[h.length-1]>n){l=h;break}}return 0==l.length?[]:(l.forEach(function(e){var t=i.Item(String(e));r=r.concat(t.slice(0,1))}),r)},t.seekBiggerStraightPairs=function(t,n,o){if(n==e.PokerUtils.TwoValue)return[];var i=this.asValueStaticPoker(t),s=[],r=[];i.Keys().forEach(function(t){i.Item(t).length>=2&&4!=i.Item(t).length&&Number(t)<=e.PokerUtils.AValue&&s.push(Number(t))});var a=o/2;if(s.length<a)return[];var l=GlobalUtils.findNumbersSequence(s,a);if(0==l.length)return[];for(var c=[],h=0;h<l.length;h++){var u=l[h];if(u[u.length-1]>n){c=u;break}}return 0==c.length?[]:(c.forEach(function(e){var t=i.Item(String(e));r=r.concat(t.slice(0,2))}),r)},t.seekBiggerPlane=function(t,n,o){if(n==e.PokerUtils.AValue)return[];var i=this.asValueStaticPoker(t),s=[],r=[];i.Keys().forEach(function(t){3==i.Item(t).length&&Number(t)<=e.PokerUtils.AValue&&s.push(Number(t))});var a=o/3;if(s.length<a)return[];var l=GlobalUtils.findNumbersSequence(s,a);if(0==l.length)return[];for(var c=[],h=0;h<l.length;h++){var u=l[h];if(u[u.length-1]>n){c=u;break}}return 0==c.length?[]:(c.forEach(function(e){var t=i.Item(String(e));r=r.concat(t.slice(0,3))}),r)},t.seekBiggerPlane2Single=function(t,n,o){if(n==e.PokerUtils.AValue)return[];var i=o/4,s=this.seekBiggerPlane(t,n,3*i);if(0==s.length)return[];for(var r=e.PokerUtils.removePokers(t,s),a=0,l=r.length-1;l>=0;l--)if(s.push(r[l]),a++,a==i)return s;return[]},t.seekBiggerPlane2Pairs=function(t,n,o){if(n==e.PokerUtils.AValue)return[];var i=o/5,s=this.seekBiggerPlane(t,n,3*i);if(0==s.length)return[];for(var r=e.PokerUtils.removePokers(t,s),a=0,l=[],c=r.length-1;c>=1;c--)if(r[c].getOrderValue()==r[c-1].getOrderValue()){if(l.indexOf(r[c].getId())>-1||l.indexOf(r[c-1].getId())>-1)continue;if(l=l.concat(r[c].getId(),r[c-1].getId()),s=s.concat(r[c],r[c-1]),a++,a==i)return s}return[]},t.seekBiggerFour2Single=function(t,n){if(n==e.PokerUtils.TwoValue)return[];var o=this.seekBiggerBoom(t,n);if(0==o.length)return[];for(var i=e.PokerUtils.removePokers(t,o),s=0,r=i.length-1;r>=0;r--)if(o.push(i[r]),s++,2==s)return o;return[]},t.seekBiggerFour2Pairs=function(t,n){if(n==e.PokerUtils.TwoValue)return[];var o=this.seekBiggerBoom(t,n);if(0==o.length)return[];for(var i=e.PokerUtils.removePokers(t,o),s=0,r=[],a=i.length-1;a>=0;a--)if(i[a].getOrderValue()==i[a-1].getOrderValue()){if(r.indexOf(i[a].getId())>-1||r.indexOf(i[a-1].getId())>-1)continue;if(r=r.concat(i[a].getId(),i[a-1].getId()),o=o.concat(i[a],i[a-1]),s++,2==s)return o}return[]},t.randomPickOne=function(e){return[e[e.length-1]]},t.autoPlay=function(e,t,n,o,i){return console.log("轮到我出牌了，座位号：",t,"上家出牌，座位号：",i,"地主座位号：",n),null==e||0==e.length?(console.log("没牌了"),[]):null==o||0==o.length?this.randomPickOne(e):t===n?i===t?this.randomPickOne(e):this.seekBiggerHand(e,o):i===t?this.randomPickOne(e):i!=n?[]:this.seekBiggerHand(e,o)},t}();e.PokerSeekUtils=t,__reflect(t.prototype,"Ddz.PokerSeekUtils")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(e){function t(t,n,o){var i=e.call(this)||this;i.poker=t,i.width=n,i.height=n*GlobalConstants.POKER_WvsH_RATIO,i.selected=!1,i.baseX=i.x,i.baseY=i.y;var s=i.getImageID(),r=new egret.Bitmap(RES.getRes(s));return r.width=i.width,r.height=i.height,i.addChild(r),o&&(i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){i.selected=!i.selected,i.selected?(i.y=i.baseY-15,SoundManager.getInstance().playEffect("choose_card_mp3")):i.y=i.baseY},i)),i}return __extends(t,e),t.prototype.getPoker=function(){return this.poker},t.prototype.setSelected=function(e){this.dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP))},t.prototype.getSelected=function(){return this.selected},t.prototype.getImageID=function(){var e="poker_"+this.poker.getId()+"_png";return e},t}(egret.Sprite);e.PokerSprite=t,__reflect(t.prototype,"Ddz.PokerSprite")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function e(e,t){this.type=e,this.sort=t}return e.prototype.getType=function(){return this.type},e.prototype.getSort=function(){return this.sort},e}();e.PokerType=t,__reflect(t.prototype,"Ddz.PokerType")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function t(){}return t.getType=function(t){t=e.PokerUtils.sortDescPokers(t);var n=-1;return-1!=(n=this.isBoom(t))?new e.PokerType(this.Boom,n):-1!=(n=this.isKingBoom(t))?new e.PokerType(this.KingBoom,n):-1!=(n=this.isSingle(t))?new e.PokerType(this.Single,n):-1!=(n=this.isPair(t))?new e.PokerType(this.Pair,n):-1!=(n=this.isThree(t))?new e.PokerType(this.Three,n):-1!=(n=this.isThreeSingle(t))?new e.PokerType(this.ThreeSingle,n):-1!=(n=this.isThreePairs(t))?new e.PokerType(this.ThreePair,n):-1!=(n=this.isStraight(t))?new e.PokerType(this.Straight,n):-1!=(n=this.isStraightPairs(t))?new e.PokerType(this.StraightPairs,n):-1!=(n=this.isPlane(t))?new e.PokerType(this.Plane,n):-1!=(n=this.isPlane2Single(t))?new e.PokerType(this.Plane2Single,n):-1!=(n=this.isPlane2pairs(t))?new e.PokerType(this.Plane2Pairs,n):-1!=(n=this.isFour2Single(t))?new e.PokerType(this.Four2Single,n):-1!=(n=this.isFour2Pairs(t))?new e.PokerType(this.Four2Pairs,n):null},t.isBoom=function(e){return 4==e.length&&e[1].getOrderValue()==e[0].getOrderValue()&&e[2].getOrderValue()==e[0].getOrderValue()&&e[3].getOrderValue()==e[0].getOrderValue()?e[0].getOrderValue():-1},t.isKingBoom=function(t){return 2==t.length&&t[0].getOrderValue()===e.PokerUtils.BigKingValue&&t[1].getOrderValue()===e.PokerUtils.SmallKingValue?0:-1},t.isSingle=function(e){return 1==e.length?e[0].getOrderValue():-1},t.isPair=function(e){return 2==e.length&&e[0].getOrderValue()==e[1].getOrderValue()?e[0].getOrderValue():-1},t.isStraight=function(t){if(t.length<5||t.length>12)return-1;if(t[0].getOrderValue()>e.PokerUtils.AValue)return-1;for(var n=0;n<t.length-1;n++)if(t[n].getOrderValue()!=t[n+1].getOrderValue()+1)return-1;return t[0].getOrderValue()},t.isThree=function(e){return 3!=e.length?-1:e[1].getOrderValue()==e[0].getOrderValue()&&e[2].getOrderValue()==e[0].getOrderValue()?e[0].getOrderValue():-1},t.isThreeSingle=function(e){return 4!=e.length?-1:e[1].getOrderValue()===e[0].getOrderValue()&&e[2].getOrderValue()===e[0].getOrderValue()&&e[3].getOrderValue()!=e[0].getOrderValue()?e[0].getOrderValue():e[1].getOrderValue()===e[3].getOrderValue()&&e[2].getOrderValue()===e[3].getOrderValue()&&e[0].getOrderValue()!=e[3].getOrderValue()?e[1].getOrderValue():-1},t.isThreePairs=function(e){return 5!=e.length?-1:e[1].getOrderValue()===e[0].getOrderValue()&&e[2].getOrderValue()===e[0].getOrderValue()&&e[3].getOrderValue()!=e[0].getOrderValue()&&e[3].getOrderValue()===e[4].getOrderValue()?e[0].getOrderValue():e[0].getOrderValue()===e[1].getOrderValue()&&e[2].getOrderValue()===e[3].getOrderValue()&&e[3].getOrderValue()===e[4].getOrderValue()&&e[0].getOrderValue()!=e[2].getOrderValue()?e[2].getOrderValue():-1},t.isStraightPairs=function(t){if(t.length<6||t.length>20||t.length%2!=0)return-1;if(t[0].getOrderValue()>e.PokerUtils.AValue)return-1;for(var n=0;n<t.length-1;n+=2)if(t[n].getOrderValue()!=t[n+1].getOrderValue())return-1;for(var n=0;n<t.length-2;n+=2)if(t[n].getOrderValue()!=t[n+2].getOrderValue()+1)return-1;return t[0].getOrderValue()},t.isPlane=function(t){if(t.length<6||t.length%3!=0)return-1;if(t[0].getOrderValue()>e.PokerUtils.AValue)return-1;for(var n=0;n<t.length-1;n+=3)if(t[n].getOrderValue()!=t[n+1].getOrderValue()||t[n].getOrderValue()!=t[n+2].getOrderValue())return-1;for(var n=0;n<t.length-3;n+=3)if(t[n].getOrderValue()!=t[n+3].getOrderValue()+1)return-1;return t[0].getOrderValue()},t.containPokerWithTheSameRank=function(e,t){for(var n=0;n<e.length;n++)if(e[n].getOrderValue()==t.getOrderValue())return!0;return!1},t.isPlane2Single=function(n){var o=[],i=[];if(n.length<8||n.length%4!=0)return-1;for(var s=0;s<n.length-2;s++)n[s].getOrderValue()===n[s+1].getOrderValue()&&n[s].getOrderValue()==n[s+2].getOrderValue()&&(t.containPokerWithTheSameRank(o,n[s])||(o.push(n[s]),i.push(n[s].getOrderValue())));var r=n.length/4;if(o.length<r)return-1;var a=GlobalUtils.findNumbersSequence(i,r);return 0==a.length?-1:n.length-3*a[0].length!=r?-1:o[0].getOrderValue()>e.PokerUtils.AValue?-1:o[0].getOrderValue()},t.isPlane2pairs=function(t){var n=[],o=[],i=[],s=[];if(t.length<10||t.length%5!=0)return-1;for(var r=0;r<t.length-3;r++)t[r].getOrderValue()===t[r+1].getOrderValue()&&t[r].getOrderValue()===t[r+2].getOrderValue()&&t[r].getOrderValue()===t[r+3].getOrderValue()&&(i=i.concat([t[r],t[r+1],t[r+2],t[r+3]]));t=e.PokerUtils.removePokers(t,i);for(var r=0;r<t.length-2;r++)t[r].getOrderValue()==t[r+1].getOrderValue()&&t[r].getOrderValue()==t[r+2].getOrderValue()&&(o.push(t[r]),s.push(t[r].getOrderValue()),n=n.concat([t[r],t[r+1],t[r+2]]));var a=(t.length+i.length)/5;if(o.length<a)return-1;var l=GlobalUtils.findNumbersSequence(s,a);if(0==l.length)return-1;n=e.PokerUtils.removePokers(t,n),n=n.concat(i),e.PokerUtils.sortDescPokers(n);for(var c=0,r=0;r<n.length-1;r+=2){if(n[r].getOrderValue()!==n[r+1].getOrderValue())return-1;c++}return c!=a?-1:o[0].getOrderValue()>e.PokerUtils.AValue?-1:o[0].getOrderValue()},t.isFour2Single=function(e){if(6!=e.length)return-1;for(var t=0;t<e.length-3;t++)if(e[t].getOrderValue()===e[t+1].getOrderValue()&&e[t].getOrderValue()===e[t+2].getOrderValue()&&e[t].getOrderValue()===e[t+3].getOrderValue())return e[t].getOrderValue();
return-1},t.isFour2Pairs=function(t){var n,o=[];if(8!=t.length)return-1;for(var i=0;i<t.length-3;i++)t[i].getOrderValue()===t[i+1].getOrderValue()&&t[i].getOrderValue()===t[i+2].getOrderValue()&&t[i].getOrderValue()===t[i+3].getOrderValue()&&(o=o.concat(e.PokerUtils.removePokers(t,[t[i],t[i+1],t[i+2],t[i+3]])),n=t[i]);if(null==n||void 0==n)return-1;for(var i=0;i<o.length-1;i+=2)if(o[i].getOrderValue()!==o[i+1].getOrderValue())return-1;return n.getOrderValue()},t.Boom="Boom",t.KingBoom="KingBoom",t.Single="Single",t.Pair="Pair",t.Three="Three",t.ThreeSingle="ThreeSingle",t.ThreePair="ThreePair",t.Straight="Straight",t.StraightPairs="StraightPairs",t.Plane="Plane",t.Plane2Single="Plane2Single",t.Plane2Pairs="Plane2Pairs",t.Four2Single="Four2Single",t.Four2Pairs="Four2Pairs",t}();e.PokerTypeUtils=t,__reflect(t.prototype,"Ddz.PokerTypeUtils")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function t(){}return t.getRandomPokers=function(){for(var t,n,o=new Array,i=this.pokerIds.length,s=this.pokerIds.slice(),r=[],a=0;a<this.pokerIds.length;a++)t=Math.floor(Math.random()*s.length),n=s[t],r.push(n),s=ArrayUtils.slice(s,0,t).concat(ArrayUtils.slice(s,t+1,s.length)),i--;for(var l=0;l<r.length;l++){var c=new e.Poker(this.pokerIds[r[l]-1],this.pokerSortValues[r[l]-1]);o.push(c)}return console.log("已随机生成一副牌",o.toString()),o},t.sortDescPokers=function(e){return e.sort(this.sortDesc)},t.sortDescPokerSprites=function(e){return e.sort(this.sortPokerSpriteDesc)},t.parsePokersFromPokerIds=function(n){var o=new Array;return void 0==n||0==n.length?o:(n.forEach(function(n){var i=new e.Poker(t.pokerIds[n-1],t.pokerSortValues[n-1]);o.push(i)}),o)},t.parsePokersFromPokerSprites=function(e){var t=new Array;return void 0==e||0==e.length?t:(e.forEach(function(e){var n=e.getPoker();t.push(n)}),t)},t.parsePokerIdsFromPokerSprites=function(e){var t=new Array;return e.forEach(function(e){var n=e.getPoker().getId();t.push(n)}),t},t.parsePokerSpritesFromPokerIds=function(n){var o=new Array,i=t.parsePokersFromPokerIds(n);return i.forEach(function(t){var n=new e.PokerSprite(t,GlobalConstants.POKER_M_W,!1);o.push(n)}),o},t.createPoker=function(n){return new e.Poker(t.pokerIds[n-1],t.pokerSortValues[n-1])},t.removePokerSprites=function(e,t){for(var n=new Array,o=0;o<e.length;o++){for(var i=!1,s=0;s<t.length;s++)e[o].getPoker().getId()==t[s].getPoker().getId()&&(i=!0);i||n.push(e[o])}return n},t.removePokers=function(e,t){for(var n=new Array,o=0;o<e.length;o++){for(var i=!1,s=0;s<t.length;s++)e[o].getId()==t[s].getId()&&(i=!0);i||n.push(e[o])}return n},t.sortDesc=function(e,t){return e.getOrderValue()<t.getOrderValue()?1:e.getOrderValue()>t.getOrderValue()?-1:0},t.sortPokerSpriteDesc=function(e,t){return e.getPoker().getOrderValue()<t.getPoker().getOrderValue()?1:e.getPoker().getOrderValue()>t.getPoker().getOrderValue()?-1:0},t.pokerSortValues=[12,12,12,12,13,13,13,13,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,11,11,11,11,14,15],t.AValue=12,t.TwoValue=13,t.BigKingValue=15,t.SmallKingValue=14,t.pokerIds=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],t}();e.PokerUtils=t,__reflect(t.prototype,"Ddz.PokerUtils")}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(e){function t(t,n){var o=e.call(this)||this;return o.isMe=t,n?o.skinName="DdzSeatUILSkin":o.skinName="DdzSeatUIRSkin",o.isMe?o.alignment=GlobalUtils.ALIGNMENT_CENTER:n?o.alignment=GlobalUtils.ALIGNMENT_LEFT:o.alignment=GlobalUtils.ALIGNMENT_RIGHT,o}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.initUI=function(){this.user=null,this.imgWinner.visible=!1,this.imgWinner.x=this.imgWinner.width/2,this.imgWinner.y=this.imgWinner.height/2,this.imgWinner.anchorOffsetX=this.imgWinner.width/2,this.imgWinner.anchorOffsetY=this.imgWinner.height/2,this.labName.text="",this.labScore.text="",this.labPokersNum.text="",this.imgPokersNumBG.visible=!1,this.imgLandlord.visible=!1,this.imgUserReady.visible=!1,null!=this.grpTimer&&(this.grpTimer.visible=!0,this.grpTimer.removeChildren()),null!=this.grpPokers&&(this.grpPokers.visible=!0,this.grpPokers.removeChildren()),null!=this.grpLastAction&&(this.grpLastAction.visible=!0,this.grpLastAction.removeChildren()),null!=this.grpPokerType&&(this.grpPokerType.visible=!0,this.grpPokerType.removeChildren()),null!=this.grpPokersInHand&&(this.grpPokersInHand.visible=!0,this.grpPokersInHand.removeChildren())},t.prototype.setUser=function(e){this.user=e},t.prototype.getUser=function(){return this.user},t.prototype.show=function(){this.grpParent.visible=!0,this.grpParent.removeChildren(),this.grpParent.addChild(this)},t.prototype.getIsMe=function(){return this.isMe},t.prototype.setAlignment=function(e){this.alignment=e},t.prototype.getAlignment=function(){return this.alignment},t.prototype.setLabName=function(e){(void 0==e||null==e)&&(e=""),this.labName.text=GlobalUtils.getFixedLenOfString(e,6)},t.prototype.setLabPokersNum=function(e){(void 0==e||null==e)&&(e=""),this.imgPokersNumBG.visible=!0,this.labPokersNum.text=e},t.prototype.setImgAvatar=function(e){this.imgAvatar.source=e,this.imgAvatar.width=this.imgAvatar.height=80},t.prototype.setLabScore=function(e){(void 0==e||null==e)&&(e="0"),this.labScore.text=String(e)},t.prototype.setImgLandlord=function(e){if(e){this.imgLandlord.visible=!0;var t=egret.Tween.get(this.imgLandlord);t.to({scaleX:1.5,scaleY:1.5},100,egret.Ease.quintOut).to({scaleX:1,scaleY:1},80).to({scaleX:1.1,scaleY:1.1},80).to({scaleX:1,scaleY:1},80).call(function(){t&&egret.Tween.removeTweens(t)})}else this.imgLandlord.visible=!1},t.prototype.getImgLandlord=function(){return this.imgLandlord},t.prototype.setImgWinner=function(e){var t=this;e?(this.imgWinner.visible=!0,this.tweenWin=egret.Tween.get(this.imgWinner,{loop:!0}),this.tweenWin.to({scaleX:1,scaleY:1},200,egret.Ease.quintOut).to({alpha:0},100).to({scaleX:.95,scaleY:.95},200).to({alpha:1},100).call(function(){setTimeout(function(){t.tweenWin&&(t.tweenWin.to({scaleX:1,scaleY:1}),t.tweenWin.setPaused(!0),egret.Tween.removeTweens(t.tweenWin))},5e3)})):(this.imgWinner.visible=!1,this.tweenWin=null)},t.prototype.setImgUserReady=function(e){e?this.imgUserReady.visible=!0:this.imgUserReady.visible=!1},t.prototype.setGrpTimer=function(e){e.removeChildren(),this.grpTimer=e},t.prototype.getGrpTimer=function(){return this.grpTimer},t.prototype.setGrpParent=function(e){e.removeChildren(),this.grpParent=e},t.prototype.getGrpParent=function(){return this.grpParent},t.prototype.setGrpPokers=function(e){e.removeChildren(),this.grpPokers=e},t.prototype.getGrpPokers=function(){return this.grpPokers},t.prototype.setGrpSDPokers=function(e){e.removeChildren(),this.grpSDPokers=e},t.prototype.getGrpSDPokers=function(){return this.grpSDPokers},t.prototype.setGrpLastAction=function(e){e.removeChildren(),this.grpLastAction=e},t.prototype.getGrpLastAction=function(){return this.grpLastAction},t.prototype.setGrpPokerType=function(e){e.removeChildren(),this.grpPokerType=e},t.prototype.getGrpPokerType=function(){return this.grpPokerType},t.prototype.setGrpPokersInHand=function(e){e.removeChildren(),this.grpPokersInHand=e},t.prototype.getGrpPokersInHand=function(){return this.grpPokersInHand},t.prototype.setImgSizeAndPos=function(e,t){e.width=.85*e.width,e.height=.85*e.height,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=.5*t.width,e.y=t.height-e.height/2},t.prototype.showImgAnimation=function(e){var t=egret.Tween.get(e);t.to({scaleX:2,scaleY:2},100,egret.Ease.sineOut).wait(20).to({scaleX:.9,scaleY:.9},100,egret.Ease.sineIn).to({scaleX:1.2,scaleY:1.2},100,egret.Ease.sineIn).to({scaleX:1,scaleY:1},100,egret.Ease.sineIn).call(function(){egret.Tween.removeTweens(t)})},t.prototype.setImgPokerType=function(e){this.imgPokerType=GlobalUtils.createBitmapByName(e),this.imgPokerType.anchorOffsetX=this.imgPokerType.width/2,this.imgPokerType.anchorOffsetX=this.imgPokerType.height/2,this.imgPokerType.x=this.grpPokerType.width/2,this.imgPokerType.y=this.grpPokerType.height/2-this.imgPokerType.height/2,this.alignment==GlobalUtils.ALIGNMENT_LEFT?this.imgPokerType.x=30:this.alignment==GlobalUtils.ALIGNMENT_RIGHT&&(this.imgPokerType.x=this.grpPokerType.width-this.imgPokerType.width-30),this.setImgSizeAndPos(this.imgPokerType,this.grpPokerType),this.grpPokerType.addChild(this.imgPokerType),this.showImgAnimation(this.imgPokerType)},t.prototype.setImgLastAction=function(e){this.imgLastAction=GlobalUtils.createBitmapByName(e);var t=this.grpLastAction;this.setImgSizeAndPos(this.imgLastAction,t),t.addChild(this.imgLastAction),this.showImgAnimation(this.imgLastAction)},t}(eui.Component);e.SeatUI=t,__reflect(t.prototype,"Ddz.SeatUI",["eui.UIComponent","egret.DisplayObject"])}(Ddz||(Ddz={}));var Ddz;!function(e){var t;!function(e){e[e.NONE=0]="NONE",e[e.WAITTING=1]="WAITTING",e[e.START=2]="START",e[e.DEALPOKERS=3]="DEALPOKERS",e[e.CALLLANDLORD=4]="CALLLANDLORD",e[e.HASLANDLORD=5]="HASLANDLORD",e[e.NOLANDLORD=6]="NOLANDLORD",e[e.ADDSCORE=7]="ADDSCORE",e[e.PLAYPOKERS=8]="PLAYPOKERS",e[e.SHOWDOWN=9]="SHOWDOWN",e[e.SUBGAMEEND=10]="SUBGAMEEND"}(t=e.State||(e.State={}))}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return n.sceneName="Ddz.TableScene",n.index=0,n.skinName="DdzTableSkin",n.addExtraAttributeToTable(),n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(n.stage,n),SoundManager.getInstance().playMusic("bg_ddz_mp3"),EventManager.getInstance().dispatchEvent(e.Constants.EVENT_DDZ_RELOAD_DATA),n.shuffle=new Shuffle(n.grpDeck,n.dealPokersResCB.bind(n)),n.btnReady.setClick(function(e){n.beReady(e)}),n.btnInvite.setClick(function(e){n.inviteOthers(e)}),n.btnGoMatching.setClick(function(){n.coinModeRoomReq()}),n.btnCallScore0.setClick(function(){n.callLandlordReq(1)}),n.btnCallScore3.setClick(function(){n.callLandlordReq(3)}),n.btnPrompt.setClick(function(){n.playPokersPrompt()}),n.btnGo.setClick(function(){n.playPokersGo()}),n.btnPass.setClick(function(){n.playPokersPass()}),n.btnAddScoreX2.setClick(function(){n.addScoreReq(2)}),n.btnAddScoreX4.setClick(function(){n.addScoreReq(4)}),n.btnAddScoreNo.setClick(function(){n.addScoreReq(1)}),n.btnEnableHost.setClick(function(){n.enableHostReq()}),n.btnDisableHost.setClick(function(){n.disableHostReq()}),EventManager.getInstance().addEvent(GlobalConstants.EVENT_SYSTEM_MESSAGE,n.showSystemMessage.bind(n),null),EventManager.getInstance().addEvent(GlobalConstants.EVENT_DISABLE_HOST,n.showGrpPokerControls.bind(n),null),n.clearSampleImgAndData()},n),n}return __extends(n,t),n.getInstance=function(){return null==this.ddzTableScene&&(this.ddzTableScene=new n),this.ddzTableScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initBtnFunc()},n.prototype.initBtnFunc=function(){var e=this;this.btnGoBack.setClick(function(){e.showGoBackConfirmationWin()}),this.btnSetting.setClick(function(){e.showSettingScene()}),this.btnScores.setClick(function(){e.showGameScores()})},n.prototype.showGrpPokerControls=function(){this.isMyTurn(e.ExtraAttribute.get().currentSeatNo)&&(this.grpPokerControls.visible=!0)},n.prototype.showSystemMessage=function(e){var t=new ScrollingMessages(this.grpSystemMessage),n={};n.msg=e.content,n.loopNum=3;var o=new ScrollingMessage(n,0);t.pushpaoMaDengMsg(o),t.start()},n.prototype.showStartMatchingCountDownTimer=function(){var e=GlobalLocales.get()["start.Matching.Player"];this.startMatchingUserCountDownTimer=new CountDownTimer(e),this.grpTimer.addChild(this.startMatchingUserCountDownTimer),this.startMatchingUserCountDownTimer.timeStart(30)},n.prototype.coinModeRoomReq=function(){console.log("开始匹配");var e=EventType.COINMODE_ROOM_JOIN,t=new CoinModeRoomJoinReq;t.coinModeId=GlobalVars.getInstance().coinModeId,t.step=2;var n=new EventReq(e,t);Network.getInstance().request(n,this.onCoinModeRoomJoinSuccess.bind(this),this.onCoinModeRoomJoinError.bind(this))},n.prototype.onCoinModeRoomJoinSuccess=function(e){console.log("onCoinModeRoomJoinSuccess:"+e.getContent()),this.grpReadyAndInvite.visible=!1,this.btnGoMatching.visible=!1,this.showStartMatchingCountDownTimer()},n.prototype.onCoinModeRoomJoinError=function(e){console.log("onCoinModeRoomJoinError:"+e.getContent()),TipsScene.getInstance().showError(e.getContent())},n.prototype.getRoomId=function(){var e=RoomService.getInstance().getRoom();return null!=e?e.id:null!=this.roomId?this.roomId:null},n.prototype.initialize=function(){this.labEntityId.text=String(this.getRoomId()),this.labRoundNums.text="",this.setAllGrpsToInVisible(),this.initSeatMap(),this.fillUserOfSeatUI()},n.prototype.setAllGrpsToInVisible=function(){this.grpReadyAndInvite.visible=!1,this.grpCallLandlord.visible=!1,this.grpAddScore.visible=!1,this.grpPokerControls.visible=!1,this.grpHost.visible=!1},n.prototype.showSettingScene=function(){SceneManager.getInstance().pushScene(Setting.SettingScene.getInstance(this.sceneName))},n.prototype.showGoBackConfirmationWin=function(){var t=this,n=e.Locales.get()["Go.Back.Confirmation"];TipsScene.getInstance().confirm(n,function(){t.close()})},n.prototype.close=function(){this.roomLeaveReq(),SoundManager.getInstance().stopMusic(),SceneManager.getInstance().popScene(this)},n.prototype.roomLeaveReq=function(){var e=EventType.ROOM_LEAVE,t=new RoomLeaveReq,n=new EventReq(e,t);Network.getInstance().send(n)},n.prototype.setRoom=function(e){this.roomId=e},n.prototype.clearSampleImgAndData=function(){this.grpBottomPokers.removeChildren()},n.prototype.addExtraAttributeToTable=function(){},n.prototype.initSeatMap=function(){this.seatMap=new Dictionary;for(var t=(RoomService.getInstance().getRoom().table.getSeatsNum(),1);t<=e.Constants.USER_NUM_PER_TABLE;++t){var n=void 0;1==t?n=new e.SeatUI(!0,!0):2==t?n=new e.SeatUI(!1,!1):3==t&&(n=new e.SeatUI(!1,!0)),n.setGrpParent(this["grpProfile_Seat"+t]),n.setGrpPokers(this["grpPokers_Seat"+t]),n.setGrpLastAction(this["grpLastAction_Seat"+t]),n.setGrpPokerType(this["grpLastAction_Seat"+t]),n.setGrpPokersInHand(this.grpPokersInHand),1!=t?n.setGrpSDPokers(this["grpSDPokers_Seat"+t]):n.setGrpSDPokers(this["grpPokers_Seat"+t]),n.initUI(),this.seatMap.Add("Seat"+t,n)}},n.prototype.getSeatUI=function(e){var t=this.getMySeatNo();return e==t?this.seatMap.Item("Seat1"):e==RoomService.getInstance().getRoom().table.peekSeatNoRecursively(t,1)?this.seatMap.Item("Seat2"):e==RoomService.getInstance().getRoom().table.peekSeatNoRecursively(t,2)?this.seatMap.Item("Seat3"):void 0},n.prototype.getPrevSeatNo=function(e){var t=RoomService.getInstance().getRoom().table.peekPreviousSeatNo(e);return t},n.prototype.fillUserOfSeatUI=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers();t.forEach(function(t){var n=e.getSeatUI(t.seatNo);n.setUser(t)})},n.prototype.roomJoinOthers=function(e){this.setOthersSeatUI(e.user),console.log("其他用户加入:"+e)},n.prototype.roomLeaveOthers=function(e){var t=RoomService.getInstance().getRoom().table.getUserByUserId(String(e.userId));if(null!=t){var n=this.getSeatUI(t.seatNo);n.initUI(),console.log("其他用户离开:"+e)}},n.prototype.setOthersSeatUI=function(e){var t=this.getSeatUI(e.seatNo);t.show(),t.setUser(e),t.setLabName(e.name),t.setImgAvatar(e.avatar),t.setLabScore(String(e.score))},n.prototype.updateUserScoreAndUI=function(e){var t=this;e.forEach(function(e){var n=RoomService.getInstance().getRoom().table.getUserBySeatNo(e.seatNo);if(n.score=e.score,t.getMySeatNo()!=e.seatNo){var o=t.getSeatUI(e.seatNo);o.setLabScore(String(n.score))}})},n.prototype.setMySeatUI=function(){var e=this.getMySeatNo(),t=this.getSeatUI(e),n=UserService.getInstance().getUser();t.show(),t.setUser(n),t.setLabName(n.name),t.setImgAvatar(n.avatar),t.setLabScore(String(n.score))},n.prototype.initOthersSeatUI=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers(),n=UserService.getInstance().getUser();t.forEach(function(t){n.id!=t.id&&e.setOthersSeatUI(t)})},n.prototype.tableIsFull=function(){this.btnInvite.visible=!1},n.prototype.setUsersReady=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers();t.forEach(function(t){var n=e.getSeatUI(t.seatNo);t.beReady?n.setImgUserReady(!0):n.setImgUserReady(!1)})},n.prototype.beReadyRes=function(e){var t=RoomService.getInstance().getRoom(),n=t.table.getUserByUserId(String(e.userId)),o=this.getSeatUI(n.seatNo);o.setImgUserReady(!0)},n.prototype.getMySeatNo=function(){return RoomService.getInstance().getRoom().table.getMySeatNo()},n.prototype.getMySeaUI=function(){var e=this.getMySeatNo();return this.getSeatUI(e)},n.prototype.initTheTable=function(){this.initialize(),this.setMySeatUI(),this.initOthersSeatUI()},n.prototype.initGrpReadyAndInvite=function(e){this.grpReadyAndInvite.removeChildren(),this.grpReadyAndInvite.visible=!0,e?(this.btnReady.visible=!0,this.grpReadyAndInvite.addChild(this.btnReady),this.btnInvite.visible=!0,this.grpReadyAndInvite.addChild(this.btnInvite)):(this.btnGoMatching.visible=!0,this.grpReadyAndInvite.addChild(this.btnGoMatching)),GlobalUtils.setHorizontalLayout(this.grpReadyAndInvite,150,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.enableHostReq=function(){var e=EventType.ENABLE_HOST,t=new EnableHostReq;t.userId=UserService.getInstance().getUser().id;var n=new EventReq(e,t);Network.getInstance().request(n,this.onEnableHostSuccess.bind(this),this.onEnableHostError.bind(this))},n.prototype.onEnableHostSuccess=function(e){console.log("onEnableHostSuccess:"+JSON.stringify(e.args)),this.grpHost.visible=!0,UserService.getInstance().getUser().beHosted=!0},n.prototype.onEnableHostError=function(e){console.log("onEnableHostError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.disableHostReq=function(){var e=EventType.DISABLE_HOST,t=new DisableHostReq;t.userId=UserService.getInstance().getUser().id;var n=new EventReq(e,t);Network.getInstance().request(n,this.onDisableHostSuccess.bind(this),this.onDisableHostError.bind(this))},n.prototype.onDisableHostSuccess=function(e){console.log("onDisableHostSuccess:"+JSON.stringify(e.args)),this.grpHost.visible=!1,UserService.getInstance().getUser().beHosted=!1},n.prototype.onDisableHostError=function(e){console.log("onDisableHostError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.showGameScores=function(){var e=GameResult.FinalGameRslScene.getInstance();e.setRoom(String(this.roomId)),SceneManager.getInstance().pushScene(e)},n.prototype.beReady=function(e){console.log("点击准备按钮"),this.initTheTable();var t=EventType.BE_READY,n=new BeReadyReq;n.roomId=this.roomId;var o=new EventReq(t,n);Network.getInstance().request(o,this.onReadySuccess.bind(this),this.onReadyError.bind(this))},n.prototype.onReadySuccess=function(e){console.log("onReadySuccess:"+JSON.stringify(e.args)),this.btnReady.visible=!1,this.btnInvite.visible=!1,this.setMyReadyStatus(!0)},n.prototype.setMyReadyStatus=function(e){var t=this.getMySeatNo(),n=this.getSeatUI(t);n.setImgUserReady(e)},n.prototype.onReadyError=function(e){console.log("onReadyError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.inviteOthersBK=function(t){console.log("点击邀请按钮"),this.btnInvite.visible=!1;var n=new Array(1,2,5,6,17,18,19,20,21,22,23,26,27,30,31,33,34,35,37,38,39,41,53,54),o=new Array(9,10,11,12,14,15,17,18),i=e.PokerSeekUtils.seekBiggerHand(e.PokerUtils.parsePokersFromPokerIds(n),e.PokerUtils.parsePokersFromPokerIds(o));console.log(i.toString()),e.DdzEffects.playRocketAnimation(this.grpAnim),e.DdzEffects.playBombAnimation(this.grpAnim),e.DdzEffects.playPlaneAnimation(this.grpAnim),e.DdzEffects.playStraightAnimation(this.grpAnim);var s="395170";Hall.HallScene.getInstance().joinRoomReq(s)},n.prototype.inviteOthers=function(e){var t=InviteScene.getInstance();t.setEntityId(String(this.roomId)),SceneManager.getInstance().pushScene(t)},n.prototype.dealPokersRes=function(){this.clearGrpTimer(),this.grpPokersInHand.removeChildren(),this.grpDeck.visible=!0,this.shuffle.launch()},n.prototype.dealPokersResCB=function(){this.index=0;var t=e.Constants.TOTAL_POKERS_PER_PLAYER;this.dealPokersTimer=new egret.Timer(150,t),this.dealPokersTimer.addEventListener(egret.TimerEvent.TIMER,this.dealPokerInOneRoundAnimation,this),this.dealPokersTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.dealPokersEndReq,this),this.dealPokersTimer.start()},n.prototype.dealPokerInOneRoundAnimation=function(){for(var e=RoomService.getInstance().getRoom().capacity,t=GlobalUtils.getRandomIntInclusive(1,e),n=1;e>=n;n++){var o=0,i=null;(o=RoomService.getInstance().getRoom().table.peekSeatNoRecursively(t,n))&&(i=this.seatMap.Item("Seat"+n),this.dealPokerToSeatAnimation(i,this.index))}this.index++},n.prototype.dealPokerToSeatAnimation=function(t,n){var o=new e.Poker(0,0),i=new e.PokerSprite(o,GlobalConstants.POKER_M_W,!1);this.grpDeck.visible=!0,i.x=i.y=0,this.grpDeck.addChild(i),SoundManager.getInstance().playEffect("send_card_wav");var s=t.getGrpParent();t.getIsMe()&&(s=t.getGrpPokersInHand());var r=this.grpDeck.globalToLocal(s.x+s.width/2,s.y+s.height/2),a=egret.Tween.get(i);a.to({x:r.x,y:r.y},200).call(function(){if(this.grpDeck&&this.grpDeck.contains(i)&&this.grpDeck.removeChild(i),egret.Tween.removeTweens(i),t.getIsMe()){var o=e.ExtraAttribute.get().pokerSpritesInHands[n];s.addChild(o),GlobalUtils.setHorizontalLayout(s,e.Constants.POKERS_IN_HAND_GAP,t.getAlignment())}},this)},n.prototype.initSeatUIPokersNum=function(){var t=this;this.seatMap.Keys().forEach(function(n){var o=t.seatMap.Item(n);o.setLabPokersNum(String(e.Constants.TOTAL_POKERS_PER_PLAYER))})},n.prototype.dealPokersEndReq=function(){console.log("发牌完成");var t=this.getMySeaUI();GlobalUtils.setHorizontalLayout(t.getGrpPokersInHand(),e.Constants.POKERS_IN_HAND_GAP,t.getAlignment()),this.grpBottomPokers.visible=!0,this.setBottomPokers(null),this.initSeatUIPokersNum(),this.grpDeck.visible=!1;var n=EventType.GAME_DDZ,o=new e.DealPokersEndReq;o.cmd=e.CommandType.DEAL_POKERS_END_REQ;var i=new EventReq(n,o);Network.getInstance().send(i)},n.prototype.isMyTurn=function(e){var t=this.getMySeatNo();return-1!=t&&t==e?(SoundManager.getInstance().playEffect("my_turn_mp3"),!0):!1},n.prototype.amILandlord=function(){var t=this.getMySeatNo();return-1!=t&&t==e.ExtraAttribute.get().landLordSeatNo?!0:!1},n.prototype.clearAllSeatUIs=function(){var e=this;this.seatMap.Keys().forEach(function(t){var n=e.seatMap.Item(t);n.setLabPokersNum(""),n.getGrpLastAction().removeChildren(),n.getGrpPokers().removeChildren(),n.getGrpSDPokers().removeChildren(),n.getGrpPokerType().removeChildren(),n.getGrpPokersInHand()&&n.getGrpPokersInHand().removeChildren(),n.setImgUserReady(!1),n.setImgLandlord(!1),n.setImgWinner(!1)})},n.prototype.clearTheTableScene=function(){this.grpReadyAndInvite.removeChildren(),this.clearAllSeatUIs(),this.grpBottomPokers.removeChildren(),this.index=0,this.labRoundNums.text="",null!=this.startMatchingUserCountDownTimer&&this.startMatchingUserCountDownTimer.stop(),this.grpTimer.contains(this.startMatchingUserCountDownTimer)&&this.grpTimer.removeChild(this.startMatchingUserCountDownTimer)},n.prototype.setLabRoundNums=function(){var t=String(e.ExtraAttribute.get().subGameIndex),n=String(e.ExtraAttribute.get().subGameNums),o=e.Locales.get().roundnums+t+"/"+n;this.labRoundNums.text=o},n.prototype.clearImgBeReadyOfAllSeatUIs=function(){var e=this;this.seatMap.Keys().forEach(function(t){var n=e.seatMap.Item(t);n.setImgUserReady(!1)})},n.prototype.startGameRes=function(e){this.clearTheTableScene(),this.clearImgBeReadyOfAllSeatUIs(),this.setLabRoundNums(),this.showStartGameCountDownTimer(e.startGameTimeout),SoundManager.getInstance().playEffect("game_start_wav")},n.prototype.showStartGameCountDownTimer=function(t){this.clearAllTimer();var n=new CountDownTimer(e.Locales.get()["start.game.countdown"]);this.grpTimer.addChild(n),n.timeStart(t)},n.prototype.clearGrpTimer=function(){this.grpTimer.removeChildren()},n.prototype.showTimer=function(t){this.clearAllTimer();var n=e.ExtraAttribute.get().currentSeatNo;this.timer=new ETimer(t);var o=this.getSeatUI(n);o.getGrpTimer().visible=!0,o.getGrpTimer().removeChildren(),o.getGrpPokers().removeChildren(),this.timer.onComplete(function(){o.getGrpTimer().removeChildren()}),this.timer.x=.5*o.getGrpTimer().width,this.timer.y=.5*o.getGrpTimer().height,o.getGrpTimer().addChild(this.timer),this.timer.startTimer()},n.prototype.clearAllTimer=function(){if(null!=this.timer&&void 0!=this.timer){this.timer.stopTimer(),this.timer=null;for(var e=0;e<this.seatMap.Count();e++){var t=this.seatMap.Values()[e];t.getGrpTimer().removeChildren()}}},n.prototype.clearMyTimer=function(){null!=this.timer&&void 0!=this.timer&&(this.timer.stopTimer(),this.timer=null);var e=this.getMySeaUI();e.getGrpTimer().removeChildren()},n.prototype.clearMyLastAction=function(){var e=this.getMySeaUI();e.getGrpLastAction().removeChildren()},n.prototype.clearAllLastActions=function(){if(null!=this.seatMap)for(var e=0;e<this.seatMap.Count();e++){var t=this.seatMap.Values()[e];t.getGrpLastAction().removeChildren()}},n.prototype.clearAllUsersReady=function(){this.seatMap.Values().forEach(function(e){e.setImgUserReady(!1)})},n.prototype.isLastTurn=function(e){return-1==e.currentSeatNo&&0!=e.lastPokersPlayed.length&&-1!=e.lastSeatPlayed&&0==e.lastSeatPokersNum?!0:!1},n.prototype.showLastSeatPlayPokers=function(t){if(!this.isFirstTurn(t)&&t.lastSeatPassed!=t.lastSeatPlayed){var n=0;if(n=this.isLastTurn(t)?t.lastSeatPlayed:this.getPrevSeatNo(t.currentSeatNo),0!=n){var o=this.getMySeatNo(),i=this.getSeatUI(n);if(o==n&&t.lastSeatPlayed==n&&null!=t.lastPokersPlayed&&t.lastPokersPlayed.length>0&&this.removePlayedPokersFromMyHand(),i.getGrpLastAction().removeChildren(),i.getGrpPokers().removeChildren(),t.lastSeatPlayed==n&&null!=t.lastPokersPlayed&&t.lastPokersPlayed.length>0){var s=e.PokerUtils.parsePokersFromPokerIds(t.lastPokersPlayed);s=e.PokerUtils.sortDescPokers(s);for(var r=0;r<s.length;r++){var a=new e.PokerSprite(s[r],GlobalConstants.POKER_M_W,!1);i.getGrpPokers().addChild(a),GlobalUtils.setHorizontalLayout(i.getGrpPokers(),e.Constants.POKERS_GAP,i.getAlignment())}i.setLabPokersNum(String(t.lastSeatPokersNum)),this.setPokerTypeAndPlayAnimation(i,s),this.isPlayedByLeader(t)||SoundManager.getInstance().playEffect("kill_0_mp3")}else i.setImgLastAction("txt_no_go_png"),SoundManager.getInstance().playEffect("pass_0_mp3")}}},n.prototype.isPlayedByLeader=function(t){var n=e.ExtraAttribute.get().prevPPRes;return null==n?!0:n.lastSeatPlayed!=t.lastSeatPlayed?!1:!0},n.prototype.setPokerTypeAndPlayAnimation=function(t,n){var o=e.PokerTypeUtils.getType(n);o.getType()==e.PokerTypeUtils.KingBoom?(console.log("王炸"),t.setImgPokerType("ddz_king_bomb_png"),e.DdzEffects.playRocketAnimation(this.grpAnim)):o.getType()==e.PokerTypeUtils.Boom?(console.log("炸弹"),t.setImgPokerType("ddz_bomb_png"),e.DdzEffects.playBombAnimation(this.grpAnim)):o.getType()==e.PokerTypeUtils.Straight?(console.log("顺子"),t.setImgPokerType("ddz_straight_png"),e.DdzEffects.playStraightAnimation(this.grpAnim)):o.getType()==e.PokerTypeUtils.StraightPairs?(console.log("连对"),t.setImgPokerType("ddz_pair_png")):(o.getType()==e.PokerTypeUtils.Plane||o.getType()==e.PokerTypeUtils.Plane2Single||o.getType()==e.PokerTypeUtils.Plane2Pairs)&&(console.log("飞机"),t.setImgPokerType("ddz_plane_png"),e.DdzEffects.playPlaneAnimation(this.grpAnim))},n.prototype.showLastSeatCallLandlord=function(e){if(-1!=e.lastCallLandlordSeatNo){var t=this.getPrevSeatNo(e.currentSeatNo);if(0!=t){var n=this.getSeatUI(t);n.getGrpLastAction().removeChildren(),t==e.lastCallLandlordSeatNo&&e.lastCallLandlordScore>=3?(n.setImgLastAction("txt_call_landlord_png"),SoundManager.getInstance().playEffect("call_landlord_0_mp3")):(n.setImgLastAction("txt_no_call_png"),SoundManager.getInstance().playEffect("no_call_0_mp3"))}}},n.prototype.showLastSeatAddScore=function(e){if(-1!=e.lastAddScoreSeatNo){var t=this.getPrevSeatNo(e.currentSeatNo);if(0!=t){var n=this.getSeatUI(t);n.getGrpLastAction().removeChildren(),t==e.lastAddScoreSeatNo&&4==e.lastAddScore?n.setImgLastAction("txt_add_score_x4_png"):t==e.lastAddScoreSeatNo&&2==e.lastAddScore?n.setImgLastAction("txt_add_score_x2_png"):n.setImgLastAction("txt_add_score_x1_png")}}},n.prototype.callLandlordRes=function(e){return this.showTimer(e.callLandlordTimeout),this.updateLandlordScore(e.landLordScore),this.showLastSeatCallLandlord(e),this.isMyTurn(e.currentSeatNo)?(this.clearMyLastAction(),void(this.grpCallLandlord.visible=!0)):void(this.grpCallLandlord.visible=!1)},n.prototype.callLandlordReq=function(t){console.log("发送抢地主请求："+t);var n=EventType.GAME_DDZ,o=new e.CallLandlordReq;o.cmd=e.CommandType.CALL_LANDLORD_REQ,o.score=t;var i=new EventReq(n,o);Network.getInstance().request(i,this.onCallLandlordReqSuccess.bind(this),this.onCallLandlordReqError.bind(this))},n.prototype.onCallLandlordReqSuccess=function(e){console.log("onCallLandlordReqSuccess:"+JSON.stringify(e.args)),this.grpCallLandlord.visible=!1,this.clearMyTimer()},n.prototype.onCallLandlordReqError=function(t){console.log("onCallLandlordReqError:"+JSON.stringify(t.args)),TipsScene.getInstance().show(e.Locales.get()["call.landlord.error"],!1,null,this,!0)},n.prototype.hasLandlordRes=function(t){var n=this;if(this.clearAllTimer(),this.showLoadlandAnimation(),this.setBottomPokers(t.bottomPokers),this.amILandlord()){var o=e.PokerUtils.parsePokersFromPokerIds(t.bottomPokers);if(null==o)return;o.forEach(function(t){var o=new e.PokerSprite(t,GlobalConstants.POKER_XL_W,!0);e.ExtraAttribute.get().pokerSpritesInHands.push(o),n.updateMyPokersInHand()});var i=this.getMySeaUI();return void i.setLabPokersNum(String(e.Constants.TOTAL_POKERS_PER_PLAYER+e.Constants.BOTTOM_POKERS_NUM))}this.showOthersHasLandlord()},n.prototype.showOthersHasLandlord=function(){var t=this.getSeatUI(e.ExtraAttribute.get().landLordSeatNo);t.setLabPokersNum(String(e.Constants.TOTAL_POKERS_PER_PLAYER+e.Constants.BOTTOM_POKERS_NUM))},n.prototype.showNoLandlordCountDownTimer=function(t){this.clearAllTimer();var n=new CountDownTimer(e.Locales.get()["no.landlord.countdown"]);this.grpTimer.addChild(n),n.timeStart(t)},n.prototype.noLandlordRes=function(e){console.log("无地主,重新发牌."),this.clearAllTimer(),this.grpCallLandlord.visible=!1,this.grpPokersInHand.removeChildren(),this.clearAllLastActions(),this.grpBottomPokers.removeChildren(),SoundManager.getInstance().playEffect("no_landlord_mp3"),this.showNoLandlordCountDownTimer(e.noLandlordTimeout)},n.prototype.addScoreReq=function(t){console.log("发送加分的请求"+t);var n=EventType.GAME_DDZ,o=new e.AddScoreReq;o.cmd=e.CommandType.ADD_SCORE_REQ,o.score=t;var i=new EventReq(n,o);Network.getInstance().request(i,this.onAddScoreReqSuccess.bind(this),this.onAddScoreReqError.bind(this))},n.prototype.onAddScoreReqSuccess=function(e){console.log("onAddScoreReqSuccess:"+JSON.stringify(e.args)),this.grpAddScore.visible=!1,this.clearMyTimer()},n.prototype.onAddScoreReqError=function(t){console.log("onAddScoreReqError:"+JSON.stringify(t.args)),TipsScene.getInstance().show(e.Locales.get()["add.score.error"],!1,null,this,!0)},n.prototype.setBottomPokers=function(t){this.grpBottomPokers.visible=!0,this.grpBottomPokers.removeChildren();var n=new Array;if(null!=t&&t.length>0){var o=e.PokerUtils.parsePokersFromPokerIds(t);o.forEach(function(t){var o=new e.PokerSprite(t,GlobalConstants.POKER_S_W,!1);n.push(o)})}else for(var i=0;i<e.Constants.BOTTOM_POKERS_NUM;i++){var s=new e.PokerSprite(new e.Poker(0,0),GlobalConstants.POKER_S_W,!1);n.push(s)}for(var i=0;i<n.length;i++)this.grpBottomPokers.addChild(n[i]);GlobalUtils.setHorizontalLayout(this.grpBottomPokers,e.Constants.BOTTOM_POKERS_GAP,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.addScoreRes=function(e){return this.showTimer(e.addScoreTimeout),this.grpCallLandlord.visible=!1,this.updateLandlordScore(e.landLordScore),this.showLastSeatAddScore(e),this.isMyTurn(e.currentSeatNo)?(this.clearMyLastAction(),void(this.grpAddScore.visible=!0)):void(this.grpAddScore.visible=!1)
},n.prototype.updateLandlordScore=function(t){this.labBottomScore.text=String(e.ExtraAttribute.get().bottomScore),this.labLandlordScore.text=String(t)},n.prototype.showLoadlandAnimation=function(){var t=this,n=this.getSeatUI(e.ExtraAttribute.get().landLordSeatNo),o=GlobalUtils.createBitmapByName("landlord_png");o.x=this.grpCenter.width/2,o.y=this.grpCenter.height/2-o.height/2,o.width=130,o.height=130,o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2;var i=GlobalUtils.createBitmapByName("light_bold_png");i.x=o.x,i.y=o.y,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,this.grpCenter.addChild(i),this.grpCenter.addChild(o);var s=egret.Tween.get(i).to({alpha:1},200).call(function(){s=egret.Tween.get(i,{loop:!0}).to({rotation:360},500).wait(500).call(function(){s.setPaused(!0),s=null,t.grpCenter.contains(i)&&t.grpCenter.removeChild(i)})}),r=this.grpCenter.globalToLocal(n.getGrpParent().x+25,n.getGrpParent().y+50),a=egret.Tween.get(o).wait(1e3).to({x:r.x,y:r.y},500).call(function(){a.setPaused(!0),a=null,this.grpCenter.removeChild(o),n.setImgLandlord(!0)},this)},n.prototype.isFirstTurn=function(e){return-1==e.lastSeatPassed&&0==e.lastPokersPlayed.length&&-1==e.lastSeatPlayed&&-1==e.lastSeatPokersNum?!0:!1},n.prototype.setPokerControls=function(e){this.grpPokerControls.removeChildren(),e&&this.grpPokerControls.addChild(this.btnPass),this.grpPokerControls.addChild(this.btnPrompt),this.grpPokerControls.addChild(this.btnGo),GlobalUtils.setHorizontalLayout(this.grpPokerControls,50,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.isMeHosted=function(){var e=UserService.getInstance().getUser();return e.beHosted},n.prototype.showGrpHost=function(){this.isMeHosted()?this.grpHost.visible=!0:this.grpHost.visible=!1},n.prototype.playPokersRes=function(t){return this.showGrpHost(),t.currentSeatNo>0&&this.showTimer(t.playPokersTimeout),this.grpCallLandlord.visible=!1,this.grpAddScore.visible=!1,this.updateLandlordScore(t.landLordScore),this.showLastSeatPlayPokers(t),this.isMyTurn(t.currentSeatNo)?(this.clearMyLastAction(),this.isMeHosted()||(this.grpPokerControls.visible=!0),t.lastSeatPlayed==this.getMySeatNo()||this.isFirstTurn(t)?this.setPokerControls(!1):this.setPokerControls(!0),e.ExtraAttribute.get().lastSeatPlayed==this.getMySeatNo()?this.lastHandAutoActivePlay():this.lastHandAutoFollow(),void SoundManager.getInstance().playEffect("my_turn_mp3")):(e.ExtraAttribute.get().prevPPRes=t,void(this.grpPokerControls.visible=!1))},n.prototype.showDownRes=function(){this.clearAllTimer(),SoundManager.getInstance().playEffect("showdown_1_wav"),this.grpPokerControls.visible=!1,setTimeout(this.setValueOfAllSeatUIs.bind(this),1e3),setTimeout(this.showImgResAnimation.bind(this),3e3),setTimeout(this.updateAllUserScoreAndPopUpChipsNum.bind(this),5e3)},n.prototype.setValueOfAllSeatUIs=function(){var t=this,n=e.ExtraAttribute.get().userDatas;n.forEach(function(e){var n=t.getSeatUI(e.seatNo);null!=n&&(n.getGrpLastAction().removeChildren(),n.getGrpPokers().removeChildren(),t.showUserPokers(n,e))})},n.prototype.showUserPokers=function(t,n){if(t.getGrpSDPokers().removeChildren(),t.getGrpSDPokers().visible=!0,null!=n.pokers&&0!=n.pokers.length){var o=e.PokerUtils.parsePokersFromPokerIds(n.pokers);o=e.PokerUtils.sortDescPokers(o);for(var i=0;i<o.length;i++){var s=new e.PokerSprite(o[i],GlobalConstants.POKER_M_W,!1);t.getGrpSDPokers().addChild(s),GlobalUtils.setHorizontalLayout(t.getGrpSDPokers(),e.Constants.POKERS_GAP,t.getAlignment())}}},n.prototype.showImgResAnimation=function(){var e=this,t=this.getImgAndSoundResNames();setTimeout(function(){Effects.wordsImgAnimation(e.grpImgRes,t[0],Effects.V_ALIGNMENT_MIDDLE,e.showChipsFlyAnimation.bind(e),!0),SoundManager.getInstance().playEffect(t[1])},500)},n.prototype.getImgAndSoundResNames=function(){var t=new Array,n="",o="",i=RoomService.getInstance().getRoom().table.getMySeatNo(),s=e.ExtraAttribute.get().userDatas,r=ArrayUtils.findItemByKey(s,"seatNo",i);return r.win?(n="win_font_b_png",o="game_win_mp3"):(n="lose_font_b_png",o="game_lose_mp3"),t.push(n),t.push(o),t},n.prototype.showChipsFlyAnimation=function(){var e=this.findWinnerSeatUIs(),t=this.findLoserSeatUIs();if(2==e.length){var n=t[0];e.forEach(function(e){e.setImgWinner(!0);var t=new ChipsFly(10,n.getGrpParent(),e.getGrpParent());t.fly()})}else{var o=e[0];if(null==o)return;o.setImgWinner(!0),t.forEach(function(e){var t=new ChipsFly(10,e.getGrpParent(),o.getGrpParent());t.fly()})}},n.prototype.updateAllUserScoreAndPopUpChipsNum=function(){var t=this,n=e.ExtraAttribute.get().userDatas;n.forEach(function(e){var n=t.getSeatUI(e.seatNo);n.setLabScore(String(e.score));var o=new PopTips;o.launch(n.getGrpParent(),e.awarded.toString())})},n.prototype.findWinnerSeatUIs=function(){for(var t=new Array,n=e.ExtraAttribute.get().userDatas,o=0;o<n.length;o++){var i=n[o];if(i.win){var s=this.getSeatUI(i.seatNo);t.push(s)}}return t},n.prototype.findLoserSeatUIs=function(){for(var t=new Array,n=e.ExtraAttribute.get().userDatas,o=0;o<n.length;o++){var i=n[o];if(!i.win){var s=this.getSeatUI(i.seatNo);t.push(s)}}return t},n.prototype.subGameEndRes=function(){var t=e.Locales.get()["subgame.continue.countdown"],n=new CountDownTimer(t);this.grpTimer.addChild(n),n.timeStart(3)},n.prototype.gameEndRes=function(e){var t=this,n=e.content,o=new CountDownTimer(n);this.grpTimer.addChild(o),o.onComplete(function(){SceneManager.getInstance().popScene(t)}),o.timeStart(5)},n.prototype.resetSelectedPoker=function(){e.ExtraAttribute.get().pokerSpritesInHands.forEach(function(e){e.getSelected()&&e.setSelected(!1)})},n.prototype.playPokersPrompt=function(){var t,n=e.ExtraAttribute.get().lastSeatPlayed,o=e.PokerUtils.parsePokersFromPokerSprites(e.ExtraAttribute.get().pokerSpritesInHands);if(this.getMySeatNo()!=n){var i=e.PokerUtils.parsePokersFromPokerSprites(e.ExtraAttribute.get().LastPokersPlayed);t=e.PokerSeekUtils.seekBiggerHand(o,i)}else t=e.PokerSeekUtils.randomPickOne(o);0!=t.length&&(this.deSelectPokerSpritesInHands(),t.forEach(function(t){e.ExtraAttribute.get().pokerSpritesInHands.forEach(function(e){t==e.getPoker()&&e.setSelected(!0)})}))},n.prototype.deSelectPokerSpritesInHands=function(){for(var t=e.ExtraAttribute.get().pokerSpritesInHands,n=0;n<t.length,n++;)t[n].setSelected(!1)},n.prototype.lastHandAutoFollow=function(){var t=e.ExtraAttribute.get().pokerSpritesInHands,n=e.PokerUtils.parsePokersFromPokerSprites(t),o=e.PokerUtils.parsePokersFromPokerSprites(e.ExtraAttribute.get().LastPokersPlayed),i=e.PokerSeekUtils.seekBiggerHand(n,o);if(i.length==n.length){for(var s=t.length-1;s>=0;--s){t[s].setSelected(!0);var r=new e.PokerSprite(t[s].getPoker(),GlobalConstants.POKER_M_W,!1);e.ExtraAttribute.get().pokersToBeVerified.push(r)}return this.playPokersReq(e.ExtraAttribute.get().pokersToBeVerified),!0}return!1},n.prototype.lastHandAutoActivePlay=function(){var t=e.ExtraAttribute.get().pokerSpritesInHands,n=e.PokerUtils.parsePokersFromPokerSprites(t),o=e.PokerTypeUtils.getType(n);if(null!=o&&void 0!=o){if(o.getType()==e.PokerTypeUtils.Four2Single||o.getType()==e.PokerTypeUtils.Four2Pairs)return!1;for(var i=t.length-1;i>=0;--i){t[i].setSelected(!0);var s=new e.PokerSprite(t[i].getPoker(),GlobalConstants.POKER_M_W,!1);e.ExtraAttribute.get().pokersToBeVerified.push(s)}return this.playPokersReq(e.ExtraAttribute.get().pokersToBeVerified),!0}return!1},n.prototype.playPokersPass=function(){this.playPokersReq(new Array)},n.prototype.playPokersGo=function(){var t=e.ExtraAttribute.get().pokerSpritesInHands;e.ExtraAttribute.get().pokersToBeVerified=[];for(var n=t.length-1;n>=0;--n)if(t[n].getSelected()){var o=new e.PokerSprite(t[n].getPoker(),GlobalConstants.POKER_M_W,!1);e.ExtraAttribute.get().pokersToBeVerified.push(o)}if(0==e.ExtraAttribute.get().pokersToBeVerified.length)return void TipsScene.getInstance().show(e.Locales.get()["play.Pokers.error"],!1,null,this,!0);var i=e.PokerUtils.parsePokersFromPokerSprites(e.ExtraAttribute.get().pokersToBeVerified);return null==e.PokerTypeUtils.getType(i)?void TipsScene.getInstance().show(e.Locales.get()["play.Pokers.error"],!1,null,this,!0):void this.playPokersReq(e.ExtraAttribute.get().pokersToBeVerified)},n.prototype.playPokersReq=function(t){var n=EventType.GAME_DDZ,o=new e.PlayPokersReq;if(o.cmd=e.CommandType.PLAY_POKERS_REQ,0==t.length)o.pokers=null,Network.getInstance().send(new EventReq(n,o));else{var i=e.PokerUtils.parsePokerIdsFromPokerSprites(t);o.pokers=i,Network.getInstance().request(new EventReq(n,o),this.onPlayPokersReqSuccess.bind(this),this.onPlayPokersReqError.bind(this))}e.ExtraAttribute.get().lastSeatPlayed!=e.ExtraAttribute.get().currentSeatNo&&SoundManager.getInstance().playEffect("out_card_mp3")},n.prototype.removePlayedPokersFromMyHand=function(){if(this.getMySeatNo()==e.ExtraAttribute.get().lastSeatPlayed){var t=e.ExtraAttribute.get().LastPokersPlayed,n=e.PokerUtils.removePokerSprites(e.ExtraAttribute.get().pokerSpritesInHands,t);e.ExtraAttribute.get().pokerSpritesInHands=n,this.updateMyPokersInHand()}},n.prototype.onPlayPokersReqSuccess=function(t){console.log("onPlayPokersReqSuccess:"+JSON.stringify(t.args)),this.grpPokerControls.visible=!1,this.clearMyTimer();var n=e.ExtraAttribute.get().pokersToBeVerified,o=e.PokerUtils.removePokerSprites(e.ExtraAttribute.get().pokerSpritesInHands,n);e.ExtraAttribute.get().pokerSpritesInHands=o,e.ExtraAttribute.get().LastPokersPlayed=n,e.ExtraAttribute.get().lastSeatPlayed=this.getMySeatNo(),this.updateMyPokersInHand()},n.prototype.onPlayPokersReqError=function(t){console.log("onPlayPokersReqError:"+JSON.stringify(t.args)),TipsScene.getInstance().show(e.Locales.get()["play.Pokers.error"],!1,null,this,!0)},n.prototype.updateMyPokersInHand=function(){var t=this.getMySeaUI();if(null!=t){var n=e.ExtraAttribute.get().pokerSpritesInHands;n=e.PokerUtils.sortDescPokerSprites(n),t.getGrpPokersInHand().removeChildren();for(var o=0;o<n.length;o++)t.getGrpPokersInHand().addChild(n[o]);this.resetSelectedPoker(),GlobalUtils.setHorizontalLayout(t.getGrpPokersInHand(),e.Constants.POKERS_IN_HAND_GAP,t.getAlignment())}},n.prototype.setMyPokersInHand=function(){var t=this.getMySeaUI();t.getGrpPokersInHand().removeChildren();for(var n=e.ExtraAttribute.get().pokerSpritesInHands,o=0;o<n.length;o++)t.getGrpPokersInHand().addChild(n[o]);this.resetSelectedPoker(),GlobalUtils.setHorizontalLayout(t.getGrpPokersInHand(),e.Constants.POKERS_IN_HAND_GAP,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.setPokersNumOfAllSeatUIs=function(){var t=this,n=e.ExtraAttribute.get().userDatas;null!=n&&0!=n.length&&n.forEach(function(e){var n=t.getSeatUI(e.seatNo);n.setLabPokersNum(String(e.pokersNum))})},n.prototype.reloadDataReq=function(){console.log("请求数据重载.");var t=EventType.GAME_DDZ,n=new e.ReloadDataReq;n.cmd=e.CommandType.RELOAD_DATA_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},n.prototype.reloadDataRes=function(t){var n=this;if(this.grpCallLandlord.visible=!1,this.grpAddScore.visible=!1,this.grpPokerControls.visible=!1,e.State[e.State.NONE]!=t.state&&e.State[e.State.WAITTING]!=t.state){if(this.grpReadyAndInvite.visible=!1,this.setLabRoundNums(),e.State[e.State.START]==t.state){var o=new CountDownTimer(e.Locales.get()["start.game.countdown"]);return this.grpTimer.addChild(o),void o.timeStart(t.startGameTimeout)}if(this.updateLandlordScore(t.landLordScore),this.setMyPokersInHand(),this.setPokersNumOfAllSeatUIs(),this.setBottomPokers(t.bottomPokers),e.State[e.State.DEALPOKERS]!=t.state){if(this.clearImgBeReadyOfAllSeatUIs(),this.isMeHosted()&&(this.grpHost.visible=!0),e.State[e.State.CALLLANDLORD]==t.state)return void this.showTimer(t.callLandlordTimeout);if(e.State[e.State.NOLANDLORD]==t.state){var o=new CountDownTimer(e.Locales.get()["no.landlord.countdown"]);return this.grpTimer.addChild(o),void o.timeStart(t.noLandlordTimeout)}var i=this.getSeatUI(t.landLordSeatNo);if(null!=i&&i.setImgLandlord(!0),e.State[e.State.HASLANDLORD]!=t.state){if(e.State[e.State.ADDSCORE]==t.state)return void this.showTimer(t.addScoreTimeout);if(e.State[e.State.PLAYPOKERS]==t.state)return void this.showTimer(t.playPokersTimeout);var s=t.userDatas;null!=s&&s.length>0&&s.forEach(function(e){var t=n.getSeatUI(e.seatNo);null!=t&&(n.showUserPokers(t,e),t.setLabScore(String(e.score)),e.win&&t.setImgWinner(!0))}),e.State[e.State.SHOWDOWN]!=t.state&&this.subGameEndRes()}}}},n.prototype.leaveRoom=function(){var e=EventType.ROOM_LEAVE,t=new RoomLeaveReq,n=new EventReq(e,t);Network.getInstance().request(n,this.onLeaveRoomSuccess.bind(this),this.onLeaveRoomError.bind(this))},n.prototype.onLeaveRoomSuccess=function(e){console.log("onRoomLeaveSuccess:"+e.args()),RoomService.getInstance().setRoom(null)},n.prototype.onLeaveRoomError=function(e){console.log("onError:"+e.args()),TipsScene.getInstance().show(e.getContent(),!1,null,this,!0)},n}(eui.Component);e.TableScene=t,__reflect(t.prototype,"Ddz.TableScene",["eui.UIComponent","egret.DisplayObject"])}(Ddz||(Ddz={}));var Ddz;!function(e){var t=function(){function e(){}return e.pokerTypesToImage={Boom:"qznn_cow_x_png",KingBoom:"qznn_cow_12_png",3:"qznn_cow_11_png",4:"qznn_cow_13_png",5:"qznn_cow_x_png",6:"qznn_cow_x_png",7:"qznn_cow_x_png",8:"qznn_cow_10_png",9:"qznn_cow_9_png",10:"qznn_cow_8_png",11:"qznn_cow_7_png",12:"qznn_cow_6_png",13:"qznn_cow_5_png",14:"qznn_cow_4_png",15:"qznn_cow_3_png",16:"qznn_cow_2_png",17:"qznn_cow_1_png",18:"qznn_cow_0_png",fold:"qznn_fold_png"},e.lastActionToImage={1:"qznn_cow_x_png",2:"qznn_cow_12_png",3:"qznn_cow_11_png",4:"qznn_cow_13_png",5:"qznn_cow_x_png",6:"qznn_cow_x_png",7:"qznn_cow_x_png",8:"qznn_cow_10_png",9:"qznn_cow_9_png",10:"qznn_cow_8_png",11:"qznn_cow_7_png",12:"qznn_cow_6_png",13:"qznn_cow_5_png",14:"qznn_cow_4_png",15:"qznn_cow_3_png",16:"qznn_cow_2_png",17:"qznn_cow_1_png",18:"qznn_cow_0_png",fold:"qznn_fold_png"},e.pokerTypesToSound={1:"ops_error_mp3",2:"nn_bomb_mp3",3:"nn_5hua_mp3",4:"nn_5xiao_mp3",5:"ops_error_mp3",6:"ops_error_mp3",7:"ops_error_mp3",8:"nn_niu10_mp3",9:"nn_niu9_mp3",10:"nn_niu8_mp3",11:"nn_niu7_mp3",12:"nn_niu6_mp3",13:"nn_niu5_mp3",14:"nn_niu4_mp3",15:"nn_niu3_mp3",16:"nn_niu2_mp3",17:"nn_niu1_mp3",18:"nn_niu0_mp3",fold:"ops_error_mp3"},e}();e.Utils=t,__reflect(t.prototype,"Ddz.Utils")}(Ddz||(Ddz={}));var Email;!function(e){var t=function(){function e(){}return e.GET_RECEIVED_EMAILS_REQ="Get.Received.Emails.Req",e.GET_RECEIVED_EMAILS_RES="Get.Received.Emails.Res",e.GET_SENT_EMAILS_REQ="Get.Sent.Emails.Req",e.GET_SENT_EMAILS_RES="Get.Sent.Emails.Res",e.GET_EMAIL_REQ="Get.Email.Req",e.GET_EMAIL_RES="Get.Email.Res",e.SEND_EMAIL_REQ="Send.Email.Req",e.SEND_EMAIL_RES="Send.Email.Res",e.DELETE_EMAIL_REQ="Delete.Email.Req",e.DELETE_EMAIL_RES="Delete.Email.Res",e}();e.CommandType=t,__reflect(t.prototype,"Email.CommandType")}(Email||(Email={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.sec=0,t.perNumber=0,t.once(egret.Event.ADDED_TO_STAGE,function(e){t.createLoadingTextField(),t.createLoadingBar()},t),t}return __extends(t,e),t.prototype.createLoadingBar=function(){var e=new egret.Bitmap(RES.getRes("loading_png"));e.x=0,e.width=this.stage.stageWidth,e.height=this.stage.stageHeight,this.addChildAt(e,0);var t=(egret.Capabilities.boundingClientHeight,egret.Capabilities.boundingClientWidth,egret.Capabilities.isMobile),n=new egret.Rectangle(12,0,43,22),o=new egret.Rectangle(15,0,51,22),i=new egret.Bitmap(RES.getRes("loadingBarBg_png"));i.width=400,i.height=22,i.scale9Grid=n,this.addChild(i),this.bar=new egret.Bitmap(RES.getRes("loadingBarCur_png")),this.bar.width=400,this.bar.height=22,this.bar.scale9Grid=o,this.bar.visible=!1,this.addChild(this.bar),t?(i.x=this.stage.stageWidth/2-i.width/2,i.y=this.stage.stageHeight-100,this.textField.y=this.stage.stageHeight-150):(i.x=this.stage.stageWidth/2-i.width/2,i.y=540,this.textField.y=490),this.bar.x=i.x,this.bar.y=i.y},t.prototype.createLoadingTextField=function(){this.textField=new egret.TextField,this.textField.size=22,this.textField.y=this.stage.stageHeight-280,this.textField.textAlign=egret.HorizontalAlign.CENTER,this.textField.width=this.stage.stageWidth,this.textField.filters=[new egret.DropShadowFilter(2,45,2185068,1,2,2)],this.addChildAt(this.textField,2)},t.prototype.onProgress=function(e,t){1==e&&(this.perNumber=t/10),this.sec=e/this.perNumber*10;var n=this.sec.toFixed(0);n/=100,this.bar.scaleX=e/t,this.bar.visible=!0,this.textField.text="好运即将开启..."+this.sec.toFixed(0)+" %"},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Email;!function(e){var t=function(){function e(){}return e}();e.EmailReq=t,__reflect(t.prototype,"Email.EmailReq");var n=function(){function e(){}return e}();e.EmailRes=n,__reflect(n.prototype,"Email.EmailRes");var o=function(){function e(){}return e}();e.Email=o,__reflect(o.prototype,"Email.Email")}(Email||(Email={}));var Email;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.emailData&&(this.emailData=new t),this.emailData},t.prototype.getEmailReq=function(t){console.log("请求邮件.");var n=EventType.EMAIL_MGMT,o=new e.EmailReq;o.cmd=e.CommandType.GET_EMAIL_REQ,o.emailId=t;var i=new EventReq(n,o);Network.getInstance().send(i)},t.prototype.getEmailRes=function(e){console.log("取得邮件的响应."),this.email=e.emails[0],this.emailTimeStamp=egret.getTimer()},t.prototype.getemail=function(e){return this.isEmailDataRefreshed(e)?this.email:(this.email=null,void this.getEmailReq(e))},t.prototype.isEmailDataRefreshed=function(t){return null!=this.email&&this.email.id==t&&egret.getTimer()-this.emailTimeStamp<e.Constants.ITEMS_EMAIL_TIMEOUT?!0:!1},t.prototype.getReceivedEmailsReq=function(){console.log("请求已收邮件.");var t=EventType.EMAIL_MGMT,n=new e.EmailReq;n.cmd=e.CommandType.GET_RECEIVED_EMAILS_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},t.prototype.getReceivedEmailsRes=function(t){console.log("取得已收邮件的响应."),this.recvedEmails=t.emails,this.recvedEmailsTimeStamp=egret.getTimer(),e.EmailsScene.getInstance().getReceiveddEmailsRes(t)},t.prototype.getReceivedEmails=function(){return this.isRecvedEmailsDataRefreshed()?this.recvedEmails:void(egret.getTimer()-this.recvedEmailsReqTimeStamp<e.Constants.ITEMS_EMAIL_TIMEOUT||(this.recvedEmailsReqTimeStamp=egret.getTimer(),this.getReceivedEmailsReq()))},t.prototype.isRecvedEmailsDataRefreshed=function(){return null!=this.recvedEmails&&egret.getTimer()-this.recvedEmailsTimeStamp<e.Constants.ITEMS_EMAIL_TIMEOUT?!0:!1},t.prototype.getSentEmailsReq=function(){console.log("请求已发邮件.");var t=EventType.EMAIL_MGMT,n=new e.EmailReq;n.cmd=e.CommandType.GET_SENT_EMAILS_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},t.prototype.getSentEmailsRes=function(t){console.log("取得已发邮件的响应."),this.sentEmails=t.emails,this.sentEmailsTimeStamp=egret.getTimer(),e.EmailsScene.getInstance().getSentEmailsRes(t)},t.prototype.getSentEmails=function(){return this.isSentEmailsDataRefreshed()?this.sentEmails:void(egret.getTimer()-this.sentEmailsReqTimeStamp<e.Constants.ITEMS_EMAIL_TIMEOUT||(this.sentEmailsReqTimeStamp=egret.getTimer(),this.getSentEmailsReq()))},t.prototype.isSentEmailsDataRefreshed=function(){return null!=this.sentEmails&&egret.getTimer()-this.sentEmailsTimeStamp<e.Constants.ITEMS_EMAIL_TIMEOUT?!0:!1},t}();e.EmailData=t,__reflect(t.prototype,"Email.EmailData")}(Email||(Email={}));var Email;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.emailLogic&&(this.emailLogic=new t),this.emailLogic},t.prototype.getCommand=function(e){return e.cmd},t.prototype.processCmd=function(t){var n=null,o="",i=this.getCommand(t);switch(i){case e.CommandType.GET_RECEIVED_EMAILS_RES:console.log("取得已收邮件的响应."),n=this.getReceivedEmailsRes(t);break;case e.CommandType.GET_SENT_EMAILS_RES:console.log("取得已发邮件的响应."),n=this.getSentEmailsRes(t);break;case e.CommandType.GET_EMAIL_RES:console.log("取得邮件的响应."),n=this.getEmailRes(t);break;default:o="命令:"+i+"不存在.",n=new FuncResult(!1,o)}return n},t.prototype.getReceivedEmailsRes=function(t){var n=null,o=t;return e.EmailData.getInstance().getReceivedEmailsRes(o),n},t.prototype.getSentEmailsRes=function(t){var n=null,o=t;return e.EmailData.getInstance().getSentEmailsRes(o),n},t.prototype.getEmailRes=function(t){var n=null,o=t;return e.EmailData.getInstance().getEmailRes(o),n},t}();e.EmailLogic=t,__reflect(t.prototype,"Email.EmailLogic")}(Email||(Email={}));var Email;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="EmailSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.emailScene&&(this.emailScene=new n),this.emailScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnReply.setClick(function(){e.showSendEmailSceneWin()})},n.prototype.showSendEmailSceneWin=function(){console.log("显示发送邮件的窗口"),SceneManager.getInstance().pushScene(e.SendEmailScene.getInstance(this.email))},n.prototype.setEmailId=function(e){this.email=null,this.emailId=e,this.syncGetEmail(this.emailId)},n.prototype.syncGetEmail=function(t){var n=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return n.getEmailData(String(t))},!0,500,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),n.updateEmailData()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getEmailData=function(t){console.log("取得邮件.");var n=e.EmailData.getInstance().getemail(t);return null!=n?(this.email=n,!0):!1},n.prototype.updateEmailData=function(){null!=this.email&&(UserService.getInstance().getUser().id==this.email.sender?this.btnReply.visible=!1:this.btnReply.visible=!0,this.labTitle.text=String(this.email.title),this.labSender.text=String(this.email.sender),this.labContent.text=String(this.email.content),this.labReceivedDate.text=String(GlobalUtils.dateFormat(this.email.receivedDate)))},n}(eui.Component);e.EmailScene=t,__reflect(t.prototype,"Email.EmailScene",["eui.UIComponent","egret.DisplayObject"])}(Email||(Email={}));var Email;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.systemEmails=new Array,e.userEmails=new Array,e.sentEmails=new Array,e.skinName="EmailsSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),e.getReceivedEmailsReq()},e),e}return __extends(n,t),n.getInstance=function(){return null==this.emailsScene&&(this.emailsScene=new n),this.emailsScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.initTabMenu(),this.emailRadioBtn.group.addEventListener(eui.UIEvent.CHANGE,function(t){var n=t.target;e.vsEmails.selectedIndex=n.selectedValue,e.sendGetDataReqs(),SoundManager.getInstance().playEffect("btn_click_mp3")},this),this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh1.setClick(function(){e.getReceivedEmailsReq()}),this.btnRefresh2.setClick(function(){e.getReceivedEmailsReq()}),this.btnRefresh3.setClick(function(){e.getSentEmailsReq()}),this.btnSendEmailWin.setClick(function(){e.showSendEmailSceneWin()})},n.prototype.initTabMenu=function(){this.grpSystemEmails.horizontalCenter=0,this.grpSystemEmails.verticalCenter=0,this.vsEmails.addChild(this.grpSystemEmails),this.grpUserEmails.horizontalCenter=0,this.grpUserEmails.verticalCenter=0,this.vsEmails.addChild(this.grpUserEmails),this.grpSentEmails.horizontalCenter=0,this.grpSentEmails.verticalCenter=0,this.vsEmails.addChild(this.grpSentEmails),this.vsEmails.selectedIndex=0},n.prototype.sendGetDataReqs=function(){0==this.vsEmails.selectedIndex||1==this.vsEmails.selectedIndex?this.getReceivedEmailsReq():this.getSentEmailsReq()},n.prototype.getReceivedEmailsReq=function(){console.log("请求已收邮件."),null!=this.systemEmails&&egret.getTimer()-this.systemEmailsTimeStamp<e.Constants.ITEMS_EMAIL_TIMEOUT||null!=this.userEmails&&egret.getTimer()-this.userEmailsTimeStamp<e.Constants.ITEMS_EMAIL_TIMEOUT||e.EmailData.getInstance().getReceivedEmails()},n.prototype.getReceiveddEmailsRes=function(t){console.log("取得已收邮件的响应."),this.systemEmails=new Array,this.userEmails=new Array;var n=t.emails;if(null!=n&&0!=n.length){for(var o=0;o<n.length;o++){var i=n[o];i.receiver==e.Constants.SYSTEM_ALL_UID?this.systemEmails.push(i):this.userEmails.push(i)}this.systemEmailsTimeStamp=egret.getTimer(),this.userEmailsTimeStamp=egret.getTimer(),this.addSystemEmailsItems(),this.addUserEmailsItems()}},n.prototype.addSystemEmailsItems=function(){null!=this.systemEmails&&0!=this.systemEmails.length?this.lablistSystemEmailsNoData.visible=!1:this.lablistSystemEmailsNoData.visible=!0,this.listSystemEmails.dataProvider=this.systemEmailsArray=new eui.ArrayCollection,this.listSystemEmails.itemRenderer=e.ItemEmail;var t=this.systemEmails;this.systemEmailsArray.source=t,this.systemEmailsArray.refresh()},n.prototype.addUserEmailsItems=function(){null!=this.userEmails&&0!=this.userEmails.length?this.lablistUserEmailsNoData.visible=!1:this.lablistUserEmailsNoData.visible=!0,this.listUserEmails.dataProvider=this.userEmailsArray=new eui.ArrayCollection,this.listUserEmails.itemRenderer=e.ItemEmail;var t=this.userEmails;this.userEmailsArray.source=t,this.userEmailsArray.refresh()},n.prototype.changeEmailsList=function(e){var t,n=new Array;0==this.vsEmails.selectedIndex?(n=this.systemEmails,t=ArrayUtils.findItemByKey(n,"id",e),null!=t&&(t.read=!0,this.addSystemEmailsItems())):1==this.vsEmails.selectedIndex?(n=this.userEmails,t=ArrayUtils.findItemByKey(n,"id",e),null!=t&&(t.read=!0,this.addUserEmailsItems())):(n=this.sentEmails,t=ArrayUtils.findItemByKey(n,"id",e),null!=t&&(t.read=!0,this.addSentEmailsItems()))},n.prototype.refreshEmailsList=function(e){var t=new Array;0==this.vsEmails.selectedIndex?(t=this.systemEmails,ArrayUtils.removeItemByKey(t,"id",e),this.addSystemEmailsItems()):1==this.vsEmails.selectedIndex?(t=this.userEmails,ArrayUtils.removeItemByKey(t,"id",e),this.addUserEmailsItems()):(t=this.sentEmails,ArrayUtils.removeItemByKey(t,"id",e),this.addSentEmailsItems())},n.prototype.getSentEmailsReq=function(){console.log("请求我发送的邮件."),null!=this.sentEmails&&egret.getTimer()-this.sentEmailsTimeStamp<e.Constants.ITEMS_EMAIL_TIMEOUT||e.EmailData.getInstance().getSentEmails()},n.prototype.getSentEmailsRes=function(e){console.log("取得发送的邮件的响应."),this.sentEmails=e.emails,this.sentEmailsTimeStamp=egret.getTimer(),this.addSentEmailsItems()},n.prototype.addSentEmailsItems=function(){null!=this.sentEmails&&0!=this.sentEmails.length?this.lablistSentEmailsNoData.visible=!1:this.lablistSentEmailsNoData.visible=!0,this.listSentEmails.dataProvider=this.sentEmailsArray=new eui.ArrayCollection,this.listSentEmails.itemRenderer=e.ItemEmail;var t=this.sentEmails;this.sentEmailsArray.source=t,this.sentEmailsArray.refresh()},n.prototype.showSendEmailSceneWin=function(){console.log("显示发送邮件的窗口"),SceneManager.getInstance().pushScene(e.SendEmailScene.getInstance(null))},n}(eui.Component);e.EmailsScene=t,__reflect(t.prototype,"Email.EmailsScene",["eui.UIComponent","egret.DisplayObject"])}(Email||(Email={}));var Email;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemEmailSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){var e=this;this.btnView.setClick(function(){e.showEmailSceneWin()}),this.btnDelete.setClick(function(){e.deleteEmailReq()})},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.emailId=this.data.id,null!=this.data.read&&this.data.read?this.imgEmailNotRead.visible=!1:this.imgEmailNotRead.visible=!0,this.labTitle.text=String(this.data.title),this.labUserId.text=String(this.data.sender),this.labCreateTime.text=String(GlobalUtils.dateFormat(this.data.receivedDate)),null!=this.data.receiver&&this.data.receiver==e.Constants.SYSTEM_ALL_UID?this.btnDelete.visible=!1:this.btnDelete.visible=!0},n.prototype.showEmailSceneWin=function(){console.log("显示发送邮件的窗口");var t=e.EmailScene.getInstance();t.setEmailId(String(this.emailId)),SceneManager.getInstance().pushScene(t),e.EmailsScene.getInstance().changeEmailsList(String(this.emailId))},n.prototype.deleteEmailReq=function(){console.log("删除邮件的请求");var t=EventType.EMAIL_MGMT,n=new e.EmailReq;n.cmd=e.CommandType.DELETE_EMAIL_REQ,n.emailId=String(this.data.id);var o=new EventReq(t,n);Network.getInstance().request(o,this.onDeleteEmailSuccess.bind(this),this.onDeleteEmailError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onDeleteEmailSuccess=function(t){console.log("onDeleteMemberSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),e.EmailsScene.getInstance().refreshEmailsList(this.data.id),TipsScene.getInstance().showInfo(t.getContent())},n.prototype.onDeleteEmailError=function(e){console.log("onDeleteMemberError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.ItemRenderer);e.ItemEmail=t,__reflect(t.prototype,"Email.ItemEmail")}(Email||(Email={}));var Email;!function(e){var t=function(){function e(){}return e.get=function(){return e.CN},e.CN={"Network.Timeout.Error":"网络超时,请稍后重试","Network.Common.Error":"网络错误,请稍后重试","Email.User.Id.Error":"请输入有效会员ID!","Email.Title.Error":"请输入有效的主题!","Email.Content.Error":"请输入有效的内容!"},e}();e.Locales=t,__reflect(t.prototype,"Email.Locales")}(Email||(Email={}));var Email;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.skinName="SendEmailSkin",n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(n.stage,n)},n),n.updateEmailData(e),n}return __extends(n,t),n.getInstance=function(e){return null==this.sendEmailScene&&(this.sendEmailScene=new n(e)),this.sendEmailScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnSendEmail.setClick(function(){e.sendEmailReq()})},n.prototype.validateTxtFields=function(){return 6!=this.txtReceiver.text.trim().length?(TipsScene.getInstance().showError(e.Locales.get()["Email.User.Id.Error"]),!1):""==this.txtTitle.text.trim()||this.txtTitle.text.length>30||this.txtTitle.text.length<2?(TipsScene.getInstance().showError(e.Locales.get()["Email.Title.Error"]),!1):""==this.txtContent.text.trim()||Number(this.txtContent.text.trim())>500||Number(this.txtContent.text.trim())<2?(TipsScene.getInstance().showError(e.Locales.get()["Email.Content.Error"]),!1):!0},n.prototype.updateEmailData=function(t){null!=t&&(this.txtReceiver.text=String(t.sender),this.txtTitle.text=e.Constants.EMAIL_REPLY_PREFIX+String(t.content))},n.prototype.sendEmailReq=function(){if(console.log("发送邮件的请求"),this.validateTxtFields()){var t=EventType.EMAIL_MGMT,n=new e.EmailReq;n.cmd=e.CommandType.SEND_EMAIL_REQ,n.receiver=String(this.txtReceiver.text.trim()),n.title=String(this.txtTitle.text.trim()),n.content=String(this.txtContent.text.trim());var o=new EventReq(t,n);Network.getInstance().request(o,this.onSendEmailSuccess.bind(this),this.onSendEmailError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.onSendEmailSuccess=function(e){var t=this;console.log("onSendEmailSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().confirm(e.getContent(),function(){t.close()
})},n.prototype.onSendEmailError=function(e){console.log("onSendEmailError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.SendEmailScene=t,__reflect(t.prototype,"Email.SendEmailScene",["eui.UIComponent","egret.DisplayObject"])}(Email||(Email={}));var Feedback;!function(e){var t=function(){function e(){}return e.GET_FEEDBACKS_REQ="Get.FeedBacks.Req",e.GET_FEEDBACKS_RES="Get.FeedBacks.Res",e.GET_FEEDBACK_REQ="Get.FeedBack.Req",e.GET_FEEDBACK_RES="Get.FeedBack.Res",e.SEND_FEEDBACK_REQ="Send.FeedBack.Req",e.SEND_FEEDBACK_RES="Send.FeedBack.Res",e.SEND_RESPONSE_REQ="Send.Response.Req",e.SEND_RESPONSE_RES="Send.Response.Res",e}();e.CommandType=t,__reflect(t.prototype,"Feedback.CommandType")}(Feedback||(Feedback={}));var Feedback;!function(e){var t=function(){function e(){}return e.ITEMS_FEEDBACK_TIMEOUT=5e3,e.EVENT_FEEDBACK_RELOAD_DATA="Event.Feedback.Reload.Data",e}();e.Constants=t,__reflect(t.prototype,"Feedback.Constants")}(Feedback||(Feedback={}));var Feedback;!function(e){var t=function(){function e(){}return e}();e.FeedbackReq=t,__reflect(t.prototype,"Feedback.FeedbackReq");var n=function(){function e(){}return e}();e.FeedbackRes=n,__reflect(n.prototype,"Feedback.FeedbackRes");var o=function(){function e(){}return e}();e.Feedback=o,__reflect(o.prototype,"Feedback.Feedback");var i=function(){function e(){}return e}();e.FBResponse=i,__reflect(i.prototype,"Feedback.FBResponse")}(Feedback||(Feedback={}));var Feedback;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.feedbackData&&(this.feedbackData=new t),this.feedbackData},t.prototype.getFeedbackReq=function(t){console.log("请求反馈.");var n=EventType.FEEDBACK_MGMT,o=new e.FeedbackReq;o.cmd=e.CommandType.GET_FEEDBACK_REQ,o.feedbackId=t;var i=new EventReq(n,o);Network.getInstance().send(i)},t.prototype.getFeedbackRes=function(e){console.log("取得反馈的响应."),this.feedback=e.feedbacks[0],this.feedbackTimeStamp=egret.getTimer()},t.prototype.getfeedback=function(e){return this.isFeedbackDataRefreshed(e)?this.feedback:(this.feedback=null,void this.getFeedbackReq(e))},t.prototype.isFeedbackDataRefreshed=function(t){return null!=this.feedback&&this.feedback.id==t&&egret.getTimer()-this.feedbackTimeStamp<e.Constants.ITEMS_FEEDBACK_TIMEOUT?!0:!1},t.prototype.getSentFeedbacksReq=function(){console.log("请求已发反馈.");var t=EventType.FEEDBACK_MGMT,n=new e.FeedbackReq;n.cmd=e.CommandType.GET_FEEDBACKS_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},t.prototype.getSentFeedbacksRes=function(t){console.log("取得所有反馈的响应."),this.sentFeedbacks=t.feedbacks,this.sentFeedbacksTimeStamp=egret.getTimer(),e.FeedbacksScene.getInstance().getFeedbacksRes(t)},t.prototype.getSentFeedbacks=function(){return this.isSentFeedbacksDataRefreshed()?this.sentFeedbacks:void(egret.getTimer()-this.sentFeedbacksReqTimeStamp<e.Constants.ITEMS_FEEDBACK_TIMEOUT||(this.sentFeedbacksReqTimeStamp=egret.getTimer(),this.getSentFeedbacksReq()))},t.prototype.isSentFeedbacksDataRefreshed=function(){return null!=this.sentFeedbacks&&egret.getTimer()-this.sentFeedbacksTimeStamp<e.Constants.ITEMS_FEEDBACK_TIMEOUT?!0:!1},t}();e.FeedbackData=t,__reflect(t.prototype,"Feedback.FeedbackData")}(Feedback||(Feedback={}));var Feedback;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.feedbackLogic&&(this.feedbackLogic=new t),this.feedbackLogic},t.prototype.getCommand=function(e){return e.cmd},t.prototype.processCmd=function(t){var n=null,o="",i=this.getCommand(t);switch(i){case e.CommandType.GET_FEEDBACKS_RES:console.log("取得所有反馈的响应."),n=this.getSentFeedbacksRes(t);break;case e.CommandType.GET_FEEDBACK_RES:console.log("取得反馈的响应."),n=this.getFeedbackRes(t);break;default:o="命令:"+i+"不存在.",n=new FuncResult(!1,o)}return n},t.prototype.getSentFeedbacksRes=function(t){var n=null,o=t;return e.FeedbackData.getInstance().getSentFeedbacksRes(o),n},t.prototype.getFeedbackRes=function(t){var n=null,o=t;return e.FeedbackData.getInstance().getFeedbackRes(o),n},t}();e.FeedbackLogic=t,__reflect(t.prototype,"Feedback.FeedbackLogic")}(Feedback||(Feedback={}));var Feedback;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="FeedbackSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.feedbackScene&&(this.feedbackScene=new n),this.feedbackScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()})},n.prototype.showSendFeedbackSceneWin=function(){console.log("显示发送反馈的窗口"),SceneManager.getInstance().pushScene(e.SendFeedbackScene.getInstance())},n.prototype.setFeedbackId=function(e){this.feedback=null,this.feedbackId=e,this.syncGetFeedback(this.feedbackId)},n.prototype.syncGetFeedback=function(t){var n=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return n.getFeedbackData(String(t))},!0,300,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),n.updateFeedbackData()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getFeedbackData=function(t){console.log("取得反馈.");var n=e.FeedbackData.getInstance().getfeedback(t);return null!=n?(this.feedback=n,!0):!1},n.prototype.updateFeedbackData=function(){if(null!=this.feedback){this.labTitle.text=String(this.feedback.title),this.labContent.text=String(this.feedback.content),this.labCreatedDate.text=String(GlobalUtils.dateFormat(this.feedback.createdDate));var t=this.feedback.response;null==t?(this.labResponseDate.text=e.Locales.get()["Feedback.Non.Response.Tips"],this.labResponseContent.text=e.Locales.get()["Feedback.Non.Response.Tips"]):(this.labResponseDate.text=String(GlobalUtils.dateFormat(t.createdDate)),this.labResponseContent.text=String(t.content))}},n}(eui.Component);e.FeedbackScene=t,__reflect(t.prototype,"Feedback.FeedbackScene",["eui.UIComponent","egret.DisplayObject"])}(Feedback||(Feedback={}));var Feedback;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.feedbacks=new Array,e.skinName="FeedbacksSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.feedbacksScene&&(this.feedbacksScene=new n),this.feedbacksScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh.setClick(function(){e.getFeedbacksReq()}),this.btnShowSFSWin.setClick(function(){e.showSendFeedbackScene()}),this.getFeedbacksReq()},n.prototype.showSendFeedbackScene=function(){console.log("显示创建反馈的窗口"),SceneManager.getInstance().pushScene(e.SendFeedbackScene.getInstance())},n.prototype.getFeedbacksReq=function(){console.log("请求发送的反馈."),null!=this.feedbacks&&egret.getTimer()-this.feedbacksTimeStamp<e.Constants.ITEMS_FEEDBACK_TIMEOUT||(SceneManager.getInstance().pushScene(LoadingScene.getInstance()),e.FeedbackData.getInstance().getSentFeedbacks())},n.prototype.getFeedbacksRes=function(e){console.log("取得发送的反馈的响应."),SceneManager.getInstance().popScene(LoadingScene.getInstance()),this.feedbacks=e.feedbacks,this.feedbacksTimeStamp=egret.getTimer(),this.addFeedbacksItems()},n.prototype.addFeedbacksItems=function(){if(null==this.feedbacks||0==this.feedbacks.length)return void(this.labListNoData.visible=!0);this.labListNoData.visible=!1,this.listFeedbacks.dataProvider=this.fbArray=new eui.ArrayCollection,this.listFeedbacks.itemRenderer=e.ItemFeedback;var t=this.feedbacks;this.fbArray.source=t,this.fbArray.refresh()},n}(eui.Component);e.FeedbacksScene=t,__reflect(t.prototype,"Feedback.FeedbacksScene",["eui.UIComponent","egret.DisplayObject"])}(Feedback||(Feedback={}));var Feedback;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemFeedbackSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){var e=this;this.btnView.setClick(function(){e.showFeedbackSceneWin()})},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.feedbackId=this.data.id,this.labTitle.text=String(this.data.title),this.labUserId.text=String(this.data.sender),this.labCreateTime.text=String(GlobalUtils.dateFormat(this.data.createdDate))},n.prototype.showFeedbackSceneWin=function(){console.log("显示发送邮件的窗口");var t=e.FeedbackScene.getInstance();t.setFeedbackId(String(this.feedbackId)),SceneManager.getInstance().pushScene(t)},n}(eui.ItemRenderer);e.ItemFeedback=t,__reflect(t.prototype,"Feedback.ItemFeedback")}(Feedback||(Feedback={}));var Feedback;!function(e){var t=function(){function e(){}return e.get=function(){return e.CN},e.CN={"Network.Timeout.Error":"网络超时,请稍后重试","Network.Common.Error":"网络错误,请稍后重试","Feedback.Non.Response.Tips":"暂无回复!","Feedback.Title.Error":"请输入有效的主题!","Feedback.Content.Error":"请输入有效的内容!"},e}();e.Locales=t,__reflect(t.prototype,"Feedback.Locales")}(Feedback||(Feedback={}));var Feedback;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="SendFeedbackSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.sendFeedbackScene&&(this.sendFeedbackScene=new n),this.sendFeedbackScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnSendFeedback.setClick(function(){e.sendFeedbackReq()})},n.prototype.validateTxtFields=function(){return""==this.txtTitle.text.trim()||this.txtTitle.text.length>30||this.txtTitle.text.length<2?(TipsScene.getInstance().showError(e.Locales.get()["Feedback.Title.Error"]),!1):""==this.txtContent.text.trim()||Number(this.txtContent.text.trim())>500||Number(this.txtContent.text.trim())<2?(TipsScene.getInstance().showError(e.Locales.get()["Feedback.Content.Error"]),!1):!0},n.prototype.sendFeedbackReq=function(){if(console.log("发送反馈的请求"),this.validateTxtFields()){var t=EventType.FEEDBACK_MGMT,n=new e.FeedbackReq;n.cmd=e.CommandType.SEND_FEEDBACK_REQ,n.title=String(this.txtTitle.text.trim()),n.content=String(this.txtContent.text.trim());var o=new EventReq(t,n);Network.getInstance().request(o,this.onSendFeedbackSuccess.bind(this),this.onSendFeedbackError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.onSendFeedbackSuccess=function(e){var t=this;console.log("onSendFeedbackSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().confirm(e.getContent(),function(){t.close()})},n.prototype.onSendFeedbackError=function(e){console.log("onSendFeedbackError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.SendFeedbackScene=t,__reflect(t.prototype,"Feedback.SendFeedbackScene",["eui.UIComponent","egret.DisplayObject"])}(Feedback||(Feedback={}));var GameResult;!function(e){var t=function(){function e(){}return e.ITEM_ROOMS_NUM_PER_PAGE=30,e.ITEMS_CACHE_TIMEOUT=5e3,e.REQUEST_RETRY_LIMIT=5e3,e}();e.Constants=t,__reflect(t.prototype,"GameResult.Constants")}(GameResult||(GameResult={}));var GameResult;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.userRsls=new Array,e.skinName="FinalGameRslSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),e.syncGetRoom()},e),e}return __extends(n,t),n.getInstance=function(){return null==this.finalGameRslScene&&(this.finalGameRslScene=new n),this.finalGameRslScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnShowDetails.setClick(function(){e.showGameRslWin()})},n.prototype.setRoom=function(e){this.roomId=e},n.prototype.setFinalUserRsls=function(e){this.finalUserRsls=e,this.addAllListItems()},n.prototype.setGameRsls=function(e){this.gameRsls=e},n.prototype.syncGetRoom=function(){var t=this;console.log("同步获取房间的数据."),null!=this.roomId&&(SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getRoom()},!0,500,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.addAllListItems()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])}))},n.prototype.getRoom=function(){console.log("取得间的数据.");var t=e.GameRslData.getInstance().getRoom(this.roomId);return e.GameRslData.getInstance().isRoomsDataRefreshed(this.roomId)?null!=t?(this.room=t,null!=t.finalRsls&&this.setFinalUserRsls(t.finalRsls),null!=t.gameRsls&&this.setGameRsls(t.gameRsls),!0):!0:!1},n.prototype.showGameRslWin=function(){console.log("显示房间战绩详情的窗口");var t=e.GameRslsScene.getInstance();t.setGameRsls(this.gameRsls),SceneManager.getInstance().pushScene(t)},n.prototype.addAllListItems=function(){this.addUserRslsItems()},n.prototype.addUserRslsItems=function(){null!=this.finalUserRsls&&0!=this.finalUserRsls.length?this.lablistFinalUserRslsNoData.visible=!1:this.lablistFinalUserRslsNoData.visible=!0,this.listFinalUserRsls.dataProvider=this.finalUserRslsArray=new eui.ArrayCollection,this.listFinalUserRsls.itemRenderer=e.ItemFinalUserRsl;var t=this.finalUserRsls;this.finalUserRslsArray.source=t,this.finalUserRslsArray.refresh()},n}(eui.Component);e.FinalGameRslScene=t,__reflect(t.prototype,"GameResult.FinalGameRslScene",["eui.UIComponent","egret.DisplayObject"])}(GameResult||(GameResult={}));var GameResult;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.gameRslData&&(this.gameRslData=new t),this.gameRslData},t.prototype.getOfflineRoomsReq=function(){console.log("请求离线房间.");var e=EventType.USER_MGMT,t=new UserMgmt.UserMgmtReq;t.cmd=UserMgmt.CommandType.GET_OFFLINEROOMS_REQ;var n=new EventReq(e,t);Network.getInstance().send(n)},t.prototype.getOfflineRoomsRes=function(e){console.log("取得离线的响应."),this.offlineRooms=e.offlineRooms,this.offlineRoomsTimeStamp=egret.getTimer()},t.prototype.getOfflineRooms=function(){return this.isGameRslDataRefreshed()?this.offlineRooms:void(egret.getTimer()-this.offlineRoomsReqTimeStamp<e.Constants.REQUEST_RETRY_LIMIT||(this.offlineRoomsReqTimeStamp=egret.getTimer(),this.getOfflineRoomsReq()))},t.prototype.isGameRslDataRefreshed=function(){return null!=this.offlineRooms&&egret.getTimer()-this.offlineRoomsTimeStamp<e.Constants.ITEMS_CACHE_TIMEOUT?!0:!1},t.prototype.getRoomReq=function(e){console.log("请求房间.");var t=EventType.ROOM_LIST,n=new RoomListReq;n.cmd=RoomList.CommandType.GET_ROOM,n.roomId=e;var o=new EventReq(t,n);Network.getInstance().send(o)},t.prototype.roomListRes=function(e){console.log("取得房间的响应."),null!=e.rooms&&1==e.rooms.length&&(this.room=e.rooms[0]),this.roomTimeStamp=egret.getTimer()},t.prototype.getRoom=function(t){return this.isRoomsDataRefreshed(t)?this.room:void(egret.getTimer()-this.roomReqTimeStamp<e.Constants.REQUEST_RETRY_LIMIT||(this.roomReqTimeStamp=egret.getTimer(),this.getRoomReq(t)))},t.prototype.isRoomsDataRefreshed=function(t){return null!=this.room&&this.room.id==t&&egret.getTimer()-this.roomTimeStamp<e.Constants.ITEMS_CACHE_TIMEOUT?!0:!1},t}();e.GameRslData=t,__reflect(t.prototype,"GameResult.GameRslData")}(GameResult||(GameResult={}));var GameResult;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.gameRsls=new Array,e.skinName="GameRslsSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e)},e),e}return __extends(n,t),n.getInstance=function(){return null==this.gameRslsScene&&(this.gameRslsScene=new n),this.gameRslsScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()})},n.prototype.setGameRsls=function(e){this.gameRsls=e,this.addAllListItems()},n.prototype.addAllListItems=function(){this.addGameRslsItems()},n.prototype.addGameRslsItems=function(){null!=this.gameRsls&&0!=this.gameRsls.length?this.lablistGameRslsNoData.visible=!1:this.lablistGameRslsNoData.visible=!0,this.listGameRsls.dataProvider=this.gameRslsArray=new eui.ArrayCollection,this.listGameRsls.itemRenderer=e.ItemGameRsl;var t=this.gameRsls;this.gameRslsArray.source=t,this.gameRslsArray.refresh()},n}(eui.Component);e.GameRslsScene=t,__reflect(t.prototype,"GameResult.GameRslsScene",["eui.UIComponent","egret.DisplayObject"])}(GameResult||(GameResult={}));var GameResult;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="ItemFinalUserRslSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.labUserName.text=String(this.data.name),this.labUserId.text=String(this.data.id),this.labAwarded.text=String(this.data.awarded)},t}(eui.ItemRenderer);e.ItemFinalUserRsl=t,__reflect(t.prototype,"GameResult.ItemFinalUserRsl")}(GameResult||(GameResult={}));var GameResult;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.userRsls=new Array,e.skinName="ItemGameRslSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.userRsls=this.data.userRsls,this.labRoundIdx.text=GlobalUtils.stringFormat(e.Locales.get().RoundIdx,String(this.data.roundIdx));var n=40+35*this.userRsls.length;this.height=this.listGameRsl.height=n,this.addUserRslItems()},n.prototype.addUserRslItems=function(){null!=this.userRsls&&0!=this.userRsls.length?this.lablistGameRslNoData.visible=!1:this.lablistGameRslNoData.visible=!0,this.listGameRsl.dataProvider=this.userRslsArray=new eui.ArrayCollection,this.listGameRsl.itemRenderer=e.ItemUserRsl;var t=this.userRsls;this.userRslsArray.source=t,this.userRslsArray.refresh()},n}(eui.ItemRenderer);e.ItemGameRsl=t,__reflect(t.prototype,"GameResult.ItemGameRsl")}(GameResult||(GameResult={}));var GameResult;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemOfflineRoomSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){var e=this;this.btnAction.setClick(function(){e.onBtnClicked()})},n.prototype.onBtnClicked=function(){this.showFinalGameRslWin()},n.prototype.showFinalGameRslWin=function(){console.log("显示房间战绩的窗口");var t=e.FinalGameRslScene.getInstance();t.setRoom(null),t.setFinalUserRsls(this.data.finalRsls),t.setGameRsls(this.data.gameRsls),SceneManager.getInstance().pushScene(t)},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.labRoomId.text=String(this.data.id),this.data.type==RoomType.TEXAS?(this.labBottomTips.text=e.Locales.get()["Lab.Texas.BottomTips"],this.labBottomScore.text=String(this.data.bottomScore)+"/"+String(2*this.data.bottomScore)):(this.labBottomTips.text=e.Locales.get()["Lab.Others.BottomTips"],this.labBottomScore.text=String(this.data.bottomScore));var n=0;null!=this.data.users&&0!=this.data.users.length&&(n=this.data.users.length),this.labUsersNum.text=String(n),this.labRounds.text=String(this.data.rounds),this.labCreateTime.text=String(this.data.createDate)},n.prototype.getUserAwarded=function(e){var t=0,n=this.data.finalRsls;return null==n||0==n.length?t:void 0},n}(eui.ItemRenderer);e.ItemOfflineRoom=t,__reflect(t.prototype,"GameResult.ItemOfflineRoom")}(GameResult||(GameResult={}));var GameResult;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemUserRslSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.labUserId.text=String(this.data.id),null==this.data.dealer||0==this.data.dealer?this.labDealer.text=e.Locales.get().No:this.labDealer.text=e.Locales.get().Yes,this.labSeatNo.text=String(this.data.seatNo),this.labAwarded.text=String(this.data.awarded),null==this.data.win||0==this.data.win?this.labWin.text=e.Locales.get().No:this.labWin.text=e.Locales.get().Yes},n}(eui.ItemRenderer);e.ItemUserRsl=t,__reflect(t.prototype,"GameResult.ItemUserRsl")}(GameResult||(GameResult={}));var GameResult;!function(e){var t=function(){function e(){}return e.get=function(){return e.CN},e.CN={"Btn.Detail":"详情","Lab.Texas.BottomTips":"盲注:","Lab.Others.BottomTips":"底分:",Yes:"是",No:"否",RoundIdx:"第{0}局","Network.Timeout.Error":"网络超时,请稍后重试","Network.Common.Error":"网络错误,请稍后重试"},e}();e.Locales=t,__reflect(t.prototype,"GameResult.Locales")}(GameResult||(GameResult={}));var GameResult;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.offlineRooms=new Array,n.skinName="OfflineRoomsSkin",n.pagedItems=new Dictionary,n.clubId=e,n.addEventListener(eui.UIEvent.COMPLETE,function(){},n),n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(n.stage,n),n.syncGetOfflineRooms()},n),n}return __extends(n,t),n.getInstance=function(e){return null==this.offlineRoomsScene&&(this.offlineRoomsScene=new n(e)),this.offlineRoomsScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh.setClick(function(){e.syncGetOfflineRooms()}),this.btnPageUp.setClick(function(){e.pageIdx<=1?e.pageIdx=1:e.pageIdx--,e.addOfflineRoomsItems(e.pageIdx)}),this.btnPageDown.setClick(function(){e.pageIdx>=e.pagesNum?e.pageIdx=e.pagesNum:e.pageIdx++,e.addOfflineRoomsItems(e.pageIdx)})},n.prototype.syncGetOfflineRooms=function(){var t=this;console.log("同步获取离线房间的数据."),SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getOfflineRooms()},!0,GlobalConstants.WAIT_FOR_INTRVAL_INMS,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.addAllListItems()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getOfflineRooms=function(){console.log("取得离线房间的数据.");var t=e.GameRslData.getInstance().getOfflineRooms();return null!=t?(this.offlineRooms=t,!0):!1},n.prototype.addAllListItems=function(){this.splitAllRoomsIntoPages(),this.addOfflineRoomsItems(this.pageIdx)},n.prototype.splitAllRoomsIntoPages=function(){for(var t=1;this.offlineRooms.length>0;){var n=this.offlineRooms.splice(0,e.Constants.ITEM_ROOMS_NUM_PER_PAGE);this.pagedItems.Add(String(t),n),t++}this.pageIdx=1,this.pagesNum=t-1},n.prototype.addOfflineRoomsItems=function(t){null!=this.pagedItems&&0!=this.pagedItems.Count()?this.lablistOfflineRoomsNoData.visible=!1:this.lablistOfflineRoomsNoData.visible=!0,this.listOfflineRooms.dataProvider=this.offlineRoomsArray=new eui.ArrayCollection,this.listOfflineRooms.itemRenderer=e.ItemOfflineRoom;var n=this.pagedItems.Item(String(t));this.offlineRoomsArray.source=n,this.offlineRoomsArray.refresh(),this.labPagesNum.text=String(t)+"/"+String(this.pagesNum)},n}(eui.Component);e.OfflineRoomsScene=t,__reflect(t.prototype,"GameResult.OfflineRoomsScene",["eui.UIComponent","egret.DisplayObject"])}(GameResult||(GameResult={}));var Hall;!function(e){var t=function(){function e(){}return e.GET_MESSAGES_REQ="Get.Messages.Req",e.GET_MESSAGES_RES="Get.Messages.Res",e.GET_ANNC_REQ="Get.Annc.Req",e.GET_ANNC_RES="Get.Annc.Res",e.GET_KEFU_REQ="Get.Kefu.Req",e.GET_KEFU_RES="Get.Kefu.Res",e.GET_COINMODES_REQ="Get.CoinModes.Req",e.GET_COINMODES_RES="Get.CoinModes.Res",e}();e.CommandType=t,__reflect(t.prototype,"Hall.CommandType")}(Hall||(Hall={}));var Hall;!function(e){var t=function(){function e(){}return e.EICON_WIDTH=220,e.EICON_HEIGHT=280,e.EICON_IMG_BAS="coin_mode_bas_png",e.EICON_IMG_MID="coin_mode_mid_png",e.EICON_IMG_ADV="coin_mode_adv_png",e.EVENT_GET_ANNC="Event.Get.Annc",e.EVENT_GET_MESSAGES="Event.Get.Messages",e.EVENT_GET_COINMODES="Event.Get.CoinModes",e}();e.Constants=t,__reflect(t.prototype,"Hall.Constants")}(Hall||(Hall={}));var Hall;!function(e){var t=function(){function e(){}return e}();e.SystemReq=t,__reflect(t.prototype,"Hall.SystemReq");var n=function(){function e(){}return e}();e.SystemRes=n,__reflect(n.prototype,"Hall.SystemRes");var o=function(){function e(){}return e}();e.Message=o,__reflect(o.prototype,"Hall.Message");var i=function(){function e(){}return e}();e.CoinMode=i,__reflect(i.prototype,"Hall.CoinMode");var s=function(){function e(){}return e}();e.Product=s,__reflect(s.prototype,"Hall.Product");var r=function(){function e(){}return e}();e.ShopOrders=r,__reflect(r.prototype,"Hall.ShopOrders");var a=function(){function e(){}return e}();e.Order=a,__reflect(a.prototype,"Hall.Order")}(Hall||(Hall={}));var Hall;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.hallLogic&&(this.hallLogic=new t),this.hallLogic},t.prototype.getCommand=function(e){return e.cmd},t.prototype.processCmd=function(t){var n=null,o="",i=this.getCommand(t);switch(i){case e.CommandType.GET_ANNC_RES:console.log("取得公告的响应."),n=this.getAnncRes(t);break;case e.CommandType.GET_KEFU_RES:console.log("取得客服的响应."),n=this.getKefuRes(t);break;case e.CommandType.GET_MESSAGES_RES:console.log("取得滚动消息的响应."),n=this.getMessagesRes(t);break;case e.CommandType.GET_COINMODES_RES:console.log("取得金币场的响应."),n=this.getCoinModesRes(t);break;default:o="命令:"+i+"不存在.",n=new FuncResult(!1,o)}return n},t.prototype.getAnncRes=function(t){var n=null,o=t;return e.HallScene.getInstance().getAnncRes(o),n},t.prototype.getKefuRes=function(e){var t=null,n=e;return KeFu.KeFuScene.getInstance().getKefuRes(n),t},t.prototype.getMessagesRes=function(t){var n=null,o=t;return e.HallScene.getInstance().getMessagesRes(o),n},t.prototype.getCoinModesRes=function(t){var n=null,o=t;return e.HallScene.getInstance().getCoinModesRes(o),n},t}();e.HallLogic=t,__reflect(t.prototype,"Hall.HallLogic")}(Hall||(Hall={}));var Hall;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.sendRoomReJoinReq=!1,e.sceneName="HallScene",e.skinName="HallSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),SceneManager.getInstance().popScene(LoginScene.getInstance()),SoundManager.getInstance().playMusic("bg_hall_mp3"),e.getAnncReq(),e.getMessagesReq(),e.getCoinModesReq(),e.refreshUserDataUI(),e.autoJoinRoom()},e),e}return __extends(n,t),n.getInstance=function(){return null==this.hallScene&&(this.hallScene=new n),this.hallScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.imgGrpCoinModeOuter.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.closeGrpCoinMode()},this),this.btnRefresh.setClick(function(){e.getUserData()}),this.btnAddCards.setClick(function(){e.showShopScene()}),this.btnAddCoins.setClick(function(){e.showShopScene()}),this.btnSettings.setClick(function(){e.showSettingScene()}),this.btnFeedback.setClick(function(){e.showFeedbacksScene()}),this.btnKeFu.setClick(function(){e.showKeFuScene()}),this.btnExit.setClick(function(){e.showQuitConfirmationWin()}),this.btnAgent.setClick(function(){e.showAgentScene()}),this.btnEmail.setClick(function(){e.showEmailsScene()}),this.btnCharging.setClick(function(){e.showShopScene()}),this.btnShop.setClick(function(){e.showShopScene()}),this.btnWanFa.setClick(function(){e.showHelpScene()}),this.btnHistory.setClick(function(){e.showGameRslsScene()}),this.btnShare.setClick(function(){e.showShareScene()}),this.btnAcctSetting.setClick(function(){e.showAccountSettingScene()}),this.btnCreateRoom.setClick(function(){e.showCreateRoomScene()}),this.btnJoinRoom.setClick(function(){e.showJoinRoomScene()}),this.btnClubMode.setClick(function(){e.showClubsScene()}),this.btnCoinModeDdz.setClick(function(){e.showGrpDdzCoinMode()}),this.btnCoinModeTexas.setClick(function(){e.showGrpTexasCoinMode()}),this.btnCoinModeZjh.setClick(function(){e.showGrpZjhCoinMode()}),this.btnCoinModeQznn.setClick(function(){e.showGrpQznnCoinMode()}),this.btnCloseGrpCoinMode.setClick(function(){e.closeGrpCoinMode()}),this.preloadScene(),this.scrollingMsgs=new ScrollingMessages(this.grpScrollingMessages),this.scrollingMsgs.onComplete(function(){e.getMessagesReq()}),EventManager.getInstance().addEvent(GlobalConstants.EVENT_USER_DATA,this.refreshUserDataUI.bind(this),null),EventManager.getInstance().addEvent(GlobalConstants.EVENT_USER_DATA,this.roomReJoinReq.bind(this),null),this.stage.addEventListener(egret.Event.ACTIVATE,this.getUserData.bind(this),this),Network.getInstance().setErrorHandler(this.onDisconnected,this)},n.prototype.preloadScene=function(){this.shopScene=Shop.ShopScene.getInstance(),this.agentScene=Agent.AgentScene.getInstance(),this.clubScene=Club.ClubsScene.getInstance()},n.prototype.onDisconnected=function(){this.sendRoomReJoinReq=!1,Network.getInstance().reconnect()},n.prototype.getUserData=function(){var e=EventType.USER_DATA,t=new UserDataReq,n=new EventReq(e,t);Network.getInstance().send(n)},n.prototype.getAnncReq=function(){if(console.log("取得公告"),null==this.anncmnt){var t=EventType.SYSTEM_MGMT,n=new e.SystemReq;n.cmd=e.CommandType.GET_ANNC_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)}},n.prototype.autoJoinRoom=function(){var e=GlobalVars.getInstance().ajRoomId;null!=e&&""!=e.trim()&&JoinRoomScene.getInstance().joinRoomReq(String(e))},n.prototype.logOutReq=function(){console.log("退出游戏"),LocalStorage.setItem(GlobalConstants.RECONNECT_USERNAME,""),LocalStorage.setItem(GlobalConstants.RECONNECT_PASSWORD,"");var e=EventType.LOG_OUT,t=new LogOutReq;t.content="";var n=new EventReq(e,t);Network.getInstance().send(n)},n.prototype.getMessagesReq=function(){console.log("取得滚动消息");var t=EventType.SYSTEM_MGMT,n=new e.SystemReq;n.cmd=e.CommandType.GET_MESSAGES_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},n.prototype.getCoinModesReq=function(){if(console.log("取得金币场配置"),null==this.coinModes||0==this.coinModes.length){var t=EventType.SYSTEM_MGMT,n=new e.SystemReq;n.cmd=e.CommandType.GET_COINMODES_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)}},n.prototype.getAnncRes=function(e){this.anncmnt=e.annc,this.labAnnouncement.text=String(this.anncmnt)},n.prototype.getMessagesRes=function(e){var t=e.messages;if(null!=t&&0!=t.length){for(var n=0;n<t.length;n++){var o={};
o.msg=t[n].content,o.loopNum=3;var i=new ScrollingMessage(o,0);this.scrollingMsgs.pushpaoMaDengMsg(i)}this.scrollingMsgs.start()}},n.prototype.getCoinModesRes=function(e){this.coinModes=e.coinModes},n.prototype.showCreateRoomScene=function(){SceneManager.getInstance().pushScene(CreateRoomScene.getInstance())},n.prototype.showJoinRoomScene=function(){SceneManager.getInstance().pushScene(JoinRoomScene.getInstance())},n.prototype.showShopScene=function(){SceneManager.getInstance().pushScene(this.shopScene)},n.prototype.showAgentScene=function(){SceneManager.getInstance().pushScene(this.agentScene)},n.prototype.showClubsScene=function(){SceneManager.getInstance().pushScene(this.clubScene)},n.prototype.showSettingScene=function(){SceneManager.getInstance().pushScene(Setting.SettingScene.getInstance(this.sceneName))},n.prototype.showQuitConfirmationWin=function(){var t=this,n=e.Locales.get()["Log.Out.Confirmation"];TipsScene.getInstance().confirm(n,function(){t.logOutReq()})},n.prototype.refreshUserDataUI=function(){var e=UserService.getInstance().getUser();null!=e&&(this.labUserId.text=e.id,this.labUserName.text=e.name,this.imgUserAvatar.source=e.avatar,this.labCardNum.text=String(e.cardNum),this.labScore.text=String(e.score))},n.prototype.showKeFuScene=function(){SceneManager.getInstance().pushScene(KeFu.KeFuScene.getInstance())},n.prototype.showEmailsScene=function(){SceneManager.getInstance().pushScene(Email.EmailsScene.getInstance())},n.prototype.showHelpScene=function(){SceneManager.getInstance().pushScene(Help.HelpScene.getInstance())},n.prototype.showFeedbacksScene=function(){SceneManager.getInstance().pushScene(Feedback.FeedbacksScene.getInstance())},n.prototype.showShareScene=function(){Share.ShareScene.getInstance();SceneManager.getInstance().pushScene(Share.ShareScene.getInstance())},n.prototype.showGameRslsScene=function(){SceneManager.getInstance().pushScene(GameResult.OfflineRoomsScene.getInstance(null))},n.prototype.showAccountSettingScene=function(){SceneManager.getInstance().pushScene(UserMgmt.AccountSettingScene.getInstance())},n.prototype.closeGrpCoinMode=function(){this.grpCoinMode.visible=!1},n.prototype.showGrpDdzCoinMode=function(){var t=this;this.grpCoinMode.visible=!0,this.labCoinModeName.text=e.Locales.get()["Ddz.CoinMode.Title"];var n=ArrayUtils.findItemByKey(this.coinModes,"id","DDZ001"),o=new EIcon(e.Constants.EICON_IMG_BAS,e.Constants.EICON_WIDTH,e.Constants.EICON_HEIGHT);o.setLbBottomScoreVal(n.bottomScore),o.setLbMinChipsVal(n.minChips),o.setClick(function(){t.coinModeRoomReq(String(n.id))}),this.grpCoinModeBas.removeChildren(),this.grpCoinModeBas.addChild(o);var i=ArrayUtils.findItemByKey(this.coinModes,"id","DDZ002"),s=new EIcon(e.Constants.EICON_IMG_MID,e.Constants.EICON_WIDTH,e.Constants.EICON_HEIGHT);s.setLbBottomScoreVal(i.bottomScore),s.setLbMinChipsVal(i.minChips),s.setClick(function(){t.coinModeRoomReq(String(i.id))}),this.grpCoinModeMid.removeChildren(),this.grpCoinModeMid.addChild(s);var r=ArrayUtils.findItemByKey(this.coinModes,"id","DDZ003"),a=new EIcon(e.Constants.EICON_IMG_ADV,e.Constants.EICON_WIDTH,e.Constants.EICON_HEIGHT);a.setLbBottomScoreVal(r.bottomScore),a.setLbMinChipsVal(r.minChips),a.setClick(function(){t.coinModeRoomReq(String(r.id))}),this.grpCoinModeAdv.removeChildren(),this.grpCoinModeAdv.addChild(a)},n.prototype.showGrpTexasCoinMode=function(){var t=this;this.grpCoinMode.visible=!0,this.labCoinModeName.text=e.Locales.get()["Texas.CoinMode.Title"];var n=ArrayUtils.findItemByKey(this.coinModes,"id","TEXAS001"),o=new EIcon(e.Constants.EICON_IMG_BAS,e.Constants.EICON_WIDTH,e.Constants.EICON_HEIGHT);o.setLbBottomScoreVal(n.bottomScore),o.setLbMinChipsVal(n.minChips),o.setClick(function(){t.coinModeRoomReq(String(n.id))}),this.grpCoinModeBas.removeChildren(),this.grpCoinModeBas.addChild(o);var i=ArrayUtils.findItemByKey(this.coinModes,"id","TEXAS002"),s=new EIcon(e.Constants.EICON_IMG_MID,e.Constants.EICON_WIDTH,e.Constants.EICON_HEIGHT);s.setLbBottomScoreVal(i.bottomScore),s.setLbMinChipsVal(i.minChips),s.setClick(function(){t.coinModeRoomReq(String(i.id))}),this.grpCoinModeMid.removeChildren(),this.grpCoinModeMid.addChild(s);var r=ArrayUtils.findItemByKey(this.coinModes,"id","TEXAS003"),a=new EIcon(e.Constants.EICON_IMG_ADV,e.Constants.EICON_WIDTH,e.Constants.EICON_HEIGHT);a.setLbBottomScoreVal(r.bottomScore),a.setLbMinChipsVal(r.minChips),a.setClick(function(){t.coinModeRoomReq(String(r.id))}),this.grpCoinModeAdv.removeChildren(),this.grpCoinModeAdv.addChild(a)},n.prototype.showGrpZjhCoinMode=function(){var t=this;this.grpCoinMode.visible=!0,this.labCoinModeName.text=e.Locales.get()["Zjh.CoinMode.Title"];var n=ArrayUtils.findItemByKey(this.coinModes,"id","ZJH001"),o=new EIcon(e.Constants.EICON_IMG_BAS,e.Constants.EICON_WIDTH,e.Constants.EICON_HEIGHT);o.setLbBottomScoreVal(n.bottomScore),o.setLbMinChipsVal(n.minChips),o.setClick(function(){t.coinModeRoomReq(String(n.id))}),this.grpCoinModeBas.removeChildren(),this.grpCoinModeBas.addChild(o);var i=ArrayUtils.findItemByKey(this.coinModes,"id","ZJH002"),s=new EIcon(e.Constants.EICON_IMG_MID,e.Constants.EICON_WIDTH,e.Constants.EICON_HEIGHT);s.setLbBottomScoreVal(i.bottomScore),s.setLbMinChipsVal(i.minChips),s.setClick(function(){t.coinModeRoomReq(String(i.id))}),this.grpCoinModeMid.removeChildren(),this.grpCoinModeMid.addChild(s);var r=ArrayUtils.findItemByKey(this.coinModes,"id","ZJH003"),a=new EIcon(e.Constants.EICON_IMG_ADV,e.Constants.EICON_WIDTH,e.Constants.EICON_HEIGHT);a.setLbBottomScoreVal(r.bottomScore),a.setLbMinChipsVal(r.minChips),a.setClick(function(){t.coinModeRoomReq(String(r.id))}),this.grpCoinModeAdv.removeChildren(),this.grpCoinModeAdv.addChild(a)},n.prototype.showGrpQznnCoinMode=function(){var t=this;this.grpCoinMode.visible=!0,this.labCoinModeName.text=e.Locales.get()["Qznn.CoinMode.Title"];var n=ArrayUtils.findItemByKey(this.coinModes,"id","QZNN001"),o=new EIcon(e.Constants.EICON_IMG_BAS,e.Constants.EICON_WIDTH,e.Constants.EICON_HEIGHT);o.setLbBottomScoreVal(n.bottomScore),o.setLbMinChipsVal(n.minChips),o.setClick(function(){t.coinModeRoomReq(String(n.id))}),this.grpCoinModeBas.removeChildren(),this.grpCoinModeBas.addChild(o);var i=ArrayUtils.findItemByKey(this.coinModes,"id","QZNN002"),s=new EIcon(e.Constants.EICON_IMG_MID,e.Constants.EICON_WIDTH,e.Constants.EICON_HEIGHT);s.setLbBottomScoreVal(i.bottomScore),s.setLbMinChipsVal(i.minChips),s.setClick(function(){t.coinModeRoomReq(String(i.id))}),this.grpCoinModeMid.removeChildren(),this.grpCoinModeMid.addChild(s);var r=ArrayUtils.findItemByKey(this.coinModes,"id","QZNN003"),a=new EIcon(e.Constants.EICON_IMG_ADV,e.Constants.EICON_WIDTH,e.Constants.EICON_HEIGHT);a.setLbBottomScoreVal(r.bottomScore),a.setLbMinChipsVal(r.minChips),a.setClick(function(){t.coinModeRoomReq(String(r.id))}),this.grpCoinModeAdv.removeChildren(),this.grpCoinModeAdv.addChild(a)},n.prototype.roomReJoinReq=function(){if(!this.sendRoomReJoinReq){console.log("发送重新加入房间的请求");var e=UserService.getInstance().getUser(),t=EventType.ROOM_REJOIN,n=new RoomReJoinReq;n.roomId=String(e.room);var o=new EventReq(t,n);Network.getInstance().send(o),this.sendRoomReJoinReq=!0}},n.prototype.createRoomReq=function(){console.log("创建房间");var e=EventType.ROOM_CREATE,t=new RoomCreateReq;t.type=RoomType.DDZ,t.tier=RoomTier.STD;var n=new EventReq(e,t);Network.getInstance().request(n,this.onCreateRoomSuccess.bind(this),this.onCreateRoomError.bind(this))},n.prototype.onCreateRoomSuccess=function(e){console.log("onCreateRoomSuccess:"+e.getContent());var t=e.getArgs();if(null!=t.room){var n=t.room;n.table=new Table(n.capacity),RoomService.getInstance().setRoom(n)}},n.prototype.onCreateRoomError=function(e){console.log("onCreateRoomError:"+e.getContent()),TipsScene.getInstance().showError(e.getContent())},n.prototype.joinRoomReq=function(e){console.log("加入房间："+e);var t=EventType.ROOM_JOIN,n=new RoomJoinReq;n.roomId=e;var o=new EventReq(t,n);Network.getInstance().request(o,this.onJoinRoomSuccess.bind(this),this.onJoinRoomError.bind(this))},n.prototype.onJoinRoomSuccess=function(e){console.log("onJoinRoomSuccess:"+e.getArgs());var t=e.getArgs();Room.init(t.room);var n=RoomService.getInstance().getRoom();Table.init(n);var o=EventHandlersManager.getExtraAttrByRoomType(n.type);n.table.setExtraAttribute(o),User.init(t.users)},n.prototype.getOthersReadyStatus=function(e){switch(e.room.type){case RoomType.DDZ:console.log("斗地主.");break;case RoomType.TEXAS:console.log("德州扑克.");break;default:console.log("房间类型:"+e.room.type+"不存在.")}},n.prototype.onJoinRoomError=function(e){console.log("onJoinRoomError:"+e.getContent()),TipsScene.getInstance().showError(e.getContent())},n.prototype.coinModeRoomReq=function(e){console.log("加入金币场房间");var t=EventType.COINMODE_ROOM_JOIN,n=new CoinModeRoomJoinReq;n.coinModeId=e,n.step=1;var o=new EventReq(t,n);Network.getInstance().request(o,this.onCoinModeRoomJoinSuccess.bind(this),this.onCoinModeRoomJoinError.bind(this)),GlobalVars.getInstance().coinModeId=e},n.prototype.onCoinModeRoomJoinSuccess=function(e){console.log("onCoinModeRoomJoinSuccess:"+e.getContent()),this.closeGrpCoinMode()},n.prototype.onCoinModeRoomJoinError=function(e){console.log("onCoinModeRoomJoinError:"+e.getContent()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.HallScene=t,__reflect(t.prototype,"Hall.HallScene",["eui.UIComponent","egret.DisplayObject"])}(Hall||(Hall={}));var Hall;!function(e){var t=function(){function e(){}return e.get=function(){return e.CN},e.CN={"Network.Timeout.Error":"网络超时,请稍后重试","Network.Common.Error":"网络错误,请稍后重试","No.Announcement":"暂无公告.",Yes:"是",No:"否","Log.Out.Confirmation":"您确认将退出吗?","Ddz.CoinMode.Title":"斗地主","Texas.CoinMode.Title":"德州扑克","Zjh.CoinMode.Title":"炸金花","Qznn.CoinMode.Title":"抢庄牛牛"},e}();e.Locales=t,__reflect(t.prototype,"Hall.Locales")}(Hall||(Hall={}));var Help;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="HelpSkin",t.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(t.stage,t)},t),t}return __extends(t,e),t.getInstance=function(){return null==this.helpScene&&(this.helpScene=new t),this.helpScene},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initOnce()},t.prototype.close=function(){SceneManager.getInstance().popScene(this)},t.prototype.initOnce=function(){var e=this;this.initTabMenu(),this.helpRadioBtn.group.addEventListener(eui.UIEvent.CHANGE,function(t){var n=t.target;e.vsHelp.selectedIndex=n.selectedValue,e.getAllHelpReq(),SoundManager.getInstance().playEffect("btn_click_mp3")},this),this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()})},t.prototype.initTabMenu=function(){this.grpDdzHelp.horizontalCenter=0,this.grpDdzHelp.verticalCenter=0,this.vsHelp.addChild(this.grpDdzHelp),this.grpTexasHelp.horizontalCenter=0,this.grpTexasHelp.verticalCenter=0,this.vsHelp.addChild(this.grpTexasHelp),this.grpZjhHelp.horizontalCenter=0,this.grpZjhHelp.verticalCenter=0,this.vsHelp.addChild(this.grpZjhHelp),this.grpQznnHelp.horizontalCenter=0,this.grpQznnHelp.verticalCenter=0,this.vsHelp.addChild(this.grpQznnHelp),this.vsHelp.selectedIndex=0},t.prototype.getAllHelpReq=function(){console.log("请求所有的帮助信息.")},t.prototype.getAllHelpRes=function(){console.log("取得所有帮助的响应.")},t}(eui.Component);e.HelpScene=t,__reflect(t.prototype,"Help.HelpScene",["eui.UIComponent","egret.DisplayObject"])}(Help||(Help={}));var KeFu;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="KeFuSkin",t.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(t.stage,t),t.getKefuReq()},t),t}return __extends(t,e),t.getInstance=function(){return null==this.keFuScene&&(this.keFuScene=new t),this.keFuScene},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initOnce()},t.prototype.close=function(){SceneManager.getInstance().popScene(this)},t.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnOK.setClick(function(){e.close()})},t.prototype.getKefuReq=function(){if(console.log("取得客服"),null==this.kefu){var e=EventType.SYSTEM_MGMT,t=new Hall.SystemReq;t.cmd=Hall.CommandType.GET_KEFU_REQ;var n=new EventReq(e,t);Network.getInstance().send(n)}},t.prototype.getKefuRes=function(e){this.kefu=e.kefu,this.labKefu.text=String(this.kefu)},t}(eui.Component);e.KeFuScene=t,__reflect(t.prototype,"KeFu.KeFuScene",["eui.UIComponent","egret.DisplayObject"])}(KeFu||(KeFu={}));var LoginScene=function(e){function t(){var t=e.call(this)||this;return t.ref="",t.skinName="loginSkin",t.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(t.stage,t),t.initOnce(),t.loadMusicResources(),t.preloadScenes(),t.autoLogin()},t),t}return __extends(t,e),t.getInstance=function(){return null==this.loginScene&&(this.loginScene=new t),this.loginScene},t.prototype.loadMusicResources=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,RES.loadGroup("sound",0,null)];case 1:return e.sent(),[2]}})})},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.preloadScenes=function(){SceneManager.getInstance(),TipsScene.getInstance(),LoadingScene.getInstance(),Hall.HallScene.getInstance(),Ddz.TableScene.getInstance(),Texas.TableScene.getInstance(),Qznn.TableScene.getInstance(),Zjh.TableScene.getInstance()},t.prototype.initOnce=function(){var e=this;this.imgBG.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.onImgBGClick()},this),this.grpUserPolicy.visible=!1,this.btnAccountLogIn.setClick(function(){e.onBtnAccountLoginClick()}),this.btnReturnToLogin.setClick(function(){e.onBtnAccountLoginClick()}),this.btnFastRegister.setClick(function(){e.onBtnFastRegisterClick()}),this.btnLogin.setClick(function(){e.login()}),this.btnRegister.setClick(function(){e.register()}),this.btnAgreePolicy.setClick(function(){e.onBtnbAgreePolicyClick()}),this.btnClose.setClick(function(){e.onBtnCloseClick()}),this.btnGoBack.setClick(function(){e.onBtnCloseClick()}),this.ref=egret.getOption("ref"),GlobalVars.getInstance().ajRoomId=egret.getOption("rid")},t.prototype.onImgBGClick=function(){this.grpFastLogin.visible=!0,this.grpAccountLogin.visible=!1,this.grpRegister.visible=!1,this.grpUserPolicy.visible=!1},t.prototype.onBtnAccountLoginClick=function(){this.grpAccountLogin.visible=!0,this.grpFastLogin.visible=!1,this.grpRegister.visible=!1,this.grpUserPolicy.visible=!1},t.prototype.onBtnFastRegisterClick=function(){this.grpRegister.visible=!0,this.grpAccountLogin.visible=!1,this.grpFastLogin.visible=!1,this.grpUserPolicy.visible=!1},t.prototype.onBtnCloseClick=function(){this.grpUserPolicy.visible=!1},t.prototype.onBtnbAgreePolicyClick=function(){this.grpUserPolicy.visible=!0},t.prototype.buildFullWebsocketUrl=function(e,t){return"ws://"+e+"?sessionid="+t},t.prototype.validateLoginFields=function(){return""==this.txtLUserName.text.trim()||this.txtLUserName.text.length>20||this.txtLUserName.text.length<2?(TipsScene.getInstance().showError("请输入有效的用户名!"),!1):""==this.txtLPasswd.text.trim()||this.txtLPasswd.text.length>20||this.txtLPasswd.text.length<2?(TipsScene.getInstance().showError("请输入有效的密码!"),!1):!0},t.prototype.validateRegisterFields=function(){return""==this.txtRUserName.text.trim()||this.txtRUserName.text.length>20||this.txtRUserName.text.length<2?(TipsScene.getInstance().showError("请输入有效的用户名,只能用英文和数字!"),!1):""==this.txtRNickName.text.trim()||this.txtRNickName.text.length>20||this.txtRNickName.text.length<2?(TipsScene.getInstance().showError("请输入有效的昵称!"),!1):""==this.txtRPasswd.text.trim()||this.txtRPasswd.text.length>20||this.txtRPasswd.text.length<2||!GlobalUtils.isLettersAndNumbers(this.txtRPasswd.text.trim())?(TipsScene.getInstance().showError("请输入有效的密码,只能用英文和数字!"),!1):this.txtRPasswd.text!=this.txtRPasswd2.text.trim()?(TipsScene.getInstance().showError("两次密码不一致!"),!1):this.agreePolicy.selected?!0:(TipsScene.getInstance().showError("请检查并同意用户协议!"),!1)},t.prototype.login=function(){return this.validateLoginFields()?(this.userName=this.txtLUserName.text.trim(),this.passwd=this.txtLPasswd.text.trim(),LocalStorage.setItem(GlobalConstants.RECONNECT_USERNAME,Base64.b64EncodeUnicode(this.userName)),LocalStorage.setItem(GlobalConstants.RECONNECT_PASSWORD,Base64.b64EncodeUnicode(this.passwd)),this.doLogin(),!0):void 0},t.prototype.doLogin=function(){var e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT;var t="?username="+encodeURIComponent(this.userName)+"&password="+encodeURIComponent(this.passwd);e.open("http://"+GlobalConstants.HTTP_HOST+":"+GlobalConstants.HTTP_PORT+"/api/login"+t,egret.HttpMethod.GET),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),e.send(),e.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),e.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},t.prototype.register=function(){if(this.validateRegisterFields()){this.userName=this.txtRUserName.text.trim(),this.nickName=this.txtRNickName.text.trim(),this.passwd=this.txtRPasswd.text.trim();var e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT;var t="?username="+encodeURIComponent(this.userName)+"&nickname="+encodeURIComponent(this.nickName)+"&password="+encodeURIComponent(this.passwd)+"&ref="+encodeURIComponent(this.ref);return e.open("http://"+GlobalConstants.HTTP_HOST+":"+GlobalConstants.HTTP_PORT+"/api/register"+t,egret.HttpMethod.GET),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),e.send(),e.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),e.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this),SceneManager.getInstance().pushScene(LoadingScene.getInstance()),!0}},t.prototype.onGetComplete=function(e){var t=e.currentTarget,n=EventRes.decode(t.response),o=n.getArgs().url,i=n.getArgs().sessionId;this.user=n.getArgs().user,this.user.sessionId=i,Network.getInstance().setConnectHandler(this.OnSocketConnected,this),Network.getInstance().setCloseHandler(this.OnSocketClosed,this);var s=this.buildFullWebsocketUrl(o,i);Network.getInstance().connect(s)},t.prototype.OnSocketConnected=function(){console.log("获取用户数据");var e=EventType.USER_DATA,n=new UserDataReq,o=new EventReq(e,n);Network.getInstance().send(o);var i=Hall.HallScene.getInstance();SceneManager.getInstance().popScene(LoadingScene.getInstance()),this.stage.addChild(t.getInstance()),SceneManager.getInstance().pushScene(i)},t.prototype.destroy=function(){this.parent&&this.parent.removeChild(this)},t.prototype.OnSocketClosed=function(){console.log("Socket closed.")},t.prototype.onGetIOError=function(e){SceneManager.getInstance().popScene(LoadingScene.getInstance());var t=e.currentTarget,n=EventRes.decode(t.response),o="";o=null==n?GlobalLocales.get()["nw.connection.error"]:n.getContent(),TipsScene.getInstance().showError(o)},t.prototype.onGetProgress=function(e){console.log("post progress : "+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%")},t.prototype.autoLogin=function(){var e=LocalStorage.getItem(GlobalConstants.RECONNECT_USERNAME),t=LocalStorage.getItem(GlobalConstants.RECONNECT_PASSWORD);null!=e&&""!=e&&(this.userName=Base64.b64DecodeUnicode(e)),null!=t&&""!=t&&(this.passwd=Base64.b64DecodeUnicode(t)),null!=this.userName&&null!=this.passwd&&""!=this.userName&&""!=this.passwd&&this.doLogin()},t}(eui.Component);__reflect(LoginScene.prototype,"LoginScene",["eui.UIComponent","egret.DisplayObject"]);var qr;!function(e){var t=function(){function t(t){this.mode=e.QRMode.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var n=0,o=this.data.length;o>n;n++){var i=[],s=this.data.charCodeAt(n);s>65536?(i[0]=240|(1835008&s)>>>18,i[1]=128|(258048&s)>>>12,i[2]=128|(4032&s)>>>6,i[3]=128|63&s):s>2048?(i[0]=224|(61440&s)>>>12,i[1]=128|(4032&s)>>>6,i[2]=128|63&s):s>128?(i[0]=192|(1984&s)>>>6,i[1]=128|63&s):i[0]=s,this.parsedData.push(i)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return t.prototype.getLength=function(e){return this.parsedData.length},t.prototype.write=function(e){for(var t=0,n=this.parsedData.length;n>t;t++)e.put(this.parsedData[t],8)},t}();e.QR8bitByte=t,__reflect(t.prototype,"qr.QR8bitByte")}(qr||(qr={}));var qr;!function(e){var t=function(){function e(){this.buffer=[],this.length=0}return e.prototype.get=function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},e.prototype.put=function(e,t){for(var n=0;t>n;n++)this.putBit(1==(e>>>t-n-1&1))},e.prototype.getLengthInBits=function(){return this.length},e.prototype.putBit=function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++},e}();e.QRBitBuffer=t,__reflect(t.prototype,"qr.QRBitBuffer")}(qr||(qr={}));var qr;!function(e){var t=function(){function t(){}return t.create=function(n,o,i,s,r){void 0===o&&(o=200),void 0===i&&(i=200),void 0===s&&(s=0),void 0===r&&(r=2);var a={width:o,height:i,correctLevel:e.QRErrorCorrectLevel.H,color:s},l=new e.QRCodeModel(e.QRUtil._getTypeNumber(n,a.correctLevel),a.correctLevel);return l.addData(n),l.make(),t.draw(l,a)},t.draw=function(e,t){var n=new egret.Sprite,t=t,o=e.getModuleCount(),i=Math.floor(t.width/o),s=Math.floor(t.height/o);n.graphics.beginFill(t.color);for(var r=0;o>r;r++)for(var a=0;o>a;a++){var l=e.isDark(r,a);l&&n.graphics.drawRect(a*i,r*s,i,s)}return n.graphics.endFill(),n},t}();e.QRCode=t,__reflect(t.prototype,"qr.QRCode")}(qr||(qr={}));var qr;!function(e){var t=function(){function t(e,t){this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[],this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}return t.prototype.addData=function(t){var n=new e.QR8bitByte(t);this.dataList.push(n),this.dataCache=null},t.prototype.isDark=function(e,t){if(0>e||this.moduleCount<=e||0>t||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},t.prototype.getModuleCount=function(){return this.moduleCount},t.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},t.prototype.makeImpl=function(e,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++){this.modules[o]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[o][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,n),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},t.prototype.setupPositionProbePattern=function(e,t){for(var n=-1;7>=n;n++)if(!(-1>=e+n||this.moduleCount<=e+n))for(var o=-1;7>=o;o++)-1>=t+o||this.moduleCount<=t+o||(n>=0&&6>=n&&(0==o||6==o)||o>=0&&6>=o&&(0==n||6==n)||n>=2&&4>=n&&o>=2&&4>=o?this.modules[e+n][t+o]=!0:this.modules[e+n][t+o]=!1)},t.prototype.getBestMaskPattern=function(){for(var t=0,n=0,o=0;8>o;o++){this.makeImpl(!0,o);var i=e.QRUtil.getLostPoint(this);(0==o||t>i)&&(t=i,n=o)}return n},t.prototype.createMovieClip=function(e,t,n){var o=e.createEmptyMovieClip(t,n),i=1;this.make();for(var s=0;s<this.modules.length;s++)for(var r=s*i,a=0;a<this.modules[s].length;a++){var l=a*i,c=this.modules[s][a];c&&(o.beginFill(0,100),o.moveTo(l,r),o.lineTo(l+i,r),o.lineTo(l+i,r+i),o.lineTo(l,r+i),o.endFill())}return o},t.prototype.setupTimingPattern=function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},t.prototype.setupPositionAdjustPattern=function(){for(var t=e.QRUtil.getPatternPosition(this.typeNumber),n=0;n<t.length;n++)for(var o=0;o<t.length;o++){var i=t[n],s=t[o];if(null==this.modules[i][s])for(var r=-2;2>=r;r++)for(var a=-2;2>=a;a++)-2==r||2==r||-2==a||2==a||0==r&&0==a?this.modules[i+r][s+a]=!0:this.modules[i+r][s+a]=!1}},t.prototype.setupTypeNumber=function(t){for(var n=e.QRUtil.getBCHTypeNumber(this.typeNumber),o=0;18>o;o++){var i=!t&&1==(n>>o&1);this.modules[Math.floor(o/3)][o%3+this.moduleCount-8-3]=i}for(var o=0;18>o;o++){var i=!t&&1==(n>>o&1);this.modules[o%3+this.moduleCount-8-3][Math.floor(o/3)]=i}},t.prototype.setupTypeInfo=function(t,n){for(var o=this.errorCorrectLevel<<3|n,i=e.QRUtil.getBCHTypeInfo(o),s=0;15>s;s++){var r=!t&&1==(i>>s&1);6>s?this.modules[s][8]=r:8>s?this.modules[s+1][8]=r:this.modules[this.moduleCount-15+s][8]=r}for(var s=0;15>s;s++){var r=!t&&1==(i>>s&1);8>s?this.modules[8][this.moduleCount-s-1]=r:9>s?this.modules[8][15-s-1+1]=r:this.modules[8][15-s-1]=r}this.modules[this.moduleCount-8][8]=!t},t.prototype.mapData=function(t,n){for(var o=-1,i=this.moduleCount-1,s=7,r=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var l=0;2>l;l++)if(null==this.modules[i][a-l]){var c=!1;r<t.length&&(c=1==(t[r]>>>s&1));var h=e.QRUtil.getMask(n,i,a-l);h&&(c=!c),this.modules[i][a-l]=c,s--,-1==s&&(r++,s=7)}if(i+=o,0>i||this.moduleCount<=i){i-=o,o=-o;break}}},t.createData=function(n,o,i){for(var s=e.QRRSBlock.getRSBlocks(n,o),r=new e.QRBitBuffer,a=0;a<i.length;a++){var l=i[a];r.put(l.mode,4),r.put(l.getLength(),e.QRUtil.getLengthInBits(l.mode,n)),l.write(r)}for(var c=0,a=0;a<s.length;a++)c+=s[a].dataCount;if(r.getLengthInBits()>8*c)throw new Error("code length overflow. ("+r.getLengthInBits()+">"+8*c+")");for(r.getLengthInBits()+4<=8*c&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(!1);for(;!(r.getLengthInBits()>=8*c)&&(r.put(t.PAD0,8),!(r.getLengthInBits()>=8*c));)r.put(t.PAD1,8);return t.createBytes(r,s)},t.createBytes=function(t,n){for(var o=0,i=0,s=0,r=new Array(n.length),a=new Array(n.length),l=0;l<n.length;l++){var c=n[l].dataCount,h=n[l].totalCount-c;i=Math.max(i,c),s=Math.max(s,h),r[l]=new Array(c);for(var u=0;u<r[l].length;u++)r[l][u]=255&t.buffer[u+o];o+=c;var p=e.QRUtil.getErrorCorrectPolynomial(h),g=new e.QRPolynomial(r[l],p.getLength()-1),d=g.mod(p);a[l]=new Array(p.getLength()-1);for(var u=0;u<a[l].length;u++){var m=u+d.getLength()-a[l].length;a[l][u]=m>=0?d.get(m):0}}for(var f=0,u=0;u<n.length;u++)f+=n[u].totalCount;for(var S=new Array(f),y=0,u=0;i>u;u++)for(var l=0;l<n.length;l++)u<r[l].length&&(S[y++]=r[l][u]);for(var u=0;s>u;u++)for(var l=0;l<n.length;l++)u<a[l].length&&(S[y++]=a[l][u]);return S},t.PAD0=236,t.PAD1=17,t}();e.QRCodeModel=t,__reflect(t.prototype,"qr.QRCodeModel")}(qr||(qr={}));var qr;!function(e){var t=function(){function e(){}return e.L=1,e.M=0,e.Q=3,e.H=2,e}();e.QRErrorCorrectLevel=t,__reflect(t.prototype,"qr.QRErrorCorrectLevel")}(qr||(qr={}));var qr;!function(e){var t=function(){function e(){}return e.PATTERN000=0,e.PATTERN001=1,e.PATTERN010=2,e.PATTERN011=3,e.PATTERN100=4,e.PATTERN101=5,e.PATTERN110=6,e.PATTERN111=7,e}();e.QRMaskPattern=t,__reflect(t.prototype,"qr.QRMaskPattern")}(qr||(qr={}));var qr;!function(e){var t=function(){function e(){}return e.glog=function(t){return e.isInit||e.init(),1>t&&console.log("错误:n="+t),e.LOG_TABLE[t]},e.gexp=function(t){for(e.isInit||e.init();0>t;)t+=255;for(;t>=256;)t-=255;return e.EXP_TABLE[t]},e.init=function(){e.isInit=!0;for(var t=0;8>t;t++)e.EXP_TABLE[t]=1<<t;for(var t=8;256>t;t++)e.EXP_TABLE[t]=e.EXP_TABLE[t-4]^e.EXP_TABLE[t-5]^e.EXP_TABLE[t-6]^e.EXP_TABLE[t-8];for(var t=0;255>t;t++)e.LOG_TABLE[e.EXP_TABLE[t]]=t},e.EXP_TABLE=new Array(256),e.LOG_TABLE=new Array(256),e}();e.QRMath=t,__reflect(t.prototype,"qr.QRMath")}(qr||(qr={}));var qr;!function(e){var t=function(){function e(){}return e.MODE_NUMBER=1,e.MODE_ALPHA_NUM=2,e.MODE_8BIT_BYTE=4,e.MODE_KANJI=8,e}();e.QRMode=t,__reflect(t.prototype,"qr.QRMode")}(qr||(qr={}));var qr;!function(e){var t=function(){function t(e,t){if(void 0==e.length)throw new Error(e.length+"/"+t);for(var n=0;n<e.length&&0==e[n];)n++;this.num=new Array(e.length-n+t);for(var o=0;o<e.length-n;o++)this.num[o]=e[o+n]}return t.prototype.get=function(e){return this.num[e]},t.prototype.getLength=function(){return this.num.length},t.prototype.multiply=function(n){for(var o=new Array(this.getLength()+n.getLength()-1),i=0;i<this.getLength();i++)for(var s=0;s<n.getLength();s++)o[i+s]^=e.QRMath.gexp(e.QRMath.glog(this.get(i))+e.QRMath.glog(n.get(s)));return new t(o,0)},t.prototype.mod=function(n){if(this.getLength()-n.getLength()<0)return this;for(var o=e.QRMath.glog(this.get(0))-e.QRMath.glog(n.get(0)),i=new Array(this.getLength()),s=0;s<this.getLength();s++)i[s]=this.get(s);for(var s=0;s<n.getLength();s++)i[s]^=e.QRMath.gexp(e.QRMath.glog(n.get(s))+o);return new t(i,0).mod(n)},t}();e.QRPolynomial=t,__reflect(t.prototype,"qr.QRPolynomial")}(qr||(qr={}));var qr;!function(e){var t=function(){function t(e,t){this.totalCount=e,this.dataCount=t}return t.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],t.getRSBlocks=function(e,n){var o=t.getRsBlockTable(e,n);
if(void 0==o)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+n);for(var i=o.length/3,s=[],r=0;i>r;r++)for(var a=o[3*r+0],l=o[3*r+1],c=o[3*r+2],h=0;a>h;h++)s.push(new t(l,c));return s},t.getRsBlockTable=function(n,o){switch(o){case e.QRErrorCorrectLevel.L:return t.RS_BLOCK_TABLE[4*(n-1)+0];case e.QRErrorCorrectLevel.M:return t.RS_BLOCK_TABLE[4*(n-1)+1];case e.QRErrorCorrectLevel.Q:return t.RS_BLOCK_TABLE[4*(n-1)+2];case e.QRErrorCorrectLevel.H:return t.RS_BLOCK_TABLE[4*(n-1)+3];default:return}},t}();e.QRRSBlock=t,__reflect(t.prototype,"qr.QRRSBlock")}(qr||(qr={}));var qr;!function(e){var t=function(){function t(){}return t.getBCHTypeInfo=function(e){for(var n=e<<10;t.getBCHDigit(n)-t.getBCHDigit(t.G15)>=0;)n^=t.G15<<t.getBCHDigit(n)-t.getBCHDigit(t.G15);return(e<<10|n)^t.G15_MASK},t.getBCHTypeNumber=function(e){for(var n=e<<12;t.getBCHDigit(n)-t.getBCHDigit(t.G18)>=0;)n^=t.G18<<t.getBCHDigit(n)-t.getBCHDigit(t.G18);return e<<12|n},t.getBCHDigit=function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},t.getPatternPosition=function(e){return t.PATTERN_POSITION_TABLE[e-1]},t.getMask=function(t,n,o){switch(t){case e.QRMaskPattern.PATTERN000:return(n+o)%2==0;case e.QRMaskPattern.PATTERN001:return n%2==0;case e.QRMaskPattern.PATTERN010:return o%3==0;case e.QRMaskPattern.PATTERN011:return(n+o)%3==0;case e.QRMaskPattern.PATTERN100:return(Math.floor(n/2)+Math.floor(o/3))%2==0;case e.QRMaskPattern.PATTERN101:return n*o%2+n*o%3==0;case e.QRMaskPattern.PATTERN110:return(n*o%2+n*o%3)%2==0;case e.QRMaskPattern.PATTERN111:return(n*o%3+(n+o)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},t.getErrorCorrectPolynomial=function(t){for(var n=new e.QRPolynomial([1],0),o=0;t>o;o++)n=n.multiply(new e.QRPolynomial([1,e.QRMath.gexp(o)],0));return n},t.getLengthInBits=function(t,n){if(n>=1&&10>n)switch(t){case e.QRMode.MODE_NUMBER:return 10;case e.QRMode.MODE_ALPHA_NUM:return 9;case e.QRMode.MODE_8BIT_BYTE:return 8;case e.QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(27>n)switch(t){case e.QRMode.MODE_NUMBER:return 12;case e.QRMode.MODE_ALPHA_NUM:return 11;case e.QRMode.MODE_8BIT_BYTE:return 16;case e.QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(41>n))throw new Error("type:"+n);switch(t){case e.QRMode.MODE_NUMBER:return 14;case e.QRMode.MODE_ALPHA_NUM:return 13;case e.QRMode.MODE_8BIT_BYTE:return 16;case e.QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},t.getLostPoint=function(e){for(var t=e.getModuleCount(),n=0,o=0;t>o;o++)for(var i=0;t>i;i++){for(var s=0,r=e.isDark(o,i),a=-1;1>=a;a++)if(!(0>o+a||o+a>=t))for(var l=-1;1>=l;l++)0>i+l||i+l>=t||(0!=a||0!=l)&&r==e.isDark(o+a,i+l)&&s++;s>5&&(n+=3+s-5)}for(var o=0;t-1>o;o++)for(var i=0;t-1>i;i++){var c=0;e.isDark(o,i)&&c++,e.isDark(o+1,i)&&c++,e.isDark(o,i+1)&&c++,e.isDark(o+1,i+1)&&c++,(0==c||4==c)&&(n+=3)}for(var o=0;t>o;o++)for(var i=0;t-6>i;i++)e.isDark(o,i)&&!e.isDark(o,i+1)&&e.isDark(o,i+2)&&e.isDark(o,i+3)&&e.isDark(o,i+4)&&!e.isDark(o,i+5)&&e.isDark(o,i+6)&&(n+=40);for(var i=0;t>i;i++)for(var o=0;t-6>o;o++)e.isDark(o,i)&&!e.isDark(o+1,i)&&e.isDark(o+2,i)&&e.isDark(o+3,i)&&e.isDark(o+4,i)&&!e.isDark(o+5,i)&&e.isDark(o+6,i)&&(n+=40);for(var h=0,i=0;t>i;i++)for(var o=0;t>o;o++)e.isDark(o,i)&&h++;var u=Math.abs(100*h/t/t-50)/5;return n+=10*u},t.prototype.static_isSupportCanvas=function(){return"undefined"!=typeof CanvasRenderingContext2D},t._getTypeNumber=function(n,o){for(var i=1,s=t._getUTF8Length(n),r=0,a=t.QRCodeLimitLength.length;a>=r;r++){var l=0;switch(o){case e.QRErrorCorrectLevel.L:l=t.QRCodeLimitLength[r][0];break;case e.QRErrorCorrectLevel.M:l=t.QRCodeLimitLength[r][1];break;case e.QRErrorCorrectLevel.Q:l=t.QRCodeLimitLength[r][2];break;case e.QRErrorCorrectLevel.H:l=t.QRCodeLimitLength[r][3]}if(l>=s)break;i++}if(i>t.QRCodeLimitLength.length)throw new Error("Too long data");return i},t._getUTF8Length=function(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)},t.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],t.G15=1335,t.G18=7973,t.G15_MASK=21522,t.QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],t}();e.QRUtil=t,__reflect(t.prototype,"qr.QRUtil")}(qr||(qr={}));var Qznn;!function(e){var t=function(){function e(){}return e.START_GAME_RES="Start.Game.Res",e.DEAL_POKERS_REQ="Deal.Pokers.Req",e.DEAL_POKERS_RES="Deal.Pokers.Res",e.DEAL_POKERS_END_REQ="Deal.Pokers.End.Req",e.CALL_DEALER_REQ="Call.Dealer.Req",e.CALL_DEALER_RES="Call.Dealer.Res",e.OTHERS_CALL_DEALER_RES="Others.Call.Dealer.Res",e.HAS_DEALER_RES="Has.Dealer.Res",e.PUT_BETS_REQ="Put.Bets.Req",e.PUT_BETS_RES="Put.Bets.Res",e.OTHERS_PUT_BETS_RES="Others.Put.Bets.Res",e.SUBMIT_POKERTYPE_REQ="Submit.PokerType.Req",e.SUBMIT_POKERTYPE_RES="Submit.PokerType.Res",e.OTHERS_SUBMIT_POKERTYPE_RES="Others.Submit.PokerType.Res",e.SHOW_DOWN_RES="Show.Down.Res",e.RELOAD_DATA_REQ="Reload.Data.Req",e.RELOAD_DATA_RES="Reload.Data.Res",e.SUB_GAME_END_RES="Sub.Game.End.Res",e.GAME_END_RES="Game.End.Res",e}();e.CommandType=t,__reflect(t.prototype,"Qznn.CommandType")}(Qznn||(Qznn={}));var Qznn;!function(e){var t=function(){function e(){}return e.PUT_BET_DELAY_IN_SECS=10,e.USER_ALLIN_IMAGE="avatar_allIn_png",e.USER_FOLD_IMAGE="avatar_fold_png",e.PX_BG_IMAGE="1pxbg_png",e.THREE_X_BIGBLIND_AMOUNT="Three.X.BigBlind.Amount",e.FOUR_X_BIGBLIND_AMOUNT="Four.X.BigBlind.Amount",e.ONE_X_POT_AMOUNT="One.X.Pot.Amount",e.TWO_X_CALL_AMOUNT="Two.X.Call.Amount",e.THREE_X_CALL_AMOUNT="Three.X.Call.Amount",e.FOUR_X_CALL_AMOUNT="Four.X.Call.Amount",e.FIVE_X_CALL_AMOUNT="Five.X.Call.Amount",e.EVENT_QZNN_RELOAD_DATA="Event.Qznn.Reload.Data",e}();e.Constants=t,__reflect(t.prototype,"Qznn.Constants")}(Qznn||(Qznn={}));var Qznn;!function(e){var t=function(){function e(){}return e}();e.StartGameRes=t,__reflect(t.prototype,"Qznn.StartGameRes");var n=function(){function e(){}return e}();e.DealPokersRes=n,__reflect(n.prototype,"Qznn.DealPokersRes");var o=function(){function e(){}return e}();e.DealPokersEndReq=o,__reflect(o.prototype,"Qznn.DealPokersEndReq");var i=function(){function e(){}return e}();e.CallDealerRes=i,__reflect(i.prototype,"Qznn.CallDealerRes");var s=function(){function e(){}return e}();e.CallDealerReq=s,__reflect(s.prototype,"Qznn.CallDealerReq");var r=function(){function e(){}return e}();e.OthersCallDealerRes=r,__reflect(r.prototype,"Qznn.OthersCallDealerRes");var a=function(){function e(){}return e}();e.HasDealerRes=a,__reflect(a.prototype,"Qznn.HasDealerRes");var l=function(){function e(){}return e}();e.PutBetsReq=l,__reflect(l.prototype,"Qznn.PutBetsReq");var c=function(){function e(){}return e}();e.PutBetsRes=c,__reflect(c.prototype,"Qznn.PutBetsRes");var h=function(){function e(){}return e}();e.OthersPutBetsRes=h,__reflect(h.prototype,"Qznn.OthersPutBetsRes");var u=function(){function e(){}return e}();e.SubmitPokerTypeRes=u,__reflect(u.prototype,"Qznn.SubmitPokerTypeRes");var p=function(){function e(){}return e}();e.SubmitPokerTypeReq=p,__reflect(p.prototype,"Qznn.SubmitPokerTypeReq");var g=function(){function e(){}return e}();e.OthersSubmitPokerTypeRes=g,__reflect(g.prototype,"Qznn.OthersSubmitPokerTypeRes");var d=function(){function e(){}return e}();e.ShowDownRes=d,__reflect(d.prototype,"Qznn.ShowDownRes");var m=function(){function e(){}return e}();e.SubGameEndRes=m,__reflect(m.prototype,"Qznn.SubGameEndRes");var f=function(){function e(){}return e}();e.UserData=f,__reflect(f.prototype,"Qznn.UserData");var S=function(){function e(){}return e}();e.GameEndReq=S,__reflect(S.prototype,"Qznn.GameEndReq");var y=function(){function e(){}return e}();e.GameEndRes=y,__reflect(y.prototype,"Qznn.GameEndRes");var b=function(){function e(){}return e}();e.ReloadDataReq=b,__reflect(b.prototype,"Qznn.ReloadDataReq");var C=function(){function e(){}return e}();e.ReloadDataRes=C,__reflect(C.prototype,"Qznn.ReloadDataRes")}(Qznn||(Qznn={}));var Qznn;!function(e){var t=function(){function e(){this.subGameIndex=0,this.subGameNums=0,this.startGameTimeout=0,this.pokers=new Array,this.threePokers=new Array}return e.get=function(){return RoomService.getInstance().getRoom().table.getExtraAttribute()},e.reset=function(){var t=new e;RoomService.getInstance().getRoom().table.setExtraAttribute(t)},e}();e.ExtraAttribute=t,__reflect(t.prototype,"Qznn.ExtraAttribute")}(Qznn||(Qznn={}));var Qznn;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.texasLogic&&(this.texasLogic=new t),this.texasLogic},t.prototype.getCommand=function(e){return e.cmd},t.prototype.processCmd=function(t){var n=null,o="",i=this.getCommand(t);switch(i){case e.CommandType.START_GAME_RES:console.log("服务器通知游戏开始的命令."),n=this.startGameRes(t);break;case e.CommandType.DEAL_POKERS_RES:console.log("服务器通知发手牌的命令."),n=this.dealPokersRes(t);break;case e.CommandType.CALL_DEALER_RES:console.log("服务器通知抢庄的命令."),n=this.callDealerRes(t);break;case e.CommandType.OTHERS_CALL_DEALER_RES:console.log("服务器其他用户抢庄的命令."),n=this.othersCallDealerRes(t);break;case e.CommandType.HAS_DEALER_RES:console.log("服务器通知有庄的命令."),n=this.hasDealerRes(t);break;case e.CommandType.PUT_BETS_RES:console.log("服务器通知下注的命令."),n=this.putBetsRes(t);break;case e.CommandType.OTHERS_PUT_BETS_RES:console.log("服务器通知有其他用户下注的命令."),n=this.othersputBetsRes(t);break;case e.CommandType.SUBMIT_POKERTYPE_RES:console.log("服务器通知提交牌型的命令."),n=this.submitPokerTypeRes(t);break;case e.CommandType.OTHERS_SUBMIT_POKERTYPE_RES:console.log("服务器通知其他人提交牌型的命令."),n=this.othersSubmitPokerTypeRes(t);break;case e.CommandType.SHOW_DOWN_RES:console.log("服务器通知最终摊牌的命令."),n=this.showDownRes(t);break;case e.CommandType.RELOAD_DATA_RES:console.log("服务器通知数据重载的命令."),n=this.reloadDataRes(t);break;case e.CommandType.SUB_GAME_END_RES:console.log("服务器通知本局结束."),n=this.subGameEndRes(t);break;case e.CommandType.GAME_END_RES:console.log("服务通知本房间游戏结束."),n=this.gameEndRes(t);break;default:o="命令:"+i+"不存在.",n=new FuncResult(!1,o)}return n},t.prototype.roomJoinOthers=function(t){var n=t;null!=n.user&&RoomService.getInstance().getRoom().table.addUser(n.user.seatNo,n.user,!1),e.TableScene.getInstance().roomJoinOthers(n)},t.prototype.roomLeaveOthers=function(t){var n=t,o=RoomService.getInstance().getRoom();null!=n.userId&&""!=n.userId&&o.id==n.roomId&&e.TableScene.getInstance().roomLeaveOthers(n)},t.prototype.startGameRes=function(t){var n=null,o=t;return e.ExtraAttribute.reset(),e.ExtraAttribute.get().subGameIndex=o.subGameIndex,e.ExtraAttribute.get().subGameNums=o.subGameNums,e.ExtraAttribute.get().startGameTimeout=o.startGameTimeout,e.TableScene.getInstance().startGameRes(o),n},t.prototype.tableIsFull=function(t){e.TableScene.getInstance().tableIsFull()},t.prototype.dealPokersRes=function(t){var n=null,o=1,i=t;null!=i.pokers&&1==i.pokers.length&&(o=2),console.log(i.pokers);var s=e.PokerSprite.fromIndexs(i.pokers);return 4==s.length?e.ExtraAttribute.get().pokers=s:4==e.ExtraAttribute.get().pokers.length&&e.ExtraAttribute.get().pokers.push(s[0]),null!=i.threePokers&&(e.ExtraAttribute.get().threePokers=e.PokerSprite.fromIndexs(i.threePokers)),null!=i.pokerType&&(e.ExtraAttribute.get().pokerType=String(i.pokerType)),e.TableScene.getInstance().dealPokersRes(o),n},t.prototype.callDealerRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().callDealerTimeout=o.callDealerTimeout,e.ExtraAttribute.get().callDealerStartTime=egret.getTimer()/1e3,e.TableScene.getInstance().callDealerRes(o),n},t.prototype.othersCallDealerRes=function(t){var n=null,o=t;return e.TableScene.getInstance().othersCallDealerRes(o),n},t.prototype.hasDealerRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().dealerSeatNo=o.dealerSeatNo,e.TableScene.getInstance().hasDealerRes(o),n},t.prototype.putBetsRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().putBetsTimeout=o.putBetsTimeout,e.ExtraAttribute.get().putBetsStartTime=egret.getTimer()/1e3,e.TableScene.getInstance().putBetsRes(o),n},t.prototype.othersputBetsRes=function(t){var n=null,o=t;return e.TableScene.getInstance().othersPutBetsRes(o),n},t.prototype.submitPokerTypeRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().submentPokerTypeTimeout=o.submentPokerTypeTimeout,e.ExtraAttribute.get().submitPokerTypeStartTime=egret.getTimer()/1e3,e.TableScene.getInstance().submitPokerTypeRes(o),n},t.prototype.othersSubmitPokerTypeRes=function(t){var n=null,o=t;return e.TableScene.getInstance().othersSubmitPokerTypeRes(o),n},t.prototype.showDownRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().userDatas=o.userDatas,e.TableScene.getInstance().showDownRes(),n},t.prototype.reloadDataRes=function(t){var n=null,o=t;e.ExtraAttribute.get().subGameIndex=o.subGameIndex,e.ExtraAttribute.get().subGameNums=o.subGameNums,e.ExtraAttribute.get().startGameTimeout=o.startGameTimeout,e.ExtraAttribute.get().callDealerTimeout=o.callDealerTimeout,e.ExtraAttribute.get().dealerSeatNo=o.dealerSeatNo,e.ExtraAttribute.get().putBetsTimeout=o.putBetsTimeout;var i=this.getMyData(o.userDatas);return null!=i&&(null!=i.pokers&&(e.ExtraAttribute.get().pokers=e.PokerSprite.fromIndexs(i.pokers)),e.ExtraAttribute.get().pokerType=i.pokerType,null!=i.threePokers&&(e.ExtraAttribute.get().threePokers=e.PokerSprite.fromIndexs(i.threePokers))),e.ExtraAttribute.get().submentPokerTypeTimeout=o.submentPokerTypeTimeout,e.ExtraAttribute.get().userDatas=o.userDatas,e.TableScene.getInstance().reloadDataRes(o),n},t.prototype.getMyData=function(e){var t=RoomService.getInstance().getRoom().table.getMySeatNo(),n=ArrayUtils.findItemByKey(e,"seatNo",t);return n},t.prototype.subGameEndRes=function(t){var n=null;return e.TableScene.getInstance().subGameEndRes(),n},t.prototype.gameEndRes=function(t){var n=null,o=t;return e.TableScene.getInstance().gameEndRes(o),n},t.prototype.roomJoin=function(t){var n=null,o=RoomService.getInstance().getRoom(),i=e.TableScene.getInstance();i.initTheTable(),i.setRoom(o.id),i.setUsersReady();var s=!0;return null!=o.category&&o.category==RoomCategory.COINMODE&&(s=!1),i.initGrpReadyAndInvite(s),SceneManager.getInstance().pushScene(i),n},t.prototype.roomRejoin=function(t){var n=null;EventManager.getInstance().addEvent(e.Constants.EVENT_QZNN_RELOAD_DATA,e.TableScene.getInstance().reloadDataReq.bind(this),null);var o=e.TableScene.getInstance();return o.initTheTable(),o.setRoom(RoomService.getInstance().getRoom().id),o.setUsersReady(),SceneManager.getInstance().pushScene(o),n},t.prototype.beReady=function(t){var n=t;e.TableScene.getInstance().beReadyRes(n)},t.prototype.getRoomType=function(){return RoomType.QZNN},t}();e.GameLogic=t,__reflect(t.prototype,"Qznn.GameLogic")}(Qznn||(Qznn={}));var Qznn;!function(e){var t=function(){function e(){}return e.get=function(){return e.CN},e.CN={"start.game.countdown":"游戏即将开始","subgame.continue.countdown":"本局游戏结束,继续","call.dealer.countdown":"请抢庄","call.dealer.multiplier":"抢 x","no.call.dealer":"不抢","no.ops":"无操作","wait.others.callDealer.countdown":"请等待其他玩家抢庄","put.bets.countdown":"请选择下注倍数","wait.others.putbets.countdown":"请等待其他玩家下注","put.bets.multiplier":"投 x","submit.pokertype.countdown":"请提交有牛的三张牌","wait.others.submit.countdown":"有人还在冥思苦想中","poker.type.submitted":"完成","continue":"继续",roundnums:"局数:","calc.cow.error":"请重新选择三张牌.","Go.Back.Confirmation":"这将退出当前游戏,您确认吗?"},e}();e.Locales=t,__reflect(t.prototype,"Qznn.Locales")}(Qznn||(Qznn={}));var Qznn;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.MockTest&&(this.MockTest=new t),this.MockTest},t.prototype.joinRoomResp=function(){var e='{"id":1,"type":1060,"status":true,"args":{"room":{"id":"827314","game":null,"name":null,"tier":"STD","bottomScore":0,"type":"TEXAS","status":"CREATED","owner":"1","capacity":3,"rounds":0},"users":[{"id":"1","name":"wesley","nickName":null,"sex":null,"avatar":null,"level":0,"cardNum":9,"score":2500,"room":"827314","seatNo":1},{"id":"2","name":"tom1001","nickName":null,"sex":null,"avatar":null,"level":0,"cardNum":10,"score":2500,"room":"827314","seatNo":2},{"id":"305921","name":"boby1001","nickName":null,"sex":null,"avatar":null,"level":0,"cardNum":10,"score":5000,"room":"827314","seatNo":3}]}}',t=EventRes.decode(e);Hall.HallScene.getInstance().onJoinRoomSuccess(t)},t.prototype.startGameRes=function(){var t='{"id":0,"type":2030,"status":true,"args":{"cmd":"Start.Game.Res","startGameTimeout":5}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.dealPokersResR1=function(){var t='{"id":0,"type":2030,"status":true,"args":{"cmd":"Deal.Pokers.Res","pokers":[36,21,6,38],"threePokers":null,"pokerType":null}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.dealPokersResR2=function(){var t='{"id":0,"type":2030,"status":true,"args":{"cmd":"Deal.Pokers.Res","pokers":[27],"threePokers":[6,36,38],"pokerType":"3"}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.callDealerRes=function(){var t='{"id":0,"type":2030,"status":true,"args":{"cmd":"Call.Dealer.Res","callDealerTimeout":60}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.othersCallDealerRes=function(){var t='{"id":0,"type":2030,"status":true,"args":{"cmd":"Others.Call.Dealer.Res","seatNo":2,"dealerMultiplier":1}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.hasDealerRes=function(){var t='{"id":0,"type":2030,"status":true,"args":{"cmd":"Has.Dealer.Res","dealerCandidates":[1,2,3],"dealerSeatNo":3,"dealerMultiplier":1}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.putBetsRes=function(){var t='{"id":0,"type":2030,"status":true,"args":{"cmd":"Put.Bets.Res","putBetsTimeout":60}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.othersPutBetsRes=function(){var t='{"id":0,"type":2030,"status":true,"args":{"cmd":"Others.Put.Bets.Res","seatNo":1,"betsMultiplier":5}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.submitPokerTypeRes=function(){var t='{"id":0,"type":2030,"status":true,"args":{"cmd":"Submit.PokerType.Res","submentPokerTypeTimeout":60}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.othersSubmitPokerTypeRes=function(){var t='{"id":0,"type":2030,"status":true,"args":{"cmd":"Others.Submit.PokerType.Res","seatNo":3}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.showDownRes=function(){var t='{"id":0,"type":2030,"status":true,"args":{"cmd":"Show.Down.Res","userDatas":[{"userId":"1","seatNo":1,"win":false,"dealer":true,"winAll":false,"loseAll":false,"ready":false,"scores":4970,"awarded":-30,"pokers":[1,7,11,32,49],"threePokers":[],"pokerType":"18"},{"userId":"2","seatNo":2,"win":false,"dealer":false,"winAll":false,"loseAll":false,"ready":false,"scores":4980,"awarded":-20,"pokers":null,"threePokers":null,"pokerType":null},{"userId":"305921","seatNo":3,"win":true,"dealer":false,"winAll":false,"loseAll":false,"ready":false,"scores":5050,"awarded":50,"pokers":[12,14,15,16,39],"threePokers":[12,14,15],"pokerType":"13"}]}}\n			',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.subGameEndRes=function(){var t='{"id":0,"type":2030,"status":true,"args":{"cmd":"Sub.Game.End.Res","roundIdx":1,"totalRound":15}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t}();e.MockTest=t,__reflect(t.prototype,"Qznn.MockTest")}(Qznn||(Qznn={}));var Qznn;!function(e){var t=function(){function e(){}return e.prototype.getIndex=function(){return this.index},e.prototype.getValue=function(){return this.suit},e.prototype.getSuit=function(){return this.suit},e.prototype.getCowValue=function(){var e=Math.floor(this.index/4);return 0==e?1:1==e||2==e||3==e||4==e?10:14-e},e.fromIndex=function(t){var n=new e;return n.suit=e.suits[t%4],n.value=e.numbers[t/4],n.index=t,n},e.fromIndexs=function(t){var n=new Array;return void 0==t||0==t.length?n:(t.forEach(function(t){var o=e.fromIndex(t);n.push(o)}),n)},e.toIndexs=function(e){var t=new Array;return void 0==e||0==e.length?t:(e.forEach(function(e){var n=e.getIndex();t.push(n)}),t)},e.prototype.toString=function(){return"["+this.value+","+this.suit+"]"},e.numbers=["A","K","Q","J","10","9","8","7","6","5","4","3","2"],e.suits=["SPADE","HEART","CLUB","DIAMOND"],e}();e.Poker=t,__reflect(t.prototype,"Qznn.Poker")}(Qznn||(Qznn={}));var Qznn;!function(e){var t=function(t){function n(e,n,o,i){var s=t.call(this)||this;s.poker=e,s.width=n,s.height=n*GlobalConstants.POKER_WvsH_RATIO,s.isFaceUp=i,s.selected=!1,s.baseX=s.x,s.baseY=s.y;var r=s.getImageID(),a=new egret.Bitmap(RES.getRes(r));return a.width=s.width,a.height=s.height,s.addChild(a),o&&(s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){s.selected=!s.selected,s.selected?(s.y=s.baseY-15,SoundManager.getInstance().playEffect("choose_card_mp3")):s.y=s.baseY,null!=s.call&&s.call()},s)),s}return __extends(n,t),n.prototype.getPoker=function(){return this.poker},n.prototype.setSelected=function(e){this.dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP))},n.prototype.addCall=function(e){this.call=e},n.prototype.getSelected=function(){return this.selected},n.prototype.getImageID=function(){var t=0;return this.isFaceUp&&(t=e.Utils.pokerIds[this.poker.getIndex()]),this.imgId="poker_"+t+"_png",this.imgId},n.fromIndex=function(t){var o=e.Poker.fromIndex(t),i=new n(o,GlobalConstants.POKER_XL_W,!0,!0);return i},n.fromIndexs=function(e){var t=new Array;return void 0==e||0==e.length?t:(e.forEach(function(e){var o=n.fromIndex(e);t.push(o)}),t)},n}(egret.Sprite);e.PokerSprite=t,__reflect(t.prototype,"Qznn.PokerSprite")}(Qznn||(Qznn={}));var Qznn;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.isMe=e,n.skinName="QznnSeatUISkin",n}return __extends(n,t),n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},n.prototype.initUI=function(){this.user=null,this.labChips.text="",this.imgWinner.visible=!1,this.imgWinner.x=this.imgWinner.width/2,this.imgWinner.y=this.imgWinner.height/2,this.imgWinner.anchorOffsetX=this.imgWinner.width/2,this.imgWinner.anchorOffsetY=this.imgWinner.height/2,this.imgButtonSeat.visible=!1,this.imgButtonSeat.anchorOffsetX=this.imgButtonSeat.width/2,this.imgButtonSeat.anchorOffsetY=this.imgButtonSeat.height/2,this.imgUserReady.visible=!1,this.imgUserReady.anchorOffsetX=this.imgUserReady.width/2,this.imgUserReady.anchorOffsetY=this.imgUserReady.height/2,this.setLabName(""),this.setLabChips(""),this.setLabLastAction(""),null!=this.grpPokers&&(this.grpPokers.visible=!0,this.grpPokers.removeChildren()),null!=this.grpPokersInHand&&(this.grpPokersInHand.visible=!0,this.grpPokersInHand.removeChildren())},n.prototype.show=function(){this.grpParent.visible=!0,this.grpParent.removeChildren(),this.grpParent.addChild(this)},n.prototype.setGrpParent=function(e){e.removeChildren(),this.grpParent=e},n.prototype.getGrpParent=function(){return this.grpParent},n.prototype.setUser=function(e){this.user=e},n.prototype.getUser=function(){return this.user},n.prototype.getIsMe=function(){return this.isMe},n.prototype.setLabName=function(e){(void 0==e||null==e)&&(e=""),this.labName.text=GlobalUtils.getFixedLenOfString(e,6)},n.prototype.setImgAvatar=function(e){this.imgAvatar.source=e,this.imgAvatar.width=this.imgAvatar.height=70},n.prototype.setLabLastAction=function(e){this.labLastAction.size=20,this.labLastAction.bold=!0,this.labLastAction.textColor=16045678,this.labLastAction.stroke=1,this.labLastAction.strokeColor=11301130,this.labLastAction.textAlign=egret.HorizontalAlign.CENTER,this.labLastAction.verticalAlign=egret.VerticalAlign.MIDDLE,this.labLastAction.text=e},n.prototype.setLabChips=function(e){(void 0==e||null==e)&&(e="0"),this.labChips.text=String(e)},n.prototype.setImgWinner=function(e){var t=this;e?(this.imgWinner.visible=!0,this.tweenWin=egret.Tween.get(this.imgWinner,{loop:!0}),this.tweenWin.to({scaleX:1.1,scaleY:1.1},200,egret.Ease.quintOut).to({alpha:0},100).to({scaleX:1,scaleY:1},200).to({alpha:1},100).call(function(){setTimeout(function(){t.tweenWin&&(t.tweenWin.setPaused(!0),egret.Tween.removeTweens(t.tweenWin))},5e3)})):(this.imgWinner.visible=!1,this.tweenWin=null)},n.prototype.setImgButton=function(e){if(e){this.imgButtonSeat.visible=!0;var t=egret.Tween.get(this.imgButtonSeat);t.to({scaleX:1.5,scaleY:1.5},100,egret.Ease.quintOut).to({scaleX:1,scaleY:1},80).to({scaleX:1.1,scaleY:1.1},80).to({scaleX:1,scaleY:1},80).call(function(){t&&egret.Tween.removeTweens(t)})}else this.imgButtonSeat.visible=!1},n.prototype.setImgUserReady=function(e){e?this.imgUserReady.visible=!0:this.imgUserReady.visible=!1},n.prototype.setGrpPokers=function(e){this.grpPokers=e},n.prototype.setGrpPokersInHand=function(e){this.grpPokersInHand=e},n.prototype.getGrpPokers=function(){return this.grpPokers},n.prototype.getGrpPokersInHand=function(){return this.grpPokersInHand},n.prototype.setImgSizeAndPos=function(e,t,n){this.isMe&&n?(e.width=240,e.height=45):(e.width=150,e.height=30),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=.5*t.width,e.y=t.height-e.height/2},n.prototype.showImgAnimation=function(e){var t=egret.Tween.get(e);t.to({scaleX:2,scaleY:2},100,egret.Ease.sineOut).wait(20).to({scaleX:.9,scaleY:.9},100,egret.Ease.sineIn).to({scaleX:1.2,scaleY:1.2},100,egret.Ease.sineIn).to({scaleX:1,scaleY:1},100,egret.Ease.sineIn).call(function(){egret.Tween.removeTweens(t)})},n.prototype.setPokerType=function(t,n){null==t?this.imgPokerType=GlobalUtils.createBitmapByName(e.Utils.pokerTypesToImage.fold):this.imgPokerType=GlobalUtils.createBitmapByName(e.Utils.pokerTypesToImage[t]);var o=null;o=n?this.grpPokersInHand:this.grpPokers,this.setImgSizeAndPos(this.imgPokerType,o,n),o.addChild(this.imgPokerType),this.showImgAnimation(this.imgPokerType)},n.prototype.setImgFold=function(){this.imgPokerType&&this.grpPokers.contains(this.imgPokerType)&&this.grpPokers.removeChild(this.imgPokerType),this.imgFold=GlobalUtils.createBitmapByName("zjh_fold_png"),this.setImgSizeAndPos(this.imgFold,this.grpPokers,!1),this.grpPokers.addChild(this.imgFold),this.showImgAnimation(this.imgFold)},n.prototype.setImgFinished=function(){this.imgPokerType&&this.grpPokers.contains(this.imgPokerType)&&this.grpPokers.removeChild(this.imgPokerType),this.imgFinished=GlobalUtils.createBitmapByName("zjh_finished_png"),this.setImgSizeAndPos(this.imgFinished,this.grpPokers,!1),this.grpPokers.addChild(this.imgFinished),this.showImgAnimation(this.imgFinished)},n}(eui.Component);e.SeatUI=t,__reflect(t.prototype,"Qznn.SeatUI",["eui.UIComponent","egret.DisplayObject"])}(Qznn||(Qznn={}));var Qznn;!function(e){var t;!function(e){e[e.NONE=0]="NONE",e[e.WAITTING=1]="WAITTING",e[e.START=2]="START",e[e.DEALPOKERS1=3]="DEALPOKERS1",e[e.CALLDEALER=4]="CALLDEALER",e[e.HASDEALER=5]="HASDEALER",e[e.PUTBETS=6]="PUTBETS",e[e.DEALPOKERS2=7]="DEALPOKERS2",e[e.SUBMITPOKERTYPE=8]="SUBMITPOKERTYPE",e[e.SHOWDOWN=9]="SHOWDOWN",e[e.SUBGAMEEND=10]="SUBGAMEEND"}(t=e.State||(e.State={}))}(Qznn||(Qznn={}));var Qznn;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return n.sceneName="Qznn.TableScene",n.index=0,n.skinName="QznnTableSkin",n.addExtraAttributeToTable(),n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(n.stage,n),SoundManager.getInstance().playMusic("bg_qznn_mp3"),EventManager.getInstance().dispatchEvent(e.Constants.EVENT_QZNN_RELOAD_DATA),n.shuffle=new Shuffle(n.grpDeck,n.dealPokers1stRound.bind(n)),n.btnReady.setClick(function(e){n.beReady(e)}),n.btnInvite.setClick(function(e){n.inviteOthers(e)}),n.btnGoMatching.setClick(function(){n.coinModeRoomReq()}),n.btnNoCall.setClick(function(){n.callDealerReq(0)}),n.btnCall1x.setClick(function(){n.callDealerReq(1)}),n.btnCall2x.setClick(function(){n.callDealerReq(2)}),n.btnCall3x.setClick(function(){n.callDealerReq(3)}),n.btnCall4x.setClick(function(){n.callDealerReq(4)}),n.btnBet5x.setClick(function(){n.putBetsReq(5)}),n.btnBet10x.setClick(function(){n.putBetsReq(10)}),n.btnBet15x.setClick(function(){n.putBetsReq(15)}),n.btnBet20x.setClick(function(){n.putBetsReq(20)}),n.btnBet25x.setClick(function(){n.putBetsReq(25)}),n.btnCowTips.setClick(function(){n.calcCowTips()}),n.btnHasCow.setClick(function(){n.submitPokerTypeReq(!0)}),n.btnHasntCow.setClick(function(){n.submitPokerTypeReq(!1)}),n.btnEnableHost.setClick(function(){n.enableHostReq()}),n.btnDisableHost.setClick(function(){n.disableHostReq()}),EventManager.getInstance().addEvent(GlobalConstants.EVENT_SYSTEM_MESSAGE,n.showSystemMessage.bind(n),null),EventManager.getInstance().addEvent(GlobalConstants.EVENT_DISABLE_HOST,n.showGrpPutBetsControls.bind(n),null)},n),n}return __extends(n,t),n.getInstance=function(){return null==this.QznnTableScene&&(this.QznnTableScene=new n),this.QznnTableScene},n.prototype.showSettingScene=function(){SceneManager.getInstance().pushScene(Setting.SettingScene.getInstance(this.sceneName))},n.prototype.showGoBackConfirmationWin=function(){var t=this,n=e.Locales.get()["Go.Back.Confirmation"];TipsScene.getInstance().confirm(n,function(){t.close()})},n.prototype.close=function(){this.roomLeaveReq(),SoundManager.getInstance().stopMusic(),SceneManager.getInstance().popScene(this)},n.prototype.roomLeaveReq=function(){var e=EventType.ROOM_LEAVE,t=new RoomLeaveReq,n=new EventReq(e,t);Network.getInstance().send(n)},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initBtnFunc()},n.prototype.initBtnFunc=function(){var e=this;this.btnGoBack.setClick(function(){e.showGoBackConfirmationWin()}),this.btnSetting.setClick(function(){e.showSettingScene()}),this.btnScores.setClick(function(){e.showGameScores()})},n.prototype.showGrpPutBetsControls=function(){},n.prototype.showSystemMessage=function(e){var t=new ScrollingMessages(this.grpSystemMessage),n={};n.msg=e.content,n.loopNum=3;var o=new ScrollingMessage(n,0);t.pushpaoMaDengMsg(o),t.start()},n.prototype.showStartMatchingCountDownTimer=function(){var e=GlobalLocales.get()["start.Matching.Player"];this.startMatchingUserCountDownTimer=new CountDownTimer(e),this.grpTimer.addChild(this.startMatchingUserCountDownTimer),this.startMatchingUserCountDownTimer.timeStart(30)},n.prototype.coinModeRoomReq=function(){console.log("开始匹配");var e=EventType.COINMODE_ROOM_JOIN,t=new CoinModeRoomJoinReq;t.coinModeId=GlobalVars.getInstance().coinModeId,t.step=2;var n=new EventReq(e,t);Network.getInstance().request(n,this.onCoinModeRoomJoinSuccess.bind(this),this.onCoinModeRoomJoinError.bind(this))},n.prototype.onCoinModeRoomJoinSuccess=function(e){console.log("onCoinModeRoomJoinSuccess:"+e.getContent()),this.grpReadyAndInvite.visible=!1,this.btnGoMatching.visible=!1,this.showStartMatchingCountDownTimer()
},n.prototype.onCoinModeRoomJoinError=function(e){console.log("onCoinModeRoomJoinError:"+e.getContent()),TipsScene.getInstance().showError(e.getContent())},n.prototype.getRoomId=function(){var e=RoomService.getInstance().getRoom();return null!=e?e.id:null!=this.roomId?this.roomId:null},n.prototype.initialize=function(){this.labEntityId.text=String(this.getRoomId()),this.labRoundNums.text="",this.setAllGrpsToInVisible(),this.initSeatLayoutMap(),this.initSeatMap(),this.fillUserOfSeatUI(),this.clearSampleImgAndData()},n.prototype.setAllGrpsToInVisible=function(){this.grpReadyAndInvite.visible=!1,this.grpSubmitPTControls.visible=!1,this.grpPutBetsControls.visible=!1,this.grpCallDealerControls.visible=!1,this.grpCowCalc.visible=!1,this.grpHost.visible=!1},n.prototype.setRoom=function(e){this.roomId=e},n.prototype.clearSampleImgAndData=function(){this.grpPokersInHand.removeChildren()},n.prototype.addExtraAttributeToTable=function(){},n.prototype.initSeatLayoutMap=function(){this.seatLayoutMap={3:[1,3,8],4:[1,3,5,8],5:[1,3,5,6,8],6:[1,2,3,5,6,8],7:[1,2,3,5,6,8,9],8:[1,2,3,4,5,6,7,8],9:[1,2,3,4,5,6,7,8,9]}},n.prototype.initSeatMap=function(){this.seatMap=new Dictionary;for(var t=RoomService.getInstance().getRoom().table.getSeatsNum(),n=this.seatLayoutMap[String(t)],o=1;t>=o;++o){var i=null;i=1==o?new e.SeatUI(!0):new e.SeatUI(!1),i.setGrpParent(this["grpProfile_Seat"+n[o-1]]),i.setGrpPokers(this["grpPokers_Seat"+n[o-1]]),i.setGrpPokersInHand(this.grpPokersInHand),i.initUI(),this.seatMap.Add("Seat"+o,i)}},n.prototype.setUsersReady=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers();t.forEach(function(t){if(t.beReady){var n=e.getSeatUI(t.seatNo);n.setImgUserReady(!0)}})},n.prototype.beReadyRes=function(e){var t=e.userId,n=RoomService.getInstance().getRoom().table.getSeatNoByUserId(t);if(null!=n){var o=this.getSeatUI(n);o.setImgUserReady(!0),SoundManager.getInstance().playEffect("user_ready_mp3")}},n.prototype.fillUserOfSeatUI=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers();t.forEach(function(t){var n=e.getSeatUI(t.seatNo);n.setUser(t)})},n.prototype.setUserReadyStatus=function(e){var t=RoomService.getInstance().getRoom().table.getUserByUserId(e),n=this.getSeatUI(t.seatNo);n.setImgUserReady(!0)},n.prototype.getSeatUI=function(e){var t=this.getMySeatNo();if(e==t)return this.seatMap.Item("Seat1");for(var n=RoomService.getInstance().getRoom().capacity,o=2;n>=o;++o)if(e==RoomService.getInstance().getRoom().table.peekSeatNoRecursively(t,o-1))return this.seatMap.Item("Seat"+o)},n.prototype.getMySeaUI=function(){var e=this.getMySeatNo();return this.getSeatUI(e)},n.prototype.setOthersSeatUI=function(e){var t=this.getSeatUI(e.seatNo);t.show(),t.setUser(e),t.setLabName(e.name),t.setLabChips(String(e.score)),t.setImgAvatar(e.avatar)},n.prototype.roomLeaveOthers=function(e){var t=RoomService.getInstance().getRoom().table.getUserByUserId(String(e.userId));if(null!=t){var n=this.getSeatUI(t.seatNo);n.setUser(null),console.log("其他用户离开:"+e)}},n.prototype.roomJoinOthers=function(e){this.setOthersSeatUI(e.user),console.log("其他用户加入:"+e)},n.prototype.updateUserScoreAndUI=function(){var t=this,n=e.ExtraAttribute.get().userDatas;null!=n&&n.forEach(function(e){var n=RoomService.getInstance().getRoom().table.getUserBySeatNo(e.seatNo);n.score=e.score;var o=t.getSeatUI(e.seatNo);o.setLabChips(String(n.score))})},n.prototype.setMySeatUI=function(){var e=this.getMySeatNo(),t=this.getSeatUI(e);t.show(),t.setLabName(t.getUser().name),t.setLabChips(String(t.getUser().score)),t.setImgAvatar(t.getUser().avatar)},n.prototype.initOthersSeatUI=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers(),n=UserService.getInstance().getUser();t.forEach(function(t){n.id!=t.id&&e.setOthersSeatUI(t)})},n.prototype.clearAllSeatUIs=function(){var e=this;this.seatMap.Keys().forEach(function(t){var n=e.seatMap.Item(t);n.setLabLastAction(""),n.setImgUserReady(!1),n.setImgButton(!1),n.getGrpPokers().removeChildren(),n.getIsMe()&&n.getGrpPokersInHand().removeChildren()})},n.prototype.tableIsFull=function(){this.btnInvite.visible=!1},n.prototype.getMySeatNo=function(){return RoomService.getInstance().getRoom().table.getMySeatNo()},n.prototype.initTheTable=function(){this.initialize(),this.setMySeatUI(),this.initOthersSeatUI()},n.prototype.initGrpReadyAndInvite=function(e){this.grpReadyAndInvite.removeChildren(),this.grpReadyAndInvite.visible=!0,e?(this.btnReady.visible=!0,this.grpReadyAndInvite.addChild(this.btnReady),this.btnInvite.visible=!0,this.grpReadyAndInvite.addChild(this.btnInvite)):(this.btnGoMatching.visible=!0,this.grpReadyAndInvite.addChild(this.btnGoMatching)),GlobalUtils.setHorizontalLayout(this.grpReadyAndInvite,150,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.enableHostReq=function(){var e=EventType.ENABLE_HOST,t=new EnableHostReq;t.userId=UserService.getInstance().getUser().id;var n=new EventReq(e,t);Network.getInstance().request(n,this.onEnableHostSuccess.bind(this),this.onEnableHostError.bind(this))},n.prototype.onEnableHostSuccess=function(e){console.log("onEnableHostSuccess:"+JSON.stringify(e.args)),this.grpHost.visible=!0,UserService.getInstance().getUser().beHosted=!0},n.prototype.onEnableHostError=function(e){console.log("onEnableHostError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.disableHostReq=function(){var e=EventType.DISABLE_HOST,t=new DisableHostReq;t.userId=UserService.getInstance().getUser().id;var n=new EventReq(e,t);Network.getInstance().request(n,this.onDisableHostSuccess.bind(this),this.onDisableHostError.bind(this))},n.prototype.onDisableHostSuccess=function(e){console.log("onEnableHostSuccess:"+JSON.stringify(e.args)),this.grpHost.visible=!1,UserService.getInstance().getUser().beHosted=!1},n.prototype.onDisableHostError=function(e){console.log("onDisableHostError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.showGameScores=function(){var e=GameResult.FinalGameRslScene.getInstance();e.setRoom(String(this.roomId)),SceneManager.getInstance().pushScene(e)},n.prototype.beReady=function(e){console.log("点击准备按钮"),this.initTheTable();var t=EventType.BE_READY,n=new BeReadyReq;n.roomId=this.roomId;var o=new EventReq(t,n);Network.getInstance().request(o,this.onReadySuccess.bind(this),this.onReadyError.bind(this))},n.prototype.onReadySuccess=function(e){console.log("onReadySuccess:"+JSON.stringify(e.args)),this.btnReady.visible=!1,this.btnInvite.visible=!1,this.setMyReadyStatus(!0)},n.prototype.setMyReadyStatus=function(e){var t=this.getMySeatNo(),n=this.getSeatUI(t);n.setImgUserReady(e)},n.prototype.onReadyError=function(e){console.log("onReadyError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.inviteOthersBK=function(e){console.log("点击邀请按钮"),this.btnInvite.visible=!1;var t="978102";Hall.HallScene.getInstance().joinRoomReq(t)},n.prototype.inviteOthers=function(e){var t=InviteScene.getInstance();t.setEntityId(String(this.roomId)),SceneManager.getInstance().pushScene(t)},n.prototype.clearTheTableScene=function(){this.grpReadyAndInvite.removeChildren(),this.clearAllSeatUIs(),this.index=0,this.showDownIdx=0,this.labRoundNums.text="",null!=this.startMatchingUserCountDownTimer&&this.startMatchingUserCountDownTimer.stop(),this.grpTimer.contains(this.startMatchingUserCountDownTimer)&&this.grpTimer.removeChild(this.startMatchingUserCountDownTimer)},n.prototype.setLabRoundNums=function(){var t=String(e.ExtraAttribute.get().subGameIndex),n=String(e.ExtraAttribute.get().subGameNums),o=e.Locales.get().roundnums+t+"/"+n;this.labRoundNums.text=o},n.prototype.clearImgBeReadyOfAllSeatUIs=function(){var e=this;this.seatMap.Keys().forEach(function(t){var n=e.seatMap.Item(t);n.setImgUserReady(!1)})},n.prototype.startGameRes=function(e){this.clearTheTableScene(),this.clearImgBeReadyOfAllSeatUIs(),this.setLabRoundNums(),this.showStartGameCountDownTimer(e.startGameTimeout),SoundManager.getInstance().playEffect("game_start_wav")},n.prototype.dealPokersRes=function(e){this.clearTimer(),this.setMyReadyStatus(!1),1==e?this.shuffle.launch():this.dealPokers2ndRound()},n.prototype.dealPokers2ndRound=function(){this.dealPokerInOneRoundAnimation()},n.prototype.dealPokers1stRound=function(){this.grpDeck.visible=!0,this.index=0;var t=e.ExtraAttribute.get().pokers.length;this.dealPokersTimer=new egret.Timer(200,t),this.dealPokersTimer.addEventListener(egret.TimerEvent.TIMER,this.dealPokerInOneRoundAnimation,this),this.dealPokersTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.dealPokersEndReq,this),this.dealPokersTimer.start()},n.prototype.generatePokerSpriteInDeck=function(){this.grpDeck.visible=!1;for(var t=RoomService.getInstance().getRoom().capacity,n=0;2*t>n;n++){var o=e.Poker.fromIndex(0),i=new e.PokerSprite(o,GlobalConstants.POKER_S_W,!1,!1);i.x=n,i.y=n,this.grpDeck.addChild(i)}},n.prototype.dealPokerInOneRoundAnimation=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers();t.forEach(function(t){var n=e.getSeatUI(t.seatNo);e.dealPokerToSeatAnimation(n,e.index)}),this.index++},n.prototype.dealPokerToSeatAnimation=function(t,n){var o=e.Poker.fromIndex(0),i=new e.PokerSprite(o,GlobalConstants.POKER_S_W,!1,!1);this.grpDeck.visible=!0,i.x=i.y=0,this.grpDeck.addChild(i),SoundManager.getInstance().playEffect("send_card_wav");var s=t.getGrpPokers();t.getIsMe()&&(s=t.getGrpPokersInHand()),s.visible=!0;var r=this.grpDeck.globalToLocal(s.x+s.width/2,s.y+s.height/2),a=egret.Tween.get(i);a.to({x:r.x,y:r.y},300).call(function(){if(this.grpDeck&&this.grpDeck.contains(i)&&this.grpDeck.removeChild(i),egret.Tween.removeTweens(a),t.getIsMe()){var r=e.ExtraAttribute.get().pokers[n];s&&s.addChild(r)}else{var l=new e.PokerSprite(o,GlobalConstants.POKER_S_W,!1,!1);l.x=l.y=0,s&&s.addChild(l)}if(5==e.ExtraAttribute.get().pokers.length)this.resetThePokersInSeatUI(t);else{var c=3;t.getIsMe()||(c=-20),GlobalUtils.setHorizontalLayout(s,c,GlobalUtils.ALIGNMENT_CENTER)}},this)},n.prototype.resetThePokersInSeatUI=function(e){e.getIsMe()?this.setFaceUpPokersIntoMySeatUI(e):this.setFaceDownPokersIntoSeatUI(e,5)},n.prototype.setFaceUpPokersIntoMySeatUI=function(t){t.getGrpPokers().removeChildren(),t.getGrpPokersInHand().removeChildren();for(var n=e.ExtraAttribute.get().pokers,o=0;o<n.length;o++)t.getGrpPokersInHand().addChild(n[o]);var i=3;GlobalUtils.setHorizontalLayout(t.getGrpPokersInHand(),i,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.dealPokersEndReq=function(){console.log("发牌完成"),this.dealPokersTimer.stop(),this.dealPokersTimer=null,this.grpDeck.visible=!1;var t=EventType.GAME_QZNN,n=new e.DealPokersEndReq;n.cmd=e.CommandType.DEAL_POKERS_END_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},n.prototype.amIDealer=function(){var t=this.getMySeatNo();return-1!=t&&t==e.ExtraAttribute.get().dealerSeatNo?!0:!1},n.prototype.showStartGameCountDownTimer=function(t){this.clearTimer(),this.startGameCountDownTimer=new CountDownTimer(e.Locales.get()["start.game.countdown"]),this.grpTimer.addChild(this.startGameCountDownTimer),this.startGameCountDownTimer.timeStart(t)},n.prototype.showCallDealerCountDownTimer=function(t){var n=this;this.clearTimer(),this.callDealerCountDownTimer=new CountDownTimer(e.Locales.get()["call.dealer.countdown"]),this.grpTimer.addChild(this.callDealerCountDownTimer),this.callDealerCountDownTimer.timeStart(t),this.callDealerCountDownTimer.onComplete(function(){n.grpCallDealerControls.visible=!1})},n.prototype.showPutBetsCountDownTimer=function(t){this.clearTimer();var n="";n=this.amIDealer()?e.Locales.get()["wait.others.putbets.countdown"]:e.Locales.get()["put.bets.countdown"],this.pubBetsCountDownTimer=new CountDownTimer(n),this.grpTimer.addChild(this.pubBetsCountDownTimer),this.pubBetsCountDownTimer.timeStart(t)},n.prototype.showSubmitPokerTypeCountDownTimer=function(t){this.clearTimer();var n=e.Locales.get()["submit.pokertype.countdown"];this.submitPokerTypeCountDownTimer=new CountDownTimer(n),this.grpTimer.addChild(this.submitPokerTypeCountDownTimer),this.submitPokerTypeCountDownTimer.timeStart(t)},n.prototype.clearTimer=function(){this.grpTimer.removeChildren(),this.startGameCountDownTimer&&this.startGameCountDownTimer.stop(),this.callDealerCountDownTimer&&this.callDealerCountDownTimer.stop(),this.pubBetsCountDownTimer&&this.pubBetsCountDownTimer.stop(),this.submitPokerTypeCountDownTimer&&this.submitPokerTypeCountDownTimer.stop()},n.prototype.callDealerRes=function(e){this.showCallDealerCountDownTimer(e.callDealerTimeout),this.grpCallDealerControls.visible=!0},n.prototype.callDealerReq=function(t){var n=EventType.GAME_QZNN,o=new e.CallDealerReq;o.cmd=e.CommandType.CALL_DEALER_REQ,o.dealerMultiplier=t,e.ExtraAttribute.get().dealerMultiplier=t,Network.getInstance().request(new EventReq(n,o),this.onCallDealerSuccess.bind(this),this.onCallDealerError.bind(this))},n.prototype.onCallDealerSuccess=function(t){console.log("onCallDealerSuccess:"+JSON.stringify(t.args)),this.grpCallDealerControls.visible=!1,this.clearTimer();var n=this.getMySeaUI();this.setCallDealerContent(n,e.ExtraAttribute.get().dealerMultiplier),this.waitOtherCallDealerCountDownTimer(e.ExtraAttribute.get().callDealerTimeout,e.ExtraAttribute.get().callDealerStartTime)},n.prototype.waitOtherCallDealerCountDownTimer=function(t,n){var o=e.Locales.get()["wait.others.callDealer.countdown"],i=new CountDownTimer(o);this.grpTimer.addChild(i),isNaN(n)&&(n=egret.getTimer()/1e3);var s=Math.floor(t-(egret.getTimer()/1e3-n));0>s||i.timeStart(s)},n.prototype.onCallDealerError=function(t){console.log("onCallDealerError:"+JSON.stringify(t.args)),e.ExtraAttribute.get().dealerMultiplier=0,TipsScene.getInstance().showError(t.getContent())},n.prototype.othersCallDealerRes=function(e){var t=this.getSeatUI(e.seatNo);this.setCallDealerContent(t,e.dealerMultiplier)},n.prototype.hasDealerRes=function(e){var t=this;this.clearTimer(),this.grpCallDealerControls.visible=!1,this.showDealerCandidatesAnimation(e.dealerCandidates),setTimeout(function(){t.showHasDealerAnimation(e)},500)},n.prototype.showDealerCandidatesAnimation=function(e){var t=this;e.forEach(function(e){var n=t.getSeatUI(e);n.setImgWinner(!0),setTimeout(function(){n.setImgWinner(!1)},500)})},n.prototype.showHasDealerAnimation=function(t){var n=this,o=this.getSeatUI(e.ExtraAttribute.get().dealerSeatNo),i=GlobalUtils.createBitmapByName("dealer_b_png");i.x=this.grpCenter.width/2,i.y=this.grpCenter.height/2-i.height/2,i.width=130,i.height=130,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2;var s=GlobalUtils.createBitmapByName("light_bold_png");s.x=i.x,s.y=i.y,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,this.grpCenter.addChild(s),this.grpCenter.addChild(i);var r=egret.Tween.get(s).to({alpha:1},200).call(function(){r=egret.Tween.get(s,{loop:!0}).to({rotation:360},500).wait(500).call(function(){r.setPaused(!0),r=null,n.grpCenter.contains(s)&&n.grpCenter.removeChild(s)})}),a=this.grpCenter.globalToLocal(o.getGrpParent().x+25,o.getGrpParent().y+50),l=egret.Tween.get(i).wait(1e3).to({x:a.x,y:a.y},500).call(function(){l.setPaused(!0),l=null,this.grpCenter.removeChild(i),o.setImgButton(!0)},this)},n.prototype.setCallDealerContent=function(t,n){var o="",i="";n>0?(o=e.Locales.get()["call.dealer.multiplier"]+n,i="call_dealer_0_m4a"):0==n?(o=e.Locales.get()["no.call.dealer"],i="no_call_0_m4a"):(o=e.Locales.get()["no.ops"],i="ops_error_mp3"),t.setLabLastAction(o),SoundManager.getInstance().playEffect(i)},n.prototype.setPutBetsContent=function(t,n){var o=e.Locales.get()["put.bets.multiplier"]+n;t.setLabLastAction(o)},n.prototype.pokerFlopAnimation=function(t){var n=e.Poker.fromIndex(0);new e.PokerSprite(n,GlobalConstants.POKER_XL_W,!1,!1)},n.prototype.isMeHosted=function(){var e=UserService.getInstance().getUser();return e.beHosted},n.prototype.showGrpHost=function(){this.isMeHosted()?this.grpHost.visible=!0:this.grpHost.visible=!1},n.prototype.putBetsRes=function(e){return this.showGrpHost(),this.showPutBetsCountDownTimer(e.putBetsTimeout),this.amIDealer()?void(this.grpPutBetsControls.visible=!1):void(this.isMeHosted()||(this.grpPutBetsControls.visible=!0))},n.prototype.putBetsReq=function(t){var n=EventType.GAME_QZNN,o=new e.PutBetsReq;o.cmd=e.CommandType.PUT_BETS_REQ,o.betsMultiplier=t,e.ExtraAttribute.get().betsMultiplier=t,Network.getInstance().request(new EventReq(n,o),this.onPutBetsSuccess.bind(this),this.onPutBetsError.bind(this))},n.prototype.onPutBetsSuccess=function(t){console.log("onPutBetsSuccess:"+JSON.stringify(t.args)),this.grpPutBetsControls.visible=!1,this.clearTimer();var n=this.getMySeaUI();this.setPutBetsContent(n,e.ExtraAttribute.get().betsMultiplier),this.waitOtherPutBetsCountDownTimer(e.ExtraAttribute.get().putBetsTimeout,e.ExtraAttribute.get().putBetsStartTime)},n.prototype.waitOtherPutBetsCountDownTimer=function(t,n){var o=e.Locales.get()["wait.others.putbets.countdown"],i=new CountDownTimer(o);this.grpTimer.addChild(i),isNaN(n)&&(n=egret.getTimer()/1e3);var s=Math.floor(t-(egret.getTimer()/1e3-n));0>s||i.timeStart(s)},n.prototype.onPutBetsError=function(t){console.log("onPutBetsError:"+JSON.stringify(t.args)),e.ExtraAttribute.get().betsMultiplier=0,TipsScene.getInstance().showError(t.getContent())},n.prototype.othersPutBetsRes=function(e){var t=this.getSeatUI(e.seatNo);this.setPutBetsContent(t,e.betsMultiplier)},n.prototype.showSubmitPokerTypeControls=function(e){this.showSubmitPokerTypeCountDownTimer(e),this.addCalcCowFuncToPokerSprites(),this.grpCowCalc.visible=!0,this.grpSubmitPTControls.visible=!0,this.labSelPoker1.text="",this.labSelPoker2.text="",this.labSelPoker3.text="",this.labPokersSum.text=""},n.prototype.noSubmitPokerTypeTips=function(t){this.clearTimer();var n=e.Locales.get()["wait.others.submit.countdown"],o=new CountDownTimer(n);this.grpTimer.addChild(o),o.timeStart(Math.floor(egret.getTimer()/1e3-e.ExtraAttribute.get().submitPokerTypeStartTime))},n.prototype.submitPokerTypeRes=function(t){var n=this;this.clearTimer(),this.grpPutBetsControls.visible=!1;var o=e.ExtraAttribute.get().pokerType;if(Number(o).valueOf()>8)this.showSubmitPokerTypeControls(t.submentPokerTypeTimeout);else{if(null!=o){var i=this.getMySeaUI();i.setPokerType(e.ExtraAttribute.get().pokerType,!0)}setTimeout(function(){n.submitPokerTypeReq(!1)},3e3)}},n.prototype.addCalcCowFuncToPokerSprites=function(){var t=this,n=e.ExtraAttribute.get().pokers;n.forEach(function(e){e.addCall(t.calcPokerType.bind(t))})},n.prototype.othersSubmitPokerTypeRes=function(t){var n=this.getSeatUI(t.seatNo);n.setLabLastAction(e.Locales.get()["poker.type.submitted"]),n.setImgFinished()},n.prototype.calcCowTips=function(){var t=e.ExtraAttribute.get().pokers,n=e.ExtraAttribute.get().threePokers;t.forEach(function(e){e.getSelected()&&e.setSelected(!1)}),t.forEach(function(e){var t=!1;n.forEach(function(n){e.getPoker().getIndex()==n.getPoker().getIndex()&&(t=!0,e.setSelected(!0))})}),this.calcPokerType()},n.prototype.calcPokerType=function(){var t=e.ExtraAttribute.get().pokers;if(this.labSelPoker1.text="",this.labSelPoker2.text="",this.labSelPoker3.text="",this.labPokersSum.text="",null!=t&&5==t.length){var n=new Array,o=0;if(t.forEach(function(e){e.getSelected()&&3>o&&(n.push(e),o++)}),0!=n.length){n.length>=1&&(this.labSelPoker1.text=String(n[0].getPoker().getCowValue())),n.length>=2&&(this.labSelPoker2.text=String(n[1].getPoker().getCowValue())),n.length>=3&&(this.labSelPoker3.text=String(n[2].getPoker().getCowValue()));var i=0;n.forEach(function(e){i+=e.getPoker().getCowValue()}),this.labPokersSum.text=String(i)}}},n.prototype.submitPokerTypeReq=function(t){var n=EventType.GAME_QZNN,o=new e.SubmitPokerTypeReq;o.cmd=e.CommandType.SUBMIT_POKERTYPE_REQ;var i=e.ExtraAttribute.get().pokers,s=new Array,r=0;return i.forEach(function(e){e.getSelected()&&(r+=e.getPoker().getCowValue(),s.push(e.getPoker().getIndex()))}),1!=t||0!=r&&r%10==0?(t||(s=[]),o.threePokers=s,void Network.getInstance().request(new EventReq(n,o),this.onSubmitPokerTypeSuccess.bind(this),this.onSubmitPokerTypeError.bind(this))):void TipsScene.getInstance().showError(e.Locales.get()["calc.cow.error"])},n.prototype.onSubmitPokerTypeSuccess=function(e){console.log("onSubmitPokerTypeSuccess:"+JSON.stringify(e.args)),this.updateSubmitPokerTypeControlsOfMySeatUI()},n.prototype.updateSubmitPokerTypeControlsOfMySeatUI=function(){this.grpCowCalc.visible=!1,this.grpSubmitPTControls.visible=!1,this.grpPokersInHand.visible=!1,this.clearTimer();var t=this.getMySeaUI();t.setLabLastAction(e.Locales.get()["poker.type.submitted"]),this.setMyFiveFaceDownPokers(),t.setImgFinished(),this.waitOtherSubmitPokerTypeCountDownTimer(e.ExtraAttribute.get().submentPokerTypeTimeout,e.ExtraAttribute.get().submitPokerTypeStartTime)},n.prototype.waitOtherSubmitPokerTypeCountDownTimer=function(t,n){var o=e.Locales.get()["wait.others.submit.countdown"],i=new CountDownTimer(o);this.grpTimer.addChild(i),isNaN(n)&&(n=egret.getTimer()/1e3);var s=Math.floor(t-(egret.getTimer()/1e3-n));0>s||i.timeStart(s)},n.prototype.onSubmitPokerTypeError=function(e){console.log("onSubmitPokerTypeError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.setMyFiveFaceDownPokers=function(){var t=this.getMySeaUI();t.getGrpPokers().removeChildren();for(var n=0;5>n;n++){var o=e.Poker.fromIndex(0),i=new e.PokerSprite(o,GlobalConstants.POKER_S_W,!1,!1);t.getGrpPokers().addChild(i)}var s=-20;GlobalUtils.setHorizontalLayout(t.getGrpPokers(),s,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.showDownRes=function(){this.clearTimer(),this.grpCowCalc.visible=!1,this.grpSubmitPTControls.visible=!1,this.startShowDownTimer()},n.prototype.startShowDownTimer=function(){this.showDownIdx=0;var t=e.ExtraAttribute.get().userDatas;null!=t&&(this.showDownTimer=new egret.Timer(1e3,t.length),this.showDownTimer.addEventListener(egret.TimerEvent.TIMER,this.setPokerTypeOfTheSeatUI.bind(this),this),this.showDownTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.showImgResAnimation.bind(this),this),this.showDownTimer.start())},n.prototype.moveChipsAcrossUsers=function(){this.moveChipsToDealerAnimation(),setTimeout(this.moveChipsToWinnersAnimation.bind(this),1500),this.showDownTimer&&this.showDownTimer.stop(),setTimeout(this.updateUserScoreAndUI.bind(this),2500)},n.prototype.setPokerTypeOfTheSeatUI=function(){var t=e.ExtraAttribute.get().userDatas;if(null!=t&&0!=t.length){var n=t[this.showDownIdx];if(null!=n){var o=this.getSeatUI(n.seatNo);this.seprateAndShowPokers(o,n),o.setPokerType(n.pokerType,!1),SoundManager.getInstance().playEffect(e.Utils.pokerTypesToSound[n.pokerType]),this.showDownIdx++}}},n.prototype.showImgResAnimation=function(){var e=this,t=this.getImgAndSoundResNames();setTimeout(function(){Effects.wordsImgAnimation(e.grpImgRes,t[0],Effects.V_ALIGNMENT_MIDDLE,e.moveChipsAcrossUsers.bind(e),!0),SoundManager.getInstance().playEffect(t[1])},500)},n.prototype.getImgAndSoundResNames=function(){var t=new Array,n="",o="",i=RoomService.getInstance().getRoom().table.getMySeatNo(),s=e.ExtraAttribute.get().userDatas,r=ArrayUtils.findItemByKey(s,"seatNo",i);return null==r?t:(r.winAll?(n="tongsha_png",o="nn_ts_mp3"):r.loseAll?(n="tongpei_png",o="nn_tp_mp3"):r.win?(n="win_font_b_png",o="game_win_mp3"):(n="lose_font_b_png",o="game_lose_mp3"),t.push(n),t.push(o),t)},n.prototype.setPokerTypeOfAllSeatUIs=function(){var t=this,n=e.ExtraAttribute.get().userDatas;null!=n&&0!=n.length&&n.forEach(function(n){var o=t.getSeatUI(n.seatNo);t.seprateAndShowPokers(o,n),o.setPokerType(n.pokerType,!1),SoundManager.getInstance().playEffect(e.Utils.pokerTypesToSound[n.pokerType])})},n.prototype.getUserData=function(e,t){if(null==e||0==e.length)return null;var n=ArrayUtils.findItemByKey(e,"userId",t);return n},n.prototype.seprateAndShowPokers=function(t,n){if(t.getGrpPokers().removeChildren(),t.getGrpPokersInHand().removeChildren(),null!=n.threePokers&&3==n.threePokers.length){n.threePokers.forEach(function(n){var o=e.Poker.fromIndex(n),i=new e.PokerSprite(o,GlobalConstants.POKER_S_W,!1,!0);t.getGrpPokers().addChild(i)});var o=e.Poker.fromIndex(0),i=new e.PokerSprite(o,GlobalConstants.POKER_S_W,!1,!1);i.alpha=0,t.getGrpPokers().addChild(i),n.pokers.forEach(function(o){if(0==n.threePokers.filter(function(e){return e==o}).length){var i=e.Poker.fromIndex(o),s=new e.PokerSprite(i,GlobalConstants.POKER_S_W,!1,!0);t.getGrpPokers().addChild(s)}})}else if(null!=n.pokers)n.pokers.forEach(function(n){var o=e.Poker.fromIndex(n),i=new e.PokerSprite(o,GlobalConstants.POKER_S_W,!1,!0);t.getGrpPokers().addChild(i)});else for(var s=0;5>s;s++){var o=e.Poker.fromIndex(0),i=new e.PokerSprite(o,GlobalConstants.POKER_S_W,!1,!1);t.getGrpPokers().addChild(i)}var r=-20;GlobalUtils.setHorizontalLayout(t.getGrpPokers(),r,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.moveChipsToDealerAnimation=function(){var t=this,n=this.getSeatUI(e.ExtraAttribute.get().dealerSeatNo),o=e.ExtraAttribute.get().userDatas;null!=o&&o.forEach(function(e){var o=t.getSeatUI(e.seatNo);e.win||e.dealer||t.showChipsFlyAnimation(o,n,e.awarded)})},n.prototype.moveChipsToWinnersAnimation=function(){var t=this,n=this.getSeatUI(e.ExtraAttribute.get().dealerSeatNo),o=e.ExtraAttribute.get().userDatas;null!=o&&o.forEach(function(e){var o=t.getSeatUI(e.seatNo);e.win&&!e.dealer&&t.showChipsFlyAnimation(n,o,e.awarded);var i=new PopTips;i.launch(o.getGrpParent(),String(e.awarded))})},n.prototype.showChipsFlyAnimation=function(e,t,n){t.setImgWinner(!0);var o=new ChipsFly(10,e.getGrpParent(),t.getGrpParent());o.onComplete(function(){t.setImgWinner(!1)}),o.fly()},n.prototype.reloadDataReq=function(){console.log("请求数据重载.");var t=EventType.GAME_QZNN,n=new e.ReloadDataReq;n.cmd=e.CommandType.RELOAD_DATA_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},n.prototype.reloadDataRes=function(t){if(this.grpPutBetsControls.visible=!1,e.State[e.State.NONE]!=t.state&&e.State[e.State.WAITTING]!=t.state){if(this.grpReadyAndInvite.visible=!1,this.setLabRoundNums(),e.State[e.State.START]==t.state){var n=new CountDownTimer(e.Locales.get()["start.game.countdown"]);return this.grpTimer.addChild(n),void n.timeStart(t.startGameTimeout)}this.clearImgBeReadyOfAllSeatUIs(),this.isMeHosted()&&(this.grpHost.visible=!0),e.ExtraAttribute.get().callDealerTimeout=t.callDealerTimeout,e.ExtraAttribute.get().putBetsTimeout=t.putBetsTimeout,e.ExtraAttribute.get().submentPokerTypeTimeout=t.submentPokerTypeTimeout,e.ExtraAttribute.get().userDatas=t.userDatas;var o=this.getMyPokerIds(t.userDatas);if(e.State[e.State.DEALPOKERS1]==t.state){if(!this.doMeHaveThesePokers(t.userDatas,4))return;return void(null!=o&&this.setPokersIntoAllSeatUIs(4,o))}if(null!=o&&this.setPokersIntoAllSeatUIs(4,o),this.setDealerMultiplierOfAllSeatUIs(t.userDatas),e.State[e.State.CALLDEALER]==t.state)return void(this.doMeCallDealer(t.userDatas)?(this.waitOtherCallDealerCountDownTimer(t.callDealerTimeout,egret.getTimer()/1e3),this.grpCallDealerControls.visible=!1):(this.showCallDealerCountDownTimer(t.callDealerTimeout),this.grpCallDealerControls.visible=!0));var i=this.getSeatUI(t.dealerSeatNo);if(i.setImgButton(!0),e.State[e.State.HASDEALER]!=t.state){if(e.State[e.State.PUTBETS]==t.state)return void(this.doMePutBets(t.userDatas)?(this.waitOtherPutBetsCountDownTimer(t.putBetsTimeout,egret.getTimer()/1e3),this.grpPutBetsControls.visible=!1):(this.showPutBetsCountDownTimer(t.putBetsTimeout),this.grpPutBetsControls.visible=!0));if(e.State[e.State.DEALPOKERS2]==t.state){if(!this.doMeHaveThesePokers(t.userDatas,5))return;return void(null!=o&&this.setPokersIntoAllSeatUIs(5,o))}return null!=o&&this.setPokersIntoAllSeatUIs(5,o),e.State[e.State.SUBMITPOKERTYPE]==t.state?void(this.doMeSubmPokerType(t.userDatas)?this.updateSubmitPokerTypeControlsOfMySeatUI():this.showSubmitPokerTypeControls(t.submentPokerTypeTimeout)):e.State[e.State.SHOWDOWN]==t.state?void this.showDownRes():void this.subGameEndRes()}}},n.prototype.getMyPokerIds=function(e){var t=this.getMySeatNo();if(null==e||0==e.length)return null;var n=ArrayUtils.findItemByKey(e,"seatNo",t);return null!=n?n.pokers:null},n.prototype.doMeHaveThesePokers=function(e,t){var n=this.getMySeatNo();if(null==e||0==e.length)return!1;var o=ArrayUtils.findItemByKey(e,"seatNo",n);return null==o?!1:null!=o.pokers&&o.pokers.length>=t?!0:!1},n.prototype.doMeCallDealer=function(e){var t=this.getMySeatNo();if(null==e||0==e.length)return!1;var n=ArrayUtils.findItemByKey(e,"seatNo",t);return null==n?!1:n.callDealerMultipliers>=0?!0:!1},n.prototype.doMePutBets=function(e){var t=this.getMySeatNo();if(null==e||0==e.length)return!1;var n=ArrayUtils.findItemByKey(e,"seatNo",t);return null==n?!1:1==n.dealer||n.putBetsMultipliers>=0?!0:!1},n.prototype.doMeSubmPokerType=function(e){var t=this.getMySeatNo();if(null==e||0==e.length)return!1;var n=ArrayUtils.findItemByKey(e,"seatNo",t);return null==n?!1:n.submitPokerType?!0:!1},n.prototype.setDealerMultiplierOfAllSeatUIs=function(e){var t=this;null!=e&&0!=e.length&&e.forEach(function(e){var n=t.getSeatUI(e.seatNo);null!=n&&t.setCallDealerContent(n,e.callDealerMultipliers)})},n.prototype.setPokersIntoAllSeatUIs=function(e,t){var n=this;this.seatMap.Keys().forEach(function(o){var i=n.seatMap.Item(o);i.getIsMe()?n.setFaceUpPokersIntoMySeatUIByPokerIds(i,e,t):n.setFaceDownPokersIntoSeatUI(i,e)})},n.prototype.setFaceUpPokersIntoMySeatUIByPokerIds=function(e,t,n){e.getGrpPokersInHand().removeChildren();for(var o=0;t>o;o++)this.addOnePokerIntoSeatUI(e,n[o],!0,!0)},n.prototype.setFaceDownPokersIntoSeatUI=function(e,t){e.getGrpPokers().removeChildren();for(var n=0;t>n;n++)this.addOnePokerIntoSeatUI(e,0,!1,!1)},n.prototype.addOnePokerIntoSeatUI=function(t,n,o,i){var s=0,r=null;t.getIsMe()&&i?(s=GlobalConstants.POKER_XL_W,r=t.getGrpPokersInHand()):(s=GlobalConstants.POKER_S_W,r=t.getGrpPokers());var a=new e.PokerSprite(e.Poker.fromIndex(n),s,!1,o);a.x=a.y=0,r.addChild(a);var l=3;t.getIsMe()||(l=-20),GlobalUtils.setHorizontalLayout(r,l,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.subGameEndRes=function(){var t=e.Locales.get()["subgame.continue.countdown"],n=new CountDownTimer(t);this.grpTimer.addChild(n),n.timeStart(3)},n.prototype.gameEndRes=function(e){var t=this,n=e.content,o=new CountDownTimer(n);this.grpTimer.addChild(o),o.onComplete(function(){SceneManager.getInstance().popScene(t)}),o.timeStart(5)},n.prototype.leaveRoom=function(){var e=EventType.ROOM_LEAVE,t=new RoomLeaveReq,n=new EventReq(e,t);Network.getInstance().request(n,this.onLeaveRoomSuccess.bind(this),this.onLeaveRoomError.bind(this))},n.prototype.onLeaveRoomSuccess=function(e){console.log("onRoomLeaveSuccess:"+e.args()),RoomService.getInstance().setRoom(null)},n.prototype.onLeaveRoomError=function(e){console.log("onError:"+e.args()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.TableScene=t,__reflect(t.prototype,"Qznn.TableScene",["eui.UIComponent","egret.DisplayObject"])}(Qznn||(Qznn={}));var Qznn;!function(e){var t=function(){function e(){}return e.pokerIds=[1,2,3,4,49,50,51,52,45,46,47,48,41,42,43,44,37,38,39,40,33,34,35,36,29,30,31,32,25,26,27,28,21,22,23,24,17,18,19,20,13,14,15,16,9,10,11,12,5,6,7,8,53,54],e.pokerTypesToCN={1:"同花顺",2:"炸弹牛",3:"五花牛",4:"五小牛",5:"葫芦",6:"同花",7:"顺子",8:"牛牛",9:"牛九",10:"牛八",11:"牛七",12:"牛六",13:"牛五",14:"牛四",15:"牛三",16:"牛二",17:"牛一",18:"无牛"},e.pokerTypesToImage={1:"qznn_cow_x_png",2:"qznn_cow_12_png",3:"qznn_cow_11_png",4:"qznn_cow_13_png",5:"qznn_cow_x_png",6:"qznn_cow_x_png",7:"qznn_cow_x_png",8:"qznn_cow_10_png",9:"qznn_cow_9_png",10:"qznn_cow_8_png",11:"qznn_cow_7_png",12:"qznn_cow_6_png",13:"qznn_cow_5_png",14:"qznn_cow_4_png",15:"qznn_cow_3_png",16:"qznn_cow_2_png",17:"qznn_cow_1_png",18:"qznn_cow_0_png",fold:"qznn_fold_png"},e.pokerTypesToSound={1:"ops_error_mp3",2:"nn_bomb_mp3",3:"nn_5hua_mp3",4:"nn_5xiao_mp3",5:"ops_error_mp3",6:"ops_error_mp3",7:"ops_error_mp3",8:"nn_niu10_mp3",9:"nn_niu9_mp3",10:"nn_niu8_mp3",11:"nn_niu7_mp3",12:"nn_niu6_mp3",13:"nn_niu5_mp3",14:"nn_niu4_mp3",15:"nn_niu3_mp3",16:"nn_niu2_mp3",17:"nn_niu1_mp3",18:"nn_niu0_mp3",fold:"ops_error_mp3"},e}();e.Utils=t,__reflect(t.prototype,"Qznn.Utils")
}(Qznn||(Qznn={}));var RoomList;!function(e){var t=function(){function e(){}return e.GET_CARD_MODE_OPENING_ROOMS="Get.Card.Mode.Opening.Rooms",e.GET_CARD_MODE_ONLINE_ROOMS="Get.Card.Mode.Online.Rooms",e.GET_CARD_MODE_OFFLINE_ROOMS="Get.Card.Mode.Offline.Rooms",e.GET_MY_OPENING_ROOMS="Get.My.Opening.Rooms",e.GET_MY_ONLINE_ROOMS="Get.My.Online.Rooms",e.GET_MY_OFFLINE_ROOMS="Get.My.Offline.Rooms",e.GET_MY_JOINED_ROOMS="Get.My.Joined.Rooms",e.GET_CLUB_MODE_OPENING_ROOMS="Get.Club.Mode.Opening.Rooms",e.GET_CLUB_MODE_ONLINE_ROOMS="Get.Club.Mode.Online.Rooms",e.GET_CLUB_MODE_OFFLINE_ROOMS="Get.Club.Mode.Offline.Rooms",e.GET_CONTEST_MODE_OPENING_ROOMS="Get.Contest.Mode.Opening.Rooms",e.GET_CONTEST_MODE_ONLINE_ROOMS="Get.Contest.Mode.Online.Rooms",e.GET_CONTEST_MODE_OFFLINE_ROOMS="Get.Contest.Mode.Offline.Rooms",e.GET_AUTO_MODE_OPENING_ROOMS="Get.Auto.Mode.Opening.Rooms",e.GET_AUTO_MODE_ONLINE_ROOMS="Get.Auto.Mode.Online.Rooms",e.GET_AUTO_MODE_OFFLINE_ROOMS="Get.Auto.Mode.Offline.Rooms",e.GET_ROOM="Get.Room",e}();e.CommandType=t,__reflect(t.prototype,"RoomList.CommandType")}(RoomList||(RoomList={}));var RoomList;!function(e){var t=function(){function e(){}return e.ITEM_ROOMS_NUM_PER_PAGE=30,e.ITEMS_CACHE_TIMEOUT=5e3,e.REQUEST_RETRY_LIMIT=5e3,e}();e.Constants=t,__reflect(t.prototype,"RoomList.Constants")}(RoomList||(RoomList={}));var CreateRoomScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="CreateRoomSkin",t.addEventListener(eui.UIEvent.COMPLETE,function(){},t),t.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(t.stage,t),t.roomConfsReq()},t),t}return __extends(t,e),t.getInstance=function(){return null==this.createRoomScene&&(this.createRoomScene=new t),this.createRoomScene},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initOnce()},t.prototype.close=function(){SceneManager.getInstance().popScene(this)},t.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.initTabMenu(),this.crRadioBtn.group.addEventListener(eui.UIEvent.CHANGE,function(t){var n=t.target;e.vsCreateRooms.selectedIndex=n.selectedValue,SoundManager.getInstance().playEffect("btn_click_mp3")},this),this.btnCreateDdzRoom.setClick(function(){e.createDdzRoom()}),this.btnCreateTexasRoom.setClick(function(){e.createTexasRoom()}),this.btnCreateQznnRoom.setClick(function(){e.createQznnRoom()}),this.btnCreateZjhRoom.setClick(function(){e.createZjhRoom()}),this.hsTexasCapacity.addEventListener(egret.Event.CHANGE,this.onHsTexasCapacityChange,this),this.hsQznnCapacity.addEventListener(egret.Event.CHANGE,this.onHsQznnCapacityChange,this),this.hsZjhCapacity.addEventListener(egret.Event.CHANGE,this.onHsZjhCapacityChange,this)},t.prototype.initTabMenu=function(){this.grpCreateDdzRoom.horizontalCenter=0,this.grpCreateDdzRoom.verticalCenter=0,this.vsCreateRooms.addChild(this.grpCreateDdzRoom),this.grpCreateTexasRoom.horizontalCenter=0,this.grpCreateTexasRoom.verticalCenter=0,this.vsCreateRooms.addChild(this.grpCreateTexasRoom),this.grpCreateQznnRoom.horizontalCenter=0,this.grpCreateQznnRoom.verticalCenter=0,this.vsCreateRooms.addChild(this.grpCreateQznnRoom),this.grpCreateZjhRoom.horizontalCenter=0,this.grpCreateZjhRoom.verticalCenter=0,this.vsCreateRooms.addChild(this.grpCreateZjhRoom),this.vsCreateRooms.selectedIndex=0},t.prototype.roomConfsReq=function(){if(console.log("请求房间的配置."),null==this.roomConfs||0==this.roomConfs.length){var e=EventType.ROOM_CONFS,t=new RoomConfsReq,n=new EventReq(e,t);Network.getInstance().send(n)}},t.prototype.romConfsRes=function(e){console.log("处理房间的配置.");var t=e;null!=t&&(this.roomConfs=t.roomConfs,LocalStorage.setItemObj(GlobalConstants.ROOM_CONFS,t.roomConfs),this.initRoomConfs())},t.prototype.initRoomConfs=function(){this.initDdzRoomConf(),this.initTexasRoomConf(),this.initQznnRoomConf(),this.initZjhRoomConf()},t.prototype.initDdzRoomConf=function(){var e=ArrayUtils.findItemByKey(this.roomConfs,"roomType",RoomType.DDZ);if(null!=e){var t=e.bottomScore.split("|");this.ddzBottomOpt1.label=t[0],this.ddzBottomOpt2.label=t[1],this.ddzBottomOpt3.label=t[2],this.ddzBottomOpt1.value=t[0],this.ddzBottomOpt2.value=t[1],this.ddzBottomOpt3.value=t[2];var n=e.rounds.split("|");this.ddzRoundsOpt1.label=n[0],this.ddzRoundsOpt2.label=n[1],this.ddzRoundsOpt3.label=n[2],this.ddzRoundsOpt1.value=n[0],this.ddzRoundsOpt2.value=n[1],this.ddzRoundsOpt3.value=n[2];var o=e.minChips.split("|");this.ddzMinChipsOpt1.label=o[0],this.ddzMinChipsOpt2.label=o[1],this.ddzMinChipsOpt3.label=o[2],this.ddzMinChipsOpt1.value=o[0],this.ddzMinChipsOpt2.value=o[1],this.ddzMinChipsOpt3.value=o[2],this.labDdzRoomOwnerPrice.text=String(e.price),this.labDdzRoomAAPrice.text=""}},t.prototype.onHsTexasCapacityChange=function(){this.labTexasCapacity.text=String(this.hsTexasCapacity.value)},t.prototype.onHsQznnCapacityChange=function(){this.labQznnCapacity.text=String(this.hsQznnCapacity.value)},t.prototype.onHsZjhCapacityChange=function(){this.labZjhCapacity.text=String(this.hsZjhCapacity.value)},t.prototype.initTexasRoomConf=function(){var e=ArrayUtils.findItemByKey(this.roomConfs,"roomType",RoomType.TEXAS);if(null!=e){var t=e.bottomScore.split("|");this.texasBottomOpt1.label=t[0]+"/"+String(2*Number(t[0])),this.texasBottomOpt2.label=t[1]+"/"+String(2*Number(t[1])),this.texasBottomOpt3.label=t[2]+"/"+String(2*Number(t[2])),this.texasBottomOpt1.value=t[0],this.texasBottomOpt2.value=t[1],this.texasBottomOpt3.value=t[2];var n=e.rounds.split("|");this.texasRoundsOpt1.label=n[0],this.texasRoundsOpt2.label=n[1],this.texasRoundsOpt3.label=n[2],this.texasRoundsOpt1.value=n[0],this.texasRoundsOpt2.value=n[1],this.texasRoundsOpt3.value=n[2];var o=e.minChips.split("|");this.texasMinChipsOpt1.label=o[0],this.texasMinChipsOpt2.label=o[1],this.texasMinChipsOpt3.label=o[2],this.texasMinChipsOpt1.value=o[0],this.texasMinChipsOpt2.value=o[1],this.texasMinChipsOpt3.value=o[2];var i=e.maxChips.split("|");this.texasMaxChipsOpt1.label=i[0],this.texasMaxChipsOpt2.label=i[1],this.texasMaxChipsOpt3.label=i[2],this.texasMaxChipsOpt1.value=i[0],this.texasMaxChipsOpt2.value=i[1],this.texasMaxChipsOpt3.value=i[2],this.hsTexasCapacity.minimum=2,this.hsTexasCapacity.maximum=9,this.hsTexasCapacity.value=6,this.hsTexasCapacity.snapInterval=1,this.labTexasCapacity.text=String(this.hsTexasCapacity.value),this.labTexasRoomOwnerPrice.text=String(e.price),this.labTexasRoomAAPrice.text=""}},t.prototype.initQznnRoomConf=function(){var e=ArrayUtils.findItemByKey(this.roomConfs,"roomType",RoomType.QZNN);if(null!=e){var t=e.bottomScore.split("|");this.qznnBottomOpt1.label=t[0],this.qznnBottomOpt2.label=t[1],this.qznnBottomOpt3.label=t[2],this.qznnBottomOpt1.value=t[0],this.qznnBottomOpt2.value=t[1],this.qznnBottomOpt3.value=t[2];var n=e.rounds.split("|");this.qznnRoundsOpt1.label=n[0],this.qznnRoundsOpt2.label=n[1],this.qznnRoundsOpt3.label=n[2],this.qznnRoundsOpt1.value=n[0],this.qznnRoundsOpt2.value=n[1],this.qznnRoundsOpt3.value=n[2];var o=e.minChips.split("|");this.qznnMinChipsOpt1.label=o[0],this.qznnMinChipsOpt2.label=o[1],this.qznnMinChipsOpt3.label=o[2],this.qznnMinChipsOpt1.value=o[0],this.qznnMinChipsOpt2.value=o[1],this.qznnMinChipsOpt3.value=o[2],this.hsQznnCapacity.minimum=2,this.hsQznnCapacity.maximum=9,this.hsQznnCapacity.value=6,this.hsQznnCapacity.snapInterval=1,this.labQznnCapacity.text=String(this.hsQznnCapacity.value),this.labQznnRoomOwnerPrice.text=String(e.price),this.labQznnRoomAAPrice.text=""}},t.prototype.initZjhRoomConf=function(){var e=ArrayUtils.findItemByKey(this.roomConfs,"roomType",RoomType.QZNN);if(null!=e){var t=e.bottomScore.split("|");this.zjhBottomOpt1.label=t[0],this.zjhBottomOpt2.label=t[1],this.zjhBottomOpt3.label=t[2],this.zjhBottomOpt1.value=t[0],this.zjhBottomOpt2.value=t[1],this.zjhBottomOpt3.value=t[2];var n=e.rounds.split("|");this.zjhRoundsOpt1.label=n[0],this.zjhRoundsOpt2.label=n[1],this.zjhRoundsOpt3.label=n[2],this.zjhRoundsOpt1.value=n[0],this.zjhRoundsOpt2.value=n[1],this.zjhRoundsOpt3.value=n[2];var o=e.minChips.split("|");this.zjhMinChipsOpt1.label=o[0],this.zjhMinChipsOpt2.label=o[1],this.zjhMinChipsOpt3.label=o[2],this.zjhMinChipsOpt1.value=o[0],this.zjhMinChipsOpt2.value=o[1],this.zjhMinChipsOpt3.value=o[2];var i=e.maxChips.split("|");this.zjhMaxChipsOpt1.label=i[0],this.zjhMaxChipsOpt2.label=i[1],this.zjhMaxChipsOpt3.label=i[2],this.zjhMaxChipsOpt1.value=i[0],this.zjhMaxChipsOpt2.value=i[1],this.zjhMaxChipsOpt3.value=i[2],this.hsZjhCapacity.minimum=2,this.hsZjhCapacity.maximum=9,this.hsZjhCapacity.value=6,this.hsZjhCapacity.snapInterval=1,this.labZjhCapacity.text=String(this.hsZjhCapacity.value),this.labZjhRoomOwnerPrice.text=String(e.price),this.labZjhRoomAAPrice.text=""}},t.prototype.createDdzRoom=function(){console.log("创建Ddz房间");var e=EventType.ROOM_CREATE,t=new RoomCreateReq;t.type=RoomType.DDZ,t.tier=RoomTier.STD,t.price=Number(this.labDdzRoomOwnerPrice.text),t.category=RoomCategory.CARDMODE,t.subCatId="0",t.bottomScore=this.ddzBottomOpt1.group.selectedValue,t.rounds=this.ddzRoundsOpt1.group.selectedValue,t.minChips=this.ddzMinChipsOpt1.group.selectedValue,t.chargingMode=this.ddzChargingModeOpt1.group.selectedValue,t.capacity=3;var n=new EventReq(e,t);Network.getInstance().request(n,this.onCreateDdzRoomSuccess.bind(this),this.onCreateDdzRoomError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},t.prototype.onCreateDdzRoomSuccess=function(e){console.log("onCreateDdzRoomSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance())},t.prototype.onCreateDdzRoomError=function(e){console.log("onCreateDdzRoomError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},t.prototype.createTexasRoom=function(){console.log("创建Texas房间");var e=EventType.ROOM_CREATE,t=new RoomCreateReq;t.type=RoomType.TEXAS,t.tier=RoomTier.STD,t.price=Number(this.labTexasRoomOwnerPrice.text),t.category=RoomCategory.CARDMODE,t.subCatId="0",t.bottomScore=this.texasBottomOpt1.group.selectedValue,t.rounds=this.texasRoundsOpt1.group.selectedValue,t.minChips=this.texasMinChipsOpt1.group.selectedValue,t.maxChips=this.texasMaxChipsOpt1.group.selectedValue,t.chargingMode=this.texasChargingModeOpt1.group.selectedValue,t.capacity=this.hsTexasCapacity.value;var n=new EventReq(e,t);Network.getInstance().request(n,this.onCreateTexasRoomSuccess.bind(this),this.onCreateTexasRoomError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},t.prototype.onCreateTexasRoomSuccess=function(e){console.log("onCreateTexasRoomSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance())},t.prototype.onCreateTexasRoomError=function(e){console.log("onCreatTexasRoomError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},t.prototype.createQznnRoom=function(){console.log("创建Qznn房间");var e=EventType.ROOM_CREATE,t=new RoomCreateReq;t.type=RoomType.QZNN,t.tier=RoomTier.STD,t.price=Number(this.labQznnRoomOwnerPrice.text),t.category=RoomCategory.CARDMODE,t.subCatId="0",t.bottomScore=this.qznnBottomOpt1.group.selectedValue,t.rounds=this.qznnRoundsOpt1.group.selectedValue,t.minChips=this.qznnMinChipsOpt1.group.selectedValue,t.chargingMode=this.qznnChargingModeOpt1.group.selectedValue,t.capacity=this.hsQznnCapacity.value;var n=new EventReq(e,t);Network.getInstance().request(n,this.onCreateQznnRoomSuccess.bind(this),this.onCreateQznnRoomError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},t.prototype.onCreateQznnRoomSuccess=function(e){console.log("onCreateQznnRoomSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance())},t.prototype.onCreateQznnRoomError=function(e){console.log("onCreateQznnRoomError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},t.prototype.createZjhRoom=function(){console.log("创建Zjh房间");var e=EventType.ROOM_CREATE,t=new RoomCreateReq;t.type=RoomType.ZJH,t.tier=RoomTier.STD,t.price=Number(this.labZjhRoomOwnerPrice.text),t.category=RoomCategory.CARDMODE,t.subCatId="0",t.bottomScore=this.zjhBottomOpt1.group.selectedValue,t.rounds=this.zjhRoundsOpt1.group.selectedValue,t.minChips=this.zjhMinChipsOpt1.group.selectedValue,t.maxChips=this.zjhMaxChipsOpt1.group.selectedValue,t.chargingMode=this.zjhChargingModeOpt1.group.selectedValue,t.capacity=this.hsZjhCapacity.value;var n=new EventReq(e,t);Network.getInstance().request(n,this.onCreateZjhRoomSuccess.bind(this),this.onCreateZjhRoomError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},t.prototype.onCreateZjhRoomSuccess=function(e){console.log("onCreateZjhRoomSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance())},t.prototype.onCreateZjhRoomError=function(e){console.log("onCreateZjhRoomError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},t.prototype.joinRoom=function(e){console.log("加入房间："+e);var t=EventType.ROOM_JOIN,n=new RoomJoinReq;n.roomId=e;var o=new EventReq(t,n);Network.getInstance().request(o,this.onJoinRoomSuccess.bind(this),this.onJoinRoomError.bind(this))},t.prototype.onJoinRoomSuccess=function(e){console.log("onJoinRoomSuccess:"+e.getArgs());var t=e.getArgs();Room.init(t.room);var n=RoomService.getInstance().getRoom();Table.init(n);var o=EventHandlersManager.getExtraAttrByRoomType(n.type);n.table.setExtraAttribute(o),n.capacity=3,User.init(t.users)},t.prototype.getOthersReadyStatus=function(e){switch(e.room.type){case RoomType.DDZ:console.log("斗地主.");break;case RoomType.TEXAS:console.log("德州扑克.");break;default:console.log("房间类型:"+e.room.type+"不存在.")}},t.prototype.onJoinRoomError=function(e){console.log("onJoinRoomError:"+e.getContent()),TipsScene.getInstance().showError(e.getContent())},t}(eui.Component);__reflect(CreateRoomScene.prototype,"CreateRoomScene",["eui.UIComponent","egret.DisplayObject"]);var InviteScene=function(e){function t(){var t=e.call(this)||this;return t.url="",t.skinName="InviteSkin",t.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(t.stage,t)},t),t}return __extends(t,e),t.getInstance=function(){return null==this.inviteScene&&(this.inviteScene=new t),this.inviteScene},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initOnce()},t.prototype.close=function(){SceneManager.getInstance().popScene(this)},t.prototype.setEntityId=function(e){this.labEntityId.text=String(e),this.url=GlobalConstants.HTTP_URL+"/?rid="+String(e),this.labUrl.text=this.url},t.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.createQrCode()},t.prototype.createQrCode=function(){var e=qr.QRCode.create(this.url,250,250);e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=.5*this.grpQrCode.width,e.y=this.grpQrCode.height-this.grpQrCode.height/2,this.grpQrCode.addChild(e)},t}(eui.Component);__reflect(InviteScene.prototype,"InviteScene",["eui.UIComponent","egret.DisplayObject"]);var JoinRoomScene=function(e){function t(){var t=e.call(this)||this;return t.numberlist="------",t.numberIndex=0,t.skinName="JoinRoomSkin",t}return __extends(t,e),t.getInstance=function(){return null==this.joinRoomScene&&(this.joinRoomScene=new t),this.joinRoomScene},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.btnGoBack.setClick(function(){t.close()}),this.btnClose.setClick(function(){t.close()});for(var n=this.ebtn_group_number.numChildren,o=0;n>o;o++){var i=this.ebtn_group_number.getChildAt(o);i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){var n=e.currentTarget,o=n.name;"del1"==o?(0==t.numberIndex?0:t.numberIndex-=1,t.UpdateNumberList(t.numberIndex,"-")):"del2"==o?(t.numberIndex=0,t.numberlist="------"):t.numberIndex<=5&&(t.UpdateNumberList(t.numberIndex,n.name),t.numberIndex+=1),t.UpdateNumber(),6==t.numberIndex&&(console.log("开始查找房间"),t.joinRoomReq(t.numberlist))},this)}},t.prototype.close=function(){SceneManager.getInstance().popScene(this)},t.prototype.UpdateNumber=function(){this.lb0.text=this.numberlist[0],this.lb1.text=this.numberlist[1],this.lb2.text=this.numberlist[2],this.lb3.text=this.numberlist[3],this.lb4.text=this.numberlist[4],this.lb5.text=this.numberlist[5]},t.prototype.UpdateNumberList=function(e,t){for(var n="",o=0;o<this.numberlist.length;o++)n+=e==o?t:this.numberlist[o];this.numberlist=n},t.prototype.joinRoomReq=function(e){console.log("加入房间："+e);var t=EventType.ROOM_JOIN,n=new RoomJoinReq;n.roomId=e;var o=new EventReq(t,n);Network.getInstance().request(o,this.onJoinRoomSuccess.bind(this),this.onJoinRoomError.bind(this)),GlobalVars.getInstance().ajRoomId=null},t.prototype.onJoinRoomSuccess=function(e){console.log("onJoinRoomSuccess:"+e.getArgs());e.getArgs()},t.prototype.onJoinRoomError=function(e){console.log("onJoinRoomError:"+e.getContent()),TipsScene.getInstance().showError(e.getContent())},t}(eui.Component);__reflect(JoinRoomScene.prototype,"JoinRoomScene",["eui.UIComponent","egret.DisplayObject"]);var RoomList;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.roomListLogic&&(this.roomListLogic=new t),this.roomListLogic},t.prototype.getCommand=function(e){return e.cmd},t.prototype.processCmd=function(t){var n=null,o="",i=this.getCommand(t);switch(i){case e.CommandType.GET_ROOM:console.log("取得房间的命令."),n=this.getRoomRes(t);break;default:o="命令:"+i+"不存在.",n=new FuncResult(!1,o)}return n},t.prototype.getRoomRes=function(e){var t=e;GameResult.GameRslData.getInstance().roomListRes(t)},t}();e.RoomListLogic=t,__reflect(t.prototype,"RoomList.RoomListLogic")}(RoomList||(RoomList={}));var Setting;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n.skinName="SettingSkin",n.curtScene=t,n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(n.stage,n),n.initCToggleBtnValue()},n),n}return __extends(t,e),t.getInstance=function(e){return null==this.settingScene&&(this.settingScene=new t(e)),this.settingScene},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initOnce()},t.prototype.close=function(){SceneManager.getInstance().popScene(this)},t.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnMusicBg.setClick(function(){e.onChanged()}),this.btnMusicEffect.setClick(function(){e.onChanged()})},t.prototype.initCToggleBtnValue=function(){1==SoundManager.getInstance().musicMute?this.btnMusicBg.setSelected(!1):this.btnMusicBg.setSelected(!0),1==SoundManager.getInstance().effectMute?this.btnMusicEffect.setSelected(!1):this.btnMusicEffect.setSelected(!0)},t.prototype.onChanged=function(){var e=!0;this.btnMusicBg.selected&&(e=!1);var t=!0;this.btnMusicEffect.selected&&(t=!1),SoundManager.getInstance().musicMute=e,SoundManager.getInstance().effectMute=t,this.switchMusicBackGround()},t.prototype.switchMusicBackGround=function(){return SoundManager.getInstance().musicMute?void SoundManager.getInstance().stopMusic():void("HallScene"==this.curtScene?SoundManager.getInstance().playMusic("bg_hall_mp3"):"Ddz.TableScene"==this.curtScene?SoundManager.getInstance().playMusic("bg_ddz_mp3"):"Qznn.TableScene"==this.curtScene?SoundManager.getInstance().playMusic("bg_qznn_mp3"):"Texas.TableScene"==this.curtScene?SoundManager.getInstance().playMusic("bg_texas_mp3"):"Zjh.TableScene"==this.curtScene&&SoundManager.getInstance().playMusic("bg_zjh_mp3"))},t}(eui.Component);e.SettingScene=t,__reflect(t.prototype,"Setting.SettingScene",["eui.UIComponent","egret.DisplayObject"])}(Setting||(Setting={}));var Share;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.url="",t.skinName="ShareSkin",t.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(t.stage,t)},t),t}return __extends(t,e),t.getInstance=function(){return null==this.shareScene&&(this.shareScene=new t),this.shareScene},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initOnce()},t.prototype.close=function(){SceneManager.getInstance().popScene(this)},t.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()});var t=UserService.getInstance().getUser();this.labEntityId.text=String(t.id),this.url=GlobalConstants.HTTP_URL+"/?ref="+this.labEntityId.text,this.labUrl.text=this.url,this.createQrCode()},t.prototype.createQrCode=function(){var e=qr.QRCode.create(this.url,250,250);e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=.5*this.grpQrCode.width,e.y=this.grpQrCode.height-this.grpQrCode.height/2,this.grpQrCode.addChild(e)},t}(eui.Component);e.ShareScene=t,__reflect(t.prototype,"Share.ShareScene",["eui.UIComponent","egret.DisplayObject"])}(Share||(Share={}));var Shop;!function(e){var t=function(){function e(){}return e.GET_SHOP_REQ="Get.Shop.Req",e.GET_SHOP_RES="Get.Shop.Res",e.GET_MY_ORDERS_REQ="Get.My.Orders.Req",e.GET_MY_ORDERS_RES="Get.My.Orders.Res",e.PLACE_ORDER_REQ="Place.Order.Req",e.PLACE_ORDER_RES="Place.Order.Res",e.BIND_PAYMENT_REQ="Bind.Payment.Req",e.BIND_PAYMENT_RES="Bind.Payment.Res",e.DELETE_ORDER_REQ="Delete.Order.Req",e.DELETE_ORDER_RES="Delete.Order.Res",e}();e.CommandType=t,__reflect(t.prototype,"Shop.CommandType")}(Shop||(Shop={}));var Shop;!function(e){var t=function(){function e(){}return e.ITEM_ORDERS_NUM_PER_PAGE=30,e.ITEMS_CACHE_TIMEOUT=5e3,e.REQUEST_RETRY_LIMIT=5e3,e.WEXIN_ICON_NAME="wexin_icon_png",e.QQ_ICON_NAME="qq_icon_png",e}();e.Constants=t,__reflect(t.prototype,"Shop.Constants")}(Shop||(Shop={}));var Shop;!function(e){var t=function(){function e(){}return e}();e.ShopReq=t,__reflect(t.prototype,"Shop.ShopReq");var n=function(){function e(){}return e}();e.ShopRes=n,__reflect(n.prototype,"Shop.ShopRes");var o=function(){function e(){}return e}();e.ShopConf=o,__reflect(o.prototype,"Shop.ShopConf");var i=function(){function e(){}return e}();e.Operator=i,__reflect(i.prototype,"Shop.Operator");var s=function(){function e(){}return e}();e.Product=s,__reflect(s.prototype,"Shop.Product");var r=function(){function e(){}return e}();e.ShopOrders=r,__reflect(r.prototype,"Shop.ShopOrders");var a=function(){function e(){}return e}();e.Order=a,__reflect(a.prototype,"Shop.Order")}(Shop||(Shop={}));var Shop;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemOperatorSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var n="";n=this.data.type==e.OperatorType.QQ?e.Constants.QQ_ICON_NAME:e.Constants.WEXIN_ICON_NAME,this.imgOperatorType=GlobalUtils.getImagebyUrl(n),this.labOperatorId.text=String(this.data.openId)},n}(eui.ItemRenderer);e.ItemOperator=t,__reflect(t.prototype,"Shop.ItemOperator")}(Shop||(Shop={}));var Shop;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemOrderSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){var e=this;this.btnAction.setClick(function(){e.onBtnClicked()})},n.prototype.onBtnClicked=function(){this.deleteOrderReq()},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.state==e.OrderState.PENDING?this.btnAction.visible=!0:this.btnAction.visible=!1,this.labAmount.text=String(this.data.amount),this.data.prodType==e.ProductType.CARD?(this.imgRoomCard.visible=!0,this.labCardsNum.visible=!0,this.labCardsNum.text=String(this.data.qty),this.imgCoin.visible=!1,this.labCoinsNum.visible=!1):this.data.prodType==e.ProductType.COIN&&(this.imgCoin.visible=!0,this.labCoinsNum.visible=!0,this.labCoinsNum.text=String(this.data.qty),this.imgRoomCard.visible=!1,this.labCardsNum.visible=!1),this.labState.text=this.getState(this.data.state),this.labPaymentType.text=this.getPaymentType(String(this.data.paymentType)),this.labPaymentId.text=String(this.data.paymentId),this.labCreateTime.text=String(GlobalUtils.dateFormat(this.data.createTime))},n.prototype.getState=function(t){var n="";return t==e.OrderState.PENDING?n=e.Locales.get()["Order.State.Pending"]:t==e.OrderState.APPROVED?n=e.Locales.get()["Order.State.Approved"]:t==e.OrderState.PROCESSED&&(n=e.Locales.get()["Order.State.Processed"]),n},n.prototype.getPaymentType=function(t){var n="";return t==e.PaymentType.BANKCARD?n=e.Locales.get()["Payment.Type.BankCard"]:t==e.PaymentType.ALIPAY?n=e.Locales.get()["Payment.Type.Alipay"]:t==e.PaymentType.WEIXINPAY&&(n=e.Locales.get()["Payment.Type.Wxpay"]),n},n.prototype.deleteOrderReq=function(){console.log("撤销订单");var t=EventType.SHOP_MGMT,n=new e.ShopReq;n.cmd=e.CommandType.DELETE_ORDER_REQ,n.orderId=this.data.id;var o=new EventReq(t,n);Network.getInstance().request(o,this.onDeleteOrderSuccess.bind(this),this.onDeleteOrderError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onDeleteOrderSuccess=function(t){console.log("onDeleteOrderSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),e.ShopOrdersScene.getInstance().refreshOrdersList(this.data.id),TipsScene.getInstance().showInfo(t.getContent())},n.prototype.onDeleteOrderError=function(e){console.log("onDeleteOrderError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.ItemRenderer);e.ItemOrder=t,__reflect(t.prototype,"Shop.ItemOrder")}(Shop||(Shop={}));var Shop;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="ItemProductSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.createChildren.call(this),this.initOnce()},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.initOnce=function(){var e=this;this.btnAction.setClick(function(){e.onBtnClicked()})},t.prototype.onBtnClicked=function(){},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.imgProd=GlobalUtils.getImagebyUrl(this.data.image),this.labProdName.text=String(this.data.name),this.labProdQty.text=String(this.data.qty),this.btnAction.setLabTitle(String(this.data.price))},t}(eui.ItemRenderer);e.ItemProuduct=t,__reflect(t.prototype,"Shop.ItemProuduct")}(Shop||(Shop={}));var Shop;!function(e){var t=function(){function e(){}return e.get=function(){return e.CN},e.CN={"Network.Timeout.Error":"网络超时,请稍后重试","Network.Common.Error":"网络错误,请稍后重试","Order.State.Pending":"待处理","Order.State.Approved":"已批准","Order.State.Processed":"已完成","Payment.Type.BankCard":"银行卡","Payment.Type.Alipay":"支付宝","Payment.Type.Wxpay":"微信支付"},e}();e.Locales=t,__reflect(t.prototype,"Shop.Locales")}(Shop||(Shop={}));var Shop;!function(e){var t=function(){function e(){}return e.PENDING="PENDING",e.APPROVED="APPROVED",e.PROCESSED="PROCESSED",e}();e.OrderState=t,__reflect(t.prototype,"Shop.OrderState");var n=function(){function e(){}return e.VIPRECHARGE="VIPRECHARGE",e.RECHARGE="RECHARGE",e.WITHDRAW="WITHDRAW",e}();e.OrderType=n,__reflect(n.prototype,"Shop.OrderType");var o=function(){function e(){}return e.WEXIN="WEXIN",e.QQ="QQ",e}();e.OperatorType=o,__reflect(o.prototype,"Shop.OperatorType");var i=function(){function e(){}return e.BANKCARD="BANKCARD",e.ALIPAY="ALIPAY",e.WEIXINPAY="WEIXINPAY",e}();e.PaymentType=i,__reflect(i.prototype,"Shop.PaymentType");var s=function(){function e(){}return e.CARD="CARD",e.COIN="COIN",e.PROPS="PROPS",e.COMMODITY="COMMODITY",e}();e.ProductType=s,__reflect(s.prototype,"Shop.ProductType");var r=function(){function e(){}return e.RMB="RMB",e.CARD="CARD",e.COIN="COIN",e}();e.ProductCurrencyType=r,__reflect(r.prototype,"Shop.ProductCurrencyType")}(Shop||(Shop={}));var Shop;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.shopData&&(this.shopData=new t),this.shopData},t.prototype.getShopReq=function(){console.log("请求商店.");var t=EventType.SHOP_MGMT,n=new e.ShopReq;n.cmd=e.CommandType.GET_SHOP_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},t.prototype.getShopRes=function(e){console.log("取得商店的响应."),this.shop=e,console.log(this.shop.shopConf.withdrawNote),this.shopTimeStamp=egret.getTimer()},t.prototype.getShop=function(){return this.isShopDataRefreshed()?this.shop:void(egret.getTimer()-this.shopReqTimeStamp<e.Constants.REQUEST_RETRY_LIMIT||(this.shopReqTimeStamp=egret.getTimer(),this.getShopReq()))},t.prototype.isShopDataRefreshed=function(){return egret.getTimer()-this.shopTimeStamp<e.Constants.ITEMS_CACHE_TIMEOUT?!0:!1},t.prototype.getOrdersReq=function(){console.log("请求充值提现的记录.");var t=EventType.SHOP_MGMT,n=new e.ShopReq;n.cmd=e.CommandType.GET_MY_ORDERS_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},t.prototype.getOrdersRes=function(e){console.log("取得充值提现的响应."),this.shopOrders=e.orders,this.ordersTimeStamp=egret.getTimer()},t.prototype.getOrders=function(){return this.isOrdersDataRefreshed()?this.shopOrders:void(egret.getTimer()-this.ordersReqTimeStamp<e.Constants.REQUEST_RETRY_LIMIT||(this.ordersReqTimeStamp=egret.getTimer(),this.getOrdersReq()))},t.prototype.isOrdersDataRefreshed=function(){return egret.getTimer()-this.ordersTimeStamp<e.Constants.ITEMS_CACHE_TIMEOUT?!0:!1},t}();e.ShopData=t,__reflect(t.prototype,"Shop.ShopData")}(Shop||(Shop={}));var Shop;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.shopLogic&&(this.shopLogic=new t),this.shopLogic},t.prototype.getCommand=function(e){return e.cmd},t.prototype.processCmd=function(t){var n=null,o="",i=this.getCommand(t);switch(i){case e.CommandType.GET_SHOP_RES:console.log("取得商店的响应."),n=this.getShopRes(t);break;case e.CommandType.GET_MY_ORDERS_RES:console.log("取得我的充值提现记录的响应."),n=this.getOrdersRes(t);break;default:o="命令:"+i+"不存在.",n=new FuncResult(!1,o)}return n},t.prototype.getShopRes=function(t){var n=null,o=t;return e.ShopData.getInstance().getShopRes(o),n},t.prototype.getOrdersRes=function(t){var n=null,o=t;return e.ShopData.getInstance().getOrdersRes(o),n},t}();e.ShopLogic=t,__reflect(t.prototype,"Shop.ShopLogic")}(Shop||(Shop={}));var Shop;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.detailedOrders=new Array,e.skinName="ShopOrdersSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),e.syncGetShopOrders()},e),e}return __extends(n,t),n.getInstance=function(){return null==this.shopOrdersScene&&(this.shopOrdersScene=new n),this.shopOrdersScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh.setClick(function(){e.syncGetShopOrders()})},n.prototype.syncGetShopOrders=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getShopOrders()},!0,GlobalConstants.WAIT_FOR_INTRVAL_INMS,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.addAllListItems()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getShopOrders=function(){console.log("取得订单.");
var t=e.ShopData.getInstance().getOrders();return e.ShopData.getInstance().isOrdersDataRefreshed()?(null!=t&&(this.shopOrders=t,this.detailedOrders=t.orders),!0):!1},n.prototype.addAllListItems=function(){this.refreshShopOrdersSum(),this.addOrdersItems()},n.prototype.refreshShopOrdersSum=function(){this.labBalance.text=String(this.shopOrders.balance),this.labRechargeSum.text=String(this.shopOrders.rechargeSum),this.labWithdrawSum.text=String(this.shopOrders.withdrawSum)},n.prototype.addOrdersItems=function(){null!=this.detailedOrders&&0!=this.detailedOrders.length?this.lablistShopOrdersNoData.visible=!1:this.lablistShopOrdersNoData.visible=!0,this.listShopOrders.dataProvider=this.gcsArray=new eui.ArrayCollection,this.listShopOrders.itemRenderer=e.ItemOrder;var t=this.detailedOrders;this.gcsArray.source=t,this.gcsArray.refresh()},n.prototype.refreshOrdersList=function(e){ArrayUtils.removeItemByKey(this.detailedOrders,"id",e),this.addOrdersItems()},n}(eui.Component);e.ShopOrdersScene=t,__reflect(t.prototype,"Shop.ShopOrdersScene",["eui.UIComponent","egret.DisplayObject"])}(Shop||(Shop={}));var Shop;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.operators=new Array,e.products=new Array,e.skinName="ShopSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),e.syncGetShop()},e),e}return __extends(n,t),n.getInstance=function(){return null==this.shopScene&&(this.shopScene=new n),this.shopScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.initOnce=function(){var e=this;this.initTabMenu(),this.initTxtFields(),this.shopRadioBtn.group.addEventListener(eui.UIEvent.CHANGE,function(t){var n=t.target;e.vsShop.selectedIndex=n.selectedValue,e.syncGetShop(),SoundManager.getInstance().playEffect("btn_click_mp3")},this),this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnRefresh1.setClick(function(){e.syncGetShop()}),this.btnRefresh2.setClick(function(){e.syncGetShop()}),this.btnBindBankCard.setClick(function(){e.showBindBankCardScene()}),this.btnBindAlipay.setClick(function(){e.showBindAlipayScene()}),this.btnWithdraw.setClick(function(){e.withdrawReq()}),this.btnShopOrders1.setClick(function(){e.showShopOrdersScene()}),this.btnShopOrders2.setClick(function(){e.showShopOrdersScene()}),this.btnShopOrders3.setClick(function(){e.showShopOrdersScene()}),EventManager.getInstance().addEvent(GlobalConstants.EVENT_USER_DATA,this.refreshWithdrawUI.bind(this),null)},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initTabMenu=function(){this.grpVipRecharge.horizontalCenter=0,this.grpVipRecharge.verticalCenter=0,this.vsShop.addChild(this.grpVipRecharge),this.grpRecharge.horizontalCenter=0,this.grpRecharge.verticalCenter=0,this.vsShop.addChild(this.grpRecharge),this.grpWithdraw.horizontalCenter=0,this.grpWithdraw.verticalCenter=0,this.vsShop.addChild(this.grpWithdraw),this.vsShop.selectedIndex=0},n.prototype.syncGetShop=function(){var t=this;SceneManager.getInstance().pushScene(LoadingScene.getInstance()),GlobalUtils.waitfor(function(){return t.getShop()},!0,500,egret.getTimer(),5e3,function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),t.addAllListItems()},function(){SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.Locales.get()["Network.Timeout.Error"])})},n.prototype.getShop=function(){console.log("取得商店的数据.");var t=e.ShopData.getInstance().getShop();return null!=t?(this.shop=t,this.operators=t.operators,this.products=t.products,!0):!1},n.prototype.initNotes=function(){null!=this.shop.shopConf&&(this.labVipRechargeNote.text=String(this.shop.shopConf.vipRechargeNote),this.labRechargeNote.text=String(this.shop.shopConf.rechargeNote),this.labWithdrawNote.text=String(this.shop.shopConf.withdrawNote))},n.prototype.initTxtFields=function(){this.txtBankCardNo.text="",this.txtAlipayId.text=""},n.prototype.refreshWithdrawUI=function(){var e=UserService.getInstance().getUser().coins;this.labCoinsNum.text=String(e);var t=UserService.getInstance().getUser().payment;null!=t&&(null==t.bankCard?this.txtBankCardNo.text="":this.txtBankCardNo.text=String(t.bankCard),null==t.alipayId?this.txtAlipayId.text="":this.txtAlipayId.text=String(t.alipayId))},n.prototype.addAllListItems=function(){this.initNotes(),this.addOperatorsItems(),this.addProductsItems(),this.refreshWithdrawUI()},n.prototype.addOperatorsItems=function(){null!=this.operators&&0!=this.operators.length?this.lablistOperatorsNoData.visible=!1:this.lablistOperatorsNoData.visible=!0,this.listOperators.dataProvider=this.operatorsArray=new eui.ArrayCollection,this.listOperators.itemRenderer=e.ItemOperator;var t=this.operators;this.operatorsArray.source=t,this.operatorsArray.refresh()},n.prototype.addProductsItems=function(){null!=this.products&&0!=this.products.length?this.lablistProductsNoData.visible=!1:this.lablistProductsNoData.visible=!0,this.listProducts.dataProvider=this.productsArray=new eui.ArrayCollection,this.listProducts.itemRenderer=e.ItemProuduct;var t=this.products;this.productsArray.source=t,this.productsArray.refresh()},n.prototype.withdrawReq=function(){if(console.log("兑换"),this.validateTxtFields()){var t=EventType.SHOP_MGMT,n=new e.ShopReq;n.cmd=e.CommandType.PLACE_ORDER_REQ,n.orderType=e.OrderType.WITHDRAW,n.prodType=e.ProductType.COIN,""!=this.txtBankCardNo.text.trim()?(n.paymentType=e.PaymentType.BANKCARD,n.paymentId=this.txtBankCardNo.text.trim()):""!=this.txtAlipayId.text.trim()&&(n.paymentType=e.PaymentType.ALIPAY,n.paymentId=this.txtAlipayId.text.trim()),n.qty=-Number(this.txtAmount.text.trim()),n.amount=-Number(this.txtAmount.text.trim());var o=new EventReq(t,n);Network.getInstance().request(o,this.onWithdrawSuccess.bind(this),this.onWithdrawError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.validateTxtFields=function(){if(""==this.txtBankCardNo.text.trim()&&""==this.txtAlipayId.text||""!=this.txtBankCardNo.text.trim()&&""!=this.txtAlipayId.text)return TipsScene.getInstance().showError("必须且只能选择一种支付方式！"),!1;var e=UserService.getInstance().getUser().coins;return""==this.txtAmount.text.trim()||!GlobalUtils.isNumbersOnly(this.txtAmount.text.trim())||Number(this.txtAmount.text.trim())>e?(TipsScene.getInstance().showError("请输入有效的兑换金额!"),!1):!0},n.prototype.onWithdrawSuccess=function(e){console.log("onWithdrawSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.onWithdrawError=function(e){console.log("onWithdrawError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.showShopOrdersScene=function(){console.log("显示充值记录的窗口"),SceneManager.getInstance().pushScene(e.ShopOrdersScene.getInstance())},n.prototype.showBindBankCardScene=function(){console.log("显示绑定银行卡的窗口"),SceneManager.getInstance().pushScene(UserMgmt.BindBankCardScene.getInstance())},n.prototype.showBindAlipayScene=function(){console.log("显示绑定银行卡的窗口"),SceneManager.getInstance().pushScene(UserMgmt.BindAlipayScene.getInstance())},n}(eui.Component);e.ShopScene=t,__reflect(t.prototype,"Shop.ShopScene",["eui.UIComponent","egret.DisplayObject"])}(Shop||(Shop={}));var Texas;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="BringinSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),e.initOnce()},e),e}return __extends(n,t),n.getInstance=function(){return null==this.bringinScene&&(this.bringinScene=new n),this.bringinScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnQuitGame.setClick(function(){e.roomLeaveReq()}),this.btnBringin.setClick(function(){e.bringinChipsReq()}),this.hsTexasBringin.addEventListener(egret.Event.CHANGE,this.onHsTexasBringinChange,this)},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.onHsTexasBringinChange=function(){this.labTexasBringinVal.text=String(this.hsTexasBringin.value),SoundManager.getInstance().playEffect("add_coins_value_wav")},n.prototype.initOnce=function(){var e=RoomService.getInstance().getRoom(),t=UserService.getInstance().getUser();if(null!=e&&null!=t){var n=Math.min(t.score,e.maxChips);this.hsTexasBringin.minimum=e.minChips,this.hsTexasBringin.maximum=n,this.hsTexasBringin.value=e.minChips,this.hsTexasBringin.snapInterval=10,this.labTexasBringinVal.text=String(this.hsTexasBringin.value)}},n.prototype.bringinChipsReq=function(){console.log("带入的请求");var t=EventType.GAME_TEXAS,n=new e.BringinChipsReq;n.cmd=e.CommandType.BRINGIN_CHIPS_REQ,n.chips=Number(this.hsTexasBringin.value);var o=new EventReq(t,n);Network.getInstance().request(o,this.onBringinChipsSuccess.bind(this),this.onBringinChipsError.bind(this)),this.brtInChips=Number(this.hsTexasBringin.value),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onBringinChipsSuccess=function(t){var n=this;console.log("onBringinChipsSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),e.ExtraAttribute.get().brtInChips=this.brtInChips,TipsScene.getInstance().confirm(t.getContent(),function(){n.close()})},n.prototype.onBringinChipsError=function(e){console.log("onBringinChipsError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.roomLeaveReq=function(){console.log("离开房间的请求");var e=EventType.ROOM_LEAVE,t=new RoomLeaveReq,n=new EventReq(e,t);Network.getInstance().send(n),this.close()},n}(eui.Component);e.BringinScene=t,__reflect(t.prototype,"Texas.BringinScene",["eui.UIComponent","egret.DisplayObject"])}(Texas||(Texas={}));var Texas;!function(e){var t=function(){function e(){}return e.START_GAME_RES="Start.Game.Res",e.HAS_DEALER_RES="Has.Dealer.Res",e.DEAL_BOARD_POKERS_RES="Deal.Board.Pokers.Res",e.DEAL_POCKET_POKERS_RES="Deal.Pocket.Pokers.Res",e.DEAL_POCKET_POKERS_END_REQ="Deal.Pocket.Pokers.End.Req",e.PUT_BETS_REQ="Put.Bets.Req",e.PUT_BETS_RES="Put.Bets.Res",e.SHOW_DOWN_RES="Show.Down.Res",e.RELOAD_DATA_REQ="Reload.Data.Req",e.RELOAD_DATA_RES="Reload.Data.Res",e.SUB_GAME_END_RES="Sub.Game.End.Res",e.GAME_END_RES="Game.End.Res",e.BRINGIN_CHIPS_REQ="Bringin.Chips.Req",e.BRINGIN_CHIPS_RES="Bringin.Chips.Res",e}();e.CommandType=t,__reflect(t.prototype,"Texas.CommandType")}(Texas||(Texas={}));var Texas;!function(e){var t=function(){function e(){}return e.PUT_BET_DELAY_IN_SECS=10,e.POCKET_POCKERS_NUMS=2,e.MAX_SIDE_POTS_SHOW_NUMS=3,e.USER_ALLIN_IMAGE="avatar_allIn_png",e.USER_FOLD_IMAGE="avatar_fold_png",e.PX_BG_IMAGE="1pxbg_png",e.THREE_X_BIGBLIND_AMOUNT="Three.X.BigBlind.Amount",e.FOUR_X_BIGBLIND_AMOUNT="Four.X.BigBlind.Amount",e.ONE_X_POT_AMOUNT="One.X.Pot.Amount",e.TWO_X_CALL_AMOUNT="Two.X.Call.Amount",e.THREE_X_CALL_AMOUNT="Three.X.Call.Amount",e.FOUR_X_CALL_AMOUNT="Four.X.Call.Amount",e.FIVE_X_CALL_AMOUNT="Five.X.Call.Amount",e.EVENT_TEXAS_RELOAD_DATA="Event.Texas.Reload.Data",e}();e.Constants=t,__reflect(t.prototype,"Texas.Constants")}(Texas||(Texas={}));var Texas;!function(e){var t=function(){function e(){}return e}();e.StartGameRes=t,__reflect(t.prototype,"Texas.StartGameRes");var n=function(){function e(){}return e}();e.HasDealerRes=n,__reflect(n.prototype,"Texas.HasDealerRes");var o=function(){function e(){}return e}();e.DealBoardPokersRes=o,__reflect(o.prototype,"Texas.DealBoardPokersRes");var i=function(){function e(){}return e}();e.DealPocketPokersRes=i,__reflect(i.prototype,"Texas.DealPocketPokersRes");var s=function(){function e(){}return e}();e.DealPocketPokersEndReq=s,__reflect(s.prototype,"Texas.DealPocketPokersEndReq");var r=function(){function e(){}return e}();e.PutBetsReq=r,__reflect(r.prototype,"Texas.PutBetsReq");var a=function(){function e(){}return e}();e.PutBetsRes=a,__reflect(a.prototype,"Texas.PutBetsRes");var l=function(){function e(){}return e}();e.ShowDownRes=l,__reflect(l.prototype,"Texas.ShowDownRes");var c=function(){function e(){}return e}();e.UserData=c,__reflect(c.prototype,"Texas.UserData");var h=function(){function e(){}return e}();e.SubGameEndRes=h,__reflect(h.prototype,"Texas.SubGameEndRes");var u=function(){function e(){}return e}();e.GameEndReq=u,__reflect(u.prototype,"Texas.GameEndReq");var p=function(){function e(){}return e}();e.GameEndRes=p,__reflect(p.prototype,"Texas.GameEndRes");var g=function(){function e(){}return e}();e.ReloadDataReq=g,__reflect(g.prototype,"Texas.ReloadDataReq");var d=function(){function e(){}return e}();e.ReloadDataRes=d,__reflect(d.prototype,"Texas.ReloadDataRes");var m=function(){function e(){}return e}();e.BringinChipsReq=m,__reflect(m.prototype,"Texas.BringinChipsReq");var f=function(){function e(){}return e}();e.BringinChipsRes=f,__reflect(f.prototype,"Texas.BringinChipsRes")}(Texas||(Texas={}));var Texas;!function(e){var t=function(){function e(){this.subGameIndex=0,this.subGameNums=0,this.userDatas=new Array,this.inHandUserDatas=new Array,this.boardPokers=new Array,this.pocketPokers=new Array,this.bhPokers=new Array}return e.get=function(){return RoomService.getInstance().getRoom().table.getExtraAttribute()},e.reset=function(){var t=new e;RoomService.getInstance().getRoom().table.setExtraAttribute(t)},e}();e.ExtraAttribute=t,__reflect(t.prototype,"Texas.ExtraAttribute")}(Texas||(Texas={}));var Texas;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.texasLogic&&(this.texasLogic=new t),this.texasLogic},t.prototype.getCommand=function(e){return e.cmd},t.prototype.processCmd=function(t){var n=null,o="",i=this.getCommand(t);switch(i){case e.CommandType.START_GAME_RES:console.log("服务器通知游戏开始的命令."),n=this.startGameRes(t);break;case e.CommandType.HAS_DEALER_RES:console.log("服务器通知有庄的命令."),n=this.hasDealerRes(t);break;case e.CommandType.DEAL_BOARD_POKERS_RES:console.log("服务器通知发Board Cards."),n=this.dealBoardPokersRes(t);break;case e.CommandType.DEAL_POCKET_POKERS_RES:console.log("服务器通知发pocket Cards."),n=this.dealPocketPokersRes(t);break;case e.CommandType.PUT_BETS_RES:console.log("服务器通知下注的命令."),n=this.putBetsRes(t);break;case e.CommandType.RELOAD_DATA_RES:console.log("服务器通知数据重新加载的命令."),n=this.reloadDataRes(t);break;case e.CommandType.SHOW_DOWN_RES:console.log("服务器通知最终摊牌的命令."),n=this.showDownRes(t);break;case e.CommandType.SUB_GAME_END_RES:console.log("服务器通知本局结束."),n=this.subGameEndRes(t);break;case e.CommandType.GAME_END_RES:console.log("服务通知本房间游戏结束."),n=this.gameEndRes(t);break;case e.CommandType.BRINGIN_CHIPS_RES:console.log("服务通知筹码带入."),n=this.bringinChipsRes(t);break;default:o="命令:"+i+"不存在.",n=new FuncResult(!1,o)}return n},t.prototype.beReadyRes=function(t){var n=t;e.TableScene.getInstance().beReadyRes(n)},t.prototype.othersReadyStatusRes=function(e){},t.prototype.getOthersReadyStatus=function(){},t.prototype.startGameRes=function(t){var n=null,o=t;return e.ExtraAttribute.reset(),e.ExtraAttribute.get().subGameIndex=o.subGameIndex,e.ExtraAttribute.get().subGameNums=o.subGameNums,e.TableScene.getInstance().startGameRes(o),n},t.prototype.bringinChipsRes=function(t){var n=null,o=t;return e.TableScene.getInstance().bringinChipsRes(o),n},t.prototype.hasDealerRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().buttonSeatNo=o.buttonSeatNo,e.ExtraAttribute.get().bigBlindBets=o.bigBlindBets,e.ExtraAttribute.get().putBetsTimeout=o.putBetTimeout,e.ExtraAttribute.get().userDatas=o.userDatas,e.TableScene.getInstance().hasDealerRes(o),n},t.prototype.roomJoinOthers=function(t){var n=t;null!=n.user&&RoomService.getInstance().getRoom().table.addUser(n.user.seatNo,n.user,!1),e.TableScene.getInstance().roomJoinOthers(n)},t.prototype.roomLeaveOthers=function(t){var n=t,o=RoomService.getInstance().getRoom();null!=n.userId&&""!=n.userId&&o.id==n.roomId&&e.TableScene.getInstance().roomLeaveOthers(n)},t.prototype.tableIsFull=function(t){e.TableScene.getInstance().tableIsFull()},t.prototype.dealBoardPokersRes=function(t){var n=null,o=t;return e.TableScene.getInstance().dealBoardPokersRes(o),n},t.prototype.dealPocketPokersRes=function(t){var n=null,o=t,i=e.PokerUtils.pokerSpritesFormIndexs(o.pokers,GlobalConstants.POKER_L_W,!1,!0);return e.ExtraAttribute.get().pocketPokers=i,e.TableScene.getInstance().dealPocketPokersRes(),n},t.prototype.putBetsRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().currentSeatNo=o.currentSeatNo,e.TableScene.getInstance().putBetsRes(o),n},t.prototype.showDownRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().userDatas=o.userDatas,e.ExtraAttribute.get().inHandUserDatas=this.getInHandUserDatas(o.userDatas),e.TableScene.getInstance().showDownRes(),n},t.prototype.getInHandUserDatas=function(e){var t=new Array;if(null==e&&0==e.length)return e;for(var n=0;n<e.length;n++){var o=e[n];o.folded||t.push(o)}return t},t.prototype.reloadDataRes=function(t){var n=null,o=t;e.ExtraAttribute.get().subGameIndex=o.subGameIndex,e.ExtraAttribute.get().subGameNums=o.subGameNums,e.ExtraAttribute.get().buttonSeatNo=o.buttonSeatNo,e.ExtraAttribute.get().bigBlindBets=o.bigBlindBets,e.ExtraAttribute.get().putBetsTimeout=o.putBetTimeout;var i=this.getMyData(o.userDatas);return null!=i&&(null!=i.pocketPokers&&(e.ExtraAttribute.get().pocketPokers=e.PokerSprite.fromIndexs(i.pocketPokers,GlobalConstants.POKER_L_W)),e.ExtraAttribute.get().pokerType=i.pokerType,e.ExtraAttribute.get().bhPokers=i.bhPokers),null!=o.boardPokers&&(e.ExtraAttribute.get().boardPokers=e.PokerSprite.fromIndexs(o.boardPokers,GlobalConstants.POKER_M_W)),e.ExtraAttribute.get().currentSeatNo=o.currentSeatNo,e.ExtraAttribute.get().userDatas=o.userDatas,e.ExtraAttribute.get().inHandUserDatas=this.getInHandUserDatas(o.userDatas),e.ExtraAttribute.get().reachGameRounds=o.reachGameRounds,e.TableScene.getInstance().reloadDataRes(o),n},t.prototype.getMyData=function(e){var t=RoomService.getInstance().getRoom().table.getMySeatNo(),n=ArrayUtils.findItemByKey(e,"seatNo",t);return n},t.prototype.subGameEndRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().reachGameRounds=o.reachGameRounds,e.TableScene.getInstance().subGameEndRes(o.reachGameRounds),n},t.prototype.gameEndRes=function(t){var n=null,o=t;return e.TableScene.getInstance().gameEndRes(o),n},t.prototype.roomJoin=function(t){var n=null,o=RoomService.getInstance().getRoom(),i=e.TableScene.getInstance();i.initTheTable(),i.setRoom(o.id),i.setUsersReady();var s=!0;return null!=o.category&&o.category==RoomCategory.COINMODE&&(s=!1),i.initGrpReadyAndInvite(s),SceneManager.getInstance().pushScene(i),n},t.prototype.roomRejoin=function(t){var n=null;EventManager.getInstance().addEvent(e.Constants.EVENT_TEXAS_RELOAD_DATA,e.TableScene.getInstance().reloadDataReq.bind(this),null);var o=e.TableScene.getInstance();return o.initTheTable(),o.setRoom(RoomService.getInstance().getRoom().id),o.setUsersReady(),SceneManager.getInstance().pushScene(o),n},t.prototype.getRoomType=function(){return RoomType.TEXAS},t}();e.GameLogic=t,__reflect(t.prototype,"Texas.GameLogic")}(Texas||(Texas={}));var Texas;!function(e){var t=function(){function e(){}return e.get=function(){return e.CN},e.CN={"start.game.countdown":"游戏即将开始","subgame.continue.countdown":"本局游戏结束,继续","game.end.countdown":"本房间局数已满，即将解散",BET:"投","Bet.Long":"投注",CALL:"跟",FOLD:"弃牌",CHECK:"让牌",ALLIN:"全下",RAISE:"加注",THREEBB:"3x大盲注",FOURBB:"4x大盲注",ONEPOT:"1x底池",roundnums:"局数:","Go.Back.Confirmation":"这将退出当前游戏,您确认吗?"},e}();e.Locales=t,__reflect(t.prototype,"Texas.Locales")}(Texas||(Texas={}));var Texas;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.MockTest&&(this.MockTest=new t),this.MockTest},t.prototype.joinRoomResp=function(){var e='{"id":1,"type":1060,"status":true,"args":{"room":{"id":"182659","game":null,"name":null,"tier":"STD","bottomScore":0,"type":"TEXAS","status":"CREATED","owner":"1","capacity":3,"rounds":0},"users":[{"id":"1","name":"wesley","nickName":null,"sex":null,"avatar":null,"level":0,"cardNum":9,"score":5000,"room":"182659","beReady":true,"beHosted":false,"seatNo":1},{"id":"2","name":"tom1001","nickName":null,"sex":null,"avatar":null,"level":0,"cardNum":10,"score":5000,"room":"182659","beReady":true,"beHosted":false,"seatNo":2},{"id":"305921","name":"boby1001","nickName":null,"sex":null,"avatar":null,"level":0,"cardNum":10,"score":5000,"room":"182659","beReady":false,"beHosted":false,"seatNo":3}]}}',t=EventRes.decode(e);Hall.HallScene.getInstance().onJoinRoomSuccess(t)},t.prototype.startGameRes=function(){var t='{"id":0,"type":2010,"status":true,"args":{"cmd":"Start.Game.Res","subGameIndex":1,"subGameNums":15,"startGameTimeout":5}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.hasDealerRes=function(){var t='{"id":0,"type":2010,"status":true,"args":{"cmd":"Has.Dealer.Res","buttonSeatNo":2,"smallBlindBetSeatNo":3,"bigBlindBetSeatNo":1,"smallBlindBets":5,"bigBlindBets":10,"userDatas":[{"userId":"1","ready":false,"bankrupt":false,"brtInChips":3450,"score":0},{"userId":"2","ready":false,"bankrupt":false,"brtInChips":3400,"score":0},{"userId":"305921","ready":false,"bankrupt":false,"brtInChips":2495,"score":0}],"putBetTimeout":60}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.dealPocketPokersRes1=function(){var t='{"id":0,"type":2010,"status":true,"args":{"cmd":"Deal.Board.Pokers.Res","pokers":[21,26,34],"pokerType":"ONE_PAIR"}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.dealPocketPokersRes2=function(){var t='{"id":0,"type":2010,"status":true,"args":{"cmd":"Deal.Board.Pokers.Res","pokers":[16],"pokerType":"TWO_PAIR"}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.dealPocketPokersRes3=function(){var t='{"id":0,"type":2010,"status":true,"args":{"cmd":"Deal.Board.Pokers.Res","pokers":[11],"pokerType":"TWO_PAIR"}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.putBetsRes=function(){var t='{"id":0,"type":2010,"status":true,"args":{"cmd":"Put.Bets.Res","currentSeatNo":3,"currentSeatAvailChips":2490,"minBetAmount":10,"minRaiseToAmount":20,"toCallAmount":10,"availOpsTypes":["FOLD","BET","CHECK"],"pots":[60],"lastChipsPutted":0,"lastSeatAvailChips":0,"lastSeatRoundBets":0,"lastSeatPutted":-1,"lastSeatOps":"NONE"}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.putBetsResRoundOver=function(){var t='{"id":0,"type":2010,"status":true,"args":{"cmd":"Put.Bets.Res","currentSeatNo":-1,"currentSeatAvailChips":2490,"minBetAmount":10,"minRaiseToAmount":20,"toCallAmount":10,"availOpsTypes":["FOLD","BET","CHECK"],"pots":[60],"lastChipsPutted":0,"lastSeatAvailChips":2490,"lastSeatRoundBets":0,"lastSeatPutted":2,"lastSeatOps":"CHECK"}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.dealBoardPokersRes=function(){var t='{"id":0,"type":2010,"status":true,"args":{"cmd":"Deal.Board.Pokers.Res","pokers":[41,45,37],"pokerType":"HIGH_CARD"}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.showDownRes=function(){var t='{"id":0,"type":2010,"status":true,"args":{"cmd":"Show.Down.Res","userDatas":[{"userId":"2","seatNo":1,"win":false,"dealer":false,"folded":false,"allin":true,"score":2500,"brtInChips":0,"roundBets":0,"awarded":0,"pocketPokers":[43,7],"bhPokers":[17,48,24,10,43],"pokerType":"ONE_PAIR"},{"userId":"1","seatNo":2,"win":false,"dealer":true,"folded":false,"allin":true,"score":2500,"brtInChips":0,"roundBets":0,"awarded":0,"pocketPokers":[34,30],"bhPokers":[17,48,24,10,30],"pokerType":"ONE_PAIR"},{"userId":"305921","seatNo":3,"win":true,"dealer":false,"folded":false,"allin":false,"score":2500,"brtInChips":7500,"roundBets":0,"awarded":7500,"pocketPokers":[50,41],"bhPokers":[17,48,24,10,50],"pokerType":"ONE_PAIR"}]}}\n			',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t}();e.MockTest=t,__reflect(t.prototype,"Texas.MockTest")}(Texas||(Texas={}));var Texas;!function(e){var t;!function(e){e[e.BET=0]="BET",e[e.CALL=1]="CALL",e[e.RAISE=2]="RAISE",e[e.ALLIN=3]="ALLIN",e[e.FOLD=4]="FOLD",e[e.CHECK=5]="CHECK",e[e.NONE=6]="NONE"}(t=e.OpsType||(e.OpsType={}))}(Texas||(Texas={}));var Texas;!function(e){var t=function(){function t(e,t){this.rank=e,this.suit=t}return t.prototype.getRank=function(){return this.rank},t.getSuitFromIndex=function(t){var n=null,o=Math.floor(t/13);switch(o){case 0:n=e.Suit.SPADE;break;case 1:n=e.Suit.HEART;break;case 2:n=e.Suit.CLUB;break;case 3:n=e.Suit.DIAMOND}return n},t.fromIndex=function(e){return new t(e%13,t.getSuitFromIndex(e))},t.pokersFormIndexs=function(e){var n=new Array;return void 0==e||0==e.length?n:(e.forEach(function(e){var o=t.fromIndex(e);n.push(o)}),n)},t.prototype.toIndex=function(){var e=13*this.suit+this.rank;return e},t.prototype.getSuit=function(){return this.suit},t.prototype.toString=function(){return"["+this.rank+","+this.suit+"]"},t}();e.Poker=t,__reflect(t.prototype,"Texas.Poker")}(Texas||(Texas={}));var Texas;!function(e){var t=function(t){function n(e,n,o,i){var s=t.call(this)||this;s.poker=e,s.width=n,s.height=n*GlobalConstants.POKER_WvsH_RATIO,s.isFaceUp=i,s.selected=!1,s.baseX=s.x,s.baseY=s.y;var r=s.getImageID(),a=new egret.Bitmap(RES.getRes(r));return a.width=s.width,a.height=s.height,s.addChild(a),o&&(s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){s.selected=!s.selected,s.selected?(s.y=s.baseY-15,SoundManager.getInstance().playEffect("choose_card_mp3")):s.y=s.baseY},s)),s}return __extends(n,t),n.prototype.getPoker=function(){return this.poker},n.prototype.setSelected=function(e){this.dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP))},n.prototype.getSelected=function(){return this.selected},n.prototype.getImageID=function(){var t=0;this.isFaceUp&&(t=e.Utils.pokerIds[this.poker.toIndex()]);var n="poker_"+t+"_png";return n},n.fromIndex=function(t,o){var i=e.Poker.fromIndex(t),s=new n(i,o,!1,!0);return s},n.fromIndexs=function(e,t){var o=new Array;return void 0==e||0==e.length?o:(e.forEach(function(e){var i=n.fromIndex(e,t);o.push(i)}),o)},n}(egret.Sprite);e.PokerSprite=t,__reflect(t.prototype,"Texas.PokerSprite")}(Texas||(Texas={}));var Texas;!function(e){var t=function(){function t(){}return t.pokerSpritesFormIndexs=function(t,n,o,i){var s=new Array,r=e.Poker.pokersFormIndexs(t);return null==r||0==r.length?s:(r.forEach(function(t){var r=new e.PokerSprite(t,n,o,i);s.push(r)}),s)},t}();e.PokerUtils=t,__reflect(t.prototype,"Texas.PokerUtils")}(Texas||(Texas={}));var Texas;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n.skinName="TexasPotsSkin",n.labChipNums.text=String(t),n}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.setLabChipNums=function(e){this.labChipNums.text=String(e)},t}(eui.Component);e.Pots=t,__reflect(t.prototype,"Texas.Pots",["eui.UIComponent","egret.DisplayObject"])}(Texas||(Texas={}));var Texas;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.allInIdx=0,n.isMe=e,n.skinName="TexasSeatUISkin",n}return __extends(n,t),n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},n.prototype.initUI=function(){this.user=null,this.labChips.text="",this.imgWinner.visible=!1,this.imgWinner.x=this.imgWinner.width/2,this.imgWinner.y=this.imgWinner.height/2,this.imgWinner.anchorOffsetX=this.imgWinner.width/2,this.imgWinner.anchorOffsetY=this.imgWinner.height/2,this.imgButtonSeat.visible=!1,this.imgButtonSeat.anchorOffsetX=this.imgButtonSeat.width/2,this.imgButtonSeat.anchorOffsetY=this.imgButtonSeat.height/2,this.imgUserReady.visible=!1,this.imgUserReady.anchorOffsetX=this.imgUserReady.width/2,this.imgUserReady.anchorOffsetY=this.imgUserReady.height/2,this.imgFold=null,this.imgPokerType=null,this.imgAllInBG=null,this.allInTimer=null,this.setLabName(""),this.setLabChips(""),this.setLabLastAction(""),null!=this.grpPokers&&(this.grpPokers.visible=!0,this.grpPokers.removeChildren()),null!=this.grpPokerType&&(this.grpPokerType.visible=!0,this.grpPokerType.removeChildren()),null!=this.grpChipsNum&&(this.grpChipsNum.visible=!0,this.grpChipsNum.removeChildren())},n.prototype.show=function(){this.grpParent.visible=!0,this.grpParent.removeChildren(),this.grpParent.addChild(this)},n.prototype.setGrpParent=function(e){e.removeChildren(),this.grpParent=e},n.prototype.getGrpParent=function(){return this.grpParent},n.prototype.setUser=function(e){this.user=e},n.prototype.getUser=function(){return this.user},n.prototype.setImgSizeAndPos=function(e,t){this.isMe?(e.width=150,e.height=30):(e.width=90,e.height=23),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=.5*t.width,e.y=t.height-e.height/2},n.prototype.showImgAnimation=function(e){var t=egret.Tween.get(e);t.to({scaleX:2,scaleY:2},100,egret.Ease.sineOut).wait(20).to({scaleX:.9,scaleY:.9},100,egret.Ease.sineIn).to({scaleX:1.2,scaleY:1.2},100,egret.Ease.sineIn).to({scaleX:1,scaleY:1},100,egret.Ease.sineIn).call(function(){egret.Tween.removeTweens(t)})},n.prototype.getIsMe=function(){return this.isMe},n.prototype.setLabName=function(e){(void 0==e||null==e)&&(e=""),this.labName.text=GlobalUtils.getFixedLenOfString(e,6)},n.prototype.setImgAvatar=function(e){this.imgAvatar.source=e,this.imgAvatar.width=this.imgAvatar.height=70},n.prototype.setLabLastAction=function(e){this.labLastAction.size=20,this.labLastAction.bold=!0,this.labLastAction.textColor=16045678,this.labLastAction.stroke=1,this.labLastAction.strokeColor=11301130,this.labLastAction.textAlign=egret.HorizontalAlign.CENTER,this.labLastAction.verticalAlign=egret.VerticalAlign.MIDDLE,this.labLastAction.text=e},n.prototype.setLabChips=function(e){(void 0==e||null==e)&&(e="0"),this.labChips.text=String(e)},n.prototype.setImgWinner=function(e){var t=this;e?(this.setImgAllIn(!1),this.imgWinner.visible=!0,this.tweenWin=egret.Tween.get(this.imgWinner,{loop:!0}),this.tweenWin.to({scaleX:1.1,scaleY:1.1},200,egret.Ease.quintOut).to({alpha:0},100).to({scaleX:1,scaleY:1},200).to({alpha:1},100).call(function(){setTimeout(function(){t.tweenWin&&(t.tweenWin.setPaused(!0),egret.Tween.removeTweens(t.tweenWin))},5e3)})):(this.imgWinner.visible=!1,this.tweenWin=null)},n.prototype.setImgButton=function(e){if(e){this.imgButtonSeat.visible=!0;var t=egret.Tween.get(this.imgButtonSeat);t.to({scaleX:1.5,scaleY:1.5},100,egret.Ease.quintOut).to({scaleX:1,scaleY:1},80).to({scaleX:1.1,scaleY:1.1},80).to({scaleX:1,scaleY:1},80).call(function(){t&&egret.Tween.removeTweens(t)})}else this.imgButtonSeat.visible=!1},n.prototype.setImgUserReady=function(e){e?this.imgUserReady.visible=!0:this.imgUserReady.visible=!1},n.prototype.setGrpPokers=function(e){this.grpPokers=e},n.prototype.getGrpPokers=function(){return this.grpPokers},n.prototype.setGrpPokerType=function(e){this.grpPokerType=e},n.prototype.getGrpPokerType=function(){return this.grpPokerType},n.prototype.setGrpChipsNum=function(e){this.grpChipsNum=e},n.prototype.getGrpChipsNum=function(){return this.grpChipsNum},n.prototype.setChipsNum=function(e){this.chipsNum=e,this.grpChipsNum&&(this.chipsNum.visible=!0,this.chipsNum.x=this.chipsNum.y=0,this.grpChipsNum.removeChildren(),this.grpChipsNum.addChild(this.chipsNum))},n.prototype.getChipsNum=function(){return this.chipsNum},n.prototype.setPokerType=function(t){null==this.imgFold&&(null==t?this.imgPokerType=GlobalUtils.createBitmapByName(e.Utils.pokerTypesToImage.fold):this.imgPokerType=GlobalUtils.createBitmapByName(e.Utils.pokerTypesToImage[t]),this.imgPokerType.alpha=.85,this.setImgSizeAndPos(this.imgPokerType,this.grpPokerType),this.grpPokerType.removeChildren(),this.grpPokerType.addChild(this.imgPokerType),this.showImgAnimation(this.imgPokerType))
},n.prototype.getImgProfileTimingBG=function(){return this.imgProfileTimingBG},n.prototype.setTimer=function(e){return this.timer=e},n.prototype.getTimer=function(){return this.timer},n.prototype.setImgFold=function(e){return e?(this.imgPokerType&&this.grpPokerType.contains(this.imgPokerType)&&this.grpPokerType.removeChild(this.imgPokerType),void(this.imgFold&&1==this.imgFold.visible||(this.imgFold=GlobalUtils.createBitmapByName("texas_type_fold_png"),this.setImgSizeAndPos(this.imgFold,this.grpPokerType),this.grpPokerType.addChild(this.imgFold),this.showImgAnimation(this.imgFold)))):void(this.imgFold&&(this.grpPokerType&&this.grpPokerType.contains(this.imgFold)&&this.grpPokerType.removeChild(this.imgFold),this.imgFold=null))},n.prototype.setImgAllIn=function(e){return e?(this.showImgAllInAndPlaySound(),this.allInTimer?(this.imgAllInBG.visible=!0,void this.allInTimer.start()):(this.imgAllInBG=new eui.Image,this.imgAllInBG.visible=!0,this.imgAllInBG.width=this.width+5,this.imgAllInBG.height=this.height+5,this.imgAllInBG.anchorOffsetX=.5*this.imgAllInBG.width,this.imgAllInBG.anchorOffsetY=.5*this.imgAllInBG.height,this.imgAllInBG.x=.5*this.width,this.imgAllInBG.y=.5*this.height,this.grpParent.addChild(this.imgAllInBG),this.allInTimer=new egret.Timer(200,0),this.allInTimer.addEventListener(egret.TimerEvent.TIMER,this.showImgAllInBG,this),void this.allInTimer.start())):void(this.allInTimer&&(this.allInIdx=0,this.allInTimer.stop(),this.imgAllInBG&&(this.imgAllInBG.visible=!1),this.imgAllIn&&(this.imgAllIn.visible=!1)))},n.prototype.showImgAllInBG=function(){this.imgAllInBG.visible=!0;var e=this.allInIdx%5;this.imgAllInBG.source="allin_"+e+"_png",this.allInIdx++},n.prototype.showImgAllInAndPlaySound=function(){SoundManager.getInstance().playEffect("allin_bg_wav"),this.imgAllIn=GlobalUtils.createBitmapByName("texas_type_allin_png"),this.imgAllIn.visible=!0,this.setImgSizeAndPos(this.imgAllIn,this.grpPokerType),this.grpPokerType.addChild(this.imgAllIn),this.showImgAnimation(this.imgAllIn)},n}(eui.Component);e.SeatUI=t,__reflect(t.prototype,"Texas.SeatUI",["eui.UIComponent","egret.DisplayObject"])}(Texas||(Texas={}));var Texas;!function(e){var t;!function(e){e[e.NONE=0]="NONE",e[e.WAITTING=1]="WAITTING",e[e.START=2]="START",e[e.HASDEALER=3]="HASDEALER",e[e.DEALPOCKETPOKERS=4]="DEALPOCKETPOKERS",e[e.FLOP=5]="FLOP",e[e.TURN=6]="TURN",e[e.RIVER=7]="RIVER",e[e.SHOWDOWN=8]="SHOWDOWN",e[e.SUBGAMEEND=9]="SUBGAMEEND"}(t=e.State||(e.State={}))}(Texas||(Texas={}));var Texas;!function(e){var t;!function(e){e[e.SPADE=0]="SPADE",e[e.HEART=1]="HEART",e[e.CLUB=2]="CLUB",e[e.DIAMOND=3]="DIAMOND"}(t=e.Suit||(e.Suit={}))}(Texas||(Texas={}));var Texas;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return n.sceneName="Texas.TableScene",n.index=0,n.skinName="TexasTableSkin",n.addExtraAttributeToTable(),n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(n.stage,n),SoundManager.getInstance().playMusic("bg_texas_mp3"),EventManager.getInstance().dispatchEvent(e.Constants.EVENT_TEXAS_RELOAD_DATA),n.shuffle=new Shuffle(n.grpDeck,n.dealPocketPokersResCB.bind(n)),n.imgGrpVsliderOuter.addEventListener(egret.TouchEvent.TOUCH_TAP,n.hideGrpVsliderPanel.bind(n),n),n.texasVSlider.addEventListener(egret.Event.CHANGE,n.onVSliderChange,n),n.btnReady.setClick(function(e){n.beReady(e)}),n.btnInvite.setClick(function(e){n.inviteOthers(e)}),n.btnGoMatching.setClick(function(){n.coinModeRoomReq()}),n.btnEnableHost.setClick(function(){n.enableHostReq()}),n.btnDisableHost.setClick(function(){n.disableHostReq()}),EventManager.getInstance().addEvent(GlobalConstants.EVENT_SYSTEM_MESSAGE,n.showSystemMessage.bind(n),null),EventManager.getInstance().addEvent(GlobalConstants.EVENT_DISABLE_HOST,n.showGrpPutBetsControls.bind(n),null)},n),n}return __extends(n,t),n.getInstance=function(){return null==this.texasTableScene&&(this.texasTableScene=new n),this.texasTableScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initBtnFunc()},n.prototype.initBtnFunc=function(){var e=this;this.btnGoBack.setClick(function(){e.showGoBackConfirmationWin()}),this.btnSetting.setClick(function(){e.showSettingScene()}),this.btnScores.setClick(function(){e.showGameScores()})},n.prototype.showGrpPutBetsControls=function(){this.isMyTurn()&&(this.grpPutBetsControls.visible=!0)},n.prototype.showSystemMessage=function(e){var t=new ScrollingMessages(this.grpSystemMessage),n={};n.msg=e.content,n.loopNum=3;var o=new ScrollingMessage(n,0);t.pushpaoMaDengMsg(o),t.start()},n.prototype.showStartMatchingCountDownTimer=function(){var e=GlobalLocales.get()["start.Matching.Player"];this.startMatchingUserCountDownTimer=new CountDownTimer(e),this.grpTimer.addChild(this.startMatchingUserCountDownTimer),this.startMatchingUserCountDownTimer.timeStart(30)},n.prototype.coinModeRoomReq=function(){if(console.log("开始匹配"),this.checkBringinChips()){var e=EventType.COINMODE_ROOM_JOIN,t=new CoinModeRoomJoinReq;t.coinModeId=GlobalVars.getInstance().coinModeId,t.step=2;var n=new EventReq(e,t);Network.getInstance().request(n,this.onCoinModeRoomJoinSuccess.bind(this),this.onCoinModeRoomJoinError.bind(this))}},n.prototype.onCoinModeRoomJoinSuccess=function(e){console.log("onCoinModeRoomJoinSuccess:"+e.getContent()),this.grpReadyAndInvite.visible=!1,this.btnGoMatching.visible=!1,this.showStartMatchingCountDownTimer()},n.prototype.onCoinModeRoomJoinError=function(e){console.log("onCoinModeRoomJoinError:"+e.getContent()),TipsScene.getInstance().showError(e.getContent())},n.prototype.getRoomId=function(){var e=RoomService.getInstance().getRoom();return null!=e?e.id:null!=this.roomId?this.roomId:null},n.prototype.initialize=function(){this.labEntityId.text=String(this.getRoomId()),this.labRoundNums.text="",this.setAllGrpsToInVisible(),this.initSeatLayoutMap(),this.initSeatMap(),this.fillUserOfSeatUI(),this.clearSampleImgAndData()},n.prototype.setAllGrpsToInVisible=function(){this.grpReadyAndInvite.visible=!1,this.grpBoardPokers.visible=!1,this.grpPutBetsControls.visible=!1,this.grpVsliderPanel.visible=!1,this.grpTexasPots.visible=!1,this.grpDeck.visible=!1,this.grpHost.visible=!1},n.prototype.showSettingScene=function(){SceneManager.getInstance().pushScene(Setting.SettingScene.getInstance(this.sceneName))},n.prototype.showGoBackConfirmationWin=function(){var t=this,n=e.Locales.get()["Go.Back.Confirmation"];TipsScene.getInstance().confirm(n,function(){t.close()})},n.prototype.close=function(){this.roomLeaveReq(),SoundManager.getInstance().stopMusic(),SceneManager.getInstance().popScene(this)},n.prototype.roomLeaveReq=function(){var e=EventType.ROOM_LEAVE,t=new RoomLeaveReq,n=new EventReq(e,t);Network.getInstance().send(n)},n.prototype.setRoom=function(e){this.roomId=e},n.prototype.clearSampleImgAndData=function(){this.grpBoardPokers.removeChildren()},n.prototype.addExtraAttributeToTable=function(){},n.prototype.initSeatLayoutMap=function(){this.seatLayoutMap={3:[1,4,7],4:[1,3,5,7],5:[1,3,5,6,8],6:[1,3,4,5,6,8],7:[1,3,4,5,6,7,8],8:[1,2,3,4,5,6,7,8],9:[1,2,3,4,5,6,7,8,9]}},n.prototype.initSeatMap=function(){this.seatMap=new Dictionary;for(var t=RoomService.getInstance().getRoom().table.getSeatsNum(),n=this.seatLayoutMap[String(t)],o=1;t>=o;++o){var i=null;i=1==o?new e.SeatUI(!0):new e.SeatUI(!1),i.setGrpParent(this["grpProfile_Seat"+n[o-1]]),i.setGrpPokers(this["grpPokers_Seat"+n[o-1]]),i.setGrpPokerType(this["grpPokerType_Seat"+n[o-1]]),i.setGrpChipsNum(this["grpChipsNum_Seat"+n[o-1]]),i.initUI();var s=new CTimer(i.getImgProfileTimingBG(),!1,-1);i.setTimer(s),this.seatMap.Add("Seat"+o,i)}},n.prototype.fillUserOfSeatUI=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers();t.forEach(function(t){var n=e.getSeatUI(t.seatNo);null!=n&&(n.setUser(t),n.setLabName(t.name),n.setLabChips(String(t.score)),n.setImgUserReady(t.beReady))})},n.prototype.onVSliderChange=function(){this.labVSliderVal.text=String(this.texasVSlider.value),SoundManager.getInstance().playEffect("add_coins_value_wav")},n.prototype.setUsersReady=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers();t.forEach(function(t){if(t.beReady){var n=e.getSeatUI(t.seatNo);n.setImgUserReady(!0)}})},n.prototype.beReadyRes=function(e){var t=e.userId,n=RoomService.getInstance().getRoom().table.getSeatNoByUserId(t);if(null!=n){var o=this.getSeatUI(n);o.setImgUserReady(!0),SoundManager.getInstance().playEffect("user_ready_mp3")}},n.prototype.setMyReadyStatus=function(e){var t=this.getMySeatNo(),n=this.getSeatUI(t);n.setImgUserReady(e)},n.prototype.bringinChipsRes=function(e){var t=e.userDatas;null!=t&&this.setBrtChipsOfAllUsers(t)},n.prototype.getSeatUI=function(e){var t=this.getMySeatNo();if(e==t)return this.seatMap.Item("Seat1");for(var n=RoomService.getInstance().getRoom().capacity,o=2;n>=o;++o)if(e==RoomService.getInstance().getRoom().table.peekSeatNoRecursively(t,o-1))return this.seatMap.Item("Seat"+o)},n.prototype.setOthersSeatUI=function(e){var t=this.getSeatUI(e.seatNo);t.show(),t.setUser(e),t.setLabName(e.name),t.setLabChips(String(e.score)),t.setImgAvatar(e.avatar),t.setImgUserReady(e.beReady)},n.prototype.roomLeaveOthers=function(e){console.log("其他用户离开:"+e);var t=RoomService.getInstance().getRoom().table.getUserByUserId(String(e.userId));if(null!=t){var n=this.getSeatUI(t.seatNo);n.setUser(null),SoundManager.getInstance().playEffect("other_leave_mp3")}},n.prototype.roomJoinOthers=function(e){console.log("其他用户加入:"+e),this.setOthersSeatUI(e.user),SoundManager.getInstance().playEffect("other_join_mp3")},n.prototype.updateUserScoreAndUI=function(e){var t=this;e.forEach(function(e){var n=RoomService.getInstance().getRoom().table.getUserBySeatNo(e.seatNo);if(n.score=e.score,t.getMySeatNo()!=e.seatNo){var o=t.getSeatUI(e.seatNo);o.setLabChips(String(e.score))}})},n.prototype.setMySeatUI=function(){var e=this.getMySeatNo(),t=this.getSeatUI(e);t.show(),t.setLabName(t.getUser().name),t.setLabChips(String(t.getUser().score)),t.setImgAvatar(t.getUser().avatar)},n.prototype.initOthersSeatUI=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers(),n=UserService.getInstance().getUser();t.forEach(function(t){n.id!=t.id&&e.setOthersSeatUI(t)})},n.prototype.showUserRoundBetsAnimation=function(e,t){if(0!=t){var n=e.getChipsNum();(null==n||String(t)!=n.getLabChipNums())&&(n=new ChipsNum(t),n.onComplete(function(){e.setChipsNum(n)}),n.fly(e.getGrpParent(),e.getGrpChipsNum()))}},n.prototype.checkBringinChips=function(){var t=RoomService.getInstance().getRoom();if(null!=t){var n=e.ExtraAttribute.get().brtInChips;return null==n||n<t.minChips?(SceneManager.getInstance().pushScene(e.BringinScene.getInstance()),!1):!0}},n.prototype.tableIsFull=function(){this.btnInvite.visible=!1},n.prototype.getMySeatNo=function(){return RoomService.getInstance().getRoom().table.getMySeatNo()},n.prototype.initTheTable=function(){this.initialize(),this.setMySeatUI(),this.initOthersSeatUI()},n.prototype.initGrpReadyAndInvite=function(e){this.grpReadyAndInvite.removeChildren(),this.grpReadyAndInvite.visible=!0,e?(this.btnReady.visible=!0,this.grpReadyAndInvite.addChild(this.btnReady),this.btnInvite.visible=!0,this.grpReadyAndInvite.addChild(this.btnInvite)):(this.btnGoMatching.visible=!0,this.grpReadyAndInvite.addChild(this.btnGoMatching)),GlobalUtils.setHorizontalLayout(this.grpReadyAndInvite,150,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.enableHostReq=function(){var e=EventType.ENABLE_HOST,t=new EnableHostReq;t.userId=UserService.getInstance().getUser().id;var n=new EventReq(e,t);Network.getInstance().request(n,this.onEnableHostSuccess.bind(this),this.onEnableHostError.bind(this))},n.prototype.onEnableHostSuccess=function(e){console.log("onEnableHostSuccess:"+JSON.stringify(e.args)),this.grpHost.visible=!0,UserService.getInstance().getUser().beHosted=!0},n.prototype.onEnableHostError=function(e){console.log("onEnableHostError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.disableHostReq=function(){var e=EventType.DISABLE_HOST,t=new DisableHostReq;t.userId=UserService.getInstance().getUser().id;var n=new EventReq(e,t);Network.getInstance().request(n,this.onDisableHostSuccess.bind(this),this.onDisableHostError.bind(this))},n.prototype.onDisableHostSuccess=function(e){console.log("onEnableHostSuccess:"+JSON.stringify(e.args)),this.grpHost.visible=!1,UserService.getInstance().getUser().beHosted=!1},n.prototype.onDisableHostError=function(e){console.log("onDisableHostError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.showGameScores=function(){var e=GameResult.FinalGameRslScene.getInstance();e.setRoom(String(this.roomId)),SceneManager.getInstance().pushScene(e)},n.prototype.beReady=function(e){if(console.log("点击准备按钮"),this.checkBringinChips()){var t=EventType.BE_READY,n=new BeReadyReq;n.roomId=this.roomId;var o=new EventReq(t,n);Network.getInstance().request(o,this.onReadySuccess.bind(this),this.onReadyError.bind(this))}},n.prototype.onReadySuccess=function(e){console.log("onReadySuccess:"+JSON.stringify(e.args)),this.btnReady.visible=!1,this.btnInvite.visible=!1,this.setMyReadyStatus(!0)},n.prototype.onReadyError=function(e){console.log("onReadyError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.inviteOthers=function(e){var t=InviteScene.getInstance();t.setEntityId(String(this.roomId)),SceneManager.getInstance().pushScene(t)},n.prototype.dealPocketPokersRes=function(){this.grpDeck.visible=!0,this.shuffle.launch()},n.prototype.dealPocketPokersResCB=function(){this.index=0;var t=e.ExtraAttribute.get().pocketPokers.length;this.dealPokersTimer=new egret.Timer(500,t),this.dealPokersTimer.addEventListener(egret.TimerEvent.TIMER,this.dealPokerInOneRoundAnimation,this),this.dealPokersTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.dealPokersEndReq,this),this.dealPokersTimer.start()},n.prototype.generatePokerSpriteInDeck=function(){this.grpDeck.visible=!1;for(var t=0;8>t;t++){var n=new e.PokerSprite(new e.Poker(0,0),GlobalConstants.POKER_S_W,!1,!1);n.x=t,n.y=t,this.grpDeck.addChild(n)}},n.prototype.dealPokerInOneRoundAnimation=function(){for(var t=RoomService.getInstance().getRoom().capacity,n=e.ExtraAttribute.get().buttonSeatNo,o=1;t>=o;++o){var i=0,s=null;(i=RoomService.getInstance().getRoom().table.peekSeatNoRecursively(n,o))&&(s=this.seatMap.Item("Seat"+o),this.dealPokerToSeatAnimation(s,this.index))}this.index++},n.prototype.dealPokerToSeatAnimation=function(t,n){var o=e.Poker.fromIndex(0),i=new e.PokerSprite(o,GlobalConstants.POKER_S_W,!1,!1);this.grpDeck.visible=!0,i.x=i.y=0,this.grpDeck.addChild(i),SoundManager.getInstance().playEffect("send_card_wav");var s=t.getGrpPokers(),r=this.grpDeck.globalToLocal(s.x+s.width/2,s.y+s.height/2),a=egret.Tween.get(i);a.to({x:r.x,y:r.y},300).call(function(){if(this.grpDeck&&this.grpDeck.contains(i)&&this.grpDeck.removeChild(i),egret.Tween.removeTweens(i),t.getIsMe()){var r=e.ExtraAttribute.get().pocketPokers[n];s.addChild(r)}else{var a=new e.PokerSprite(o,GlobalConstants.POKER_S_W,!1,!1);a.x=a.y=0,s.addChild(i)}GlobalUtils.setHorizontalLayout(s,0,GlobalUtils.ALIGNMENT_CENTER)},this)},n.prototype.dealPokersEndReq=function(){console.log("发牌完成"),this.grpDeck.visible=!1;var t=EventType.GAME_TEXAS,n=new e.DealPocketPokersEndReq;n.cmd=e.CommandType.DEAL_POCKET_POKERS_END_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},n.prototype.isMyTurn=function(){var t=this.getMySeatNo();return-1!=t&&t==e.ExtraAttribute.get().currentSeatNo?!0:!1},n.prototype.amIDealer=function(){var t=this.getMySeatNo();return-1!=t&&t==e.ExtraAttribute.get().buttonSeatNo?!0:!1},n.prototype.displayControlsGroup=function(e){this.isMyTurn()?e.visible=!0:e.visible=!1},n.prototype.clearPrevRoundBets=function(){var t=e.ExtraAttribute.get().currentSeatNo;if(!(0>=t)){var n=this.getSeatUI(t),o=n.getChipsNum();null!=o&&o.setLabChipNums(0)}},n.prototype.clearAllRoundBets=function(){for(var e=0;e<this.seatMap.Count();e++){var t=this.seatMap.Values()[e],n=t.getChipsNum();null!=n&&n.setLabChipNums(0)}},n.prototype.showTimer=function(){var t=this,n=e.ExtraAttribute.get().currentSeatNo,o=e.ExtraAttribute.get().putBetsTimeout;this.clearAllTimer(),-1!=n&&setTimeout(function(){var e=t.getSeatUI(n);e.addChild(e.getTimer().getContainer()),e.getTimer().timerStart(o)},1e3)},n.prototype.clearAllTimer=function(){if(this.clearGrpTimer(),null!=this.seatMap)for(var e=0;e<this.seatMap.Count();e++){var t=this.seatMap.Values()[e],n=t.getTimer();null!=n&&n.timerStop()}},n.prototype.setBrtChipsOfAllUsers=function(t){var n=this,o=UserService.getInstance().getUser(),i=RoomService.getInstance().getRoom().table.getAllUsers();null!=t&&i.forEach(function(i){var s=n.getSeatUI(i.seatNo),r=ArrayUtils.findItemByKey(t,"userId",i.id);null!=r&&(o.id==r.userId&&(e.ExtraAttribute.get().brtInChips=r.brtInChips),s.setLabChips(String(r.brtInChips)))})},n.prototype.showTheDealerBtn=function(e){var t=this.getSeatUI(e.buttonSeatNo);t.setImgButton(!0)},n.prototype.showBlindBetAnimation=function(e){var t=this,n=this.getSeatUI(e.smallBlindBetSeatNo);this.showUserRoundBetsAnimation(n,e.smallBlindBets),setTimeout(function(){var n=t.getSeatUI(e.bigBlindBetSeatNo);t.showUserRoundBetsAnimation(n,e.bigBlindBets)},500)},n.prototype.dealBoardPokersRes=function(t){var n=this;this.grpBoardPokers.visible=!0;var o=e.ExtraAttribute.get().boardPokers,i=e.PokerUtils.pokerSpritesFormIndexs(t.pokers,GlobalConstants.POKER_M_W,!1,!0);null!=o&&(e.ExtraAttribute.get().boardPokers=o.concat(i)),i.forEach(function(o){var i=new e.PokerSprite(new e.Poker(0,0),GlobalConstants.POKER_M_W,!1,!1);n.grpBoardPokers.addChild(i),GlobalUtils.setHorizontalLayout(n.grpBoardPokers,3,GlobalUtils.ALIGNMENT_CENTER),n.grpBoardPokers.addChild(o),i.scaleX=1,o.scaleX=0,egret.Tween.get(i).to({scaleX:0},200,egret.Ease.backIn).call(function(){egret.Tween.get(o).to({scaleX:1},200,egret.Ease.backOut),n.grpBoardPokers&&n.grpBoardPokers.contains(i)&&n.grpBoardPokers.removeChild(i),GlobalUtils.setHorizontalLayout(n.grpBoardPokers,3,GlobalUtils.ALIGNMENT_CENTER);var e=n.getMySeatNo(),s=n.getSeatUI(e);s.setPokerType(t.pokerType)})})},n.prototype.clearAllSeatUIs=function(){var e=this;this.seatMap.Keys().forEach(function(t){var n=e.seatMap.Item(t);n.setLabLastAction(""),n.getGrpPokers().removeChildren();var o=n.getChipsNum();null!=o&&o.setLabChipNums(0),n.getGrpPokerType().removeChildren(),n.setImgWinner(!1),n.setImgButton(!1),n.setImgAllIn(!1),n.setImgUserReady(!1),n.setImgFold(!1)})},n.prototype.clearTheTableScene=function(){this.grpReadyAndInvite.removeChildren(),this.clearAllSeatUIs(),this.grpBoardPokers.removeChildren(),this.index=0,this.labRoundNums.text="",this.labPotNums.text="",null!=this.startMatchingUserCountDownTimer&&this.startMatchingUserCountDownTimer.stop(),this.grpTimer.contains(this.startMatchingUserCountDownTimer)&&this.grpTimer.removeChild(this.startMatchingUserCountDownTimer)},n.prototype.setLabRoundNums=function(){var t=String(e.ExtraAttribute.get().subGameIndex),n=String(e.ExtraAttribute.get().subGameNums),o=e.Locales.get().roundnums+t+"/"+n;this.labRoundNums.text=o},n.prototype.clearImgBeReadyOfAllSeatUIs=function(){var e=this;this.seatMap.Keys().forEach(function(t){var n=e.seatMap.Item(t);n.setImgUserReady(!1)})},n.prototype.startGameRes=function(e){this.clearTheTableScene(),this.clearImgBeReadyOfAllSeatUIs(),this.setLabRoundNums(),this.showStartGameCountDownTimer(e),SoundManager.getInstance().playEffect("game_start_wav")},n.prototype.showStartGameCountDownTimer=function(t){this.clearAllTimer();var n=new CountDownTimer(e.Locales.get()["start.game.countdown"]);this.grpTimer.addChild(n),n.timeStart(t.startGameTimeout)},n.prototype.clearGrpTimer=function(){this.grpTimer.removeChildren()},n.prototype.hasDealerRes=function(e){this.clearAllTimer(),this.showTheDealerBtn(e),this.showBlindBetAnimation(e),this.setBrtChipsOfAllUsers(e.userDatas),this.updateThePotstUI(e.pots)},n.prototype.updateThePotstUI=function(e){this.grpTexasPots.visible=!0,this.grpTexasPots.removeChildren();var t=ArrayUtils.sum(e);this.labPotNums.text=String(t)},n.prototype.isMeHosted=function(){var e=UserService.getInstance().getUser();return e.beHosted},n.prototype.showGrpHost=function(){this.isMeHosted()?this.grpHost.visible=!0:this.grpHost.visible=!1},n.prototype.putBetsRes=function(t){this.showGrpHost(),this.showTimer(),this.updateThePotstUI(t.pots),-1==t.lastSeatPutted&&"NONE"==t.lastSeatOps?this.clearAllRoundBets():this.showLastSeatAction(t),this.isMyTurn()?(e.ExtraAttribute.get().brtInChips=t.lastSeatAvailChips,this.isMeHosted()||this.getAvailBetControlBtns(t),SoundManager.getInstance().playEffect("my_turn_mp3")):this.grpPutBetsControls.visible=!1},n.prototype.getAvailBetControlBtns=function(t){var n=this;this.grpPutBetsControls.removeChildren(),this.grpPutBetsControls.visible=!0;var o=t.availOpsTypes;if(o.indexOf(e.OpsType[e.OpsType.FOLD])>-1){var i=new TButton("btn_fold_png",e.Locales.get().FOLD);i.setSize(130,65,20),i.setClick(function(){n.putBets(e.OpsType.FOLD,0,t)}),this.grpPutBetsControls.addChild(i)}if(o.indexOf(e.OpsType[e.OpsType.CHECK])>-1){var s=new TButton("btn_call_png",e.Locales.get().CHECK);s.setSize(130,65,20),s.setClick(function(){n.putBets(e.OpsType.CHECK,0,t)}),this.grpPutBetsControls.addChild(s)}if(o.indexOf(e.OpsType[e.OpsType.BET])>-1){var r=new TButton("btn_bet_png",e.Locales.get().BET);r.setSize(130,65,20),r.setTitle(e.Locales.get().BET+t.minBetAmount),r.setClick(function(){n.putBets(e.OpsType.BET,t.minBetAmount,t)}),this.grpPutBetsControls.addChild(r);var a=2*t.minBetAmount,l=new TButton("btn_bet_png",e.Locales.get().BET);l.setSize(130,65,20),l.setTitle(e.Locales.get().BET+a),l.setClick(function(){n.putBets(e.OpsType.BET,a,t)}),this.grpPutBetsControls.addChild(l);var c=new TButton("btn_bet_png",e.Locales.get()["Bet.Long"]);c.setSize(130,65,20),c.setClick(function(){n.showGrpVsliderPanel(t,e.OpsType.BET)}),this.grpPutBetsControls.addChild(c)}if(o.indexOf(e.OpsType[e.OpsType.CALL])>-1){var h=new TButton("btn_bet_png",e.Locales.get().CALL);h.setSize(130,65,20),h.setTitle(e.Locales.get().CALL+t.toCallAmount),h.setClick(function(){n.putBets(e.OpsType.CALL,t.toCallAmount,t)}),this.grpPutBetsControls.addChild(h)}if(o.indexOf(e.OpsType[e.OpsType.RAISE])>-1){var u=2*t.minRaiseToAmount;if(t.currentSeatAvailChips>=u){var p=new TButton("btn_raise_png",e.Locales.get().RAISE);p.setSize(130,65,20),p.setTitle(e.Locales.get().RAISE+u),p.setClick(function(){n.putBets(e.OpsType.RAISE,u,t)}),this.grpPutBetsControls.addChild(p)}var g=3*t.minRaiseToAmount;if(t.currentSeatAvailChips>=g){var d=new TButton("btn_raise_png",e.Locales.get().RAISE);d.setSize(130,65,20),d.setTitle(e.Locales.get().RAISE+g),d.setClick(function(){n.putBets(e.OpsType.RAISE,g,t)}),this.grpPutBetsControls.addChild(d)}var m=new TButton("btn_raise_png",e.Locales.get().RAISE);m.setSize(130,65,20),m.setClick(function(){n.showGrpVsliderPanel(t,e.OpsType.RAISE)}),this.grpPutBetsControls.addChild(m)}if(-1==o.indexOf(e.OpsType[e.OpsType.RAISE])&&o.indexOf(e.OpsType[e.OpsType.ALLIN])>-1){var f=t.currentSeatAvailChips;if(t.currentSeatAvailChips>=f){var S=new TButton("btn_raise_png",e.Locales.get().ALLIN);S.setSize(130,65,20),S.setTitle(e.Locales.get().ALLIN+f),S.setClick(function(){n.putBets(e.OpsType.ALLIN,f,t)}),this.grpPutBetsControls.addChild(S)}}GlobalUtils.setHorizontalLayout(this.grpPutBetsControls,10,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.hideGrpVsliderPanel=function(){this.grpPutBetsControls.visible=!0,this.grpVsliderPanel.visible=!1},n.prototype.showGrpVsliderPanel=function(t,n){var o=this;this.grpPutBetsControls.visible=!1,this.grpVsliderPanel.visible=!0,n==e.OpsType.RAISE?(this.texasVSlider.minimum=t.minRaiseToAmount,this.texasVSlider.value=t.minRaiseToAmount,this.texasVSlider.snapInterval=t.minRaiseToAmount-t.toCallAmount):(this.texasVSlider.minimum=t.minBetAmount,this.texasVSlider.value=t.minBetAmount,this.texasVSlider.snapInterval=t.minBetAmount),this.texasVSlider.maximum=t.currentSeatAvailChips,this.labVSliderVal.text=String(this.texasVSlider.value),this.grpRightBtns.removeChildren();var i=new TButton("btn_raise_png",e.Locales.get().ALLIN);i.setSize(130,65,20),i.setClick(function(){o.putBets(n,t.currentSeatAvailChips,t)}),this.grpRightBtns.addChild(i);var s=null;if(s=n==e.OpsType.RAISE?new TButton("btn_raise_png",e.Locales.get().RAISE):new TButton("btn_bet_png",e.Locales.get()["Bet.Long"]),s.setSize(130,65,20),s.setClick(function(){o.putBets(n,o.texasVSlider.value,t)}),this.grpRightBtns.addChild(s),GlobalUtils.setHorizontalLayout(this.grpRightBtns,5,GlobalUtils.ALIGNMENT_CENTER),this.grpLeftBtns.removeChildren(),n==e.OpsType.RAISE){var r=3*t.minRaiseToAmount;if(t.currentSeatAvailChips>=r){var a=new TButton("btn_raise_png",e.Locales.get().RAISE);a.setSize(130,65,20),a.setTitle(String(r)),a.setClick(function(){o.putBets(e.OpsType.RAISE,r,t)}),this.grpLeftBtns.addChild(a)}var l=4*t.minRaiseToAmount;if(t.currentSeatAvailChips>=l){var c=new TButton("btn_raise_png",e.Locales.get().RAISE);c.setSize(130,65,20),c.setTitle(String(l)),c.setClick(function(){o.putBets(e.OpsType.RAISE,l,t)}),this.grpLeftBtns.addChild(c)}var h=5*t.minRaiseToAmount;if(t.currentSeatAvailChips>=h){var u=new TButton("btn_raise_png",e.Locales.get().RAISE);u.setSize(130,65,20),u.setTitle(String(h)),u.setClick(function(){o.putBets(e.OpsType.RAISE,h,t)}),this.grpLeftBtns.addChild(u)}}else{var p=3*t.minBetAmount;if(t.currentSeatAvailChips>=p){var g=new TButton("btn_bet_png",e.Locales.get().BET);g.setSize(130,65,20),g.setTitle(String(p)),g.setClick(function(){o.putBets(e.OpsType.BET,p,t)}),this.grpLeftBtns.addChild(g)}var d=4*t.minBetAmount;if(t.currentSeatAvailChips>=d){var m=new TButton("btn_bet_png",e.Locales.get().BET);m.setSize(130,65,20),m.setTitle(String(d)),m.setClick(function(){o.putBets(e.OpsType.BET,d,t)}),this.grpLeftBtns.addChild(m)}var f=5*t.minBetAmount;if(t.currentSeatAvailChips>=f){var S=new TButton("btn_bet_png",e.Locales.get().BET);S.setSize(130,65,20),S.setTitle(String(f)),S.setClick(function(){o.putBets(e.OpsType.BET,f,t)}),this.grpLeftBtns.addChild(S)}}GlobalUtils.setHorizontalLayout(this.grpLeftBtns,5,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.putBets=function(t,n,o){t==e.OpsType.BET&&n<o.minBetAmount||t==e.OpsType.CALL&&n<o.toCallAmount||t==e.OpsType.RAISE&&n<o.minBetAmount||this.putBetsReq(t,n)},n.prototype.putBetsReq=function(t,n){var o=EventType.GAME_TEXAS,i=new e.PutBetsReq;i.cmd=e.CommandType.PUT_BETS_REQ,i.opsType=e.OpsType[t],i.chips=n,Network.getInstance().request(new EventReq(o,i),this.onPutBetsSuccess.bind(this),this.onPutBetsError.bind(this))},n.prototype.onPutBetsSuccess=function(e){console.log("onPutBetsSuccess:"+JSON.stringify(e.args)),this.grpVsliderPanel.visible=!1,this.grpPutBetsControls.visible=!1,this.clearAllTimer()},n.prototype.onPutBetsError=function(e){console.log("onPutBetsError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.showLastSeatAction=function(e){this.updateLastActionOfSeatUI(e)},n.prototype.updateLastActionOfSeatUI=function(t){var n=t.lastSeatPutted,o=t.lastSeatOps,i=this.getSeatUI(n);i.setLabLastAction(e.Utils.opsTypeToCN[o]),i.setLabChips(String(t.lastSeatAvailChips)),this.showUserRoundBetsAnimation(i,t.lastSeatRoundBets),SoundManager.getInstance().playEffect(e.Utils.opsTypeToSound[o]),e.OpsType[e.OpsType.ALLIN]==o&&i.setImgAllIn(!0),e.OpsType[e.OpsType.FOLD]==o&&i.setImgFold(!0)},n.prototype.showDownRes=function(){this.clearAllTimer(),SoundManager.getInstance().playEffect("showdown_1_wav"),this.grpPutBetsControls.visible=!1,this.grpVsliderPanel.visible=!1,setTimeout(this.startShowDownTimer.bind(this),1e3)},n.prototype.startShowDownTimer=function(){this.showDownIdx=0;var t=e.ExtraAttribute.get().inHandUserDatas;(null!=t||0!=t.length)&&(this.showDownTimer=new egret.Timer(2e3,t.length),this.showDownTimer.addEventListener(egret.TimerEvent.TIMER,this.setValueOfTheSeatUI.bind(this),this),this.showDownTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.showDownOver.bind(this),this),this.showDownTimer.start())},n.prototype.setValueOfTheSeatUI=function(){var t=e.ExtraAttribute.get().inHandUserDatas,n=t[this.showDownIdx];if(null!=n){var o=this.getSeatUI(n.seatNo);null!=o&&(this.showUserPokers(o,n),o.setPokerType(n.pokerType),n.win&&SoundManager.getInstance().playEffect("game_win_mp3"),this.showChipsFlyAnimation(o,n)),this.showDownIdx++}},n.prototype.showDownOver=function(){this.showDownIdx=0,this.showDownTimer&&this.showDownTimer.stop();var t=e.ExtraAttribute.get().userDatas;this.setBrtChipsOfAllUsers(t)},n.prototype.clearlabPotNums=function(){this.labPotNums.text="0"},n.prototype.setValueOfAllSeatUIs=function(){var t=this,n=e.ExtraAttribute.get().userDatas;n.forEach(function(e){var n=t.getSeatUI(e.seatNo);null!=n&&(t.showUserPokers(n,e),n.setPokerType(e.pokerType),t.showChipsFlyAnimation(n,e))})},n.prototype.showChipsFlyAnimation=function(e,t){if(t.win){e.setImgWinner(!0);var n=new ChipsFly(10,this.grpTexasPot,e.getGrpParent());n.onComplete(this.clearlabPotNums.bind(this)),n.fly();var o=new PopTips;o.launch(e.getGrpParent(),"+"+t.awarded.toString())}},n.prototype.setTwoPokers=function(t,n){t.getGrpPokers().removeChildren();for(var o=-1,i=!1,s=n.pocketPokers,r=0;r<e.Constants.POCKET_POCKERS_NUMS;r++)null!=s&&s.length==e.Constants.POCKET_POCKERS_NUMS?(o=s[r],i=!0):o=0,-1!=o&&this.addOnePokerIntoSeatUI(t,o,i)},n.prototype.addOnePokerIntoSeatUI=function(t,n,o){var i=0;i=t.getIsMe()?GlobalConstants.POKER_L_W:GlobalConstants.POKER_S_W;var s=new e.PokerSprite(e.Poker.fromIndex(n),i,!1,o);s.x=s.y=0,t.getGrpPokers().addChild(s);var r=2;GlobalUtils.setHorizontalLayout(t.getGrpPokers(),r,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.showUserPokers=function(e,t){e.getGrpPokers().removeChildren(),this.setTwoPokers(e,t)},n.prototype.reloadDataReq=function(){console.log("请求数据重载.");var t=EventType.GAME_TEXAS,n=new e.ReloadDataReq;n.cmd=e.CommandType.RELOAD_DATA_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},n.prototype.reloadDataRes=function(t){var n=this;if(this.grpPutBetsControls.visible=!1,e.State[e.State.NONE]!=t.state&&e.State[e.State.WAITTING]!=t.state){if(this.grpReadyAndInvite.visible=!1,this.setLabRoundNums(),e.State[e.State.START]==t.state){var o=new CountDownTimer(e.Locales.get()["start.game.countdown"]);return this.grpTimer.addChild(o),void o.timeStart(t.startGameTimeout)}this.clearImgBeReadyOfAllSeatUIs(),this.isMeHosted()&&(this.grpHost.visible=!0);var i=this.getSeatUI(t.buttonSeatNo);if(i.setImgButton(!0),null!=t.userDatas&&(this.seatMap.Keys().forEach(function(e){var o=n.seatMap.Item(e),i=n.getUserDataBySeatNo(t.userDatas,o.getUser().seatNo);if(null!=i&&null!=i.roundBets){var s=new ChipsNum(i.roundBets);o.getGrpChipsNum().removeChildren(),o.setChipsNum(s)}o.setImgUserReady(!1),i.folded&&o.setImgFold(!0),i.allin&&o.setImgAllIn(!0)}),this.updateThePotstUI(t.pots),e.State[e.State.HASDEALER]!=t.state)){this.seatMap.Keys().forEach(function(e){var o=n.seatMap.Item(e),i=n.getUserDataBySeatNo(t.userDatas,o.getUser().seatNo);null!=i&&n.setTwoPokers(o,i)});var s=ArrayUtils.sum(t.pots);if(this.labPotNums.text=String(s),null!=e.ExtraAttribute.get().boardPokers){this.grpBoardPokers.visible=!0,this.grpBoardPokers.removeChildren();for(var r=0;r<e.ExtraAttribute.get().boardPokers.length;r++)this.grpBoardPokers.addChild(e.ExtraAttribute.get().boardPokers[r]);GlobalUtils.setHorizontalLayout(this.grpBoardPokers,3,GlobalUtils.ALIGNMENT_CENTER)}this.showTimer(),this.isMyTurn()&&(this.grpPutBetsControls.visible=!0),e.State[e.State.DEALPOCKETPOKERS]!=t.state&&e.State[e.State.FLOP]!=t.state&&e.State[e.State.TURN]!=t.state&&e.State[e.State.RIVER]!=t.state&&(t.userDatas.forEach(function(e){var t=n.getSeatUI(e.seatNo);null!=t&&(n.showUserPokers(t,e),t.setPokerType(e.pokerType),e.win&&t.setImgWinner(!0))}),e.State[e.State.SHOWDOWN]!=t.state&&this.subGameEndRes(t.reachGameRounds))}}},n.prototype.getUserDataBySeatNo=function(e,t){var n=ArrayUtils.findItemByKey(e,"seatNo",t);
return n},n.prototype.subGameEndRes=function(t){var n=e.Locales.get()["subgame.continue.countdown"],o=new CountDownTimer(n);this.grpTimer.addChild(o),o.timeStart(3)},n.prototype.gameEndRes=function(e){var t=this,n=e.content,o=new CountDownTimer(n);this.grpTimer.addChild(o),o.onComplete(function(){SceneManager.getInstance().popScene(t)}),o.timeStart(5)},n.prototype.leaveRoom=function(){var e=EventType.ROOM_LEAVE,t=new RoomLeaveReq,n=new EventReq(e,t);Network.getInstance().request(n,this.onLeaveRoomSuccess.bind(this),this.onLeaveRoomError.bind(this))},n.prototype.onLeaveRoomSuccess=function(e){console.log("onRoomLeaveSuccess:"+e.args()),RoomService.getInstance().setRoom(null)},n.prototype.onLeaveRoomError=function(e){console.log("onError:"+e.args()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.TableScene=t,__reflect(t.prototype,"Texas.TableScene",["eui.UIComponent","egret.DisplayObject"])}(Texas||(Texas={}));var Texas;!function(e){var t=function(){function e(){}return e.pokerIds=[5,9,13,17,21,25,29,33,37,41,45,49,1,6,10,14,18,22,26,30,34,38,42,46,50,2,7,11,15,19,23,27,31,35,39,43,47,51,3,8,12,16,20,24,28,32,36,40,44,48,52,4,53,54],e.pokerTypesToCN={HIGH_CARD:"高牌",ONE_PAIR:"对子",TWO_PAIR:"两对",THREE_OF_A_KIND:"三条",STRAIGHT:"顺子",FLUSH:"同花",FULL_HOUSE:"葫芦",FOUR_OF_A_KIND:"四条",STRAIGHT_FLUSH:"同花顺",ROYAL_FLUSH:"皇家同花顺"},e.pokerTypesToImage={HIGH_CARD:"texas_type_9_png",ONE_PAIR:"texas_type_8_png",TWO_PAIR:"texas_type_7_png",THREE_OF_A_KIND:"texas_type_6_png",STRAIGHT:"texas_type_5_png",FLUSH:"texas_type_4_png",FULL_HOUSE:"texas_type_3_png",FOUR_OF_A_KIND:"texas_type_2_png",STRAIGHT_FLUSH:"texas_type_1_png",ROYAL_FLUSH:"texas_type_0_png",fold:"texas_type_fold_png"},e.opsTypeToCN={NONE:"无操作",CHECK:"让牌",FOLD:"弃牌",ALLIN:"全下",RAISE:"加注",CALL:"跟注",BET:"下注"},e.opsTypeToSound={NONE:"no_ops_mp3",CALL:"call_0_mp3",BET:"call_0_mp3",RAISE:"raise_0_mp3",ALLIN:"allIn_0_mp3",FOLD:"fold_0_mp3",CHECK:"check_0_wav"},e}();e.Utils=t,__reflect(t.prototype,"Texas.Utils")}(Texas||(Texas={}));var UserMgmt;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.avatars=new Array,e.skinName="AccountSettingSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),e.initOnce(),e.grpChangeAvatars.visible=!1},e),e}return __extends(n,t),n.getInstance=function(){return null==this.acctSettingScene&&(this.acctSettingScene=new n),this.acctSettingScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnGrpClose.setClick(function(){e.showGrpChangeAvatars(!1)}),this.btnChangeAvatar.setClick(function(){e.showGrpChangeAvatars(!0)}),this.btnChangeNickName.setClick(function(){e.changeNicknameReq()}),this.btnChangePassword.setClick(function(){e.changePasswordReq()})},n.prototype.initOnce=function(){var t=UserService.getInstance().getUser(),n=GlobalConstants.USER_DEFAULT_IMAGE;null!=t.avatar&&(n=String(t.avatar)),this.imgUserAvatar.source=n,this.labUserName.text=String(t.name),this.labUserId.text=String(t.id),this.txtNickName.text=String(t.nickName),this.initTxtFields(),this.avatars=e.Constants.avatars,this.addAllListItems()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.showGrpChangeAvatars=function(e){this.grpChangeAvatars.visible=e},n.prototype.initTxtFields=function(){this.txtPassWord1.text="",this.txtPassWord2.text=""},n.prototype.addAllListItems=function(){this.addAvatarsItems()},n.prototype.refreshAvatar=function(){var e=UserService.getInstance().getUser().avatar;this.imgUserAvatar.source=e},n.prototype.addAvatarsItems=function(){null!=this.avatars&&0!=this.avatars.length?this.lablistAvatarsNoData.visible=!1:this.lablistAvatarsNoData.visible=!0,this.listAvatars.dataProvider=this.avatarsArray=new eui.ArrayCollection,this.listAvatars.itemRenderer=e.ItemAvatar;var t=this.avatars;this.avatarsArray.source=t,this.avatarsArray.refresh()},n.prototype.changeNicknameReq=function(){if(console.log("修改昵称"),this.validateTxtNickNameFields()){var t=EventType.USER_MGMT,n=new e.UserMgmtReq;n.cmd=e.CommandType.CHANGE_NICKNAME_REQ,n.nickName=this.txtNickName.text.trim();var o=new EventReq(t,n);Network.getInstance().request(o,this.onChangeNicknameSuccess.bind(this),this.onChangeNicknameError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.validateTxtNickNameFields=function(){return""==this.txtNickName.text.trim()||this.txtNickName.text.length>20||this.txtNickName.text.length<2?(TipsScene.getInstance().showError("请输入有效的昵称!"),!1):!0},n.prototype.onChangeNicknameSuccess=function(e){console.log("onChangeNicknameSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.onChangeNicknameError=function(e){console.log("onChangeNicknameError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n.prototype.changePasswordReq=function(){if(console.log("修改密码"),this.validateTxtPasswordFields()){var t=EventType.USER_MGMT,n=new e.UserMgmtReq;n.cmd=e.CommandType.CHANGE_PASSWORD_REQ,n.password=this.txtPassWord1.text.trim();var o=new EventReq(t,n);Network.getInstance().request(o,this.onChangePasswordSuccess.bind(this),this.onChangePasswordError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.validateTxtPasswordFields=function(){return""==this.txtPassWord1.text.trim()||this.txtPassWord1.text.length>20||this.txtPassWord1.text.length<2||!GlobalUtils.isLettersAndNumbers(this.txtPassWord1.text.trim())?(TipsScene.getInstance().showError("请输入有效的密码,只能用英文和数字!"),!1):this.txtPassWord1.text!=this.txtPassWord2.text.trim()?(TipsScene.getInstance().showError("两次密码不一致!"),!1):!0},n.prototype.onChangePasswordSuccess=function(e){console.log("onChangePasswordSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.onChangePasswordError=function(e){console.log("onChangePasswordError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.AccountSettingScene=t,__reflect(t.prototype,"UserMgmt.AccountSettingScene",["eui.UIComponent","egret.DisplayObject"])}(UserMgmt||(UserMgmt={}));var UserMgmt;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="BindAlipaySkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),e.showPaymentInfo()},e),e}return __extends(n,t),n.getInstance=function(){return null==this.bindAlipayScene&&(this.bindAlipayScene=new n),this.bindAlipayScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnBindPayment.setClick(function(){e.bindPaymentReq()})},n.prototype.showPaymentInfo=function(){var e=UserService.getInstance().getUser().payment;null!=e&&(null==e.alipayAccount?this.txtAccount.text="":this.txtAccount.text=String(e.alipayAccount),null==e.alipayId?this.txtAlipayId.text="":this.txtAlipayId.text=String(e.alipayId))},n.prototype.bindPaymentReq=function(){if(console.log("绑定支付宝"),this.validateTxtFields()){var t=EventType.USER_MGMT,n=new e.UserMgmtReq;n.cmd=e.CommandType.BIND_PAYMENT_REQ,n.paymentType=e.PaymentType.ALIPAY,n.alipayAccount=this.txtAccount.text.trim(),n.alipayId=this.txtAlipayId.text.trim();var o=new EventReq(t,n);Network.getInstance().request(o,this.onBindPaymentSuccess.bind(this),this.onBindPaymentError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.validateTxtFields=function(){return""==this.txtAccount.text.trim()||this.txtAccount.text.length>8||this.txtAccount.text.length<2?(TipsScene.getInstance().showError("请输入有效的姓名!"),!1):""!=this.txtAlipayId.text.trim()&&GlobalUtils.isEmail(this.txtAlipayId.text.trim())?!0:(TipsScene.getInstance().showError("请输入有效的支付宝账号!"),!1)},n.prototype.onBindPaymentSuccess=function(e){console.log("onBindPaymentSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),this.getUserData(),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.getUserData=function(){var e=EventType.USER_DATA,t=new UserDataReq,n=new EventReq(e,t);Network.getInstance().send(n)},n.prototype.onBindPaymentError=function(e){console.log("onBindPaymentError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.BindAlipayScene=t,__reflect(t.prototype,"UserMgmt.BindAlipayScene",["eui.UIComponent","egret.DisplayObject"])}(UserMgmt||(UserMgmt={}));var UserMgmt;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="BindBankCardSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(e.stage,e),e.showPaymentInfo()},e),e}return __extends(n,t),n.getInstance=function(){return null==this.bindBankCardScene&&(this.bindBankCardScene=new n),this.bindBankCardScene},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initOnce()},n.prototype.close=function(){SceneManager.getInstance().popScene(this)},n.prototype.initOnce=function(){var e=this;this.btnGoBack.setClick(function(){e.close()}),this.btnClose.setClick(function(){e.close()}),this.btnBindPayment.setClick(function(){e.bindPaymentReq()})},n.prototype.showPaymentInfo=function(){var e=UserService.getInstance().getUser().payment;null!=e&&(null==e.bankAccount?this.txtAccount.text="":this.txtAccount.text=String(e.bankAccount),null==e.bankCard?this.txtBandCardNo.text="":this.txtBandCardNo.text=String(e.bankCard),null==e.bankName?this.txtBankName.text="":this.txtBankName.text=String(e.bankName))},n.prototype.bindPaymentReq=function(){if(console.log("绑定银行卡"),this.validateTxtFields()){var t=EventType.USER_MGMT,n=new e.UserMgmtReq;n.cmd=e.CommandType.BIND_PAYMENT_REQ,n.paymentType=e.PaymentType.BANKCARD,n.bankAccount=this.txtAccount.text.trim(),n.bankCard=this.txtBandCardNo.text.trim(),n.bankName=this.txtBankName.text.trim();var o=new EventReq(t,n);Network.getInstance().request(o,this.onBindPaymentSuccess.bind(this),this.onBindPaymentError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())}},n.prototype.validateTxtFields=function(){return""==this.txtAccount.text.trim()||this.txtAccount.text.length>8||this.txtAccount.text.length<2?(TipsScene.getInstance().showError("请输入有效的姓名!"),!1):""==this.txtBandCardNo.text.trim()||!GlobalUtils.isNumbersOnly(this.txtBandCardNo.text.trim())||this.txtBandCardNo.text.length>20||this.txtBandCardNo.text.length<8?(TipsScene.getInstance().showError("请输入有效的卡号!"),!1):""==this.txtBankName.text.trim()||this.txtBankName.text.length<2?(TipsScene.getInstance().showError("请输入有效的银行名称!"),!1):!0},n.prototype.onBindPaymentSuccess=function(e){console.log("onBindPaymentSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),this.getUserData(),TipsScene.getInstance().showInfo(e.getContent())},n.prototype.getUserData=function(){var e=EventType.USER_DATA,t=new UserDataReq,n=new EventReq(e,t);Network.getInstance().send(n)},n.prototype.onBindPaymentError=function(e){console.log("onBindPaymentError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.BindBankCardScene=t,__reflect(t.prototype,"UserMgmt.BindBankCardScene",["eui.UIComponent","egret.DisplayObject"])}(UserMgmt||(UserMgmt={}));var UserMgmt;!function(e){var t=function(){function e(){}return e.BIND_PAYMENT_REQ="Bind.Payment.Req",e.BIND_PAYMENT_RES="Bind.Payment.Res",e.CHANGE_PASSWORD_REQ="Change.Password.Req",e.CHANGE_PASSWORD_RES="Change.Password.Res",e.CHANGE_AVATAR_REQ="Change.Avatar.Req",e.CHANGE_AVATAR_RES="Change.Avatar.Res",e.CHANGE_NICKNAME_REQ="Change.NickName.Req",e.CHANGE_NICKNAME_RES="Change.NickName.Res",e.GET_OFFLINEROOMS_REQ="Get.OfflineRooms.Req",e.GET_OFFLINEROOMS_RES="Get.OfflineRooms.Res",e}();e.CommandType=t,__reflect(t.prototype,"UserMgmt.CommandType")}(UserMgmt||(UserMgmt={}));var UserMgmt;!function(e){var t=function(){function e(){}return e.avatars=["man_01_png","man_02_png","man_03_png","man_04_png","man_05_png","man_06_png","man_07_png","man_08_png","man_09_png","man_10_png","man_10_png","man_12_png","woman_01_png","woman_02_png","woman_03_png","woman_04_png","woman_05_png","woman_06_png","woman_07_png","woman_08_png","woman_09_png","woman_10_png","woman_11_png","woman_12_png"],e}();e.Constants=t,__reflect(t.prototype,"UserMgmt.Constants")}(UserMgmt||(UserMgmt={}));var UserMgmt;!function(e){var t=function(){function e(){}return e}();e.UserMgmtReq=t,__reflect(t.prototype,"UserMgmt.UserMgmtReq");var n=function(){function e(){}return e}();e.UserMgmtRes=n,__reflect(n.prototype,"UserMgmt.UserMgmtRes")}(UserMgmt||(UserMgmt={}));var UserMgmt;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="ItemAvatarSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){var e=this;this.btnAction.setClick(function(){e.onBtnClicked()})},n.prototype.onBtnClicked=function(){this.changeAvatarReq()},n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.imgAvatar.source=this.data},n.prototype.changeAvatarReq=function(){console.log("修改头像");var t=EventType.USER_MGMT,n=new e.UserMgmtReq;n.cmd=e.CommandType.CHANGE_AVATAR_REQ,n.avatar=String(this.data);var o=new EventReq(t,n);Network.getInstance().request(o,this.onChangeAvatarSuccess.bind(this),this.onChangeAvatarError.bind(this)),SceneManager.getInstance().pushScene(LoadingScene.getInstance())},n.prototype.onChangeAvatarSuccess=function(t){console.log("onChangeAvatarSuccess:sucess"),SceneManager.getInstance().popScene(LoadingScene.getInstance()),UserService.getInstance().getUser().avatar=String(this.data),e.AccountSettingScene.getInstance().refreshAvatar(),Hall.HallScene.getInstance().refreshUserDataUI(),TipsScene.getInstance().showInfo(t.getContent())},n.prototype.onChangeAvatarError=function(e){console.log("onChangeAvatarError:"+e.getContent()),SceneManager.getInstance().popScene(LoadingScene.getInstance()),TipsScene.getInstance().showError(e.getContent())},n}(eui.ItemRenderer);e.ItemAvatar=t,__reflect(t.prototype,"UserMgmt.ItemAvatar")}(UserMgmt||(UserMgmt={}));var UserMgmt;!function(e){var t=function(){function e(){}return e.BANKCARD="BANKCARD",e.ALIPAY="ALIPAY",e.WEIXINPAY="WEIXINPAY",e}();e.PaymentType=t,__reflect(t.prototype,"UserMgmt.PaymentType")}(UserMgmt||(UserMgmt={}));var UserMgmt;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.userMgmtLogic&&(this.userMgmtLogic=new t),this.userMgmtLogic},t.prototype.getCommand=function(e){return e.cmd},t.prototype.processCmd=function(t){var n=null,o="",i=this.getCommand(t);switch(i){case e.CommandType.GET_OFFLINEROOMS_RES:console.log("取得对局记录的响应."),n=this.getOfflineRoomsRes(t);break;default:o="命令:"+i+"不存在.",n=new FuncResult(!1,o)}return n},t.prototype.getOfflineRoomsRes=function(e){var t=null,n=e;return GameResult.GameRslData.getInstance().getOfflineRoomsRes(n),t},t}();e.UserMgmtLogic=t,__reflect(t.prototype,"UserMgmt.UserMgmtLogic")}(UserMgmt||(UserMgmt={}));var ArrayUtils=function(){function e(){}return e.removeElements=function(e,t){for(var n=0;n<t.length;n++)for(var o=0;o<e.length;o++)if(t[n]==e[o]){e=this.slice(e,0,o).concat(this.slice(e,o+1,e.length));break}return e},e.Remove=function(e,t){for(var n=-1,o=0;o<e.length;o++)e[o]==t&&(n=o);return e.splice(n,1),e},e.slice=function(e,t,n){return 0>t||0>n||t>e.length||n>e.length?[]:e.slice(t,n)},e.sum=function(e){var t=0;return null==e||0==e.length?t:(e.forEach(function(e){t+=e}),t)},e.findItemByKey=function(e,t,n){if(null==e||0==e.length)return null;for(var o=0;o<e.length;o++)if(e[o][t]===n)return e[o];return null},e.removeItemByKey=function(e,t,n){if(null==e)return null;for(var o=0;o<e.length;o++)e[o][t]===n&&e.splice(o,1);return e},e}();__reflect(ArrayUtils.prototype,"ArrayUtils");var Base64=function(){function e(){}return e.b64EncodeUnicode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}))},e.b64DecodeUnicode=function(e){return decodeURIComponent(Array.prototype.map.call(atob(e),function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e}();__reflect(Base64.prototype,"Base64");var md5=function(){function e(){this.hexcase=0,this.b64pad=""}return e.prototype.hex_md5=function(e){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.b64_md5=function(e){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.any_md5=function(e,t){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(e)),t)},e.prototype.hex_hmac_md5=function(e,t){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.b64_hmac_md5=function(e,t){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.any_hmac_md5=function(e,t,n){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)),n)},e.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},e.prototype.rstr_md5=function(e){return this.binl2rstr(this.binl_md5(this.rstr2binl(e),8*e.length))},e.prototype.rstr_hmac_md5=function(e,t){var n=this.rstr2binl(e);n.length>16&&(n=this.binl_md5(n,8*e.length));for(var o=Array(16),i=Array(16),s=0;16>s;s++)o[s]=909522486^n[s],i[s]=1549556828^n[s];var r=this.binl_md5(o.concat(this.rstr2binl(t)),512+8*t.length);return this.binl2rstr(this.binl_md5(i.concat(r),640))},e.prototype.rstr2hex=function(e){try{this.hexcase}catch(t){this.hexcase=0}for(var n,o=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",i="",s=0;s<e.length;s++)n=e.charCodeAt(s),i+=o.charAt(n>>>4&15)+o.charAt(15&n);return i},e.prototype.rstr2b64=function(e){try{this.b64pad}catch(t){this.b64pad=""}for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="",i=e.length,s=0;i>s;s+=3)for(var r=e.charCodeAt(s)<<16|(i>s+1?e.charCodeAt(s+1)<<8:0)|(i>s+2?e.charCodeAt(s+2):0),a=0;4>a;a++)o+=8*s+6*a>8*e.length?this.b64pad:n.charAt(r>>>6*(3-a)&63);return o},e.prototype.rstr2any=function(e,t){var n,o,i,s,r,a=t.length,l=Array(Math.ceil(e.length/2));for(n=0;n<l.length;n++)l[n]=e.charCodeAt(2*n)<<8|e.charCodeAt(2*n+1);var c=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),h=Array(c);for(o=0;c>o;o++){for(r=Array(),s=0,n=0;n<l.length;n++)s=(s<<16)+l[n],i=Math.floor(s/a),s-=i*a,(r.length>0||i>0)&&(r[r.length]=i);h[o]=s,l=r}var u="";for(n=h.length-1;n>=0;n--)u+=t.charAt(h[n]);return u},e.prototype.str2rstr_utf8=function(e){for(var t,n,o="",i=-1;++i<e.length;)t=e.charCodeAt(i),n=i+1<e.length?e.charCodeAt(i+1):0,t>=55296&&56319>=t&&n>=56320&&57343>=n&&(t=65536+((1023&t)<<10)+(1023&n),i++),127>=t?o+=String.fromCharCode(t):2047>=t?o+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?o+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(o+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return o},e.prototype.str2rstr_utf16le=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e.charCodeAt(n),e.charCodeAt(n)>>>8&255);return t},e.prototype.str2rstr_utf16be=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)>>>8&255,255&e.charCodeAt(n));return t},e.prototype.rstr2binl=function(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(var n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t},e.prototype.binl2rstr=function(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t},e.prototype.binl_md5=function(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var n=1732584193,o=-271733879,i=-1732584194,s=271733878,r=0;r<e.length;r+=16){var a=n,l=o,c=i,h=s;n=this.md5_ff(n,o,i,s,e[r+0],7,-680876936),s=this.md5_ff(s,n,o,i,e[r+1],12,-389564586),i=this.md5_ff(i,s,n,o,e[r+2],17,606105819),o=this.md5_ff(o,i,s,n,e[r+3],22,-1044525330),n=this.md5_ff(n,o,i,s,e[r+4],7,-176418897),s=this.md5_ff(s,n,o,i,e[r+5],12,1200080426),i=this.md5_ff(i,s,n,o,e[r+6],17,-1473231341),o=this.md5_ff(o,i,s,n,e[r+7],22,-45705983),n=this.md5_ff(n,o,i,s,e[r+8],7,1770035416),s=this.md5_ff(s,n,o,i,e[r+9],12,-1958414417),i=this.md5_ff(i,s,n,o,e[r+10],17,-42063),o=this.md5_ff(o,i,s,n,e[r+11],22,-1990404162),n=this.md5_ff(n,o,i,s,e[r+12],7,1804603682),s=this.md5_ff(s,n,o,i,e[r+13],12,-40341101),i=this.md5_ff(i,s,n,o,e[r+14],17,-1502002290),o=this.md5_ff(o,i,s,n,e[r+15],22,1236535329),n=this.md5_gg(n,o,i,s,e[r+1],5,-165796510),s=this.md5_gg(s,n,o,i,e[r+6],9,-1069501632),i=this.md5_gg(i,s,n,o,e[r+11],14,643717713),o=this.md5_gg(o,i,s,n,e[r+0],20,-373897302),n=this.md5_gg(n,o,i,s,e[r+5],5,-701558691),s=this.md5_gg(s,n,o,i,e[r+10],9,38016083),i=this.md5_gg(i,s,n,o,e[r+15],14,-660478335),o=this.md5_gg(o,i,s,n,e[r+4],20,-405537848),n=this.md5_gg(n,o,i,s,e[r+9],5,568446438),s=this.md5_gg(s,n,o,i,e[r+14],9,-1019803690),i=this.md5_gg(i,s,n,o,e[r+3],14,-187363961),o=this.md5_gg(o,i,s,n,e[r+8],20,1163531501),n=this.md5_gg(n,o,i,s,e[r+13],5,-1444681467),s=this.md5_gg(s,n,o,i,e[r+2],9,-51403784),i=this.md5_gg(i,s,n,o,e[r+7],14,1735328473),o=this.md5_gg(o,i,s,n,e[r+12],20,-1926607734),n=this.md5_hh(n,o,i,s,e[r+5],4,-378558),s=this.md5_hh(s,n,o,i,e[r+8],11,-2022574463),i=this.md5_hh(i,s,n,o,e[r+11],16,1839030562),o=this.md5_hh(o,i,s,n,e[r+14],23,-35309556),n=this.md5_hh(n,o,i,s,e[r+1],4,-1530992060),s=this.md5_hh(s,n,o,i,e[r+4],11,1272893353),i=this.md5_hh(i,s,n,o,e[r+7],16,-155497632),o=this.md5_hh(o,i,s,n,e[r+10],23,-1094730640),n=this.md5_hh(n,o,i,s,e[r+13],4,681279174),s=this.md5_hh(s,n,o,i,e[r+0],11,-358537222),i=this.md5_hh(i,s,n,o,e[r+3],16,-722521979),o=this.md5_hh(o,i,s,n,e[r+6],23,76029189),n=this.md5_hh(n,o,i,s,e[r+9],4,-640364487),s=this.md5_hh(s,n,o,i,e[r+12],11,-421815835),i=this.md5_hh(i,s,n,o,e[r+15],16,530742520),o=this.md5_hh(o,i,s,n,e[r+2],23,-995338651),n=this.md5_ii(n,o,i,s,e[r+0],6,-198630844),s=this.md5_ii(s,n,o,i,e[r+7],10,1126891415),i=this.md5_ii(i,s,n,o,e[r+14],15,-1416354905),o=this.md5_ii(o,i,s,n,e[r+5],21,-57434055),n=this.md5_ii(n,o,i,s,e[r+12],6,1700485571),s=this.md5_ii(s,n,o,i,e[r+3],10,-1894986606),i=this.md5_ii(i,s,n,o,e[r+10],15,-1051523),o=this.md5_ii(o,i,s,n,e[r+1],21,-2054922799),n=this.md5_ii(n,o,i,s,e[r+8],6,1873313359),s=this.md5_ii(s,n,o,i,e[r+15],10,-30611744),i=this.md5_ii(i,s,n,o,e[r+6],15,-1560198380),o=this.md5_ii(o,i,s,n,e[r+13],21,1309151649),n=this.md5_ii(n,o,i,s,e[r+4],6,-145523070),s=this.md5_ii(s,n,o,i,e[r+11],10,-1120210379),i=this.md5_ii(i,s,n,o,e[r+2],15,718787259),o=this.md5_ii(o,i,s,n,e[r+9],21,-343485551),n=this.safe_add(n,a),o=this.safe_add(o,l),i=this.safe_add(i,c),s=this.safe_add(s,h)}return[n,o,i,s]},e.prototype.md5_cmn=function(e,t,n,o,i,s){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(t,e),this.safe_add(o,s)),i),n)},e.prototype.md5_ff=function(e,t,n,o,i,s,r){return this.md5_cmn(t&n|~t&o,e,t,i,s,r)},e.prototype.md5_gg=function(e,t,n,o,i,s,r){return this.md5_cmn(t&o|n&~o,e,t,i,s,r)},e.prototype.md5_hh=function(e,t,n,o,i,s,r){return this.md5_cmn(t^n^o,e,t,i,s,r)},e.prototype.md5_ii=function(e,t,n,o,i,s,r){return this.md5_cmn(n^(t|~o),e,t,i,s,r)},e.prototype.safe_add=function(e,t){var n=(65535&e)+(65535&t),o=(e>>16)+(t>>16)+(n>>16);return o<<16|65535&n},e.prototype.bit_rol=function(e,t){return e<<t|e>>>32-t},e}();__reflect(md5.prototype,"md5");var GlobalUtils=function(){function e(){}return e.rand=function(e,t){var n=t-e-1,o=Math.random()*n;return Math.round(o)+e},e.imageProxyUrl=function(e){return"webgl"==egret.Capabilities.renderMode?window.API_SERVER+"api.php?cmd=image_proxy&url="+encodeURIComponent(e):e},e.getImagebyUrl=function(t){if(null==t||""==t)return e.createBitmapByName(GlobalConstants.USER_DEFAULT_IMAGE);egret.ImageLoader.crossOrigin="anonymous";var n=new egret.Bitmap;return RES.getResByUrl(t,function(e){n.texture=e},this,RES.ResourceItem.TYPE_IMAGE),n},e.createBitmapByName=function(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t},e.setHorizontalLayout=function(e,t,n){for(var o=0,i=0;i<e.numChildren;i++){var s=e.getChildAt(i);o+=s.width}var r=0;"LEFT"==n?r=0:"CENTER"==n?r=Math.max(0,.5*Math.round(e.width-o-(e.numChildren-1)*t)):"RIGHT"==n&&(r=Math.max(0,Math.round(e.width-o-(e.numChildren-1)*t)));for(var a=0,i=0;i<e.numChildren;i++){var s=e.getChildAt(i),l=r+i*(a+t);a=s.width,s.x=l,s.y=e.height-s.height>>1}},e.setImageColor=function(e,t){var n=function(e){var t={r:-1,g:-1,b:-1};return t.b=e%256,t.g=Math.floor(e/256)%256,t.r=Math.floor(e/256/256),t},o=n(t),i=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];i[0]=o.r/255,i[6]=o.g/255,i[12]=o.b/255;var s=new egret.ColorMatrixFilter(i);e.filters=[s]},e.getFixedLenOfString=function(e,t){var n=e,o=new RegExp("[一-龥]+");return o.test(e)?e.length>t&&(n=e.substr(0,t-2)+"*"+e.substr(e.length-1,1)):(t=2*t,e.length>t&&(n=e.substr(0,t-2)+"*"+e.substr(e.length-1,1))),n},e.injectProp=function(e,t,n){if(void 0===t&&(t=null),void 0===n&&(n=!0),!t)return!1;var o=!0;for(var i in t){var s=t[i];n&&"function"==typeof s||(e[i]=s)}return o},e.clone=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!0);var o=t?new t:{};return this.injectProp(o,e,n),o},e.UUID=function(){return EvetnId.counter++},e.waitfor=function(t,n,o,i,s,r,a){for(var l=egret.getTimer();t()!==n;)return l-i>=s?void a():void setTimeout(function(){e.waitfor(t,n,o,i,s,r,a)},o);r()},e.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e},e.getRandomIntInclusive=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e},e.shortNumber=function(e){return 1e4>e?e.toString():Number((e/1e4).toFixed(2).toString().split(".")[1])>=10&&Number((e/1e4).toFixed(2).toString().split(".")[1])<100&&"0"==(e/1e4).toFixed(2).toString().split(".")[1].substr(1,2)?(e/1e4).toFixed(1)+"万":Number((e/1e4).toFixed(2).toString().split(".")[1])>=1&&Number((e/1e4).toFixed(2).toString().split(".")[1])<10||Number((e/1e4).toFixed(2).toString().split(".")[1])>=10&&Number((e/1e4).toFixed(2).toString().split(".")[1])<100&&"0"!=(e/1e4).toFixed(2).toString().split(".")[1].substr(1,2)?(e/1e4).toFixed(2)+"万":Math.floor(e/1e4)+"万"},e.creatMovieClipByName=function(e){var t=RES.getRes(e+"_json"),n=RES.getRes(e+"_png");if(null!=t&&null!=n){var o=new egret.MovieClipDataFactory(t,n),i=new egret.MovieClip(o.generateMovieClipData("aniName"));if(null!=i)return i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i}},e.isLettersAndNumbers=function(e){if(null==e||""==e.trim())return!1;var t=/^[A-Za-z0-9]+$/;return t.test(e)?!0:!1},e.isLettersOnly=function(e){if(null==e||""==e.trim())return!1;var t=/^[A-Za-z]+$/;return t.test(e)?!0:!1},e.isNumbersOnly=function(e){if(null==e||""==e.trim())return!1;var t=/^[0-9]+$/;return t.test(e)?!0:!1},e.isInteger=function(e){if(isNaN(e))return!1;var t=parseFloat(e);return(0|t)===t},e.isEmail=function(e){var t=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);return t.test(e)},e.stringFormat=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=t;return e.replace(/{(\d+)}/g,function(e,t){return"undefined"!=typeof o[t]?o[t]:e})},e.dateFormat=function(e){if(null==e)return"";var t=new Date(e),n=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();return n},e.findNumbersSequence=function(e,t){var n=new Array,o=Math.min(e.length,t);e.sort();for(var i=0;i<=e.length-o;i++){for(var s=[],r=0;o>r;r++)e[i+r]==e[i]+r&&s.push(e[i+r]);s.length==o&&n.push(s)}return n},e.calcRoomAAPrice=function(e,t,n){var o=0,i=Number((e/t).toFixed(2));return o=n?e-i*(t-1):i},e.loadSystemConfiguration=function(){var e=RES.getRes("system_json");for(var t in e)if("Http.Host"==t){var n=e[t];GlobalConstants.HTTP_HOST=n}else if("Http.Port"==t){var n=e[t];GlobalConstants.HTTP_PORT=Number(n)}else if("Http.Url"==t){var n=e[t];GlobalConstants.HTTP_URL=n}},e.switchMusicBg=function(e){1==SoundManager.getInstance().musicMute?SoundManager.getInstance().stopMusic():SoundManager.getInstance().playMusic(e)},e.counter=1,e.ALIGNMENT_LEFT="LEFT",e.ALIGNMENT_RIGHT="RIGHT",e.ALIGNMENT_CENTER="CENTER",e}();__reflect(GlobalUtils.prototype,"GlobalUtils");var Zjh;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t._tween_X_Left=null,t._tween_Y_Left=null,t._tween_alpha_Left=null,t._tween_scaleX_Left=null,t._tween_scaleY_Left=null,t._tween_X_Right=null,t._tween_Y_Right=null,t._tween_alpha_Right=null,t._tween_scaleX_Right=null,t._tween_scaleY_Right=null,t._tween_alpha_Back=null,t._tween_pk_alpha=null,t._tween_pk_scaleX=null,t._tween_pk_scaleY=null,t._tween_pk_add_alpha=null,t._tween_pk_add_scaleX=null,t._tween_pk_add_scaleY=null,t._tween_light_alpha=null,t._tween_lose_light_alpha=null,t.pkLightTimer=null,t.pkLightningIdx=0,t.init(),t}return __extends(t,e),t.getInstance=function(){return null==this.cardsPK&&(this.cardsPK=new t),this.cardsPK},t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.init=function(){this.angleLength=30,this.drawBg(),this.visible=!1,this.imgLeft=new eui.Image,this.addChildAt(this.imgLeft,2),this.imgRight=new eui.Image,this.addChildAt(this.imgRight,3),this.imgPKWord=new eui.Image,this.addChildAt(this.imgPKWord,8),this.imgPKLight=new eui.Image,this.addChildAt(this.imgPKLight,9),this.imgLoseLight=new eui.Image,this.addChildAt(this.imgLoseLight,10),this.imgPKWord.source="cards_pk_png",this.imgPKWord.width=137,this.imgPKWord.height=62,this.imgPKLight.source="pk_light_0_png",this.imgPKLight.width=348,this.imgPKLight.height=111,this.imgLoseLight.source="pk_lose_light_png",this.imgLoseLight.width=113,this.imgLoseLight.height=118,this.imgLeft.source="pk_left_bg_png",this.imgLeft.width=StageProxy.width/2+this.angleLength,this.imgLeft.height=150,this.imgRight.source="pk_right_bg_png",this.imgRight.width=StageProxy.width/2+this.angleLength,this.imgRight.height=150,this.imgPKWord.visible=!1,this.imgPKLight.visible=!1,this.imgLoseLight.visible=!1,this.imgLeft.visible=!1,this.imgRight.visible=!1,this.imgPKWord.x=StageProxy.width/2+30,this.imgPKWord.y=StageProxy.height/3+this.imgPKWord.height/2,this.imgPKWord.anchorOffsetX=this.imgPKWord.width/2,this.imgPKWord.anchorOffsetY=this.imgPKWord.height/2,this.imgPKLight.x=StageProxy.width/2,this.imgPKLight.y=StageProxy.height/3+30,this.imgPKLight.anchorOffsetX=this.imgPKLight.width/2,this.imgPKLight.anchorOffsetY=this.imgPKLight.height/2,this.imgLoseLight.y=(StageProxy.height-this.imgLoseLight.height)/3,this.imgLeftStartX=-this.imgLeft.width,this.imgLeftStartY=(StageProxy.height-this.imgLeft.height)/3,this.imgLeftEndX=StageProxy.width/2-this.imgLeft.width+this.angleLength,this.imgLeftEndY=this.imgLeftStartY,this.imgRightStartX=StageProxy.width+this.imgRight.width,this.imgRightStartY=(StageProxy.height-this.imgRight.height)/3,this.imgRightEndX=StageProxy.width/2-this.angleLength,this.imgRightEndY=this.imgRightStartY},t.prototype.onComplete=function(e){this.call=e},t.prototype.setUsers=function(e,t){this.contains(this.currentUser)&&this.removeChild(this.currentUser),this.contains(this.tgtUser)&&this.removeChild(this.tgtUser),this.currentUser=e,this.currentUser.x=StageProxy.width/2-80-this.currentUser.width,this.currentUser.y=(StageProxy.height-this.currentUser.height)/3+5,this.currentUser.width=200,this.currentUser.height=125,this.addChildAt(this.currentUser,4),this.currentUser.visible=!1,this.tgtUser=t,this.tgtUser.x=StageProxy.width/2+100,this.tgtUser.y=(StageProxy.height-this.tgtUser.height)/3+5,this.tgtUser.width=200,this.tgtUser.height=125,this.addChildAt(this.tgtUser,4),this.tgtUser.visible=!1
},t.prototype.drawBg=function(){this.bg=new eui.Rect,this.addChildAt(this.bg,0),this.bg.visible=!1,this.bg.width=StageProxy.width,this.bg.height=StageProxy.height,this.bg.fillColor=3878148,this.bg.alpha=.7},t.prototype.setParentCont=function(e){this.parentCont=e},t.prototype.getParentCont=function(){return this.parentCont},t.prototype.start=function(){var e=this;this.visible=!0,this.parentCont.addChild(this),this.bg.visible=!0,this.imgLeft.alpha=0,this.imgLeft.x=this.imgLeftStartX,this.imgLeft.y=this.imgLeftStartY,this.imgRight.alpha=0,this.imgRight.x=this.imgRightStartX,this.imgRight.y=this.imgRightStartY,egret.setTimeout(function(){e.startAction()},this,100)},t.prototype.startAction=function(){var e=this;this.visible=!0,this.imgLeft.visible=!0,this.imgRight.visible=!0,this.imgLoseLight.visible=!1,this._tween_alpha_Left=egret.Tween.get(this.imgLeft).to({alpha:1},300),this._tween_X_Left=egret.Tween.get(this.imgLeft).wait(300).to({x:this.imgLeftEndX},400),this._tween_Y_Left=egret.Tween.get(this.imgLeft).wait(300).to({y:this.imgLeftEndY},400),this._tween_scaleX_Left=egret.Tween.get(this.imgLeft).wait(300).to({scaleX:1},400),this._tween_scaleY_Left=egret.Tween.get(this.imgLeft).wait(300).to({scaleY:1},400),this._tween_alpha_Right=egret.Tween.get(this.imgRight).to({alpha:1},300),this._tween_X_Right=egret.Tween.get(this.imgRight).wait(300).to({x:this.imgRightEndX},400),this._tween_Y_Right=egret.Tween.get(this.imgRight).wait(300).to({y:this.imgRightEndY},400),this._tween_scaleX_Right=egret.Tween.get(this.imgRight).wait(300).to({scaleX:1},400),this._tween_scaleY_Right=egret.Tween.get(this.imgRight).wait(300).to({scaleY:1},400).call(function(){e.currentUser.visible=!0,e.tgtUser.visible=!0,SoundManager.getInstance().playEffect("kill_card_doing_wav"),e.showimgPKWord(),e.pkLightTimer=new egret.Timer(200,3),e.pkLightTimer.addEventListener(egret.TimerEvent.TIMER,e.showImgPKLightning,e),e.pkLightTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,e.showImgPKLightningComplete,e),e.pkLightTimer.start()})},t.prototype.showimgPKWord=function(){this.imgPKWord.alpha=1,this.imgPKWord.scaleX=4,this.imgPKWord.scaleY=4,this.imgPKWord.visible=!0,this._tween_pk_alpha=egret.Tween.get(this.imgPKWord).wait(2200).to({alpha:0},200),this._tween_pk_scaleX=egret.Tween.get(this.imgPKWord).to({scaleX:1.5},200).wait(2e3).to({scaleX:2.5},200),this._tween_pk_scaleY=egret.Tween.get(this.imgPKWord).to({scaleY:1.5},200).wait(2e3).to({scaleY:2.5},200)},t.prototype.showImgPKLightning=function(){this.imgPKLight.visible=!0,this.imgPKLight.source="pk_light_"+this.pkLightningIdx+"_png",this.pkLightningIdx++},t.prototype.showImgPKLightningComplete=function(){this.pkLightTimer.stop(),this.imgPKLight.visible=!1,this.showImgLoseLightning()},t.prototype.showImgLoseLightning=function(){var e=this;this.playResSound(),this.imgLoseLight.visible=!0,this.currentUser.isWin()?this.imgLoseLight.x=StageProxy.width/2+80+100:this.imgLoseLight.x=StageProxy.width/2-80-100,this._tween_lose_light_alpha=egret.Tween.get(this.imgLoseLight).wait(2200).to({alpha:0},200).call(function(){e.showPKRes()})},t.prototype.playResSound=function(){this.currentUser.getIsMe()&&(this.currentUser.isWin()?SoundManager.getInstance().playEffect("kill_card_win_wav"):SoundManager.getInstance().playEffect("kill_card_lose_wav"))},t.prototype.showPKRes=function(){var e=this;this.currentUser.isWin()?this.tgtUser.setImgPKLose():this.currentUser.setImgPKLose(),setTimeout(function(){e.stop()},2e3)},t.prototype.stop=function(){this.visible=!1,this.stopAction(),null!=this.call&&this.call()},t.prototype.stopAction=function(){this.pkLightningIdx=0,this.parentCont&&this.parentCont.removeChild(this),this._tween_X_Left&&(this._tween_X_Left.setPaused(!0),this._tween_X_Left=null),this._tween_Y_Left&&(this._tween_Y_Left.setPaused(!0),this._tween_Y_Left=null),this._tween_alpha_Left&&(this._tween_alpha_Left.setPaused(!0),this._tween_alpha_Left=null),this._tween_scaleX_Left&&(this._tween_scaleX_Left.setPaused(!0),this._tween_scaleX_Left=null),this._tween_scaleY_Left&&(this._tween_scaleY_Left.setPaused(!0),this._tween_scaleY_Left=null),this._tween_X_Right&&(this._tween_X_Right.setPaused(!0),this._tween_X_Right=null),this._tween_Y_Right&&(this._tween_Y_Right.setPaused(!0),this._tween_Y_Right=null),this._tween_alpha_Right&&(this._tween_alpha_Right.setPaused(!0),this._tween_alpha_Right=null),this._tween_scaleX_Right&&(this._tween_scaleX_Right.setPaused(!0),this._tween_scaleX_Right=null),this._tween_scaleY_Right&&(this._tween_scaleY_Right.setPaused(!0),this._tween_scaleY_Right=null),this._tween_alpha_Back&&(this._tween_alpha_Back.setPaused(!0),this._tween_alpha_Back=null),this._tween_pk_alpha&&(this._tween_pk_alpha.setPaused(!0),this._tween_pk_alpha=null),this._tween_pk_scaleX&&(this._tween_pk_scaleX.setPaused(!0),this._tween_pk_scaleX=null),this._tween_pk_scaleY&&(this._tween_pk_scaleY.setPaused(!0),this._tween_pk_scaleY=null),this._tween_pk_add_alpha&&(this._tween_pk_add_alpha.setPaused(!0),this._tween_pk_add_alpha=null),this._tween_pk_add_scaleX&&(this._tween_pk_add_scaleX.setPaused(!0),this._tween_pk_add_scaleX=null),this._tween_pk_add_scaleY&&(this._tween_pk_add_scaleY.setPaused(!0),this._tween_pk_add_scaleY=null),this._tween_light_alpha&&(this._tween_light_alpha.setPaused(!0),this._tween_light_alpha=null),this._tween_lose_light_alpha&&(this._tween_lose_light_alpha.setPaused(!0),this._tween_lose_light_alpha=null)},t}(eui.Component);e.CardsPK=t,__reflect(t.prototype,"Zjh.CardsPK")}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.isMe=e,n.skinName="CardsPKSeatUISkin",n}return __extends(n,t),n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},n.prototype.initUI=function(){this.user=null,this.setLabName(""),null!=this.grpPokers&&this.grpPokers.removeChildren()},n.formSeatUI=function(t){var o=new n(t.getIsMe());if(o.setUser(t.getUser()),o.setImgAvatar(t.getUser().avatar),o.setLabName(t.getUser().name),o.isMe&&t.isLooked()){var i=e.ExtraAttribute.get().pokers;i.forEach(function(t){var n=new e.PokerSprite(t.getPoker(),GlobalConstants.POKER_S_W,!1,!0);n.x=n.y=0,o.getGrpPokers().addChild(n)})}else for(var s=0;3>s;s++){var r=new e.PokerSprite(e.Poker.fromIndex(0),GlobalConstants.POKER_S_W,!1,!1);r.x=r.y=0,o.getGrpPokers().addChild(r)}var a=-10;return GlobalUtils.setHorizontalLayout(o.getGrpPokers(),a,GlobalUtils.ALIGNMENT_CENTER),o},n.prototype.show=function(e){e.visible=!0,e.addChild(this)},n.prototype.setUser=function(e){this.user=e},n.prototype.getUser=function(){return this.user},n.prototype.getIsMe=function(){return this.isMe},n.prototype.setWin=function(e){this.win=!0},n.prototype.isWin=function(){return this.win},n.prototype.setLabName=function(e){(void 0==e||null==e)&&(e=""),this.labName.text=GlobalUtils.getFixedLenOfString(e,6)},n.prototype.setImgAvatar=function(e){this.imgAvatar=GlobalUtils.getImagebyUrl(e),this.imgAvatar.width=this.imgAvatar.height=78},n.prototype.setGrpPokers=function(e){this.grpPokers=e},n.prototype.getGrpPokers=function(){return this.grpPokers},n.prototype.setImgPKLose=function(){this.imgPKLose=GlobalUtils.createBitmapByName("zjh_kill_lose_png"),this.imgPKLose.width=this.grpPokers.width,this.imgPKLose.height=this.grpPokers.height/2-5,this.imgPKLose.x=.5*this.grpPokers.width-.5*this.imgPKLose.width+20,this.imgPKLose.y=this.grpPokers.height-this.imgPKLose.height,this.grpPokers.addChild(this.imgPKLose)},n}(eui.Component);e.CardsPKSeatUI=t,__reflect(t.prototype,"Zjh.CardsPKSeatUI",["eui.UIComponent","egret.DisplayObject"])}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(){function e(){}return e.START_GAME_RES="Start.Game.Res",e.HAS_DEALER_RES="Has.Dealer.Res",e.DEAL_POKERS_REQ="Deal.Pokers.Req",e.DEAL_POKERS_RES="Deal.Pokers.Res",e.DEAL_POKERS_END_REQ="Deal.Pokers.End.Req",e.LOOK_POKERS_REQ="Look.Pokers.Req",e.LOOK_POKERS_RES="Look.Pokers.Res",e.OTHERS_LOOK_POKERS_RES="Others.Look.Pokers.Res",e.KILL_POKERS_REQ="Kill.Pokers.Req",e.KILL_POKERS_RES="Kill.Pokers.Res",e.PUT_BETS_REQ="Put.Bets.Req",e.PUT_BETS_RES="Put.Bets.Res",e.SHOW_DOWN_RES="Show.Down.Res",e.SHOW_DOWN_REQ="Show.Down.Req",e.RELOAD_DATA_REQ="Reload.Data.Req",e.RELOAD_DATA_RES="Reload.Data.Res",e.SUB_GAME_END_RES="Sub.Game.End.Res",e.GAME_END_RES="Game.End.Res",e}();e.CommandType=t,__reflect(t.prototype,"Zjh.CommandType")}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(){function e(){}return e.POCKET_POKERS_NUM=3,e.PUT_BET_DELAY_IN_SECS=10,e.USER_ALLIN_IMAGE="avatar_allIn_png",e.USER_FOLD_IMAGE="avatar_fold_png",e.PX_BG_IMAGE="1pxbg_png",e.BTN_CALL="Btn.Call",e.BTN_ALLIN="Btn.Allin",e.BTN_RAISE_2X="Btn.Raise.2x",e.BTN_RAISE_4X="Btn.Raise.4x",e.BTN_LOOK="Btn.Look",e.BTN_KILL="Btn.KILL",e.BTN_FOLD="Btn.Fold",e.BTN_SHOWDOWN="Btn.ShowDown",e.EVENT_ZJH_HIDE_CARDS_PK="Event.Zjh.Hide.Cards.PK",e.EVENT_ZJH_RELOAD_DATA="Event.Zjh.Reload.Data",e}();e.Constants=t,__reflect(t.prototype,"Zjh.Constants")}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(){function e(){}return e}();e.StartGameRes=t,__reflect(t.prototype,"Zjh.StartGameRes");var n=function(){function e(){}return e}();e.HasDealerRes=n,__reflect(n.prototype,"Zjh.HasDealerRes");var o=function(){function e(){}return e}();e.DealPokersRes=o,__reflect(o.prototype,"Zjh.DealPokersRes");var i=function(){function e(){}return e}();e.DealPokersEndReq=i,__reflect(i.prototype,"Zjh.DealPokersEndReq");var s=function(){function e(){}return e}();e.LookPokersReq=s,__reflect(s.prototype,"Zjh.LookPokersReq");var r=function(){function e(){}return e}();e.LookPokersRes=r,__reflect(r.prototype,"Zjh.LookPokersRes");var a=function(){function e(){}return e}();e.OthersLookPokersRes=a,__reflect(a.prototype,"Zjh.OthersLookPokersRes");var l=function(){function e(){}return e}();e.PutBetsReq=l,__reflect(l.prototype,"Zjh.PutBetsReq");var c=function(){function e(){}return e}();e.PutBetsRes=c,__reflect(c.prototype,"Zjh.PutBetsRes");var h=function(){function e(){}return e}();e.KillPokersReq=h,__reflect(h.prototype,"Zjh.KillPokersReq");var u=function(){function e(){}return e}();e.KillPokersRes=u,__reflect(u.prototype,"Zjh.KillPokersRes");var p=function(){function e(){}return e}();e.ShowDownRes=p,__reflect(p.prototype,"Zjh.ShowDownRes");var g=function(){function e(){}return e}();e.ShowDownReq=g,__reflect(g.prototype,"Zjh.ShowDownReq");var d=function(){function e(){}return e}();e.SubGameEndRes=d,__reflect(d.prototype,"Zjh.SubGameEndRes");var m=function(){function e(){}return e}();e.UserData=m,__reflect(m.prototype,"Zjh.UserData");var f=function(){function e(){}return e}();e.GameEndReq=f,__reflect(f.prototype,"Zjh.GameEndReq");var S=function(){function e(){}return e}();e.GameEndRes=S,__reflect(S.prototype,"Zjh.GameEndRes");var y=function(){function e(){}return e}();e.ReloadDataReq=y,__reflect(y.prototype,"Zjh.ReloadDataReq");var b=function(){function e(){}return e}();e.ReloadDataRes=b,__reflect(b.prototype,"Zjh.ReloadDataRes")}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(){function e(){this.subGameIndex=0,this.subGameNums=0,this.buttonSeatNo=-1,this.shareScore=0,this.cappedScroe=0,this.currentSeatNo=-1,this.currentSeatTotalBets=0,this.putBetsTimeout=0,this.availSeats=new Array,this.userDatas=new Array,this.pokers=new Array}return e.get=function(){return RoomService.getInstance().getRoom().table.getExtraAttribute()},e.reset=function(){var t=new e;RoomService.getInstance().getRoom().table.setExtraAttribute(t)},e}();e.ExtraAttribute=t,__reflect(t.prototype,"Zjh.ExtraAttribute")}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.texasLogic&&(this.texasLogic=new t),this.texasLogic},t.prototype.getCommand=function(e){return e.cmd},t.prototype.processCmd=function(t){var n=null,o="",i=this.getCommand(t);switch(i){case e.CommandType.START_GAME_RES:console.log("服务器通知游戏开始的命令."),n=this.startGameRes(t);break;case e.CommandType.DEAL_POKERS_RES:console.log("服务器通知发手牌的命令."),n=this.dealPokersRes(t);break;case e.CommandType.LOOK_POKERS_RES:console.log("服务器通知看牌."),n=this.lookPokersRes(t);break;case e.CommandType.OTHERS_LOOK_POKERS_RES:console.log("服务器其他用户看牌的命令."),n=this.othersLookPokerRes(t);break;case e.CommandType.HAS_DEALER_RES:console.log("服务器通知有庄的命令."),n=this.hasDealerRes(t);break;case e.CommandType.KILL_POKERS_RES:console.log("服务器通知比牌的命令."),n=this.killPokersRes(t);break;case e.CommandType.PUT_BETS_RES:console.log("服务器通知下注的命令."),n=this.putBetsRes(t);break;case e.CommandType.PUT_BETS_RES:console.log("服务器通知下注的命令."),n=this.putBetsRes(t);break;case e.CommandType.SHOW_DOWN_RES:console.log("服务器通知最终摊牌的命令."),n=this.showDownRes(t);break;case e.CommandType.RELOAD_DATA_RES:console.log("服务器通知数据重载的命令."),n=this.reloadDataRes(t);break;case e.CommandType.SUB_GAME_END_RES:console.log("服务器通知本局结束."),n=this.subGameEndRes(t);break;case e.CommandType.GAME_END_RES:console.log("服务通知本房间游戏结束."),n=this.gameEndRes(t);break;default:o="命令:"+i+"不存在.",n=new FuncResult(!1,o)}return n},t.prototype.roomJoinOthers=function(t){var n=t;null!=n.user&&RoomService.getInstance().getRoom().table.addUser(n.user.seatNo,n.user,!1),e.TableScene.getInstance().roomJoinOthers(n)},t.prototype.roomLeaveOthers=function(t){var n=t,o=RoomService.getInstance().getRoom();null!=n.userId&&""!=n.userId&&o.id==n.roomId&&e.TableScene.getInstance().roomLeaveOthers(n)},t.prototype.startGameRes=function(t){var n=null,o=t;return e.ExtraAttribute.reset(),e.ExtraAttribute.get().subGameIndex=o.subGameIndex,e.ExtraAttribute.get().subGameNums=o.subGameNums,e.TableScene.getInstance().startGameRes(o),n},t.prototype.tableIsFull=function(t){e.TableScene.getInstance().tableIsFull()},t.prototype.dealPokersRes=function(t){var n=null;return e.TableScene.getInstance().dealPokersRes(),n},t.prototype.lookPokersRes=function(t){var n=null,o=t,i=e.PokerSprite.fromIndexs(o.pokers);return e.ExtraAttribute.get().pokers=i,e.ExtraAttribute.get().pokerType=o.pokerType,e.TableScene.getInstance().lookPokersRes(o),n},t.prototype.othersLookPokerRes=function(t){var n=null,o=t;return e.TableScene.getInstance().othersLookPokersrRes(o),n},t.prototype.hasDealerRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().buttonSeatNo=o.buttonSeatNo,e.ExtraAttribute.get().shareScore=o.shareScore,e.ExtraAttribute.get().currentSeatTotalBets=o.shareScore,e.ExtraAttribute.get().cappedScroe=o.cappedScroe,e.ExtraAttribute.get().putBetsTimeout=o.putBetTimeout,e.TableScene.getInstance().hasDealerRes(o),n},t.prototype.putBetsRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().currentSeatNo=o.currentSeatNo,e.TableScene.getInstance().getMySeatNo()==o.lastSeatPutted&&(e.ExtraAttribute.get().currentSeatTotalBets=o.lastSeatTotalBets),e.ExtraAttribute.get().availSeats=o.availSeats,e.TableScene.getInstance().putBetsRes(o),n},t.prototype.killPokersRes=function(t){var n=null,o=t;return e.TableScene.getInstance().killPokersRes(o),n},t.prototype.showDownRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().userDatas=o.userDatas,e.TableScene.getInstance().showDownRes(),n},t.prototype.reloadDataRes=function(t){var n=null,o=t;return e.ExtraAttribute.get().subGameIndex=o.subGameIndex,e.ExtraAttribute.get().subGameNums=o.subGameNums,e.ExtraAttribute.get().buttonSeatNo=o.buttonSeatNo,e.ExtraAttribute.get().shareScore=o.shareScore,e.ExtraAttribute.get().cappedScroe=o.cappedScroe,e.ExtraAttribute.get().putBetsTimeout=o.putBetTimeout,e.ExtraAttribute.get().currentSeatNo=o.currentSeatNo,e.ExtraAttribute.get().userDatas=o.userDatas,e.TableScene.getInstance().reloadDataRes(o),n},t.prototype.subGameEndRes=function(t){var n=null,o=t;return e.TableScene.getInstance().subGameEndRes(o.reachGameRounds),n},t.prototype.gameEndRes=function(t){var n=null,o=t;return e.TableScene.getInstance().gameEndRes(o),n},t.prototype.roomJoin=function(t){var n=null,o=RoomService.getInstance().getRoom(),i=e.TableScene.getInstance();i.initTheTable(),i.setRoom(o.id),i.setUsersReady();var s=!0;return null!=o.category&&o.category==RoomCategory.COINMODE&&(s=!1),i.initGrpReadyAndInvite(s),SceneManager.getInstance().pushScene(i),n},t.prototype.roomRejoin=function(t){var n=null;EventManager.getInstance().addEvent(e.Constants.EVENT_ZJH_RELOAD_DATA,e.TableScene.getInstance().reloadDataReq.bind(this),null);var o=e.TableScene.getInstance();return o.initTheTable(),o.setRoom(RoomService.getInstance().getRoom().id),o.setUsersReady(),SceneManager.getInstance().pushScene(o),n},t.prototype.beReady=function(t){var n=t;e.TableScene.getInstance().beReadyRes(n)},t.prototype.getRoomType=function(){return RoomType.ZJH},t}();e.GameLogic=t,__reflect(t.prototype,"Zjh.GameLogic")}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(){function e(){}return e.get=function(){return e.CN},e.CN={"start.game.countdown":"游戏即将开始","subgame.continue.countdown":"本局游戏结束,继续","game.end.countdown":"本房间局数已满，即将解散","put.bets":"下注","put.bets.call":"跟注","put.bets.call.short":"跟","put.bets.raise":"加注","put.bets.raise.2x":"2倍","put.bets.raise.4x":"4倍","put.bets.fold":"弃牌","put.bets.look":"看牌","put.bets.kill":"比牌","put.bets.nokill":"不比","put.bets.kill.short":"比","put.bets.showdown":"开牌","put.bets.showdown.short":"开","put.bets.allin":"押满","put.bets.allin.short":"满","continue":"继续",roundnums:"局数:","Go.Back.Confirmation":"这将退出当前游戏,您确认吗?"},e}();e.Locales=t,__reflect(t.prototype,"Zjh.Locales")}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(){function t(){}return t.getInstance=function(){return null==this.MockTest&&(this.MockTest=new t),this.MockTest},t.prototype.joinRoomResp=function(){var e='{"id":1,"type":1060,"status":true,"args":{"room":{"id":"827314","game":null,"name":null,"tier":"STD","bottomScore":0,"type":"TEXAS","status":"CREATED","owner":"1","capacity":3,"rounds":0},"users":[{"id":"1","name":"wesley","nickName":null,"sex":null,"avatar":null,"level":0,"cardNum":9,"score":2500,"room":"827314","seatNo":1},{"id":"2","name":"tom1001","nickName":null,"sex":null,"avatar":null,"level":0,"cardNum":10,"score":2500,"room":"827314","seatNo":2},{"id":"305921","name":"boby1001","nickName":null,"sex":null,"avatar":null,"level":0,"cardNum":10,"score":5000,"room":"827314","seatNo":3}]}}',t=EventRes.decode(e);Hall.HallScene.getInstance().onJoinRoomSuccess(t)},t.prototype.startGameRes=function(){var t='{"id":0,"type":2020,"status":true,"args":{"cmd":"Start.Game.Res","subGameIndex":1,"subGameNums":15,"startGameTimeout":5}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.dealPokersRes=function(){var t='{"id":0,"type":2020,"status":true,"args":{"cmd":"Deal.Pokers.Res"}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.lookPokersRes=function(){var t='{"id":0,"type":2020,"status":true,"args":{"cmd":"Look.Pokers.Res","pokers":[9,31,49],"pokerType":"DanZi"}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.othersLookPokersRes=function(){var t='{"id":0,"type":2020,"status":true,"args":{"cmd":"Others.Look.Pokers.Res","seatNo":2}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.hasDealerRes=function(){var t='{"id":0,"type":2020,"status":true,"args":{"cmd":"Has.Dealer.Res","buttonSeatNo":1,"shareScore":5,"putBetTimeout":60}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.putBetsRes=function(){var t='{"id":0,"type":2020,"status":true,"args":{"cmd":"Put.Bets.Res","currentSeatNo":3,"currentSeatScore":4985,"minRaiseAmount":5,"toCallAmount":5,"availOpsTypes":["FOLD","CALL","RAISE","LOOK","KILL"],"availSeats":[1,2,3],"pots":50,"lastChipsPutted":5,"lastSeatScore":4985,"lastSeatPutted":2,"lastSeatOps":"CALL"}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.killPokersRes=function(){var t='{"id":0,"type":2020,"status":true,"args":{"cmd":"Kill.Pokers.Res","seatNos":[2,1],"winnerSeatNo":1}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.showDownRes=function(){var t='{"id":0,"type":2020,"status":true,"args":{"cmd":"Show.Down.Res","userDatas":[{"userId":"1","seatNo":1,"win":false,"dealer":true,"ready":false,"score":4960,"bets":15,"awarded":0,"pokers":[6,27,35],"pokerType":"DanZi"},{"userId":"2","seatNo":2,"win":true,"dealer":false,"ready":false,"score":4905,"bets":25,"awarded":55,"pokers":[14,19,36],"pokerType":"DanZi"},{"userId":"3","seatNo":3,"win":false,"dealer":false,"ready":false,"score":4960,"bets":15,"awarded":0,"pokers":[7,24,32],"pokerType":"DanZi"}]}}\n			',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t.prototype.subGameEndRes=function(){var t='{"id":0,"type":2000,"status":true,"args":{"cmd":"Sub.Game.End.Res","reachGameRounds":false}}',n=EventRes.decode(t);e.GameLogic.getInstance().processCmd(n.getArgs())},t}();e.MockTest=t,__reflect(t.prototype,"Zjh.MockTest")}(Zjh||(Zjh={}));var Zjh;!function(e){var t;!function(e){e[e.CALL=0]="CALL",e[e.RAISE=1]="RAISE",e[e.ALLIN=2]="ALLIN",e[e.FOLD=3]="FOLD",e[e.LOOK=4]="LOOK",e[e.KILL=5]="KILL",e[e.SHOWDOWN=6]="SHOWDOWN",e[e.NONE=7]="NONE"}(t=e.OpsType||(e.OpsType={}))}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(){function e(){}return e.prototype.getIndex=function(){return this.index},e.prototype.getValue=function(){return this.suit},e.prototype.getSuit=function(){return this.suit},e.fromIndex=function(t){var n=new e,o=t;return n.suit=e.suits[o%4],n.value=e.numbers[o/4],n.index=t,n},e.fromIndexs=function(t){var n=new Array;return void 0==t||0==t.length?n:(t.forEach(function(t){var o=e.fromIndex(t);n.push(o)}),n)},e.toIndexs=function(e){var t=new Array;return void 0==e||0==e.length?t:(e.forEach(function(e){var n=e.getIndex();t.push(n)}),t)},e.prototype.toString=function(){return"["+this.value+","+this.suit+"]"},e.numbers=["A","K","Q","J","10","9","8","7","6","5","4","3","2"],e.suits=["SPADE","HEART","CLUB","DIAMOND"],e}();e.Poker=t,__reflect(t.prototype,"Zjh.Poker")}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(t){function n(e,n,o,i){var s=t.call(this)||this;s.poker=e,s.width=n,s.height=n*GlobalConstants.POKER_WvsH_RATIO,s.isFaceUp=i,s.selected=!1,s.baseX=s.x,s.baseY=s.y;var r=s.getImageID(),a=new egret.Bitmap(RES.getRes(r));return a.width=s.width,a.height=s.height,s.addChild(a),o&&(s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){s.selected=!s.selected,s.selected?(s.y=s.baseY-15,SoundManager.getInstance().playEffect("choose_card_mp3")):s.y=s.baseY,null!=s.call&&s.call()},s)),s}return __extends(n,t),n.prototype.getPoker=function(){return this.poker},n.prototype.setSelected=function(e){this.dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP))},n.prototype.addCall=function(e){this.call=e},n.prototype.getSelected=function(){return this.selected},n.prototype.getImageID=function(){var t=0;this.isFaceUp&&(t=e.Utils.pokerIds[this.poker.getIndex()]);var n="poker_"+t+"_png";return n},n.fromIndex=function(t){var o=e.Poker.fromIndex(t),i=new n(o,GlobalConstants.POKER_L_W,!1,!0);return i},n.fromIndexs=function(e){var t=new Array;return void 0==e||0==e.length?t:(e.forEach(function(e){var o=n.fromIndex(e);t.push(o)}),t)},n}(egret.Sprite);e.PokerSprite=t,__reflect(t.prototype,"Zjh.PokerSprite")}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.isMe=e,n.skinName="resource/game_skins/Zjh/ZjhSeatUI.exml",n}return __extends(n,t),n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},n.prototype.initUI=function(){this.user=null,this.labChips.text="",this.imgWinner.visible=!1,this.imgWinner.x=this.imgWinner.width/2,this.imgWinner.y=this.imgWinner.height/2,this.imgWinner.anchorOffsetX=this.imgWinner.width/2,this.imgWinner.anchorOffsetY=this.imgWinner.height/2,this.imgButtonSeat.visible=!1,this.imgButtonSeat.anchorOffsetX=this.imgButtonSeat.width/2,this.imgButtonSeat.anchorOffsetY=this.imgButtonSeat.height/2,this.imgUserReady.visible=!1,this.imgUserReady.anchorOffsetX=this.imgUserReady.width/2,this.imgUserReady.anchorOffsetY=this.imgUserReady.height/2,this.imgFold=null,this.imgPKLose=null,this.imgLooked=null,this.imgPokerType=null,this.setLabName(""),this.setLabChips(""),this.setLabLastAction(""),null!=this.grpPokers&&(this.grpPokers.visible=!0,this.grpPokers.removeChildren()),null!=this.grpChipsNum&&(this.grpChipsNum.visible=!0,this.grpChipsNum.removeChildren())},n.prototype.show=function(){this.grpParent.visible=!0,this.grpParent.removeChildren(),this.grpParent.addChild(this)},n.prototype.setGrpParent=function(e){e.removeChildren(),this.grpParent=e},n.prototype.getGrpParent=function(){return this.grpParent},n.prototype.setUser=function(e){this.user=e},n.prototype.getUser=function(){return this.user},n.prototype.setImgSizeAndPos=function(e,t){var n=0;this.isMe?(e.width=210,e.height=40,n=5):(e.width=120,e.height=36),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=.5*t.width+5+n,e.y=t.height-e.height/2},n.prototype.showImgAnimation=function(e){var t=egret.Tween.get(e);t.to({scaleX:2,scaleY:2},100,egret.Ease.sineOut).wait(20).to({scaleX:.9,scaleY:.9},100,egret.Ease.sineIn).to({scaleX:1.2,scaleY:1.2},100,egret.Ease.sineIn).to({scaleX:1,scaleY:1},100,egret.Ease.sineIn).call(function(){egret.Tween.removeTweens(t)})},n.prototype.getIsMe=function(){return this.isMe},n.prototype.setLabName=function(e){(void 0==e||null==e)&&(e=""),this.labName.text=GlobalUtils.getFixedLenOfString(e,6)},n.prototype.setImgAvatar=function(e){this.imgAvatar.source=e,this.imgAvatar.width=this.imgAvatar.height=70},n.prototype.setLabLastAction=function(e){this.labLastAction.size=20,this.labLastAction.bold=!0,this.labLastAction.textColor=16045678,this.labLastAction.stroke=1,this.labLastAction.strokeColor=11301130,this.labLastAction.textAlign=egret.HorizontalAlign.CENTER,this.labLastAction.verticalAlign=egret.VerticalAlign.MIDDLE,this.labLastAction.text=e},n.prototype.setLabChips=function(e){(void 0==e||null==e)&&(e="0"),this.labChips.text=String(e)},n.prototype.setImgWinner=function(e){var t=this;e?(this.imgWinner.visible=!0,this.tweenWin=egret.Tween.get(this.imgWinner,{loop:!0}),this.tweenWin.to({scaleX:1.1,scaleY:1.1},200,egret.Ease.quintOut).to({alpha:0},100).to({scaleX:1,scaleY:1},200).to({alpha:1},100).call(function(){setTimeout(function(){t.tweenWin&&(t.tweenWin.setPaused(!0),egret.Tween.removeTweens(t.tweenWin))},5e3)})):(this.imgWinner.visible=!1,this.tweenWin=null)},n.prototype.setImgButton=function(e){if(e){this.imgButtonSeat.visible=!0;var t=egret.Tween.get(this.imgButtonSeat);t.to({scaleX:1.5,scaleY:1.5},100,egret.Ease.quintOut).to({scaleX:1,scaleY:1},80).to({scaleX:1.1,scaleY:1.1},80).to({scaleX:1,scaleY:1},80).call(function(){t&&egret.Tween.removeTweens(t)})}else this.imgButtonSeat.visible=!1},n.prototype.setImgUserReady=function(e){e?this.imgUserReady.visible=!0:this.imgUserReady.visible=!1},n.prototype.setGrpPokers=function(e){this.grpPokers=e},n.prototype.getGrpPokers=function(){return this.grpPokers},n.prototype.setGrpChipsNum=function(e){this.grpChipsNum=e},n.prototype.getGrpChipsNum=function(){return this.grpChipsNum},n.prototype.setChipsNum=function(e){this.chipsNum=e,this.grpChipsNum&&this.grpChipsNum.addChild(this.chipsNum)},n.prototype.getChipsNum=function(){return this.chipsNum},n.prototype.setPokerType=function(t){null==t?this.imgPokerType=GlobalUtils.createBitmapByName(e.Utils.pokerTypesToImage.fold):this.imgPokerType=GlobalUtils.createBitmapByName(e.Utils.pokerTypesToImage[t]),this.setImgSizeAndPos(this.imgPokerType,this.grpPokers),this.grpPokers.addChild(this.imgPokerType),this.showImgAnimation(this.imgPokerType)},n.prototype.getImgProfileTimingBG=function(){return this.imgProfileTimingBG},n.prototype.setTimer=function(e){return this.timer=e},n.prototype.getTimer=function(){return this.timer},n.prototype.setCanKill=function(e,t){return e?(this.imgLooked&&this.setimgLooked(!1),this.btnKill=new TButton("zjh_click_kill_png",""),this.btnKill.setSize(130,64,24),this.btnKill.setClick(t),this.btnKill.width=this.grpPokers.width,this.btnKill.height=this.grpPokers.height,this.btnKill.anchorOffsetX=this.btnKill.width/2,this.btnKill.anchorOffsetY=this.btnKill.height/2,this.btnKill.x=this.btnKill.width/2,this.btnKill.y=this.btnKill.height/2,this.grpPokers.addChild(this.btnKill),this.tweenKill=egret.Tween.get(this.btnKill,{loop:!0}),void this.tweenKill.wait(100).to({scaleX:1.1,scaleY:1.1},200).to({scaleX:1,scaleY:1},200).to({scaleX:1.1,scaleY:1.1},200).to({scaleX:1,scaleY:1},200)):(this.btnKill&&(this.tweenKill&&(this.tweenKill.setPaused(!0),this.tweenKill=null),this.grpPokers.contains(this.btnKill)&&this.grpPokers.removeChild(this.btnKill)),void(this.imgLooked&&this.setimgLooked(!0)))},n.prototype.setCanLook=function(e,t){return e?(this.btnLook=new TButton("zjh_click_look_png",""),this.btnLook.setSize(204,40,24),this.btnLook.setClick(t),this.btnLook.width=this.grpPokers.width,this.btnLook.height=this.grpPokers.height/2-5,this.btnLook.x=(this.grpPokers.width-this.btnLook.width)/2,this.btnLook.y=this.grpPokers.height-this.btnLook.height,void this.grpPokers.addChild(this.btnLook)):void(this.btnLook&&(this.grpPokers.contains(this.btnLook)&&this.grpPokers.removeChild(this.btnLook),this.btnLook=null))},n.prototype.setimgLooked=function(e){if(null==this.imgPKLose&&null==this.imgFold){if(!e)return void(this.imgLooked&&(this.grpPokers&&this.grpPokers.contains(this.imgLooked)&&this.grpPokers.removeChild(this.imgLooked),this.imgLooked=null));this.imgLooked=GlobalUtils.createBitmapByName("zjh_looked_png"),this.setImgSizeAndPos(this.imgLooked,this.grpPokers),this.grpPokers.addChild(this.imgLooked),this.showImgAnimation(this.imgLooked)}},n.prototype.isLooked=function(){return this.imgLooked?!0:!1},n.prototype.setImgPKLose=function(e){return e?(this.imgPokerType&&this.grpPokers.contains(this.imgPokerType)&&this.grpPokers.removeChild(this.imgPokerType),this.setimgLooked(!1),this.imgPKLose=GlobalUtils.createBitmapByName("zjh_kill_lose_png"),this.setImgSizeAndPos(this.imgPKLose,this.grpPokers),this.grpPokers.addChild(this.imgPKLose),void this.showImgAnimation(this.imgPKLose)):void(this.imgPKLose=null)},n.prototype.setImgFold=function(){this.imgPokerType&&this.grpPokers.contains(this.imgPokerType)&&this.grpPokers.removeChild(this.imgPokerType),this.grpPokers&&this.grpPokers.contains(this.imgLooked)&&this.grpPokers.removeChild(this.imgLooked),this.imgFold=GlobalUtils.createBitmapByName("zjh_fold_png"),this.setImgSizeAndPos(this.imgFold,this.grpPokers),this.grpPokers.addChild(this.imgFold),this.showImgAnimation(this.imgFold)},n}(eui.Component);e.SeatUI=t,__reflect(t.prototype,"Zjh.SeatUI",["eui.UIComponent","egret.DisplayObject"])}(Zjh||(Zjh={}));var Zjh;!function(e){var t;!function(e){e[e.NONE=0]="NONE",e[e.WAITTING=1]="WAITTING",e[e.START=2]="START",e[e.HASDEALER=3]="HASDEALER",e[e.DEALPOKERS=4]="DEALPOKERS",e[e.PUTBETS=5]="PUTBETS",e[e.SHOWDOWN=6]="SHOWDOWN",e[e.SUBGAMEEND=7]="SUBGAMEEND"}(t=e.State||(e.State={}))}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return n.sceneName="Zjh.TableScene",n.index=0,n.skinName="ZjhTableSkin",n.addExtraAttributeToTable(),n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){StageProxy.init(n.stage,n),SoundManager.getInstance().playMusic("bg_zjh_mp3"),EventManager.getInstance().dispatchEvent(e.Constants.EVENT_ZJH_RELOAD_DATA),n.shuffle=new Shuffle(n.grpDeck,n.dealPokersResCB.bind(n)),n.btnReady.setClick(function(e){n.beReady(e)}),n.btnInvite.setClick(function(e){n.inviteOthers(e)}),n.btnGoMatching.setClick(function(){n.coinModeRoomReq()}),n.btnEnableHost.setClick(function(){n.enableHostReq()}),n.btnDisableHost.setClick(function(){n.disableHostReq()}),EventManager.getInstance().addEvent(GlobalConstants.EVENT_SYSTEM_MESSAGE,n.showSystemMessage.bind(n),null),EventManager.getInstance().addEvent(GlobalConstants.EVENT_DISABLE_HOST,n.showGrpPutBetsControls.bind(n),null)},n),n}return __extends(n,t),n.getInstance=function(){return null==this.ZjhTableScene&&(this.ZjhTableScene=new n),this.ZjhTableScene
},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initBtnFunc()},n.prototype.initBtnFunc=function(){var e=this;this.btnGoBack.setClick(function(){e.showGoBackConfirmationWin()}),this.btnSetting.setClick(function(){e.showSettingScene()}),this.btnScores.setClick(function(){e.showGameScores()})},n.prototype.showGrpPutBetsControls=function(){this.isMyTurn()&&(this.grpPutBetsControls.visible=!0)},n.prototype.showSystemMessage=function(e){var t=new ScrollingMessages(this.grpSystemMessage),n={};n.msg=e.content,n.loopNum=3;var o=new ScrollingMessage(n,0);t.pushpaoMaDengMsg(o),t.start()},n.prototype.showStartMatchingCountDownTimer=function(){var e=GlobalLocales.get()["start.Matching.Player"];this.startMatchingUserCountDownTimer=new CountDownTimer(e),this.grpTimer.addChild(this.startMatchingUserCountDownTimer),this.startMatchingUserCountDownTimer.timeStart(30)},n.prototype.coinModeRoomReq=function(){console.log("开始匹配");var e=EventType.COINMODE_ROOM_JOIN,t=new CoinModeRoomJoinReq;t.coinModeId=GlobalVars.getInstance().coinModeId,t.step=2;var n=new EventReq(e,t);Network.getInstance().request(n,this.onCoinModeRoomJoinSuccess.bind(this),this.onCoinModeRoomJoinError.bind(this))},n.prototype.onCoinModeRoomJoinSuccess=function(e){console.log("onCoinModeRoomJoinSuccess:"+e.getContent()),this.grpReadyAndInvite.visible=!1,this.btnGoMatching.visible=!1,this.showStartMatchingCountDownTimer()},n.prototype.onCoinModeRoomJoinError=function(e){console.log("onCoinModeRoomJoinError:"+e.getContent()),TipsScene.getInstance().showError(e.getContent())},n.prototype.getRoomId=function(){var e=RoomService.getInstance().getRoom();return null!=e?e.id:null!=this.roomId?this.roomId:null},n.prototype.initialize=function(){this.labEntityId.text=String(this.getRoomId()),this.labRoundNums.text="",this.setAllGrpsToInVisible(),this.initSeatLayoutMap(),this.initSeatMap(),this.fillUserOfSeatUI(),this.grpChips.removeChildren(),this.clearSampleImgAndData()},n.prototype.setAllGrpsToInVisible=function(){this.grpReadyAndInvite.visible=!1,this.grpPutBetsControls.visible=!1,this.grpDeck.visible=!1,this.grpHost.visible=!1},n.prototype.showSettingScene=function(){SceneManager.getInstance().pushScene(Setting.SettingScene.getInstance(this.sceneName))},n.prototype.showGoBackConfirmationWin=function(){var t=this,n=e.Locales.get()["Go.Back.Confirmation"];TipsScene.getInstance().confirm(n,function(){t.close()})},n.prototype.close=function(){this.roomLeaveReq(),SoundManager.getInstance().stopMusic(),SceneManager.getInstance().popScene(this)},n.prototype.roomLeaveReq=function(){var e=EventType.ROOM_LEAVE,t=new RoomLeaveReq,n=new EventReq(e,t);Network.getInstance().send(n)},n.prototype.setRoom=function(e){this.roomId=e},n.prototype.clearSampleImgAndData=function(){},n.prototype.addExtraAttributeToTable=function(){},n.prototype.initSeatLayoutMap=function(){this.seatLayoutMap={3:[1,3,8],4:[1,3,5,8],5:[1,3,5,6,8],6:[1,2,3,5,6,8],7:[1,2,3,5,6,8,9],8:[1,2,3,4,5,6,7,8],9:[1,2,3,4,5,6,7,8,9]}},n.prototype.initSeatMap=function(){this.seatMap=new Dictionary;for(var t=RoomService.getInstance().getRoom().table.getSeatsNum(),n=this.seatLayoutMap[String(t)],o=1;t>=o;++o){var i=null;i=1==o?new e.SeatUI(!0):new e.SeatUI(!1),i.setGrpParent(this["grpProfile_Seat"+n[o-1]]),i.setGrpPokers(this["grpPokers_Seat"+n[o-1]]),i.setGrpChipsNum(this["grpChipsNum_Seat"+n[o-1]]),i.initUI();var s=new CTimer(i.getImgProfileTimingBG(),!1,-1);i.setTimer(s),this.seatMap.Add("Seat"+o,i)}},n.prototype.setUsersReady=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers();t.forEach(function(t){if(t.beReady){var n=e.getSeatUI(t.seatNo);n.setImgUserReady(!0)}})},n.prototype.beReadyRes=function(e){var t=e.userId,n=RoomService.getInstance().getRoom().table.getSeatNoByUserId(t);if(null!=n){var o=this.getSeatUI(n);o.setImgUserReady(!0),SoundManager.getInstance().playEffect("user_ready_mp3")}},n.prototype.fillUserOfSeatUI=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers();t.forEach(function(t){var n=e.getSeatUI(t.seatNo);null!=n&&(n.setUser(t),n.setImgUserReady(t.beReady))})},n.prototype.getSeatUI=function(e){var t=this.getMySeatNo();this.seatMap;if(e==t)return this.seatMap.Item("Seat1");for(var n=RoomService.getInstance().getRoom().capacity,o=2;n>=o;++o)if(e==RoomService.getInstance().getRoom().table.peekSeatNoRecursively(t,o-1))return this.seatMap.Item("Seat"+o)},n.prototype.getMySeaUI=function(){var e=this.getMySeatNo();return this.getSeatUI(e)},n.prototype.setOthersSeatUI=function(e){var t=this.getSeatUI(e.seatNo);t.show(),t.setUser(e),t.setLabName(e.name),t.setLabChips(String(e.score)),t.setImgAvatar(e.avatar),t.setImgUserReady(e.beReady)},n.prototype.roomLeaveOthers=function(e){console.log("其他用户离开:"+e);var t=RoomService.getInstance().getRoom().table.getUserByUserId(String(e.userId));if(null!=t){var n=this.getSeatUI(t.seatNo);n.setUser(null),SoundManager.getInstance().playEffect("other_leave_mp3")}},n.prototype.roomJoinOthers=function(e){console.log("其他用户加入:"+e),this.setOthersSeatUI(e.user),SoundManager.getInstance().playEffect("other_join_mp3")},n.prototype.clearOthersTimer=function(e){if(this.clearGrpTimer(),null!=this.seatMap)for(var t=0;t<this.seatMap.Count();t++)if(t!=e){var n=this.seatMap.Values()[t],o=n.getTimer();null!=o&&o.timerStop()}},n.prototype.showTimer=function(){var t=this,n=e.ExtraAttribute.get().currentSeatNo,o=e.ExtraAttribute.get().putBetsTimeout;this.clearAllTimer(),-1!=n&&setTimeout(function(){var e=t.getSeatUI(n);e.addChild(e.getTimer().getContainer()),e.getTimer().timerStart(o)},1e3)},n.prototype.clearAllTimer=function(){if(this.clearGrpTimer(),null!=this.seatMap)for(var e=0;e<this.seatMap.Count();e++){var t=this.seatMap.Values()[e],n=t.getTimer();null!=n&&n.timerStop()}},n.prototype.updateUserScoreAndUI=function(e){var t=this;e.forEach(function(e){var n=RoomService.getInstance().getRoom().table.getUserBySeatNo(e.seatNo);if(n.score=e.score,t.getMySeatNo()!=e.seatNo){var o=t.getSeatUI(e.seatNo);o.setLabChips(String(e.score))}})},n.prototype.setMySeatUI=function(){var e=this.getMySeatNo(),t=this.getSeatUI(e);t.show(),t.setLabName(t.getUser().name),t.setLabChips(String(t.getUser().score)),t.setImgAvatar(t.getUser().avatar)},n.prototype.initOthersSeatUI=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers(),n=UserService.getInstance().getUser();null!=n&&t.forEach(function(t){n.id!=t.id&&e.setOthersSeatUI(t)})},n.prototype.clearAllSeatUIs=function(){var e=this;this.seatMap.Keys().forEach(function(t){var n=e.seatMap.Item(t);n.setLabLastAction(""),n.getGrpPokers().removeChildren(),n.getGrpChipsNum().removeChildren(),n.setImgWinner(!1),n.setImgButton(!1),n.setimgLooked(!1),n.setImgPKLose(!1)})},n.prototype.clearTheTableScene=function(){this.grpReadyAndInvite.removeChildren(),this.clearAllSeatUIs(),this.index=0,this.labRoundNums.text="",this.labPotNums.text="",this.labBottomScore.text="",this.grpChips.removeChildren(),null!=this.startMatchingUserCountDownTimer&&this.startMatchingUserCountDownTimer.stop(),this.grpTimer.contains(this.startMatchingUserCountDownTimer)&&this.grpTimer.removeChild(this.startMatchingUserCountDownTimer)},n.prototype.tableIsFull=function(){this.btnInvite.visible=!1},n.prototype.getMySeatNo=function(){return RoomService.getInstance().getRoom().table.getMySeatNo()},n.prototype.initTheTable=function(){this.initialize(),this.setMySeatUI(),this.initOthersSeatUI()},n.prototype.initGrpReadyAndInvite=function(e){this.grpReadyAndInvite.removeChildren(),this.grpReadyAndInvite.visible=!0,e?(this.btnReady.visible=!0,this.grpReadyAndInvite.addChild(this.btnReady),this.btnInvite.visible=!0,this.grpReadyAndInvite.addChild(this.btnInvite)):(this.btnGoMatching.visible=!0,this.grpReadyAndInvite.addChild(this.btnGoMatching)),GlobalUtils.setHorizontalLayout(this.grpReadyAndInvite,150,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.enableHostReq=function(){var e=EventType.ENABLE_HOST,t=new EnableHostReq;t.userId=UserService.getInstance().getUser().id;var n=new EventReq(e,t);Network.getInstance().request(n,this.onEnableHostSuccess.bind(this),this.onEnableHostError.bind(this))},n.prototype.onEnableHostSuccess=function(e){console.log("onEnableHostSuccess:"+JSON.stringify(e.args)),this.grpHost.visible=!0,UserService.getInstance().getUser().beHosted=!0},n.prototype.onEnableHostError=function(e){console.log("onEnableHostError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.disableHostReq=function(){var e=EventType.DISABLE_HOST,t=new DisableHostReq;t.userId=UserService.getInstance().getUser().id;var n=new EventReq(e,t);Network.getInstance().request(n,this.onDisableHostSuccess.bind(this),this.onDisableHostError.bind(this))},n.prototype.onDisableHostSuccess=function(e){console.log("onEnableHostSuccess:"+JSON.stringify(e.args)),this.grpHost.visible=!1,UserService.getInstance().getUser().beHosted=!1},n.prototype.onDisableHostError=function(e){console.log("onDisableHostError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.showGameScores=function(){var e=GameResult.FinalGameRslScene.getInstance();e.setRoom(String(this.roomId)),SceneManager.getInstance().pushScene(e)},n.prototype.beReady=function(e){console.log("点击准备按钮"),this.initTheTable();var t=EventType.BE_READY,n=new BeReadyReq;n.roomId=this.roomId;var o=new EventReq(t,n);Network.getInstance().request(o,this.onReadySuccess.bind(this),this.onReadyError.bind(this))},n.prototype.onReadySuccess=function(e){console.log("onReadySuccess:"+JSON.stringify(e.args)),this.btnReady.visible=!1,this.btnInvite.visible=!1,this.setMyReadyStatus(!0)},n.prototype.setMyReadyStatus=function(e){var t=this.getMySeatNo(),n=this.getSeatUI(t);n.setImgUserReady(e)},n.prototype.onReadyError=function(e){console.log("onReadyError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.inviteOthersBK=function(e){console.log("点击邀请按钮"),this.btnInvite.visible=!1;var t="286194";Hall.HallScene.getInstance().joinRoomReq(t)},n.prototype.inviteOthers=function(e){var t=InviteScene.getInstance();t.setEntityId(String(this.roomId)),SceneManager.getInstance().pushScene(t)},n.prototype.clearImgBeReadyOfAllSeatUIs=function(){var e=this;this.seatMap.Keys().forEach(function(t){var n=e.seatMap.Item(t);n.setImgUserReady(!1)})},n.prototype.startGameRes=function(e){this.clearTheTableScene(),this.clearImgBeReadyOfAllSeatUIs(),this.setLabRoundNums(),this.showStartGameCountDownTimer(e),SoundManager.getInstance().playEffect("game_start_wav")},n.prototype.setLabRoundNums=function(){var t=String(e.ExtraAttribute.get().subGameIndex),n=String(e.ExtraAttribute.get().subGameNums),o=e.Locales.get().roundnums+t+"/"+n;this.labRoundNums.text=o},n.prototype.dealPokersRes=function(){this.shuffle.launch()},n.prototype.dealPokersResCB=function(){this.grpDeck.visible=!0,this.index=0;var t=e.Constants.POCKET_POKERS_NUM;this.dealPokersTimer=new egret.Timer(200,t),this.dealPokersTimer.addEventListener(egret.TimerEvent.TIMER,this.dealPokerInOneRoundAnimation,this),this.dealPokersTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.dealPokersEndReq,this),this.dealPokersTimer.start()},n.prototype.generatePokerSpriteInDeck=function(){this.grpDeck.visible=!1;for(var t=RoomService.getInstance().getRoom().capacity,n=0;2*t>n;n++){var o=e.Poker.fromIndex(0),i=new e.PokerSprite(o,GlobalConstants.POKER_M_W,!1,!1);i.anchorOffsetX=this.grpDeck.width/2,i.anchorOffsetY=this.grpDeck.height/2,i.x=this.grpDeck.width/2+2*n,i.y=this.grpDeck.height/2,this.grpDeck.addChild(i)}},n.prototype.dealPokerInOneRoundAnimation=function(){var e=this,t=RoomService.getInstance().getRoom().table.getAllUsers();t.forEach(function(t){var n=e.getSeatUI(t.seatNo);e.dealPokerToSeatAnimation(n,e.index)}),this.index++},n.prototype.dealPokerToSeatAnimation=function(t,n){var o=e.Poker.fromIndex(0),i=new e.PokerSprite(o,GlobalConstants.POKER_M_W,!1,!1);this.grpDeck.visible=!0,i.x=i.y=0,this.grpDeck.addChild(i),SoundManager.getInstance().playEffect("send_card_wav");var s=t.getGrpPokers(),r=this.grpDeck.globalToLocal(s.x+s.width/2,s.y+s.height/2),a=egret.Tween.get(i);a.to({x:r.x,y:r.y},300).call(function(){if(this.grpDeck&&this.grpDeck.contains(i)&&this.grpDeck.removeChild(i),egret.Tween.removeTweens(a),t.getIsMe()){var n=new e.PokerSprite(o,GlobalConstants.POKER_L_W,!1,!1);n.x=n.y=0,s.addChild(n)}else{var n=new e.PokerSprite(o,GlobalConstants.POKER_S_W,!1,!1);n.x=n.y=0,s.addChild(n)}var r=3;t.getIsMe()||(r=-10),GlobalUtils.setHorizontalLayout(s,r,GlobalUtils.ALIGNMENT_CENTER)},this)},n.prototype.dealPokersEndReq=function(){console.log("发牌完成"),this.dealPokersTimer&&(this.dealPokersTimer.stop(),this.dealPokersTimer=null),this.grpDeck.visible=!1;var t=EventType.GAME_ZJH,n=new e.DealPokersEndReq;n.cmd=e.CommandType.DEAL_POKERS_END_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},n.prototype.amIDealer=function(){var t=this.getMySeatNo();return-1!=t&&t==e.ExtraAttribute.get().buttonSeatNo?!0:!1},n.prototype.showStartGameCountDownTimer=function(t){this.clearAllTimer();var n=new CountDownTimer(e.Locales.get()["start.game.countdown"]);this.grpTimer.addChild(n),n.timeStart(t.startGameTimeout)},n.prototype.hasDealerRes=function(e){this.clearAllTimer(),this.updateThePotstUI(0),this.showTheDealerBtn(e),this.showBlindBetAnimation(e)},n.prototype.showTheDealerBtn=function(e){var t=this.getSeatUI(e.buttonSeatNo);t.setImgButton(!0)},n.prototype.showBlindBetAnimation=function(t){var n=this;this.seatMap.Keys().forEach(function(o){var i=n.seatMap.Item(o);i.setLabLastAction(e.Locales.get()["put.bets"]);var s=new ChipsNum(t.shareScore);i.getGrpChipsNum().removeChildren(),i.setChipsNum(s),n.showUserRoundBetsAnimation(i,t.shareScore)})},n.prototype.showUserRoundBetsAnimation=function(e,t){if(0!=t){var n=new BetCoin(t);n.fly(e.getGrpParent(),this.grpChips,null)}},n.prototype.chipsMoveAnimation=function(e,t,n){n.x=(e.width-n.width)/2,n.y=0,e.addChild(n);var o=e.globalToLocal(t.x,t.y);egret.Tween.get(n).to({x:o.x,y:o.y},1e3,egret.Ease.backInOut).call(function(){e.removeChild(n),egret.Tween.removeTweens(n)},this)},n.prototype.clearGrpTimer=function(){this.grpTimer.removeChildren()},n.prototype.lookPokersRes=function(t){var n=e.ExtraAttribute.get().pokers,o=this.getMySeaUI(),i=0;SoundManager.getInstance().playEffect(e.Utils.opsTypeToSound[e.OpsType.LOOK]),n.forEach(function(e){var t=o.getGrpPokers().getChildAt(i);e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,o.getGrpPokers().addChild(e),t.scaleX=1,e.scaleX=0,egret.Tween.get(t).to({scaleX:0},100,egret.Ease.backIn).call(function(){SoundManager.getInstance().playEffect("open_card_wav"),egret.Tween.get(e).to({scaleX:1},100,egret.Ease.backOut),o.getGrpPokers().contains(t)&&o.getGrpPokers().removeChild(t)}),i++}),o.setPokerType(e.ExtraAttribute.get().pokerType.toString())},n.prototype.disablePutBetsControlsAfterSendLookReq=function(){var e=this.getMySeaUI();e.setCanLook(!1,null),this.grpPutBetsControls.visible=!1},n.prototype.enablePutBetsControlsAfterLookSuccessed=function(){var e=this.getMySeaUI();e.setCanLook(!1,null),this.grpPutBetsControls.visible=!0},n.prototype.enablePutBetsControlsAfterLookFailed=function(){this.grpPutBetsControls.visible=!0},n.prototype.lookPokersReq=function(){this.disablePutBetsControlsAfterSendLookReq();var t=EventType.GAME_ZJH,n=new e.LookPokersReq;n.cmd=e.CommandType.LOOK_POKERS_REQ;var o=new EventReq(t,n);Network.getInstance().request(o,this.onLookPokersSuccess.bind(this),this.onLookPokersError.bind(this))},n.prototype.onLookPokersSuccess=function(t){console.log("onLookPokersSuccess:"+JSON.stringify(t.args)),this.enablePutBetsControlsAfterLookSuccessed(),this.clearAllTimer();var n=this.getMySeaUI();n.setLabLastAction(e.Locales.get()["put.bets.look"])},n.prototype.onLookPokersError=function(e){console.log("onLookPokersError:"+JSON.stringify(e.args)),this.enablePutBetsControlsAfterLookFailed(),TipsScene.getInstance().showError(e.getContent())},n.prototype.othersLookPokersrRes=function(e){if(this.getMySeatNo()!=e.seatNo){var t=this.getSeatUI(e.seatNo);t.setimgLooked(!0)}},n.prototype.getAvailBetControlBtns=function(t){var n=this;this.grpPutBetsControls.removeChildren(),this.grpPutBetsControls.visible=!0;var o=t.availOpsTypes,i=Math.min(t.currentSeatScore,e.ExtraAttribute.get().cappedScroe),s=e.ExtraAttribute.get().currentSeatTotalBets?e.ExtraAttribute.get().currentSeatTotalBets:0;if(o.indexOf(e.OpsType[e.OpsType.FOLD])>-1){var r=new TButton("btn_fold_png",e.Locales.get()["put.bets.fold"]);r.setSize(120,65,20),r.setClick(function(){n.putBetsReq(e.OpsType.FOLD,0)}),this.grpPutBetsControls.addChild(r)}if(o.indexOf(e.OpsType[e.OpsType.LOOK])>-1){var a=this.getMySeaUI();a.setCanLook(!0,this.lookPokersReq.bind(this))}else{var a=this.getMySeaUI();a.setCanLook(!1,null)}if(o.indexOf(e.OpsType[e.OpsType.KILL])>-1){var l=new TButton("btn_call_png",e.Locales.get()["put.bets.kill.short"]);l.setSize(130,65,20),this.enableKillBtnTitle(l,t),this.grpPutBetsControls.addChild(l)}if(o.indexOf(e.OpsType[e.OpsType.CALL])>-1){var c=new TButton("btn_call_png",e.Locales.get()["put.bets.call.short"]);c.setSize(130,65,20),c.setTitle(e.Locales.get()["put.bets.call.short"]+GlobalUtils.shortNumber(t.toCallAmount)),c.setClick(function(){n.putBetsReq(e.OpsType.CALL,t.toCallAmount)}),this.grpPutBetsControls.addChild(c)}if(o.indexOf(e.OpsType[e.OpsType.RAISE])>-1){var h=t.toCallAmount+2*t.minRaiseAmount+s;if(i>=h){var u=new TButton("btn_raise_png",e.Locales.get()["put.bets.raise.2x"]);u.setSize(130,65,20),u.setTitle(e.Locales.get()["put.bets.raise.2x"]+GlobalUtils.shortNumber(2*t.minRaiseAmount)),u.setClick(function(){n.putBetsReq(e.OpsType.RAISE,2*t.minRaiseAmount)}),this.grpPutBetsControls.addChild(u)}if(h=t.toCallAmount+4*t.minRaiseAmount+s,i>=h){var p=new TButton("btn_raise_png",e.Locales.get()["put.bets.raise.4x"]);p.setSize(130,65,20),p.setTitle(e.Locales.get()["put.bets.raise.4x"]+GlobalUtils.shortNumber(4*t.minRaiseAmount)),p.setClick(function(){n.putBetsReq(e.OpsType.RAISE,4*t.minRaiseAmount)}),this.grpPutBetsControls.addChild(p)}}if(o.indexOf(e.OpsType[e.OpsType.ALLIN])>-1){var g=new TButton("btn_raise_png",e.Locales.get()["put.bets.allin.short"]);g.setSize(130,65,20);var d=e.ExtraAttribute.get().cappedScroe-s,m=Math.min(t.currentSeatScore,d);g.setTitle(e.Locales.get()["put.bets.allin.short"]+GlobalUtils.shortNumber(m)),g.setClick(function(){n.putBetsReq(e.OpsType.ALLIN,m)}),this.grpPutBetsControls.addChild(g)}if(o.indexOf(e.OpsType[e.OpsType.SHOWDOWN])>-1){var f=new TButton("btn_call_png",e.Locales.get()["put.bets.showdown.short"]);f.setSize(130,65,20),f.setTitle(e.Locales.get()["put.bets.showdown.short"]+GlobalUtils.shortNumber(2*t.toCallAmount)),f.setClick(function(){n.showDownReq()}),this.grpPutBetsControls.addChild(f)}GlobalUtils.setHorizontalLayout(this.grpPutBetsControls,10,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.enableCanKillOfAvailSeats=function(t,n){var o=this,i=e.ExtraAttribute.get().availSeats;null!=i&&0!=i.length&&(i.forEach(function(e){var t=o.getMySeatNo();if(e!=t){var n=o.getSeatUI(e);n.setCanKill(!0,function(){o.killPokersReq(e)})}}),this.enableNoKillBtnTitle(t,n))},n.prototype.enableKillBtnTitle=function(t,n){var o=this;t.setTitle(e.Locales.get()["put.bets.kill.short"]+GlobalUtils.shortNumber(2*n.toCallAmount)),1==n.availSeats.length?t.setClick(function(){o.killPokersReq(n.availSeats[0])}):t.setClick(function(){o.enableCanKillOfAvailSeats(t,n)})},n.prototype.enableNoKillBtnTitle=function(t,n){var o=this;t.setTitle(e.Locales.get()["put.bets.nokill"]),t.setClick(function(){o.disableCanKillOfAvailSeats(t,n)})},n.prototype.disableCanKillOfAvailSeats=function(t,n){var o=this,i=e.ExtraAttribute.get().availSeats;null!=i&&0!=i.length&&(i.forEach(function(e){var t=o.getSeatUI(e);t.setCanKill(!1,null)}),t&&this.enableKillBtnTitle(t,n))},n.prototype.isMyTurn=function(){var t=this.getMySeatNo();return-1!=t&&t==e.ExtraAttribute.get().currentSeatNo?!0:!1},n.prototype.isMeHosted=function(){var e=UserService.getInstance().getUser();return e.beHosted},n.prototype.showGrpHost=function(){this.isMeHosted()?this.grpHost.visible=!0:this.grpHost.visible=!1},n.prototype.putBetsRes=function(e){return this.showGrpHost(),this.showTimer(),null!=e&&this.updateThePotstUI(e.pots),this.showLastSeatAction(e),this.isMyTurn()?(this.isMeHosted()||this.getAvailBetControlBtns(e),void SoundManager.getInstance().playEffect("my_turn_mp3")):(this.disableCanKillofAllSeats(),void this.disablePutBetsControls())},n.prototype.disablePutBetsControls=function(){var e=this.getMySeaUI();e.setCanLook(!1,null),this.grpPutBetsControls.removeChildren(),this.grpPutBetsControls.visible=!1},n.prototype.updateThePotstUI=function(t){this.labBottomScore.text=e.ExtraAttribute.get().shareScore.toString(),this.labPotNums.text=t.toString()},n.prototype.showLastSeatAction=function(e){this.updateLastActionOfSeatUI(e)},n.prototype.putBetsReq=function(t,n){var o=EventType.GAME_ZJH,i=new e.PutBetsReq;i.cmd=e.CommandType.PUT_BETS_REQ,i.opsType=e.OpsType[t],i.chips=n,Network.getInstance().request(new EventReq(o,i),this.onPutBetsSuccess.bind(this),this.onPutBetsError.bind(this))},n.prototype.onPutBetsSuccess=function(e){console.log("onPutBetsSuccess:"+JSON.stringify(e.args)),this.grpPutBetsControls.visible=!1,this.clearAllTimer();this.getMySeaUI()},n.prototype.onPutBetsError=function(e){console.log("onPutBetsError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.showDownReq=function(){var t=EventType.GAME_ZJH,n=new e.ShowDownReq;n.cmd=e.CommandType.SHOW_DOWN_REQ,Network.getInstance().request(new EventReq(t,n),this.onShowDownSuccess.bind(this),this.onShowDownError.bind(this))},n.prototype.onShowDownSuccess=function(e){console.log("onShowDownSuccess:"+JSON.stringify(e.args)),this.grpPutBetsControls.visible=!1,this.clearAllTimer();this.getMySeaUI()},n.prototype.onShowDownError=function(e){console.log("onShowDownError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.updateLastActionOfSeatUI=function(t){var n=t.lastSeatPutted,o=t.lastSeatOps,i=this.getSeatUI(n);i.setLabLastAction(e.Utils.opsTypeToCN[o]),i.setLabChips(String(t.lastSeatScore)),e.OpsType[e.OpsType.FOLD]==o&&(i.setImgFold(),SoundManager.getInstance().playEffect("fold_bg_mp3")),e.OpsType[e.OpsType.ALLIN]==o&&SoundManager.getInstance().playEffect("allin_bg_wav");var s=i.getChipsNum();null!=s&&s.getLabChipNums()!=t.lastSeatTotalBets.toString()&&(s.setLabChipNums(t.lastSeatTotalBets),this.showUserRoundBetsAnimation(i,t.lastChipsPutted),SoundManager.getInstance().playEffect(e.Utils.opsTypeToSound[o]))},n.prototype.killPokersRes=function(t){var n=this;SoundManager.getInstance().playEffect(e.Utils.opsTypeToSound[e.OpsType.KILL]),this.clearAllTimer(),this.grpPutBetsControls.visible=!1;var o=e.CardsPK.getInstance();if(o.setParentCont(this),null!=t.seatNos&&2==t.seatNos.length){var i=null,s=null,r=this.getMySeatNo();if(t.seatNos.indexOf(r)>-1){var a=t.seatNos.indexOf(r),l=this.getMySeaUI();i=e.CardsPKSeatUI.formSeatUI(l);var c=this.getSeatUI(t.seatNos[1-a]);s=e.CardsPKSeatUI.formSeatUI(c),t.winnerSeatNo==r?i.setWin(!0):s.setWin(!0)}else{var h=this.getSeatUI(t.seatNos[0]);i=e.CardsPKSeatUI.formSeatUI(h);var c=this.getSeatUI(t.seatNos[1]);s=e.CardsPKSeatUI.formSeatUI(c),t.winnerSeatNo==t.seatNos[0]?i.setWin(!0):s.setWin(!0)}o.setUsers(i,s),o.onComplete(function(){n.setPKLose(t)}),o.start()}},n.prototype.setPKLose=function(e){var t=this;e.seatNos.forEach(function(n){var o=t.getSeatUI(n);n!=e.winnerSeatNo&&o.setImgPKLose(!0)})},n.prototype.killPokersReq=function(t){var n=EventType.GAME_ZJH,o=new e.KillPokersReq;o.cmd=e.CommandType.KILL_POKERS_REQ,o.tgtSeatNo=t,Network.getInstance().request(new EventReq(n,o),this.onKillPokersSuccess.bind(this),this.onKillPokersError.bind(this))},n.prototype.onKillPokersSuccess=function(t){console.log("onKillPokersSuccess:"+JSON.stringify(t.args)),this.disableCanKillofAllSeats(),this.clearAllTimer();var n=this.getMySeaUI();n.setLabLastAction(e.Locales.get()["put.bets.kill"])},n.prototype.disableCanKillofAllSeats=function(){var e=this;this.seatMap.Keys().forEach(function(t){var n=e.seatMap.Item(t);n.setCanKill(!1,null)})},n.prototype.onKillPokersError=function(e){console.log("onKillPokersError:"+JSON.stringify(e.args)),TipsScene.getInstance().showError(e.getContent())},n.prototype.reloadDataReq=function(){console.log("请求数据重载.");var t=EventType.GAME_ZJH,n=new e.ReloadDataReq;n.cmd=e.CommandType.RELOAD_DATA_REQ;var o=new EventReq(t,n);Network.getInstance().send(o)},n.prototype.reloadDataRes=function(t){var n=this;if(this.grpPutBetsControls.visible=!1,e.State[e.State.NONE]!=t.state&&e.State[e.State.WAITTING]!=t.state){if(this.grpReadyAndInvite.visible=!1,this.setLabRoundNums(),e.State[e.State.START]==t.state){var o=new CountDownTimer(e.Locales.get()["start.game.countdown"]);return this.grpTimer.addChild(o),void o.timeStart(t.startGameTimeout)}this.clearImgBeReadyOfAllSeatUIs(),this.isMeHosted&&(this.grpHost.visible=!0),this.labBottomScore.text=String(t.shareScore);var i=this.getSeatUI(t.buttonSeatNo);if(i.setImgButton(!0),this.seatMap.Keys().forEach(function(e){var o=n.seatMap.Item(e),i=new ChipsNum(t.shareScore);o.getGrpChipsNum().removeChildren(),o.setImgUserReady(!1),o.setChipsNum(i)}),e.State[e.State.HASDEALER]!=t.state&&(this.seatMap.Keys().forEach(function(e){var t=n.seatMap.Item(e);n.setTheeFaceDownPokers(t)}),e.State[e.State.DEALPOKERS]!=t.state)){this.labPotNums.text=String(t.pots),this.showTimer(),this.isMyTurn()&&(this.grpPutBetsControls.visible=!0);var s=e.ExtraAttribute.get().userDatas;null!=s&&(s.forEach(function(t){var o=n.getSeatUI(t.seatNo);if(null!=o){t.seatNo==n.getMySeatNo()?(e.ExtraAttribute.get().currentSeatTotalBets=t.bets,t.looked&&(o.getGrpPokers().removeChildren(),t.pokers.forEach(function(e){n.addOnePokerIntoSeatUI(o,e,!0)}),o.setPokerType(t.pokerType))):t.looked&&o.setimgLooked(!0);var i=new ChipsNum(t.bets);o.getGrpChipsNum().removeChildren(),o.setChipsNum(i),t.folded&&o.setImgFold(),t.lose&&o.setImgPKLose(!0)}}),e.State[e.State.PUTBETS]!=t.state&&(s.forEach(function(e){var t=n.getSeatUI(e.seatNo);null!=t&&(n.showUserPokers(t,e),t.setPokerType(e.pokerType),e.win&&t.setImgWinner(!0))}),e.State[e.State.SHOWDOWN]!=t.state&&this.subGameEndRes(t.reachGameRounds)))}}},n.prototype.showDownRes=function(){this.clearAllTimer(),SoundManager.getInstance().playEffect("showdown_1_wav"),this.grpPutBetsControls.visible=!1,this.grpChips.removeChildren(),setTimeout(this.setValueOfAllSeatUIs.bind(this),1e3)},n.prototype.clearlabPotNums=function(){this.labPotNums.text="0"},n.prototype.setValueOfAllSeatUIs=function(){var t=this,n=e.ExtraAttribute.get().userDatas;n.forEach(function(e){var n=t.getSeatUI(e.seatNo);null!=n&&(t.showUserPokers(n,e),n.setPokerType(e.pokerType),t.showChipsFlyAnimation(n,e))})},n.prototype.showChipsFlyAnimation=function(e,t){if(t.win){e.setImgWinner(!0);var n=new ChipsFly(10,this.grpChips,e.getGrpParent());n.onComplete(this.clearlabPotNums.bind(this)),n.fly();var o=new PopTips;o.launch(e.getGrpParent(),"+"+t.awarded.toString())}},n.prototype.setTheeFaceDownPokers=function(e){e.getGrpPokers().removeChildren();for(var t=0;3>t;t++)this.addOnePokerIntoSeatUI(e,0,!1)},n.prototype.addOnePokerIntoSeatUI=function(t,n,o){var i=0;i=t.getIsMe()?GlobalConstants.POKER_L_W:GlobalConstants.POKER_S_W;var s=new e.PokerSprite(e.Poker.fromIndex(n),i,!1,o);s.x=s.y=0,t.getGrpPokers().addChild(s);var r=3;t.getIsMe()||(r=-10),GlobalUtils.setHorizontalLayout(t.getGrpPokers(),r,GlobalUtils.ALIGNMENT_CENTER)},n.prototype.showUserPokers=function(e,t){var n=this;return e.getGrpPokers().removeChildren(),null==t.pokers?void this.setTheeFaceDownPokers(e):void t.pokers.forEach(function(t){n.addOnePokerIntoSeatUI(e,t,!0)})},n.prototype.subGameEndRes=function(t){var n=e.Locales.get()["subgame.continue.countdown"],o=new CountDownTimer(n);this.grpTimer.addChild(o),o.timeStart(3)},n.prototype.gameEndRes=function(e){var t=this,n=e.content,o=new CountDownTimer(n);this.grpTimer.addChild(o),o.onComplete(function(){SceneManager.getInstance().popScene(t)}),o.timeStart(5)},n.prototype.leaveRoom=function(){var e=EventType.ROOM_LEAVE,t=new RoomLeaveReq,n=new EventReq(e,t);Network.getInstance().request(n,this.onLeaveRoomSuccess.bind(this),this.onLeaveRoomError.bind(this))},n.prototype.onLeaveRoomSuccess=function(e){console.log("onRoomLeaveSuccess:"+e.args()),RoomService.getInstance().setRoom(null)},n.prototype.onLeaveRoomError=function(e){console.log("onError:"+e.args()),TipsScene.getInstance().showError(e.getContent())},n}(eui.Component);e.TableScene=t,__reflect(t.prototype,"Zjh.TableScene",["eui.UIComponent","egret.DisplayObject"])}(Zjh||(Zjh={}));var Zjh;!function(e){var t=function(){function e(){}return e.pokerIds=[1,2,3,4,49,50,51,52,45,46,47,48,41,42,43,44,37,38,39,40,33,34,35,36,29,30,31,32,25,26,27,28,21,22,23,24,17,18,19,20,13,14,15,16,9,10,11,12,5,6,7,8,53,54],e.opsTypeToCN={NONE:"无操作",CALL:"跟注",RAISE:"加注",ALLIN:"押满",FOLD:"弃牌",KILL:"比牌",LOOK:"看牌",SHOWDOWN:"开牌"},e.opsTypeToSound={NONE:"no_ops_mp3",CALL:"call_0_mp3",RAISE:"raise_0_mp3",ALLIN:"allIn_0_mp3",FOLD:"fold_0_mp3",KILL:"kill_card_0_mp3",LOOK:"look_card_0_mp3",SHOWDOWN:"no_ops_mp3"},e.pokerTypesToCN={fold:"弃牌",DanZi:"散牌",DuiZi:"对子",ShunZi:"顺子",ShunJin:"顺金",BaoZi:"豹子"},e.pokerTypesToImage={fold:"zjh_fold_png",DanZi:"zjh_type_0_png",DuiZi:"zjh_type_1_png",ShunZi:"zjh_type_2_png",JinHua:"zjh_type_3_png",ShunJin:"zjh_type_4_png",BaoZi:"zjh_type_5_png"},e}();e.Utils=t,__reflect(t.prototype,"Zjh.Utils")}(Zjh||(Zjh={}));